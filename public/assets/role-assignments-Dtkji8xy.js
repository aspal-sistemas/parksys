import{a2 as o,j as e,aX as K,f as p,g as w,o as y,i as N,h as T,dX as W,ab as U,Q as m,V as x,W as h,Y as j,_ as i,B as l,bF as X,a4 as Y,O as Q,D as $,L as Z,e as ee,bH as se,bI as ae,bJ as k,bK as c,ao as E,bL as ie,bM as d,ah as le,n as re,w as I,x as q,au as ne,y as B,z as G,I as M,J as P,N as n,bq as te,cb as f,U as ce}from"./index-D5qLf1ib.js";import{S as b,R as C,a as V}from"./RoleBadge-D5voYAx-.js";import{u as de}from"./RoleGuard-BpTshTfO.js";import{U as oe}from"./user-plus-De6O1CpJ.js";import"./gem-dXiyKzl3.js";const z=[{id:1,name:"Ana García Ruiz",email:"ana.garcia@guadalajara.gob.mx",currentRole:"director-general",department:"Dirección General",status:"active",lastLogin:"2 horas"},{id:2,name:"Carlos Mendoza Torres",email:"carlos.mendoza@guadalajara.gob.mx",currentRole:"coordinador-parques",department:"Parques y Jardines",status:"active",lastLogin:"15 min"},{id:3,name:"María Elena Vázquez",email:"maria.vazquez@guadalajara.gob.mx",currentRole:"coordinador-actividades",department:"Actividades Recreativas",status:"active",lastLogin:"30 min"},{id:4,name:"Roberto Silva Jiménez",email:"roberto.silva@guadalajara.gob.mx",currentRole:"admin-financiero",department:"Administración",status:"active",lastLogin:"1 hora"},{id:5,name:"Laura Fernández Morales",email:"laura.fernandez@guadalajara.gob.mx",currentRole:"operador-parque",department:"Operaciones",status:"active",lastLogin:"5 min"},{id:6,name:"Diego Ramírez Castro",email:"diego.ramirez@guadalajara.gob.mx",currentRole:"operador-parque",department:"Operaciones",status:"inactive",lastLogin:"3 días"},{id:7,name:"Patricia López Herrera",email:"patricia.lopez@guadalajara.gob.mx",currentRole:"consultor-auditor",department:"Auditoría",status:"active",lastLogin:"2 días"},{id:8,name:"Fernando González Medina",email:"fernando.gonzalez@guadalajara.gob.mx",currentRole:"coordinador-parques",department:"Parques y Jardines",status:"active",lastLogin:"45 min"}],ge=()=>{const[u,J]=o.useState(""),[R,O]=o.useState("all"),[r,t]=o.useState([]),[g,L]=o.useState("");o.useState(null),o.useState(null);const A=de(),v=z.filter(s=>(s.name.toLowerCase().includes(u.toLowerCase())||s.email.toLowerCase().includes(u.toLowerCase())||s.department.toLowerCase().includes(u.toLowerCase()))&&(R==="all"||s.currentRole===R)),F=(s,a)=>{t(a?S=>[...S,s]:S=>S.filter(_=>_!==s))},D=()=>{if(!A.canAdmin("Seguridad")){f({title:"Sin permisos",description:"No tienes permisos para asignar roles",variant:"destructive"});return}if(r.length===0||!g){f({title:"Selección incompleta",description:"Selecciona usuarios y un rol a asignar",variant:"destructive"});return}f({title:"Roles asignados",description:`Se asignó el rol a ${r.length} usuarios`}),t([]),L("")},H=b.map(s=>({...s,userCount:z.filter(a=>a.currentRole===s.id).length,activeCount:z.filter(a=>a.currentRole===s.id&&a.status==="active").length}));return e.jsxs(K,{title:"Asignación de Usuarios",subtitle:"Gestión masiva de roles y permisos de usuario",children:[e.jsx("div",{className:"grid gap-4 md:grid-cols-4 mb-6",children:H.filter(s=>s.userCount>0).slice(0,4).map(s=>e.jsxs(p,{className:"bg-gradient-to-br from-blue-50 to-indigo-50 border-blue-200",children:[e.jsx(w,{className:"pb-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(C,{roleId:s.id,size:"sm"}),e.jsx(y,{variant:"outline",children:s.userCount})]})}),e.jsxs(N,{children:[e.jsx("div",{className:"text-2xl font-bold text-blue-900",children:s.activeCount}),e.jsx("p",{className:"text-xs text-blue-700",children:"usuarios activos"})]})]},s.id))}),e.jsxs(p,{className:"mb-6",children:[e.jsxs(w,{children:[e.jsxs(T,{className:"flex items-center",children:[e.jsx(W,{className:"h-5 w-5 mr-2"}),"Asignación Masiva de Roles"]}),e.jsx(U,{children:"Selecciona usuarios y asigna roles de forma masiva"})]}),e.jsx(N,{children:e.jsxs("div",{className:"flex gap-4 items-center",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("label",{className:"text-sm font-medium text-gray-700 mb-1 block",children:["Nuevo rol para usuarios seleccionados (",r.length,")"]}),e.jsxs(m,{value:g,onValueChange:L,children:[e.jsx(x,{children:e.jsx(h,{placeholder:"Seleccionar rol a asignar"})}),e.jsx(j,{children:b.map(s=>e.jsx(i,{value:s.id,children:e.jsx(C,{roleId:s.id,size:"sm"})},s.id))})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(l,{onClick:D,disabled:r.length===0||!g||!A.canAdmin("Seguridad"),children:[e.jsx(oe,{className:"h-4 w-4 mr-2"}),"Asignar Roles"]}),e.jsxs(l,{variant:"outline",onClick:()=>t([]),disabled:r.length===0,children:[e.jsx(X,{className:"h-4 w-4 mr-2"}),"Limpiar"]})]})]})})]}),e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Y,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(Q,{placeholder:"Buscar usuarios...",value:u,onChange:s=>J(s.target.value),className:"pl-10 w-80"})]}),e.jsxs(m,{value:R,onValueChange:O,children:[e.jsx(x,{className:"w-48",children:e.jsx(h,{placeholder:"Filtrar por rol"})}),e.jsxs(j,{children:[e.jsx(i,{value:"all",children:"Todos los roles"}),b.map(s=>e.jsx(i,{value:s.id,children:e.jsx(C,{roleId:s.id,size:"sm"})},s.id))]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(l,{variant:"outline",children:[e.jsx($,{className:"h-4 w-4 mr-2"}),"Exportar"]}),e.jsx(Z,{href:"/admin/roles",children:e.jsxs(l,{variant:"outline",children:[e.jsx(ee,{className:"h-4 w-4 mr-2"}),"Gestión de Roles"]})})]})]}),e.jsxs(p,{children:[e.jsxs(w,{children:[e.jsx(T,{children:"Usuarios del Sistema"}),e.jsx(U,{children:"Gestiona asignaciones individuales y masivas de roles de usuario"})]}),e.jsx(N,{children:e.jsxs(se,{children:[e.jsx(ae,{children:e.jsxs(k,{children:[e.jsx(c,{className:"w-12",children:e.jsx(E,{checked:r.length===v.length&&v.length>0,onCheckedChange:s=>{t(s?v.map(a=>a.id):[])}})}),e.jsx(c,{children:"Usuario"}),e.jsx(c,{children:"Rol Actual"}),e.jsx(c,{children:"Departamento"}),e.jsx(c,{children:"Estado"}),e.jsx(c,{children:"Última Conexión"}),e.jsx(c,{className:"text-right",children:"Acciones"})]})}),e.jsx(ie,{children:v.map(s=>e.jsxs(k,{children:[e.jsx(d,{children:e.jsx(E,{checked:r.includes(s.id),onCheckedChange:a=>F(s.id,a)})}),e.jsx(d,{children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.name}),e.jsx("div",{className:"text-sm text-gray-500",children:s.email})]})}),e.jsx(d,{children:e.jsx(V,{roleId:s.currentRole})}),e.jsx(d,{children:e.jsx("span",{className:"text-sm",children:s.department})}),e.jsx(d,{children:e.jsx(y,{variant:s.status==="active"?"default":"secondary",children:s.status==="active"?e.jsxs(e.Fragment,{children:[e.jsx(le,{className:"h-3 w-3 mr-1"}),"Activo"]}):e.jsxs(e.Fragment,{children:[e.jsx(re,{className:"h-3 w-3 mr-1"}),"Inactivo"]})})}),e.jsx(d,{children:e.jsx("span",{className:"text-sm text-gray-600",children:s.lastLogin})}),e.jsx(d,{className:"text-right",children:e.jsxs("div",{className:"flex items-center gap-2 justify-end",children:[e.jsxs(I,{children:[e.jsx(q,{asChild:!0,children:e.jsx(l,{variant:"ghost",size:"sm",children:e.jsx(ne,{className:"h-4 w-4"})})}),e.jsxs(B,{className:"max-w-md",children:[e.jsxs(G,{children:[e.jsx(M,{children:"Detalles del Usuario"}),e.jsx(P,{children:"Información completa del perfil del usuario"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(n,{className:"text-sm font-medium",children:"Nombre Completo"}),e.jsx("p",{className:"text-sm text-gray-600",children:s.name})]}),e.jsxs("div",{children:[e.jsx(n,{className:"text-sm font-medium",children:"Correo Electrónico"}),e.jsx("p",{className:"text-sm text-gray-600",children:s.email})]}),e.jsxs("div",{children:[e.jsx(n,{className:"text-sm font-medium",children:"Rol Actual"}),e.jsx("div",{className:"mt-1",children:e.jsx(C,{roleId:s.currentRole})})]}),e.jsxs("div",{children:[e.jsx(n,{className:"text-sm font-medium",children:"Departamento"}),e.jsx("p",{className:"text-sm text-gray-600",children:s.department})]}),e.jsxs("div",{children:[e.jsx(n,{className:"text-sm font-medium",children:"Estado"}),e.jsx("div",{className:"mt-1",children:e.jsx(y,{variant:s.status==="active"?"default":"secondary",children:s.status==="active"?"Activo":"Inactivo"})})]}),e.jsxs("div",{children:[e.jsx(n,{className:"text-sm font-medium",children:"Última Conexión"}),e.jsx("p",{className:"text-sm text-gray-600",children:s.lastLogin})]})]})]})]}),e.jsxs(I,{children:[e.jsx(q,{asChild:!0,children:e.jsx(l,{variant:"ghost",size:"sm",children:e.jsx(te,{className:"h-4 w-4"})})}),e.jsxs(B,{className:"max-w-md",children:[e.jsxs(G,{children:[e.jsx(M,{children:"Editar Usuario"}),e.jsx(P,{children:"Modifica la información del usuario y sus asignaciones"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(n,{className:"text-sm font-medium",children:"Rol"}),e.jsxs(m,{defaultValue:s.currentRole,children:[e.jsx(x,{children:e.jsx(h,{})}),e.jsx(j,{children:b.map(a=>e.jsx(i,{value:a.id,children:e.jsx(V,{roleId:a.id,size:"sm"})},a.id))})]})]}),e.jsxs("div",{children:[e.jsx(n,{className:"text-sm font-medium",children:"Departamento"}),e.jsxs(m,{defaultValue:s.department,children:[e.jsx(x,{children:e.jsx(h,{})}),e.jsxs(j,{children:[e.jsx(i,{value:"Dirección General",children:"Dirección General"}),e.jsx(i,{value:"Parques y Jardines",children:"Parques y Jardines"}),e.jsx(i,{value:"Actividades Recreativas",children:"Actividades Recreativas"}),e.jsx(i,{value:"Administración",children:"Administración"}),e.jsx(i,{value:"Operaciones",children:"Operaciones"}),e.jsx(i,{value:"Auditoría",children:"Auditoría"})]})]})]}),e.jsxs("div",{children:[e.jsx(n,{className:"text-sm font-medium",children:"Estado"}),e.jsxs(m,{defaultValue:s.status,children:[e.jsx(x,{children:e.jsx(h,{})}),e.jsxs(j,{children:[e.jsx(i,{value:"active",children:"Activo"}),e.jsx(i,{value:"inactive",children:"Inactivo"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(l,{variant:"outline",children:"Cancelar"}),e.jsx(l,{onClick:()=>{f({title:"Usuario actualizado",description:"Los cambios se han guardado exitosamente"})},children:"Guardar Cambios"})]})]})]})]})]})})]},s.id))})]})})]}),r.length>0&&e.jsx(p,{className:"mt-6 border-blue-200 bg-blue-50",children:e.jsx(N,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ce,{className:"h-5 w-5 text-blue-600"}),e.jsxs("span",{className:"font-medium text-blue-800",children:[r.length," usuarios seleccionados"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(l,{size:"sm",onClick:()=>t([]),children:"Limpiar selección"}),e.jsx(l,{size:"sm",onClick:D,disabled:!g,children:"Asignar rol seleccionado"})]})]})})})]})};export{ge as default};
