import{ad as M,l as Re,ae as _e,a2 as o,af as Ge,u as me,ag as he,j as e,aX as Je,f as x,av as z,B as l,b1 as Ue,b2 as We,b3 as ue,a7 as Se,b4 as ge,c_ as Q,aN as v,i as p,o as j,bh as ae,bn as T,a4 as ke,O as Ee,X as Ie,Q as K,V as O,W as $,Y as B,_ as f,dl as Me,dm as Xe,a6 as He,aM as Pe,aT as Te,w as Ye,y as Ze,z as es,I as ss,J as as,ai as ls,aj as R,ak as _,al as G,am as J,an as U,$ as rs,bC as ts,aQ as is,aZ as ns,dn as cs,bD as ds,dp as os,bp as xs,ap as ms,aq as je}from"./index-D5qLf1ib.js";import{F as hs}from"./folder-plus-DFwVL9m-.js";import{P as L}from"./pen-DCU0qVnc.js";import{C as us}from"./camera-CeZ3mmMV.js";const gs=M.object({name:M.string().min(2,"El nombre debe tener al menos 2 caracteres"),description:M.string().optional(),icon:M.string().min(1,"Selecciona un Ã­cono"),color:M.string().min(4,"Selecciona un color"),parentId:M.number().nullable().optional()}),le=[{value:"building2",label:"Infraestructura",icon:is},{value:"wrench",label:"Herramientas",icon:ns},{value:"car",label:"VehÃ­culos",icon:cs},{value:"lightbulb",label:"IluminaciÃ³n",icon:ds},{value:"camera",label:"Seguridad",icon:us},{value:"wifi",label:"TecnologÃ­a",icon:os},{value:"tag",label:"General",icon:z},{value:"settings",label:"Equipos",icon:xs},{value:"treePine",label:"JardinerÃ­a",icon:Te},{value:"folderOpen",label:"CategorÃ­a",icon:Me}],js=[{value:"#3B82F6",label:"Azul",bg:"bg-blue-500"},{value:"#10B981",label:"Verde",bg:"bg-emerald-500"},{value:"#F59E0B",label:"Naranja",bg:"bg-amber-500"},{value:"#6366F1",label:"Ãndigo",bg:"bg-indigo-500"},{value:"#EC4899",label:"Rosa",bg:"bg-pink-500"},{value:"#8B5CF6",label:"PÃºrpura",bg:"bg-violet-500"},{value:"#EF4444",label:"Rojo",bg:"bg-red-500"},{value:"#14B8A6",label:"Teal",bg:"bg-teal-500"},{value:"#067f5f",label:"Verde Parques",bg:"bg-green-700"},{value:"#00a587",label:"Verde Principal",bg:"bg-green-600"}],fs=()=>{const{toast:w}=Re(),u=_e(),[F,W]=o.useState(!1),[Le,X]=o.useState(!1),[ve,re]=o.useState(null),[H,Fe]=o.useState(null),[qe,De]=o.useState("list"),[te,ie]=o.useState(new Set),[c,Ae]=o.useState(!0),[m,Y]=o.useState(1),[C,ne]=o.useState(""),[S,pe]=o.useState("all"),[q,be]=o.useState("all"),[Z,Ne]=o.useState("compact"),[b,D]=o.useState(1),d=10,g=Ge({resolver:ms(gs),defaultValues:{name:"",description:"",icon:"tag",color:"#3B82F6",parentId:null}}),{data:n=[],isLoading:Ve}=me({queryKey:["/api/asset-categories"]}),{data:A=[]}=me({queryKey:["/api/asset-categories/parents"]}),{data:h=[]}=me({queryKey:["/api/asset-categories/tree/structure"]}),Qe=o.useMemo(()=>Array.from(new Set(n.map(a=>a.icon))).sort(),[n]),N=o.useMemo(()=>{let s=n;return C&&(s=s.filter(a=>{var t,r;return a.name.toLowerCase().includes(C.toLowerCase())||((t=a.description)==null?void 0:t.toLowerCase().includes(C.toLowerCase()))||((r=a.parentName)==null?void 0:r.toLowerCase().includes(C.toLowerCase()))})),S!=="all"&&(s=s.filter(a=>S==="principal"?a.parentId===null:S==="subcategoria"?a.parentId!==null:!0)),q!=="all"&&(s=s.filter(a=>a.icon===q)),s},[n,C,S,q]),k=Math.ceil(N.length/d),ee=(b-1)*d,ce=ee+d,de=N.slice(ee,ce),se=()=>{D(1)},oe=he({mutationFn:async s=>await(await je("/api/asset-categories",{method:"POST",data:s})).json(),onSuccess:s=>{console.log("CategorÃ­a creada exitosamente:",s),u.refetchQueries({queryKey:["/api/asset-categories"]}),u.refetchQueries({queryKey:["/api/asset-categories/parents"]}),u.refetchQueries({queryKey:["/api/asset-categories/tree/structure"]}),setTimeout(()=>{u.invalidateQueries({queryKey:["/api/asset-categories"]}),u.invalidateQueries({queryKey:["/api/asset-categories/parents"]}),u.invalidateQueries({queryKey:["/api/asset-categories/tree/structure"]})},100),W(!1),g.reset(),w({title:"âœ… CategorÃ­a creada",description:"La categorÃ­a se ha creado correctamente."})},onError:s=>{w({title:"âŒ Error",description:s.message||"Error al crear la categorÃ­a",variant:"destructive"})}}),xe=he({mutationFn:async({id:s,data:a})=>await(await je(`/api/asset-categories/${s}`,{method:"PUT",data:a})).json(),onSuccess:()=>{u.refetchQueries({queryKey:["/api/asset-categories"]}),u.refetchQueries({queryKey:["/api/asset-categories/parents"]}),u.refetchQueries({queryKey:["/api/asset-categories/tree/structure"]}),X(!1),re(null),g.reset(),w({title:"âœ… CategorÃ­a actualizada",description:"La categorÃ­a se ha actualizado correctamente."})},onError:s=>{w({title:"âŒ Error",description:s.message||"Error al actualizar la categorÃ­a",variant:"destructive"})}}),Ke=he({mutationFn:async s=>await(await je(`/api/asset-categories/${s}`,{method:"DELETE"})).json(),onSuccess:()=>{u.refetchQueries({queryKey:["/api/asset-categories"]}),u.refetchQueries({queryKey:["/api/asset-categories/parents"]}),u.refetchQueries({queryKey:["/api/asset-categories/tree/structure"]}),w({title:"âœ… CategorÃ­a eliminada",description:"La categorÃ­a se ha eliminado correctamente."})},onError:s=>{w({title:"âŒ Error",description:s.message||"Error al eliminar la categorÃ­a",variant:"destructive"})}}),Oe=s=>{const a={...s,parentId:H||s.parentId||null};oe.mutate(a)},E=s=>{re(s),g.reset({name:s.name,description:s.description||"",icon:s.icon,color:s.color,parentId:s.parentId}),X(!0)},$e=s=>{ve&&xe.mutate({id:ve.id,data:s})},I=s=>{window.confirm(`Â¿EstÃ¡s seguro de eliminar la categorÃ­a "${s.name}"?`)&&Ke.mutate(s.id)},V=(s=null)=>{Fe(s),g.reset({name:"",description:"",icon:"tag",color:"#3B82F6",parentId:s}),W(!0)},fe=s=>{const a=new Set(te);a.has(s)?a.delete(s):a.add(s),ie(a)},Ce=()=>{const s=A.filter(a=>n.filter(r=>r.parentId===a.id).length>0).map(a=>a.id);ie(new Set(s))},ye=()=>{ie(new Set)},y=(s,a=20)=>{var r;const t=((r=le.find(i=>i.value===s))==null?void 0:r.icon)||z;return e.jsx(t,{size:a})},ze=({category:s,isSubcategory:a=!1})=>e.jsx(x,{className:`transition-all hover:shadow-md ${a?"ml-6 border-l-4":""}`,style:a?{borderLeftColor:s.color}:{},children:e.jsx(p,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg",style:{backgroundColor:`${s.color}20`,color:s.color},children:y(s.icon,24)}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg",children:s.name}),s.description&&e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:s.description}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[s.parentName&&e.jsxs(j,{variant:"outline",className:"text-xs",children:["ðŸ“ ",s.parentName]}),s.hasChildren&&e.jsxs(j,{variant:"secondary",className:"text-xs",children:[s.childrenCount," subcategorÃ­a(s)"]})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[!a&&e.jsx(l,{size:"sm",variant:"outline",onClick:()=>V(s.id),children:e.jsx(ae,{size:16})}),e.jsx(l,{size:"sm",variant:"outline",onClick:()=>E(s),children:e.jsx(L,{size:16})}),e.jsx(l,{size:"sm",variant:"destructive",onClick:()=>I(s),children:e.jsx(T,{size:16})})]})]})})}),we=({category:s})=>{const a=n.filter(i=>i.parentId===s.id),t=a.length>0,r=te.has(s.id);return s.parentId?e.jsx(x,{className:"transition-all hover:shadow-md ml-8 border-l-4",style:{borderLeftColor:s.color},children:e.jsx(p,{className:"p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"p-2 rounded-lg",style:{backgroundColor:`${s.color}20`,color:s.color},children:y(s.icon,20)}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h4",{className:"text-base font-medium text-gray-900",children:s.name}),e.jsx(j,{variant:"secondary",className:"text-xs",children:"SubcategorÃ­a"})]}),s.description&&e.jsx("p",{className:"text-gray-600 text-sm",children:s.description})]})]}),e.jsx("div",{className:"flex items-center gap-4 text-xs text-gray-500 ml-11",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(z,{size:12}),e.jsxs("span",{children:["ID: ",s.id]})]})})]}),e.jsxs("div",{className:"flex gap-1 ml-4",children:[e.jsx(l,{size:"sm",variant:"outline",onClick:()=>E(s),className:"text-green-600 hover:bg-green-50 h-8 w-8 p-0",children:e.jsx(L,{size:14})}),e.jsx(l,{size:"sm",variant:"outline",onClick:()=>I(s),className:"text-red-600 hover:bg-red-50 h-8 w-8 p-0",children:e.jsx(T,{size:14})})]})]})})}):e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{className:"transition-all hover:shadow-md border-l-4",style:{borderLeftColor:s.color},children:e.jsx(p,{className:"p-6",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[t&&e.jsx(l,{variant:"ghost",size:"sm",onClick:()=>fe(s.id),className:"p-1 h-8 w-8 hover:bg-gray-100 self-start",children:r?e.jsx(Q,{size:16,className:"text-blue-600"}):e.jsx(v,{size:16,className:"text-gray-600"})}),!t&&e.jsx("div",{className:"w-8"}),e.jsx("div",{className:"p-3 rounded-lg",style:{backgroundColor:`${s.color}20`,color:s.color},children:y(s.icon,24)}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:s.name}),e.jsx(j,{variant:"default",className:"text-xs",children:"Principal"}),t&&e.jsxs(j,{variant:"outline",className:"text-xs",children:[a.length," subcategorÃ­a(s)"]})]}),s.description&&e.jsx("p",{className:"text-gray-600 text-sm leading-relaxed",children:s.description})]})]}),e.jsxs("div",{className:"flex items-center gap-6 text-sm text-gray-500 ml-12",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(z,{size:14}),e.jsxs("span",{children:["ID: ",s.id]})]}),t&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(v,{size:14}),e.jsxs("span",{children:[a.length," subcategorÃ­as"]})]})]})]}),e.jsxs("div",{className:"flex gap-2 ml-4",children:[e.jsxs(l,{size:"sm",variant:"outline",onClick:()=>V(s.id),className:"text-blue-600 hover:bg-blue-50",children:[e.jsx(ae,{size:16,className:"mr-1"}),"SubcategorÃ­a"]}),e.jsx(l,{size:"sm",variant:"outline",onClick:()=>E(s),className:"text-green-600 hover:bg-green-50",children:e.jsx(L,{size:16})}),e.jsx(l,{size:"sm",variant:"outline",onClick:()=>I(s),className:"text-red-600 hover:bg-red-50",children:e.jsx(T,{size:16})})]})]})})}),t&&r&&e.jsx("div",{className:"space-y-2 border-l-2 border-gray-200 pl-4 ml-4",children:a.map(i=>e.jsx(we,{category:i},i.id))})]})};return Ve?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Cargando categorÃ­as..."})]})}):e.jsx(Je,{children:e.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[e.jsx(x,{className:"p-4 bg-gray-50 mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(z,{className:"w-8 h-8 text-gray-900"}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"CategorÃ­as de Activos"})]}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Gestiona las categorÃ­as jerÃ¡rquicas para organizar tus activos"})]}),e.jsxs(l,{onClick:()=>V(),className:"bg-blue-600 hover:bg-blue-700 text-white",children:[e.jsx(hs,{className:"mr-2",size:20}),"Nueva CategorÃ­a Principal"]})]})}),e.jsxs(Ue,{value:qe,onValueChange:De,className:"w-full",children:[e.jsxs(We,{className:"grid w-full grid-cols-3",children:[e.jsx(ue,{value:"list",children:e.jsxs("div",{className:"flex items-center gap-2",children:["Lista Completa",e.jsx(Se,{size:14,className:"text-blue-500"})]})}),e.jsx(ue,{value:"hierarchy",children:"Vista JerÃ¡rquica"}),e.jsx(ue,{value:"tree",children:"Estructura de Ãrbol"})]}),e.jsxs(ge,{value:"hierarchy",className:"space-y-6",children:[e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsxs(l,{variant:"outline",size:"sm",onClick:Ce,className:"text-blue-600 hover:bg-blue-50",children:[e.jsx(Q,{size:16,className:"mr-2"}),"Expandir Todo"]}),e.jsxs(l,{variant:"outline",size:"sm",onClick:ye,className:"text-gray-600 hover:bg-gray-50",children:[e.jsx(v,{size:16,className:"mr-2"}),"Contraer Todo"]})]}),A.map(s=>{const a=n.filter(i=>i.parentId===s.id),t=a.length>0,r=te.has(s.id);return e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{className:"transition-all hover:shadow-md border-l-4",style:{borderLeftColor:s.color},children:e.jsx(p,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[t&&e.jsx(l,{variant:"ghost",size:"sm",onClick:()=>fe(s.id),className:"p-1 h-8 w-8 hover:bg-gray-100",children:r?e.jsx(Q,{size:16,className:"text-blue-600"}):e.jsx(v,{size:16,className:"text-gray-600"})}),!t&&e.jsx("div",{className:"w-8"}),e.jsx("div",{className:"p-2 rounded-lg",style:{backgroundColor:`${s.color}20`,color:s.color},children:y(s.icon,24)}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg",children:s.name}),s.description&&e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:s.description}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx(j,{variant:"secondary",className:"text-xs",children:"Principal"}),t&&e.jsxs(j,{variant:"outline",className:"text-xs",children:[a.length," subcategorÃ­a(s)"]})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(l,{size:"sm",variant:"outline",onClick:()=>V(s.id),className:"text-blue-600 hover:bg-blue-50",children:[e.jsx(ae,{size:16,className:"mr-1"}),"SubcategorÃ­a"]}),e.jsx(l,{size:"sm",variant:"outline",onClick:()=>E(s),className:"text-green-600 hover:bg-green-50",children:e.jsx(L,{size:16})}),e.jsx(l,{size:"sm",variant:"outline",onClick:()=>I(s),className:"text-red-600 hover:bg-red-50",children:e.jsx(T,{size:16})})]})]})})}),t&&r&&e.jsx("div",{className:"ml-8 space-y-2 border-l-2 border-gray-200 pl-4",children:a.map(i=>e.jsx(x,{className:"transition-all hover:shadow-sm border-l-4",style:{borderLeftColor:i.color},children:e.jsx(p,{className:"p-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-1.5 rounded-lg",style:{backgroundColor:`${i.color}20`,color:i.color},children:y(i.icon,20)}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-base",children:i.name}),i.description&&e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:i.description}),e.jsx(j,{variant:"outline",className:"text-xs mt-1",children:"SubcategorÃ­a"})]})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(l,{size:"sm",variant:"outline",onClick:()=>E(i),className:"text-green-600 hover:bg-green-50 h-8 w-8 p-0",children:e.jsx(L,{size:14})}),e.jsx(l,{size:"sm",variant:"outline",onClick:()=>I(i),className:"text-red-600 hover:bg-red-50 h-8 w-8 p-0",children:e.jsx(T,{size:14})})]})]})})},i.id))})]},s.id)}),n.filter(s=>!s.parentId&&!A.find(a=>a.id===s.id)).map(s=>e.jsx(ze,{category:s},s.id))]}),e.jsxs(ge,{value:"list",className:"space-y-6",children:[e.jsxs(x,{className:"p-4 bg-gray-50",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx("div",{className:"md:col-span-2",children:e.jsxs("div",{className:"relative",children:[e.jsx(ke,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:16}),e.jsx(Ee,{placeholder:"Buscar por nombre, descripciÃ³n o categorÃ­a padre...",value:C,onChange:s=>{ne(s.target.value),se()},className:"pl-10"}),C&&e.jsx(l,{variant:"ghost",size:"sm",onClick:()=>{ne(""),se()},className:"absolute right-2 top-1/2 transform -translate-y-1/2 h-6 w-6 p-0",children:e.jsx(Ie,{size:14})})]})}),e.jsx("div",{children:e.jsxs(K,{value:S,onValueChange:s=>{pe(s),se()},children:[e.jsx(O,{children:e.jsx($,{})}),e.jsxs(B,{children:[e.jsx(f,{value:"all",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Se,{size:16}),"Todos los tipos"]})}),e.jsx(f,{value:"principal",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Me,{size:16}),"Principales"]})}),e.jsx(f,{value:"subcategoria",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(v,{size:16}),"SubcategorÃ­as"]})})]})]})}),e.jsx("div",{children:e.jsxs(K,{value:q,onValueChange:s=>{be(s),se()},children:[e.jsx(O,{children:e.jsx($,{})}),e.jsxs(B,{children:[e.jsx(f,{value:"all",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(z,{size:16}),"Todos los iconos"]})}),Qe.map(s=>{var t,r;const a=((t=le.find(i=>i.value===s))==null?void 0:t.icon)||z;return e.jsx(f,{value:s,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(a,{size:16}),((r=le.find(i=>i.value===s))==null?void 0:r.label)||s]})},s)})]})]})})]}),e.jsxs("div",{className:"flex justify-between items-center mt-4 pt-4 border-t",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Mostrando ",de.length," de ",N.length," categorÃ­as",N.length!==n.length&&` (${n.length} en total)`]}),(C||S!=="all"||q!=="all")&&e.jsxs(l,{variant:"outline",size:"sm",onClick:()=>{ne(""),pe("all"),be("all"),D(1)},className:"text-gray-600",children:[e.jsx(Ie,{size:14,className:"mr-1"}),"Limpiar filtros"]})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Mostrando ",ee+1,"-",Math.min(ce,N.length)," de ",N.length," categorÃ­as"]}),e.jsxs("div",{className:"flex items-center gap-4",children:[Z==="extended"&&e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(l,{variant:"outline",size:"sm",onClick:Ce,className:"text-blue-600 hover:bg-blue-50",children:[e.jsx(Q,{size:14,className:"mr-1"}),"Expandir Todo"]}),e.jsxs(l,{variant:"outline",size:"sm",onClick:ye,className:"text-gray-600 hover:bg-gray-50",children:[e.jsx(v,{size:14,className:"mr-1"}),"Contraer Todo"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Vista:"}),e.jsxs("div",{className:"flex border rounded-md",children:[e.jsxs(l,{variant:Z==="compact"?"default":"ghost",size:"sm",onClick:()=>Ne("compact"),className:"rounded-r-none border-r-0",children:[e.jsx(Xe,{size:16,className:"mr-1"}),"Compacta"]}),e.jsxs(l,{variant:Z==="extended"?"default":"ghost",size:"sm",onClick:()=>Ne("extended"),className:"rounded-l-none",children:[e.jsx(He,{size:16,className:"mr-1"}),"Extendida"]})]})]})]})]}),Z==="compact"?e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:de.map(s=>e.jsx(ze,{category:s},s.id))}):e.jsx("div",{className:"space-y-4",children:de.filter(s=>!s.parentId).map(s=>e.jsx(we,{category:s},s.id))}),N.length===0&&e.jsx(x,{className:"p-8 text-center",children:e.jsxs("div",{className:"text-gray-500",children:[e.jsx(ke,{size:48,className:"mx-auto mb-4 text-gray-300"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No se encontraron categorÃ­as"}),e.jsx("p",{children:"Prueba ajustando los filtros o tÃ©rminos de bÃºsqueda"})]})}),k>1&&e.jsx(x,{className:"p-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["PÃ¡gina ",b," de ",k," - Mostrando ",ee+1,"-",Math.min(ce,N.length)," de ",N.length," categorÃ­as"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(l,{variant:"outline",size:"sm",onClick:()=>D(b-1),disabled:b===1,className:"flex items-center gap-1",children:[e.jsx(Pe,{size:16}),"Anterior"]}),e.jsx("div",{className:"flex gap-1",children:Array.from({length:Math.min(5,k)},(s,a)=>{const t=Math.max(1,Math.min(k-4,b-2))+a;return t>k?null:e.jsx(l,{variant:b===t?"default":"outline",size:"sm",onClick:()=>D(t),className:b===t?"bg-green-600 hover:bg-green-700":"",children:t},t)})}),e.jsxs(l,{variant:"outline",size:"sm",onClick:()=>D(b+1),disabled:b===k,className:"flex items-center gap-1",children:["Siguiente",e.jsx(v,{size:16})]})]})]})})]}),e.jsxs(ge,{value:"tree",className:"space-y-2",children:[e.jsx("div",{className:"mb-4 p-4 bg-gray-50 border border-gray-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Estructura de Ãrbol de CategorÃ­as"}),e.jsx(l,{variant:"outline",size:"sm",onClick:()=>{Ae(!c),Y(1)},className:"flex items-center gap-2",children:c?e.jsxs(e.Fragment,{children:[e.jsx(Q,{size:16}),"Contraer Todo"]}):e.jsxs(e.Fragment,{children:[e.jsx(v,{size:16}),"Expandir Todo"]})})]})}),e.jsx("div",{className:"mb-4 p-3 bg-gray-50 border border-gray-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600",children:[e.jsxs("span",{children:["Mostrando: ",Math.min(d,h.filter(s=>c||s.level===0).length-(m-1)*d)," de ",h.filter(s=>c||s.level===0).length," categorÃ­as"]}),e.jsxs("span",{children:["Estado: ",c?"EXPANDIDO":"CONTRAÃDO"," | PÃ¡gina ",m," de ",Math.ceil(h.filter(s=>c||s.level===0).length/d)]})]})}),h.filter(s=>c||s.level===0).slice((m-1)*d,m*d).map(s=>{var a,t;return e.jsx(x,{className:"transition-all hover:shadow-md border-l-4",style:{borderLeftColor:s.color},children:e.jsx(p,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{style:{marginLeft:`${(s.level||0)*32}px`},className:"flex items-center gap-3",children:[s.level&&s.level>0&&e.jsxs("div",{className:"flex items-center gap-1",children:[Array.from({length:s.level},(r,i)=>e.jsx("div",{className:"w-1 h-4 bg-gray-300 rounded"},i)),e.jsx(v,{size:16,className:"text-gray-500"})]}),e.jsx("div",{className:"p-2 rounded-lg",style:{backgroundColor:`${s.color}20`,color:s.color},children:y(s.icon,20)}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"font-semibold text-lg",children:s.name}),e.jsx(j,{variant:s.level===0?"default":"secondary",className:"text-xs",children:s.level===0?"Principal":`Nivel ${s.level}`}),s.pathNames&&e.jsxs(j,{variant:"outline",className:"text-xs",children:["ðŸ“ ",s.pathNames]})]}),((a=n.find(r=>r.id===s.id))==null?void 0:a.description)&&e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:(t=n.find(r=>r.id===s.id))==null?void 0:t.description})]})]}),e.jsxs("div",{className:"flex gap-2 ml-4",children:[s.level===0&&e.jsxs(l,{size:"sm",variant:"outline",onClick:()=>V(s.id),className:"text-blue-600 hover:bg-blue-50",children:[e.jsx(ae,{size:14,className:"mr-1"}),"Sub"]}),s.level===0&&!c&&n.filter(r=>r.parentId===s.id).length>0&&e.jsxs(j,{variant:"outline",className:"text-xs bg-yellow-50 border-yellow-300 text-yellow-700",children:["+",n.filter(r=>r.parentId===s.id).length," sub"]}),e.jsx(l,{size:"sm",variant:"outline",onClick:()=>E(n.find(r=>r.id===s.id)),className:"text-green-600 hover:bg-green-50",children:e.jsx(L,{size:14})}),e.jsx(l,{size:"sm",variant:"outline",onClick:()=>I(n.find(r=>r.id===s.id)),className:"text-red-600 hover:bg-red-50",children:e.jsx(T,{size:14})})]})]})})},s.id)}),h.filter(s=>c||s.level===0).length>d&&e.jsxs("div",{className:"mt-6 flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["PÃ¡gina ",m," de ",Math.ceil(h.filter(s=>c||s.level===0).length/d)," - Mostrando ",(m-1)*d+1,"-",Math.min(m*d,h.filter(s=>c||s.level===0).length)," de ",h.filter(s=>c||s.level===0).length," categorÃ­as"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(l,{variant:"outline",size:"sm",onClick:()=>Y(Math.max(1,m-1)),disabled:m===1,className:"flex items-center gap-1",children:[e.jsx(Pe,{size:16}),"Anterior"]}),e.jsx("div",{className:"flex gap-1",children:Array.from({length:Math.min(5,Math.ceil(h.filter(s=>c||s.level===0).length/d))},(s,a)=>{const t=Math.ceil(h.filter(Be=>c||Be.level===0).length/d);let r=Math.max(1,m-2),i=Math.min(t,r+4);i-r<4&&(r=Math.max(1,i-4));const P=r+a;return P<=t?e.jsx(l,{variant:P===m?"default":"outline",size:"sm",onClick:()=>Y(P),className:P===m?"bg-green-600 hover:bg-green-700":"",children:P},P):null})}),e.jsxs(l,{variant:"outline",size:"sm",onClick:()=>Y(Math.min(Math.ceil(h.filter(s=>c||s.level===0).length/d),m+1)),disabled:m>=Math.ceil(h.filter(s=>c||s.level===0).length/d),className:"flex items-center gap-1",children:["Siguiente",e.jsx(v,{size:16})]})]})]}),h.length===0&&e.jsx(x,{className:"p-8 text-center",children:e.jsxs("div",{className:"text-gray-500",children:[e.jsx(Te,{size:48,className:"mx-auto mb-4 text-gray-300"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No hay estructura de Ã¡rbol disponible"}),e.jsx("p",{children:"Crea algunas categorÃ­as principales y subcategorÃ­as para ver la estructura"})]})})]})]}),e.jsxs("div",{className:"mt-8 grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(x,{children:e.jsxs(p,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:n.length}),e.jsx("div",{className:"text-sm text-gray-600",children:"Total CategorÃ­as"})]})}),e.jsx(x,{children:e.jsxs(p,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:A.length}),e.jsx("div",{className:"text-sm text-gray-600",children:"CategorÃ­as Principales"})]})}),e.jsx(x,{children:e.jsxs(p,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:n.filter(s=>s.parentId).length}),e.jsx("div",{className:"text-sm text-gray-600",children:"SubcategorÃ­as"})]})}),e.jsx(x,{children:e.jsxs(p,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:Math.max(...h.map(s=>s.level||0))+1}),e.jsx("div",{className:"text-sm text-gray-600",children:"Niveles MÃ¡ximos"})]})})]}),e.jsx(Ye,{open:F||Le,onOpenChange:s=>{s||(W(!1),X(!1),re(null),g.reset())},children:e.jsxs(Ze,{className:"sm:max-w-md",children:[e.jsxs(es,{children:[e.jsx(ss,{children:F?"Nueva CategorÃ­a":"Editar CategorÃ­a"}),e.jsx(as,{children:F?"Crea una nueva categorÃ­a para organizar tus activos":"Modifica los datos de la categorÃ­a seleccionada"})]}),e.jsx(ls,{...g,children:e.jsxs("form",{onSubmit:g.handleSubmit(F?Oe:$e),className:"space-y-4",children:[e.jsx(R,{control:g.control,name:"name",render:({field:s})=>e.jsxs(_,{children:[e.jsx(G,{children:"Nombre *"}),e.jsx(J,{children:e.jsx(Ee,{placeholder:"Ej: Mobiliario Urbano",...s})}),e.jsx(U,{})]})}),e.jsx(R,{control:g.control,name:"description",render:({field:s})=>e.jsxs(_,{children:[e.jsx(G,{children:"DescripciÃ³n"}),e.jsx(J,{children:e.jsx(rs,{placeholder:"Describe brevemente esta categorÃ­a...",className:"resize-none",rows:3,...s})}),e.jsx(U,{})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(R,{control:g.control,name:"icon",render:({field:s})=>e.jsxs(_,{children:[e.jsx(G,{children:"Ãcono *"}),e.jsxs(K,{onValueChange:s.onChange,value:s.value,children:[e.jsx(J,{children:e.jsx(O,{children:e.jsx($,{placeholder:"Seleccionar Ã­cono"})})}),e.jsx(B,{children:le.map(a=>e.jsx(f,{value:a.value,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(a.icon,{size:16}),a.label]})},a.value))})]}),e.jsx(U,{})]})}),e.jsx(R,{control:g.control,name:"color",render:({field:s})=>e.jsxs(_,{children:[e.jsx(G,{children:"Color *"}),e.jsxs(K,{onValueChange:s.onChange,value:s.value,children:[e.jsx(J,{children:e.jsx(O,{children:e.jsx($,{placeholder:"Seleccionar color"})})}),e.jsx(B,{children:js.map(a=>e.jsx(f,{value:a.value,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-4 h-4 rounded-full ${a.bg}`}),a.label]})},a.value))})]}),e.jsx(U,{})]})})]}),F&&e.jsx(R,{control:g.control,name:"parentId",render:({field:s})=>e.jsxs(_,{children:[e.jsx(G,{children:"CategorÃ­a Padre (opcional)"}),e.jsxs(K,{onValueChange:a=>s.onChange(a==="null"?null:parseInt(a)),value:s.value?s.value.toString():(H==null?void 0:H.toString())||"null",children:[e.jsx(J,{children:e.jsx(O,{children:e.jsx($,{placeholder:"Seleccionar categorÃ­a padre"})})}),e.jsxs(B,{children:[e.jsx(f,{value:"null",children:"Sin categorÃ­a padre (Principal)"}),A.map(a=>e.jsx(f,{value:a.id.toString(),children:e.jsxs("div",{className:"flex items-center gap-2",children:[y(a.icon,16),a.name]})},a.id))]})]}),e.jsx(U,{})]})}),e.jsxs(ts,{children:[e.jsx(l,{type:"button",variant:"outline",onClick:()=>{W(!1),X(!1)},children:"Cancelar"}),e.jsx(l,{type:"submit",disabled:oe.isPending||xe.isPending,children:oe.isPending||xe.isPending?"Guardando...":"Guardar"})]})]})})]})})]})})};export{fs as default};
