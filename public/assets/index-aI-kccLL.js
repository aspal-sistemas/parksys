import{c as le,az as ne,a2 as m,u as ce,R as z,j as e,aX as oe,B as g,bQ as L,f as de,g as me,h as ue,ab as he,i as xe,a4 as ge,O as je,Q as F,V as O,m as B,W as V,Y as H,_ as n,b as _,K as pe,bH as fe,bI as ve,bJ as Q,bK as u,bL as _e,bM as h,a8 as W,a9 as G,aa as J,o as A,au as K,cN as we,cO as ye,cP as Ne,cQ as be,cR as Ce,cS as U,ah as De,cw as Se,cx as Ee,cz as w,cy as Ae,cA as Me,cB as ke,w as Pe,y as Ie,z as Te,I as qe,J as Re,t as ze,aW as Le,r as Fe,a1 as Oe}from"./index-D5qLf1ib.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Be=le("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);function He(){ne();const[x,Y]=m.useState(""),[j,X]=m.useState("all"),[p,Z]=m.useState("all"),[l,$]=m.useState(1),[s,ee]=m.useState(null),[ae,M]=m.useState(!1),se=[{id:1,instructor_id:1,assignment_id:1,evaluator_id:1,created_at:new Date().toISOString(),evaluation_date:new Date().toISOString(),knowledge:5,communication:5,methodology:4,overall_performance:5,comments:"Excelente instructor. Los participantes quedaron muy satisfechos con la actividad.",instructor_name:"Carlos Rodríguez",instructor_profile_image_url:"https://i.pravatar.cc/150?img=1",activity_title:"Taller de Yoga en el Parque",evaluator_type:"supervisor",follow_up_required:!1,follow_up_notes:"",professionalism:5,teaching_clarity:4,active_participation:5,group_management:4},{id:2,instructor_id:2,assignment_id:2,evaluator_id:1,created_at:new Date(Date.now()-2*24*60*60*1e3).toISOString(),evaluation_date:new Date(Date.now()-2*24*60*60*1e3).toISOString(),knowledge:4,communication:5,methodology:5,overall_performance:4,comments:"Muy buen manejo de grupo y excelente comunicación con los participantes.",instructor_name:"Ana Martínez",instructor_profile_image_url:"https://i.pravatar.cc/150?img=5",activity_title:"Clases de Pintura al Aire Libre",evaluator_type:"supervisor",follow_up_required:!1,follow_up_notes:"",professionalism:4,teaching_clarity:5,active_participation:5,group_management:4},{id:3,instructor_id:3,assignment_id:3,evaluator_id:1,created_at:new Date(Date.now()-5*24*60*60*1e3).toISOString(),evaluation_date:new Date(Date.now()-5*24*60*60*1e3).toISOString(),knowledge:5,communication:4,methodology:5,overall_performance:5,comments:"Excelente conocimiento del tema y buena metodología de enseñanza.",instructor_name:"Roberto García",instructor_profile_image_url:"https://i.pravatar.cc/150?img=3",activity_title:"Taller de Jardinería Urbana",evaluator_type:"supervisor",follow_up_required:!1,follow_up_notes:"",professionalism:5,teaching_clarity:5,active_participation:4,group_management:5}],{data:y,isLoading:te,isError:re,refetch:N}=ce({queryKey:["/api/instructors-evaluations"],suspense:!1,retry:1,meta:{errorMessage:"Error al cargar evaluaciones. Mostrando datos de ejemplo."}}),b=(y==null?void 0:y.data)||[],o=Array.isArray(b)&&b.length>0?b:se,C=a=>{if(!a)return"Fecha desconocida";try{const i=new Date(a);return Fe(i,"dd MMM yyyy",{locale:Oe})}catch{return"Fecha inválida"}},c=a=>{const i=[],r=Math.floor(a),E=a%1>=.5;for(let t=1;t<=5;t++)t<=r?i.push(e.jsx(_,{className:"fill-yellow-400 text-yellow-400 h-4 w-4"},t)):t===r+1&&E?i.push(e.jsx(_,{className:"fill-yellow-400 text-yellow-400 h-4 w-4 fill-half"},t)):i.push(e.jsx(_,{className:"text-gray-300 h-4 w-4"},t));return e.jsx("div",{className:"flex",children:i})},f=z.useMemo(()=>!o||!Array.isArray(o)||o.length===0?(console.log("No hay evaluaciones disponibles o no es un array:",o),[]):(console.log("Evaluaciones cargadas:",o.length),o.filter(a=>{const i=!x||a.instructor_name&&a.instructor_name.toLowerCase().includes(x.toLowerCase())||a.activity_title&&a.activity_title.toLowerCase().includes(x.toLowerCase()),r=j==="all"||(()=>{if(!a.evaluation_date)return!1;const t=new Date,v=new Date(a.evaluation_date);switch(j){case"today":return v.toDateString()===t.toDateString();case"week":const T=new Date(t);return T.setDate(t.getDate()-7),v>=T;case"month":const q=new Date(t);return q.setMonth(t.getMonth()-1),v>=q;case"quarter":const R=new Date(t);return R.setMonth(t.getMonth()-3),v>=R;default:return!0}})(),E=p==="all"||(()=>{const t=a.overall_performance||0;switch(p){case"excellent":return t>=4.5;case"good":return t>=4&&t<4.5;case"average":return t>=3&&t<4;case"below":return t<3;default:return!0}})();return i&&r&&E})),[o,x,j,p]),D=10,d=Math.ceil(f.length/D),ie=z.useMemo(()=>{const a=(l-1)*D;return f.slice(a,a+D)},[f,l]),S=a=>{$(a)},k=a=>{console.log("Mostrando evaluación:",a);const i={...a,evaluation_date:a.evaluation_date||a.created_at||new Date().toISOString(),instructor_name:a.instructor_name||"Instructor",instructor_profile_image_url:a.instructor_profile_image_url||"",activity_title:a.activity_title||"Actividad",professionalism:a.professionalism||0,teaching_clarity:a.teaching_clarity||0,active_participation:a.active_participation||0,communication:a.communication||0,group_management:a.group_management||0,knowledge:a.knowledge||0,methodology:a.methodology||0,overall_performance:a.overall_performance||0,comments:a.comments||"Sin comentarios",evaluator_type:a.evaluator_type||"supervisor",follow_up_required:a.follow_up_required||!1,follow_up_notes:a.follow_up_notes||""};ee(i),M(!0)},P=a=>a>=4.5?"bg-green-100 text-green-800 hover:bg-green-100":a>=4?"bg-emerald-100 text-emerald-800 hover:bg-emerald-100":a>=3?"bg-blue-100 text-blue-800 hover:bg-blue-100":a>=2?"bg-yellow-100 text-yellow-800 hover:bg-yellow-100":"bg-red-100 text-red-800 hover:bg-red-100",I=a=>{switch(a){case"participant":return"Participante";case"supervisor":return"Supervisor";case"self":return"Autoevaluación";default:return"Evaluador"}};return e.jsxs(oe,{children:[e.jsxs("div",{className:"container mx-auto py-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Evaluaciones de Instructores"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(g,{variant:"outline",onClick:()=>N(),children:[e.jsx(L,{className:"h-4 w-4 mr-2"}),"Actualizar"]}),e.jsx(g,{variant:"default",onClick:async()=>{try{if((await fetch("/api/admin/seed/instructor-evaluations",{method:"POST"})).ok)alert("Datos de muestra agregados correctamente. Actualizando..."),N();else throw new Error("Error al cargar datos de muestra")}catch(a){console.error("Error:",a),alert("Error al cargar datos de muestra. Verifica tu conexión e inténtalo de nuevo.")}},children:"Cargar Datos de Prueba"})]})]}),e.jsxs(de,{className:"mb-6",children:[e.jsxs(me,{children:[e.jsx(ue,{children:"Gestión de Evaluaciones"}),e.jsx(he,{children:"Administra las evaluaciones de los instructores y analiza su desempeño."})]}),e.jsxs(xe,{children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:[e.jsx("div",{className:"w-full md:w-1/3",children:e.jsxs("div",{className:"relative",children:[e.jsx(ge,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-gray-500"}),e.jsx(je,{type:"search",placeholder:"Buscar por instructor o actividad...",className:"pl-8",value:x,onChange:a=>Y(a.target.value)})]})}),e.jsx("div",{className:"w-full md:w-1/3",children:e.jsxs(F,{value:j,onValueChange:X,children:[e.jsx(O,{children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(B,{className:"mr-2 h-4 w-4 text-gray-500"}),e.jsx(V,{placeholder:"Filtrar por período"})]})}),e.jsxs(H,{children:[e.jsx(n,{value:"all",children:"Todos los períodos"}),e.jsx(n,{value:"today",children:"Hoy"}),e.jsx(n,{value:"week",children:"Última semana"}),e.jsx(n,{value:"month",children:"Último mes"}),e.jsx(n,{value:"quarter",children:"Último trimestre"})]})]})}),e.jsx("div",{className:"w-full md:w-1/3",children:e.jsxs(F,{value:p,onValueChange:Z,children:[e.jsx(O,{children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(_,{className:"mr-2 h-4 w-4 text-gray-500"}),e.jsx(V,{placeholder:"Filtrar por calificación"})]})}),e.jsxs(H,{children:[e.jsx(n,{value:"all",children:"Todas las calificaciones"}),e.jsx(n,{value:"excellent",children:"Excelente (4.5-5)"}),e.jsx(n,{value:"good",children:"Bueno (4-4.4)"}),e.jsx(n,{value:"average",children:"Promedio (3-3.9)"}),e.jsx(n,{value:"below",children:"Por debajo (0-2.9)"})]})]})})]}),te?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(L,{className:"h-8 w-8 animate-spin mx-auto text-gray-400"}),e.jsx("p",{className:"mt-2 text-gray-500",children:"Cargando evaluaciones..."})]}):re?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(pe,{className:"h-8 w-8 mx-auto text-red-500"}),e.jsx("p",{className:"mt-2 text-red-500",children:"Error al cargar evaluaciones"}),e.jsx(g,{variant:"outline",size:"sm",className:"mt-2",onClick:()=>N(),children:"Reintentar"})]}):f.length===0?e.jsx("div",{className:"text-center py-8",children:e.jsx("div",{className:"text-gray-500",children:"No se encontraron evaluaciones que coincidan con los criterios de búsqueda."})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"border rounded-md overflow-hidden",children:e.jsxs(fe,{children:[e.jsx(ve,{children:e.jsxs(Q,{children:[e.jsx(u,{children:"Instructor"}),e.jsx(u,{children:"Actividad"}),e.jsx(u,{children:"Fecha"}),e.jsx(u,{children:"Evaluador"}),e.jsx(u,{children:"Calificación"}),e.jsx(u,{className:"text-right",children:"Acciones"})]})}),e.jsx(_e,{children:ie.map(a=>e.jsxs(Q,{children:[e.jsx(h,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(W,{className:"h-8 w-8",children:[e.jsx(G,{src:a.instructor_image||a.instructor_profile_image_url,alt:a.instructor_name}),e.jsx(J,{children:a.instructor_name?a.instructor_name.charAt(0):"I"})]}),e.jsx("div",{children:a.instructor_name})]})}),e.jsx(h,{children:a.activity_title||"Actividad sin título"}),e.jsx(h,{children:C(a.evaluation_date||a.created_at)}),e.jsx(h,{children:e.jsx(A,{variant:"outline",children:a.evaluator_type?I(a.evaluator_type):"Supervisor"})}),e.jsx(h,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(A,{className:P(a.overall_performance),children:a.overall_performance.toFixed(1)}),c(a.overall_performance)]})}),e.jsx(h,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end",children:[e.jsx(g,{variant:"ghost",size:"icon",onClick:()=>k(a),children:e.jsx(K,{className:"h-4 w-4"})}),e.jsxs(we,{children:[e.jsx(ye,{asChild:!0,children:e.jsx(g,{variant:"ghost",size:"icon",children:e.jsx(Be,{className:"h-4 w-4"})})}),e.jsxs(Ne,{align:"end",children:[e.jsx(be,{children:"Acciones"}),e.jsx(Ce,{}),e.jsxs(U,{onClick:()=>k(a),children:[e.jsx(K,{className:"mr-2 h-4 w-4"}),"Ver detalles"]}),a.follow_up_required&&e.jsxs(U,{children:[e.jsx(De,{className:"mr-2 h-4 w-4"}),"Marcar seguimiento como completado"]})]})]})]})})]},a.id))})]})}),d>1&&e.jsx("div",{className:"mt-4",children:e.jsx(Se,{children:e.jsxs(Ee,{children:[e.jsx(w,{children:e.jsx(Ae,{onClick:()=>S(Math.max(1,l-1)),disabled:l===1})}),Array.from({length:d}).map((a,i)=>{const r=i+1;return r===1||r===d||r>=l-1&&r<=l+1?e.jsx(w,{children:e.jsx(Me,{isActive:r===l,onClick:()=>S(r),children:r})},r):r===2&&l>3||r===d-1&&l<d-2?e.jsx(w,{children:"..."},r):null}),e.jsx(w,{children:e.jsx(ke,{onClick:()=>S(Math.min(d,l+1)),disabled:l===d})})]})})})]})]})]})]}),s&&e.jsx(Pe,{open:ae,onOpenChange:M,children:e.jsxs(Ie,{className:"sm:max-w-[600px]",children:[e.jsxs(Te,{children:[e.jsx(qe,{children:"Detalles de Evaluación"}),e.jsxs(Re,{children:["Evaluación realizada el ",C(s.evaluation_date||s.created_at)]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-3",children:[e.jsxs(W,{className:"h-12 w-12",children:[e.jsx(G,{src:s.instructor_image||s.instructor_profile_image_url,alt:s.instructor_name}),e.jsx(J,{children:s.instructor_name?s.instructor_name.charAt(0):"I"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-lg",children:s.instructor_name}),e.jsx("p",{className:"text-sm text-gray-500",children:s.activity_title||"Actividad sin título"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(B,{className:"h-4 w-4 mr-2 text-gray-500"}),e.jsx("span",{children:C(s.evaluation_date||s.created_at)})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(ze,{className:"h-4 w-4 mr-2 text-gray-500"}),e.jsx("span",{children:s.evaluator_type?I(s.evaluator_type):"Supervisor"})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium mb-3",children:"Criterios Evaluados"}),e.jsxs("div",{className:"grid gap-4",children:[s.professionalism!==void 0&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-medium",children:"Profesionalismo"}),e.jsx("div",{className:"flex",children:c(s.professionalism)})]}),s.teaching_clarity!==void 0&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-medium",children:"Claridad didáctica"}),e.jsx("div",{className:"flex",children:c(s.teaching_clarity)})]}),s.active_participation!==void 0&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-medium",children:"Participación activa"}),e.jsx("div",{className:"flex",children:c(s.active_participation)})]}),s.communication!==void 0&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-medium",children:"Comunicación"}),e.jsx("div",{className:"flex",children:c(s.communication)})]}),s.group_management!==void 0&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-medium",children:"Manejo de grupo"}),e.jsx("div",{className:"flex",children:c(s.group_management)})]}),s.knowledge!==void 0&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-medium",children:"Conocimiento"}),e.jsx("div",{className:"flex",children:c(s.knowledge)})]}),s.methodology!==void 0&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-medium",children:"Metodología"}),e.jsx("div",{className:"flex",children:c(s.methodology)})]})]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Calificación General"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(A,{className:P(s.overall_performance),children:s.overall_performance.toFixed(1)}),e.jsx("div",{className:"ml-2",children:c(s.overall_performance)})]})]}),s.comments&&e.jsxs("div",{className:"mt-4",children:[e.jsx("h4",{className:"font-medium mb-2",children:"Comentarios"}),e.jsx("div",{className:"bg-gray-50 p-3 rounded-md whitespace-pre-line",children:s.comments})]}),s.follow_up_required&&e.jsxs("div",{className:"mt-4 flex items-start gap-3 p-3 border border-yellow-200 bg-yellow-50 rounded-md",children:[e.jsx("div",{className:"shrink-0",children:e.jsx(Le,{className:"h-5 w-5 text-yellow-600"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-yellow-800",children:"Requiere seguimiento"}),s.follow_up_notes&&e.jsx("p",{className:"text-sm text-yellow-700 mt-1",children:s.follow_up_notes})]})]})]})]})]})})]})}export{He as default};
