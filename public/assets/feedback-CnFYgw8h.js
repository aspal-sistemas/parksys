import{l as ke,ae as De,a2 as j,R as Re,u as se,ag as _e,j as e,aX as qe,f as y,a0 as _,i as f,n as Ne,bq as ae,ah as ze,o as A,B as o,a5 as Oe,a6 as Le,D as Ue,N as l,a4 as Be,O as He,Q as U,V as B,W as H,Y as I,_ as c,a7 as Ie,t as Ve,p as $e,P as Qe,M as Ge,r as u,av as Ke,au as ve,aM as Je,aN as We,w as fe,y as we,z as be,I as Ce,J as Ee,$ as Xe,bC as Ye,m as Ze,bD as es,aW as ss,a1 as N}from"./index-D5qLf1ib.js";import{utils as S,writeFile as as}from"./xlsx-B6sNpj_1.js";import{F as ts}from"./file-spreadsheet-DG7R7czs.js";function is(){var pe,ue,je,ge;const{toast:C}=ke(),te=De(),[t,re]=j.useState(null),[Ae,le]=j.useState(!1),[Se,q]=j.useState(!1),[M,ne]=j.useState(""),[T,ie]=j.useState("all"),[F,ce]=j.useState("all"),[P,de]=j.useState("all"),[m,z]=j.useState(1),[O,oe]=j.useState("cards"),[k,V]=j.useState({status:"",adminNotes:"",tags:[]});Re.useEffect(()=>{z(1)},[M,T,F,P]);const{data:E,isLoading:Me}=se({queryKey:["/api/feedback",{search:M,park:T,formType:F,status:P,page:m}],suspense:!1,retry:1,queryFn:async()=>{const s=new URLSearchParams;M&&s.append("search",M),T!=="all"&&s.append("park",T),F!=="all"&&s.append("formType",F),P!=="all"&&s.append("status",P),s.append("page",m.toString()),s.append("limit","10");const r=await fetch(`/api/feedback?${s.toString()}`);if(!r.ok)throw new Error("Error al cargar retroalimentación");return r.json()}}),{data:D}=se({queryKey:["/api/parks"],suspense:!1,retry:1}),$=Array.isArray(D)?D:(D==null?void 0:D.data)||[],{data:R}=se({queryKey:["/api/feedback/stats"],queryFn:async()=>{const s=await fetch("/api/feedback/stats");if(!s.ok)throw new Error("Error al cargar estadísticas");return s.json()}}),Q=_e({mutationFn:async s=>{const r=await fetch(`/api/feedback/${s.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!r.ok)throw new Error("Error al actualizar retroalimentación");return r.json()},onSuccess:()=>{te.invalidateQueries({queryKey:["/api/feedback"]}),te.invalidateQueries({queryKey:["/api/feedback/stats"]}),q(!1),C({title:"Actualizado",description:"La retroalimentación ha sido actualizada exitosamente"})},onError:()=>{C({title:"Error",description:"No se pudo actualizar la retroalimentación",variant:"destructive"})}}),xe=s=>{re(s),V({status:s.status,adminNotes:s.adminNotes||"",tags:s.tags||[]}),q(!0)},me=s=>{re(s),le(!0)},Te=()=>{t&&Q.mutate({id:t.id,status:k.status,adminNotes:k.adminNotes,tags:k.tags})},G=s=>{switch(s){case"share":return e.jsx(_,{className:"h-4 w-4"});case"report_problem":return e.jsx(ss,{className:"h-4 w-4"});case"suggest_improvement":return e.jsx(es,{className:"h-4 w-4"});case"propose_event":return e.jsx(Ze,{className:"h-4 w-4"});default:return e.jsx(_,{className:"h-4 w-4"})}},w=s=>{switch(s){case"share":return"Compartir Parque";case"report_problem":return"Reportar Problema";case"suggest_improvement":return"Sugerir Mejora";case"propose_event":return"Proponer Evento";default:return s}},K=s=>{const r={pending:"default",reviewed:"secondary",in_progress:"outline",resolved:"secondary",closed:"destructive"},i={pending:"Pendiente",reviewed:"Revisado",in_progress:"En Progreso",resolved:"Resuelto",closed:"Cerrado"};return e.jsx(A,{variant:r[s]||"default",children:i[s]||s})},J=s=>{if(!s)return null;const r={low:"outline",medium:"secondary",high:"destructive",urgent:"destructive"},i={low:"Baja",medium:"Media",high:"Alta",urgent:"Urgente"};return e.jsx(A,{variant:r[s]||"default",className:"ml-2",children:i[s]||s})};if(Me)return e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"animate-pulse space-y-4",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/4"}),e.jsx("div",{className:"h-32 bg-gray-200 rounded"}),e.jsx("div",{className:"h-64 bg-gray-200 rounded"})]})});const d=(E==null?void 0:E.feedback)||[],v=(E==null?void 0:E.pagination)||null,W=(v==null?void 0:v.total)||0,b=(v==null?void 0:v.totalPages)||0,L=s=>({pending:"Pendiente",reviewed:"Revisado",in_progress:"En Progreso",resolved:"Resuelto",closed:"Cerrado"})[s]||s,he=s=>s?{low:"Baja",medium:"Media",high:"Alta",urgent:"Urgente"}[s]||s:"",Fe=()=>{if(d.length===0){C({title:"No hay datos",description:"No hay retroalimentación para exportar",variant:"destructive"});return}const s=["SISTEMA DE GESTIÓN DE PARQUES URBANOS","Reporte de Retroalimentación Ciudadana",`Fecha de generación: ${u(new Date,"dd/MM/yyyy HH:mm",{locale:N})}`,`Total de registros: ${d.length}`,""],r=d.reduce((a,n)=>{const p=L(n.status);return a[p]=(a[p]||0)+1,a},{}),i=d.reduce((a,n)=>{const p=w(n.formType);return a[p]=(a[p]||0)+1,a},{}),x=["RESUMEN ESTADÍSTICO","","Distribución por Estado:",...Object.entries(r).map(([a,n])=>`${a}: ${n}`),"","Distribución por Tipo de Formulario:",...Object.entries(i).map(([a,n])=>`${a}: ${n}`),"","DATOS DETALLADOS",""],X=["ID","Parque","Tipo de Formulario","Nombre Completo","Email","Teléfono","Asunto","Mensaje","Estado","Prioridad","Categoría","Fecha de Creación"],Y=d.map(a=>[a.id,a.parkName,w(a.formType),a.fullName,a.email,a.phone||"N/A",a.subject||"N/A",a.message.length>100?a.message.substring(0,100)+"...":a.message,L(a.status),he(a.priority)||"N/A",a.category||"N/A",u(new Date(a.createdAt),"dd/MM/yyyy HH:mm",{locale:N})]),ee="\uFEFF"+[...s.map(a=>[a]),...x.map(a=>[a]),X,...Y].map(a=>a.map(n=>`"${String(n).replace(/"/g,'""')}"`).join(",")).join(`\r
`),h=new Blob([ee],{type:"text/csv;charset=utf-8;"}),g=document.createElement("a");if(g.download!==void 0){const a=URL.createObjectURL(h);g.setAttribute("href",a),g.setAttribute("download",`retroalimentacion_parques_profesional_${u(new Date,"dd-MM-yyyy")}.csv`),g.style.visibility="hidden",document.body.appendChild(g),g.click(),document.body.removeChild(g)}C({title:"CSV Profesional Exportado",description:"Reporte completo generado con encabezado corporativo y resumen estadístico"})},Pe=()=>{if(d.length===0){C({title:"No hay datos",description:"No hay retroalimentación para exportar",variant:"destructive"});return}const s=S.book_new(),r=["ID","Parque","Tipo de Formulario","Nombre Completo","Email","Teléfono","Asunto","Mensaje","Estado","Prioridad","Categoría","Fecha de Creación"],i=d.map(a=>[a.id,a.parkName,w(a.formType),a.fullName,a.email,a.phone||"N/A",a.subject||"N/A",a.message.length>100?a.message.substring(0,100)+"...":a.message,L(a.status),he(a.priority)||"N/A",a.category||"N/A",u(new Date(a.createdAt),"dd/MM/yyyy HH:mm",{locale:N})]),x=S.aoa_to_sheet([["SISTEMA DE GESTIÓN DE PARQUES URBANOS"],["Reporte de Retroalimentación Ciudadana"],[`Fecha de generación: ${u(new Date,"dd/MM/yyyy HH:mm",{locale:N})}`],[""],r,...i]),X=[{wch:6},{wch:25},{wch:20},{wch:25},{wch:30},{wch:15},{wch:30},{wch:50},{wch:15},{wch:12},{wch:15},{wch:18}];x["!cols"]=X,x["!merges"]=[{s:{r:0,c:0},e:{r:0,c:11}},{s:{r:1,c:0},e:{r:1,c:11}},{s:{r:2,c:0},e:{r:2,c:11}}];const Y={font:{bold:!0,color:{rgb:"FFFFFF"}},fill:{fgColor:{rgb:"00a587"}},alignment:{horizontal:"center"}},Z={font:{bold:!0,size:16,color:{rgb:"00a587"}},alignment:{horizontal:"center"}},ye={font:{bold:!0,size:14,color:{rgb:"067f5f"}},alignment:{horizontal:"center"}};x.A1={...x.A1,s:Z},x.A2={...x.A2,s:ye},x.A3={...x.A3,s:{alignment:{horizontal:"center"}}};for(let a=0;a<r.length;a++){const n=S.encode_cell({r:4,c:a});x[n]&&(x[n].s=Y)}S.book_append_sheet(s,x,"Retroalimentación");const ee=[["RESUMEN EJECUTIVO"],[""],["Estadísticas Generales"],["Total de registros:",d.length],["Fecha del reporte:",u(new Date,"dd/MM/yyyy",{locale:N})],[""],["Distribución por Estado"],...Object.entries(d.reduce((a,n)=>{const p=L(n.status);return a[p]=(a[p]||0)+1,a},{})).map(([a,n])=>[a,n]),[""],["Distribución por Tipo de Formulario"],...Object.entries(d.reduce((a,n)=>{const p=w(n.formType);return a[p]=(a[p]||0)+1,a},{})).map(([a,n])=>[a,n])],h=S.aoa_to_sheet(ee);h["!cols"]=[{wch:30},{wch:15}],h.A1={...h.A1,s:Z},h.A3={...h.A3,s:{font:{bold:!0}}},h.A7={...h.A7,s:{font:{bold:!0}}},h.A11={...h.A11,s:{font:{bold:!0}}},S.book_append_sheet(s,h,"Resumen");const g=`retroalimentacion_parques_${u(new Date,"dd-MM-yyyy")}.xlsx`;as(s,g),C({title:"Excel Exportado",description:"Reporte profesional generado con formato Excel y diseño corporativo"})};return e.jsx(qe,{children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx(y,{className:"p-4 bg-gray-50",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{className:"w-8 h-8 text-gray-900"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Retroalimentación"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Gestiona la retroalimentación de los visitantes sobre los parques"})]})]})}),R&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[e.jsx(y,{children:e.jsx(f,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:((pe=R.general)==null?void 0:pe.total)||0})]}),e.jsx(_,{className:"h-8 w-8 text-blue-600"})]})})}),e.jsx(y,{children:e.jsx(f,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Pendientes"}),e.jsx("p",{className:"text-2xl font-bold text-orange-600",children:((ue=R.general)==null?void 0:ue.pending)||0})]}),e.jsx(Ne,{className:"h-8 w-8 text-orange-600"})]})})}),e.jsx(y,{children:e.jsx(f,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"En Progreso"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:((je=R.general)==null?void 0:je.in_progress)||0})]}),e.jsx(ae,{className:"h-8 w-8 text-blue-600"})]})})}),e.jsx(y,{children:e.jsx(f,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Resueltos"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:((ge=R.general)==null?void 0:ge.resolved)||0})]}),e.jsx(ze,{className:"h-8 w-8 text-green-600"})]})})})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs(A,{variant:"secondary",children:[W," registros total"]}),v&&e.jsxs(A,{variant:"outline",children:["Página ",v.page," de ",b]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("div",{className:"flex items-center border rounded-lg p-1",children:[e.jsx(o,{variant:O==="cards"?"default":"ghost",size:"sm",onClick:()=>oe("cards"),className:"px-3",children:e.jsx(Oe,{className:"h-4 w-4"})}),e.jsx(o,{variant:O==="list"?"default":"ghost",size:"sm",onClick:()=>oe("list"),className:"px-3",children:e.jsx(Le,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(o,{variant:"outline",onClick:Fe,disabled:d.length===0,className:"flex items-center space-x-2",children:[e.jsx(Ue,{className:"h-4 w-4"}),e.jsx("span",{children:"CSV"})]}),e.jsxs(o,{variant:"outline",onClick:Pe,disabled:d.length===0,className:"flex items-center space-x-2 bg-green-50 hover:bg-green-100 border-green-200 text-green-700",children:[e.jsx(ts,{className:"h-4 w-4"}),e.jsx("span",{children:"Excel"})]})]})]})]}),e.jsx(y,{children:e.jsx(f,{className:"p-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"search",children:"Búsqueda"}),e.jsxs("div",{className:"relative",children:[e.jsx(Be,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(He,{id:"search",placeholder:"Buscar por nombre, email...",value:M,onChange:s=>ne(s.target.value),className:"pl-10"})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"park-filter",children:"Parque"}),e.jsxs(U,{value:T,onValueChange:ie,children:[e.jsx(B,{children:e.jsx(H,{placeholder:"Todos los parques"})}),e.jsxs(I,{children:[e.jsx(c,{value:"all",children:"Todos los parques"}),$==null?void 0:$.map(s=>e.jsx(c,{value:s.id.toString(),children:s.name},s.id))]})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"form-type-filter",children:"Tipo de Formulario"}),e.jsxs(U,{value:F,onValueChange:ce,children:[e.jsx(B,{children:e.jsx(H,{placeholder:"Todos los tipos"})}),e.jsxs(I,{children:[e.jsx(c,{value:"all",children:"Todos los tipos"}),e.jsx(c,{value:"share",children:"Compartir Parque"}),e.jsx(c,{value:"report_problem",children:"Reportar Problema"}),e.jsx(c,{value:"suggest_improvement",children:"Sugerir Mejora"}),e.jsx(c,{value:"propose_event",children:"Proponer Evento"})]})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"status-filter",children:"Estado"}),e.jsxs(U,{value:P,onValueChange:de,children:[e.jsx(B,{children:e.jsx(H,{placeholder:"Todos los estados"})}),e.jsxs(I,{children:[e.jsx(c,{value:"all",children:"Todos los estados"}),e.jsx(c,{value:"pending",children:"Pendiente"}),e.jsx(c,{value:"reviewed",children:"Revisado"}),e.jsx(c,{value:"in_progress",children:"En Progreso"}),e.jsx(c,{value:"resolved",children:"Resuelto"}),e.jsx(c,{value:"closed",children:"Cerrado"})]})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs(o,{variant:"outline",onClick:()=>{ne(""),ie("all"),ce("all"),de("all")},className:"w-full",children:[e.jsx(Ie,{className:"h-4 w-4 mr-2"}),"Limpiar Filtros"]})})]})})}),e.jsx("div",{className:O==="cards"?"grid gap-4":"space-y-4",children:d.length===0?e.jsx(y,{children:e.jsxs(f,{className:"p-8 text-center",children:[e.jsx(_,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No hay retroalimentación disponible"}),e.jsx("p",{className:"text-gray-600",children:"No se encontró retroalimentación con los filtros aplicados"})]})}):O==="cards"?d.map(s=>e.jsx(y,{className:"hover:shadow-md transition-shadow",children:e.jsx(f,{className:"p-6",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[G(s.formType),e.jsx("span",{className:"font-medium text-gray-900",children:w(s.formType)})]}),K(s.status),J(s.priority)]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsx(Ve,{className:"h-4 w-4 mr-2"}),s.fullName]}),e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsx($e,{className:"h-4 w-4 mr-2"}),s.email]}),s.phone&&e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsx(Qe,{className:"h-4 w-4 mr-2"}),s.phone]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsx(Ge,{className:"h-4 w-4 mr-2"}),s.parkName]}),e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsx(Ne,{className:"h-4 w-4 mr-2"}),u(new Date(s.createdAt),"dd 'de' MMMM, yyyy 'a las' HH:mm",{locale:N})]}),s.category&&e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsx(Ke,{className:"h-4 w-4 mr-2"}),s.category]})]})]}),s.subject&&e.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:s.subject}),e.jsx("p",{className:"text-gray-700 mb-4 line-clamp-3",children:s.message}),s.tags&&s.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 mb-4",children:s.tags.map((r,i)=>e.jsx(A,{variant:"outline",className:"text-xs",children:r},i))})]}),e.jsxs("div",{className:"flex space-x-2 ml-4",children:[e.jsx(o,{variant:"outline",size:"sm",onClick:()=>me(s),children:e.jsx(ve,{className:"h-4 w-4"})}),e.jsx(o,{variant:"outline",size:"sm",onClick:()=>xe(s),children:e.jsx(ae,{className:"h-4 w-4"})})]})]})})},s.id)):e.jsx(y,{children:e.jsx(f,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b bg-gray-50",children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Tipo"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Usuario"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Parque"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Estado"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Fecha"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Acciones"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:d.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[G(s.formType),e.jsx("span",{className:"text-sm font-medium",children:w(s.formType)})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.fullName}),e.jsx("div",{className:"text-sm text-gray-500",children:s.email})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"text-sm text-gray-900",children:s.parkName})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[K(s.status),J(s.priority)]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"text-sm text-gray-500",children:u(new Date(s.createdAt),"dd/MM/yyyy",{locale:N})})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(o,{variant:"outline",size:"sm",onClick:()=>me(s),children:e.jsx(ve,{className:"h-4 w-4"})}),e.jsx(o,{variant:"outline",size:"sm",onClick:()=>xe(s),children:e.jsx(ae,{className:"h-4 w-4"})})]})})]},s.id))})]})})})})}),b>1&&e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-4 mt-6",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Mostrando ",(m-1)*10+1," a ",Math.min(m*10,W)," de ",W," registros"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(o,{variant:"outline",size:"sm",onClick:()=>z(m-1),disabled:m===1,children:[e.jsx(Je,{className:"h-4 w-4 mr-1"}),"Anterior"]}),e.jsx("div",{className:"flex space-x-1",children:Array.from({length:Math.min(5,b)},(s,r)=>{let i;return b<=5||m<=3?i=r+1:m>=b-2?i=b-4+r:i=m-2+r,e.jsx(o,{variant:i===m?"default":"outline",size:"sm",onClick:()=>z(i),className:"w-8 h-8 p-0",children:i},i)})}),e.jsxs(o,{variant:"outline",size:"sm",onClick:()=>z(m+1),disabled:m===b,children:["Siguiente",e.jsx(We,{className:"h-4 w-4 ml-1"})]})]})]}),e.jsx(fe,{open:Ae,onOpenChange:le,children:e.jsxs(we,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(be,{children:[e.jsxs(Ce,{className:"flex items-center space-x-2",children:[t&&G(t.formType),e.jsx("span",{children:t&&w(t.formType)})]}),e.jsx(Ee,{children:"Detalles completos de la retroalimentación"})]}),t&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{className:"text-sm font-medium text-gray-600",children:"Estado"}),e.jsxs("div",{className:"mt-1",children:[K(t.status),J(t.priority)]})]}),e.jsxs("div",{children:[e.jsx(l,{className:"text-sm font-medium text-gray-600",children:"Parque"}),e.jsx("p",{className:"mt-1",children:t.parkName})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{className:"text-sm font-medium text-gray-600",children:"Nombre Completo"}),e.jsx("p",{className:"mt-1",children:t.fullName})]}),e.jsxs("div",{children:[e.jsx(l,{className:"text-sm font-medium text-gray-600",children:"Email"}),e.jsx("p",{className:"mt-1",children:t.email})]})]}),t.phone&&e.jsxs("div",{children:[e.jsx(l,{className:"text-sm font-medium text-gray-600",children:"Teléfono"}),e.jsx("p",{className:"mt-1",children:t.phone})]}),t.subject&&e.jsxs("div",{children:[e.jsx(l,{className:"text-sm font-medium text-gray-600",children:"Asunto"}),e.jsx("p",{className:"mt-1",children:t.subject})]}),e.jsxs("div",{children:[e.jsx(l,{className:"text-sm font-medium text-gray-600",children:"Mensaje"}),e.jsx("p",{className:"mt-1 whitespace-pre-wrap",children:t.message})]}),t.category&&e.jsxs("div",{children:[e.jsx(l,{className:"text-sm font-medium text-gray-600",children:"Categoría"}),e.jsx("p",{className:"mt-1",children:t.category})]}),t.eventType&&e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{className:"text-sm font-medium text-gray-600",children:"Tipo de Evento"}),e.jsx("p",{className:"mt-1",children:t.eventType})]}),t.expectedAttendance&&e.jsxs("div",{children:[e.jsx(l,{className:"text-sm font-medium text-gray-600",children:"Asistencia Esperada"}),e.jsxs("p",{className:"mt-1",children:[t.expectedAttendance," personas"]})]})]}),t.suggestedDate&&e.jsxs("div",{children:[e.jsx(l,{className:"text-sm font-medium text-gray-600",children:"Fecha Sugerida"}),e.jsx("p",{className:"mt-1",children:u(new Date(t.suggestedDate),"dd 'de' MMMM, yyyy",{locale:N})})]}),t.socialMedia&&e.jsxs("div",{children:[e.jsx(l,{className:"text-sm font-medium text-gray-600",children:"Redes Sociales"}),e.jsx("p",{className:"mt-1",children:t.socialMedia})]}),e.jsxs("div",{children:[e.jsx(l,{className:"text-sm font-medium text-gray-600",children:"Fecha de Creación"}),e.jsx("p",{className:"mt-1",children:u(new Date(t.createdAt),"dd 'de' MMMM, yyyy 'a las' HH:mm",{locale:N})})]}),t.tags&&t.tags.length>0&&e.jsxs("div",{children:[e.jsx(l,{className:"text-sm font-medium text-gray-600",children:"Etiquetas"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:t.tags.map((s,r)=>e.jsx(A,{variant:"outline",children:s},r))})]}),t.adminNotes&&e.jsxs("div",{children:[e.jsx(l,{className:"text-sm font-medium text-gray-600",children:"Notas Administrativas"}),e.jsx("p",{className:"mt-1 whitespace-pre-wrap",children:t.adminNotes})]})]})]})}),e.jsx(fe,{open:Se,onOpenChange:q,children:e.jsxs(we,{className:"max-w-md",children:[e.jsxs(be,{children:[e.jsx(Ce,{children:"Actualizar Retroalimentación"}),e.jsx(Ee,{children:"Actualiza el estado y agrega notas administrativas"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"status",children:"Estado"}),e.jsxs(U,{value:k.status,onValueChange:s=>V(r=>({...r,status:s})),children:[e.jsx(B,{children:e.jsx(H,{})}),e.jsxs(I,{children:[e.jsx(c,{value:"pending",children:"Pendiente"}),e.jsx(c,{value:"reviewed",children:"Revisado"}),e.jsx(c,{value:"in_progress",children:"En Progreso"}),e.jsx(c,{value:"resolved",children:"Resuelto"}),e.jsx(c,{value:"closed",children:"Cerrado"})]})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"admin-notes",children:"Notas Administrativas"}),e.jsx(Xe,{id:"admin-notes",placeholder:"Agrega notas sobre esta retroalimentación...",value:k.adminNotes,onChange:s=>V(r=>({...r,adminNotes:s.target.value})),rows:4})]})]}),e.jsxs(Ye,{children:[e.jsx(o,{variant:"outline",onClick:()=>q(!1),children:"Cancelar"}),e.jsx(o,{onClick:Te,disabled:Q.isPending,children:Q.isPending?"Actualizando...":"Actualizar"})]})]})})]})})}export{is as default};
