import{e as he,a6 as je,am as ge,Y as x,u as Q,j as e,aI as pe,B as d,b2 as Ne,C as r,c,U as b,i as L,a4 as ue,a as p,b as N,ak as fe,Z as ve,I as be,z as A,H as $,J as F,K as H,N as n,W as ye,az as we,a3 as _e,at as Ce,au as Se,h as G,M as J,f as C,b7 as De,ba as W,D as ke,r as Ve,t as Ie,v as Pe,w as Ee}from"./index-Dzu3mJf5.js";function Le(){const{toast:z}=he();je();const[,U]=ge(),q=x.useRef(null),[y,Z]=x.useState(""),[S,X]=x.useState("all"),[D,ee]=x.useState("all"),[k,se]=x.useState("all"),[o,V]=x.useState(1),[a,ae]=x.useState(null),[le,w]=x.useState(!1),I=10,{data:M,isLoading:ie}=Q({queryKey:["/api/volunteers"]}),f=Array.isArray(M)?M:[],{data:P}=Q({queryKey:["/api/parks"]}),O=(P==null?void 0:P.data)||[],m=f.filter(s=>{var l,j,v,_,Y;const i=(((l=s.firstName)==null?void 0:l.toLowerCase())||((j=s.full_name)==null?void 0:j.toLowerCase())||"").includes(y.toLowerCase())||(((v=s.lastName)==null?void 0:v.toLowerCase())||"").includes(y.toLowerCase())||(((_=s.email)==null?void 0:_.toLowerCase())||"").includes(y.toLowerCase()),t=S==="all"||s.status===S,u=D==="all"||((Y=s.preferred_park_id)==null?void 0:Y.toString())===D,h=k==="all"||(()=>{const g=s.age||0;switch(k){case"18-25":return g>=18&&g<=25;case"26-35":return g>=26&&g<=35;case"36-45":return g>=36&&g<=45;case"46+":return g>=46;default:return!0}})();return i&&t&&u&&h}),E=Math.ceil(m.length/I),T=(o-1)*I,R=T+I,te=m.slice(T,R),re=()=>{const s=["ID","Nombre Completo","Email","Teléfono","Edad","Estado","Habilidades","Experiencia","Parque Preferido","Fecha Ingreso"],i=m.map(l=>[l.id,l.full_name||`${l.firstName||""} ${l.lastName||""}`.trim(),l.email,l.phone||"",l.age||"",l.status||"active",l.skills||"",l.previous_experience||"",l.preferred_park_id||"",new Date(l.created_at||l.createdAt).toLocaleDateString()]),t=[s,...i].map(l=>l.map(j=>`"${j}"`).join(",")).join(`
`),u=new Blob([t],{type:"text/csv;charset=utf-8;"}),h=document.createElement("a");h.href=URL.createObjectURL(u),h.download=`voluntarios_${new Date().toISOString().split("T")[0]}.csv`,h.click(),z({title:"Exportación exitosa",description:`Se exportaron ${m.length} voluntarios a CSV`})},ce=s=>{var u;const i=(u=s.target.files)==null?void 0:u[0];if(!i)return;const t=new FileReader;t.onload=h=>{var v;const j=((v=h.target)==null?void 0:v.result).split(`
`);j[0].split(",").map(_=>_.replace(/"/g,"")),z({title:"Importación en desarrollo",description:`Se detectaron ${j.length-1} registros en el archivo CSV`})},t.readAsText(i)},ne=s=>{ae(s),w(!0)},de=()=>{U("/admin/volunteers/register")},B=s=>{U(`/admin/volunteers/edit/${s}`)},K=s=>{switch(s){case"activo":case"active":return"bg-green-100 text-green-800";case"inactivo":case"inactive":return"bg-red-100 text-red-800";case"suspendido":case"suspended":return"bg-yellow-100 text-yellow-800";default:return"bg-green-100 text-green-800"}},oe=s=>{V(s)},xe=()=>{o>1&&V(o-1)},me=()=>{o<E&&V(o+1)};return e.jsx(pe,{children:e.jsxs("div",{className:"container mx-auto p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Gestión de Voluntarios"}),e.jsx("p",{className:"text-muted-foreground",children:"Administra los voluntarios registrados en el sistema"})]}),e.jsxs(d,{onClick:de,children:[e.jsx(Ne,{className:"h-4 w-4 mr-2"}),"Nuevo Voluntario"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsx(r,{children:e.jsx(c,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(b,{className:"h-8 w-8 text-blue-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Voluntarios"}),e.jsx("p",{className:"text-2xl font-bold",children:f.length||0})]})]})})}),e.jsx(r,{children:e.jsx(c,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(b,{className:"h-8 w-8 text-green-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Activos"}),e.jsx("p",{className:"text-2xl font-bold",children:f.filter(s=>s.status==="activo").length||0})]})]})})}),e.jsx(r,{children:e.jsx(c,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(L,{className:"h-8 w-8 text-purple-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Horas Totales"}),e.jsx("p",{className:"text-2xl font-bold",children:f.reduce((s,i)=>s+(i.totalHours||i.total_hours||0),0)||0})]})]})})}),e.jsx(r,{children:e.jsx(c,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(ue,{className:"h-8 w-8 text-yellow-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Nuevos este mes"}),e.jsx("p",{className:"text-2xl font-bold",children:f.filter(s=>{const i=new Date(s.joinDate||s.join_date||s.createdAt),t=new Date;return i.getMonth()===t.getMonth()&&i.getFullYear()===t.getFullYear()}).length||0})]})]})})})]}),e.jsxs(r,{className:"mb-6",children:[e.jsx(p,{children:e.jsxs(N,{className:"text-lg flex items-center gap-2",children:[e.jsx(fe,{className:"h-5 w-5"}),"Filtros de Búsqueda"]})}),e.jsxs(c,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(ve,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(be,{placeholder:"Buscar por nombre o email...",value:y,onChange:s=>Z(s.target.value),className:"pl-9"})]}),e.jsxs(A,{value:S,onValueChange:X,children:[e.jsx($,{children:e.jsx(F,{placeholder:"Estado"})}),e.jsxs(H,{children:[e.jsx(n,{value:"all",children:"Todos los estados"}),e.jsx(n,{value:"active",children:"Activo"}),e.jsx(n,{value:"inactive",children:"Inactivo"}),e.jsx(n,{value:"suspended",children:"Suspendido"})]})]}),e.jsxs(A,{value:D,onValueChange:ee,children:[e.jsx($,{children:e.jsx(F,{placeholder:"Parque"})}),e.jsxs(H,{children:[e.jsx(n,{value:"all",children:"Todos los parques"}),O&&O.map(s=>e.jsx(n,{value:s.id.toString(),children:s.name},s.id))]})]}),e.jsxs(A,{value:k,onValueChange:se,children:[e.jsx($,{children:e.jsx(F,{placeholder:"Edad"})}),e.jsxs(H,{children:[e.jsx(n,{value:"all",children:"Todas las edades"}),e.jsx(n,{value:"18-25",children:"18-25 años"}),e.jsx(n,{value:"26-35",children:"26-35 años"}),e.jsx(n,{value:"36-45",children:"36-45 años"}),e.jsx(n,{value:"46+",children:"46+ años"})]})]})]}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsxs(d,{variant:"outline",onClick:re,className:"flex items-center gap-2",children:[e.jsx(ye,{className:"h-4 w-4"}),"Exportar CSV"]}),e.jsxs(d,{variant:"outline",onClick:()=>{var s;return(s=q.current)==null?void 0:s.click()},className:"flex items-center gap-2",children:[e.jsx(we,{className:"h-4 w-4"}),"Importar CSV"]}),e.jsx("input",{ref:q,type:"file",accept:".csv",style:{display:"none"},onChange:ce})]})]})]}),e.jsxs(r,{children:[e.jsxs(p,{children:[e.jsx(N,{children:"Voluntarios Registrados"}),e.jsx(_e,{children:"Lista completa de voluntarios con información básica"})]}),e.jsx(c,{children:ie?e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{children:"Cargando voluntarios..."})}):m.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(b,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"No se encontraron voluntarios"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("p",{className:"text-sm text-gray-500",children:["Mostrando ",T+1," a ",Math.min(R,m.length)," de ",m.length," voluntarios"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(d,{variant:"outline",size:"sm",onClick:xe,disabled:o===1,children:[e.jsx(Ce,{className:"h-4 w-4"}),"Anterior"]}),e.jsx("div",{className:"flex gap-1",children:Array.from({length:E},(s,i)=>i+1).map(s=>e.jsx(d,{variant:o===s?"default":"outline",size:"sm",onClick:()=>oe(s),className:o===s?"bg-green-600 hover:bg-green-700":"",children:s},s))}),e.jsxs(d,{variant:"outline",size:"sm",onClick:me,disabled:o===E,children:["Siguiente",e.jsx(Se,{className:"h-4 w-4"})]})]})]}),e.jsx("div",{className:"space-y-4",children:te.map(s=>e.jsxs("div",{className:"flex items-center gap-4 p-4 border rounded-lg hover:bg-gray-50",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center overflow-hidden",children:s.profileImageUrl||s.profile_image_url?e.jsx("img",{src:s.profileImageUrl||s.profile_image_url,alt:s.full_name||`${s.firstName||""} ${s.lastName||""}`.trim(),className:"w-16 h-16 rounded-full object-cover"}):e.jsx(b,{className:"h-8 w-8 text-green-600"})})}),e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-lg",children:s.full_name||`${s.firstName||""} ${s.lastName||""}`.trim()}),e.jsx("p",{className:"text-gray-600 mb-1",children:s.email}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 mt-2 text-sm text-gray-500",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(G,{className:"h-4 w-4"}),e.jsxs("span",{children:["Desde: ",new Date(s.joinDate||s.join_date||s.created_at||new Date).toLocaleDateString()]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(L,{className:"h-4 w-4"}),e.jsxs("span",{children:[s.totalHours||s.total_hours||0," horas"]})]}),s.phone&&e.jsx("div",{className:"flex items-center gap-1",children:e.jsxs("span",{children:["📞 ",s.phone]})}),s.age&&e.jsx("div",{className:"flex items-center gap-1",children:e.jsxs("span",{children:["👤 ",s.age," años"]})}),s.preferred_park_id&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(J,{className:"h-4 w-4"}),e.jsx("span",{children:"Parque preferido"})]}),s.available_hours&&e.jsx("div",{className:"flex items-center gap-1",children:e.jsxs("span",{children:["⏰ ",s.available_hours]})})]}),(s.skills||s.previous_experience)&&e.jsxs("div",{className:"mt-3 space-y-1",children:[s.skills&&e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("strong",{children:"Habilidades:"})," ",s.skills]}),s.previous_experience&&e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("strong",{children:"Experiencia:"})," ",s.previous_experience]})]}),s.interest_areas&&s.interest_areas.length>0&&e.jsx("div",{className:"mt-2",children:e.jsx("div",{className:"flex flex-wrap gap-1",children:s.interest_areas.map((i,t)=>e.jsx(C,{variant:"secondary",className:"text-xs",children:i},t))})})]}),e.jsxs("div",{className:"flex flex-col items-end gap-2 ml-4",children:[e.jsx(C,{className:K(s.status||"active"),children:s.status==="active"?"activo":s.status||"activo"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(d,{variant:"outline",size:"sm",onClick:()=>ne(s),children:[e.jsx(De,{className:"h-4 w-4 mr-1"}),"Ver"]}),e.jsxs(d,{variant:"outline",size:"sm",onClick:()=>B(s.id),children:[e.jsx(W,{className:"h-4 w-4 mr-1"}),"Editar"]})]})]})]})})]},s.id))})]})})]}),e.jsx(ke,{open:le,onOpenChange:w,children:e.jsxs(Ve,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(Ie,{children:[e.jsx(Pe,{className:"text-2xl",children:"Perfil del Voluntario"}),e.jsx(Ee,{children:"Información completa y detallada del voluntario seleccionado"})]}),a&&e.jsxs("div",{className:"grid gap-6 py-4",children:[e.jsxs("div",{className:"flex items-start gap-6 p-6 bg-gradient-to-r from-green-50 to-blue-50 rounded-lg",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-24 h-24 bg-green-100 rounded-full flex items-center justify-center overflow-hidden ring-4 ring-white shadow-lg",children:a.profileImageUrl||a.profile_image_url?e.jsx("img",{src:a.profileImageUrl||a.profile_image_url,alt:a.full_name||`${a.firstName||""} ${a.lastName||""}`.trim(),className:"w-24 h-24 rounded-full object-cover"}):e.jsx(b,{className:"h-12 w-12 text-green-600"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-2",children:a.full_name||`${a.firstName||""} ${a.lastName||""}`.trim()}),e.jsxs("div",{className:"flex items-center gap-4 mb-3",children:[e.jsx(C,{className:K(a.status||"active"),size:"lg",children:a.status==="active"?"ACTIVO":(a.status||"ACTIVO").toUpperCase()}),a.age&&e.jsxs("span",{className:"text-lg text-gray-600",children:[a.age," años"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(G,{className:"h-4 w-4"}),e.jsxs("span",{children:["Miembro desde: ",new Date(a.joinDate||a.join_date||a.created_at||new Date).toLocaleDateString()]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(L,{className:"h-4 w-4"}),e.jsxs("span",{children:[a.totalHours||a.total_hours||0," horas de servicio"]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(r,{children:[e.jsx(p,{children:e.jsx(N,{className:"text-lg",children:"Información de Contacto"})}),e.jsxs(c,{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-700",children:"Email:"}),e.jsx("p",{className:"text-blue-600",children:a.email})]}),a.phone&&e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-700",children:"Teléfono:"}),e.jsx("p",{children:a.phone})]}),a.address&&e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-700",children:"Dirección:"}),e.jsx("p",{children:a.address})]})]})]}),e.jsxs(r,{children:[e.jsx(p,{children:e.jsx(N,{className:"text-lg",children:"Contacto de Emergencia"})}),e.jsxs(c,{className:"space-y-3",children:[a.emergency_contact&&e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-700",children:"Nombre:"}),e.jsx("p",{children:a.emergency_contact})]}),a.emergency_phone&&e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-700",children:"Teléfono:"}),e.jsx("p",{children:a.emergency_phone})]}),!a.emergency_contact&&!a.emergency_phone&&e.jsx("p",{className:"text-gray-500 italic",children:"No especificado"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(a.skills||a.previous_experience)&&e.jsxs(r,{children:[e.jsx(p,{children:e.jsx(N,{className:"text-lg",children:"Habilidades y Experiencia"})}),e.jsxs(c,{className:"space-y-3",children:[a.skills&&e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-700",children:"Habilidades:"}),e.jsx("p",{className:"bg-gray-50 p-2 rounded",children:a.skills})]}),a.previous_experience&&e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-700",children:"Experiencia previa:"}),e.jsx("p",{className:"bg-gray-50 p-2 rounded",children:a.previous_experience})]})]})]}),e.jsxs(r,{children:[e.jsx(p,{children:e.jsx(N,{className:"text-lg",children:"Disponibilidad y Preferencias"})}),e.jsxs(c,{className:"space-y-3",children:[a.available_hours&&e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-700",children:"Horarios disponibles:"}),e.jsx("p",{className:"capitalize",children:a.available_hours})]}),a.preferred_park_id&&e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-700",children:"Parque preferido:"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(J,{className:"h-4 w-4 text-green-600"}),e.jsxs("span",{children:["ID: ",a.preferred_park_id]})]})]})]})]})]}),a.interest_areas&&a.interest_areas.length>0&&e.jsxs(r,{children:[e.jsx(p,{children:e.jsx(N,{className:"text-lg",children:"Áreas de Interés"})}),e.jsx(c,{children:e.jsx("div",{className:"flex flex-wrap gap-2",children:a.interest_areas.map((s,i)=>e.jsx(C,{variant:"outline",className:"capitalize",children:s},i))})})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[e.jsx(d,{variant:"outline",onClick:()=>w(!1),children:"Cerrar"}),e.jsxs(d,{onClick:()=>{w(!1),B(a.id)},className:"bg-green-600 hover:bg-green-700",children:[e.jsx(W,{className:"h-4 w-4 mr-2"}),"Editar Voluntario"]})]})]})]})})]})})}export{Le as default};
