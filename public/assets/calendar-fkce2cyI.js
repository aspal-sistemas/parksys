import{Y as E,u as S,j as e,aI as N,C as m,a as x,b as h,h as b,B as j,at as A,au as T,c as g,f as v,i as M,U as z,al as I}from"./index-Dzu3mJf5.js";const _={borrador:"bg-gray-100 text-gray-800",solicitado:"bg-blue-100 text-blue-800",en_revision:"bg-yellow-100 text-yellow-800",aprobado:"bg-green-100 text-green-800",rechazado:"bg-red-100 text-red-800",cancelado:"bg-gray-100 text-gray-800",realizado:"bg-purple-100 text-purple-800"},F={bajo_impacto:"bg-emerald-100 text-emerald-800",alto_impacto:"bg-orange-100 text-orange-800"};function R(){const[d,p]=E.useState(new Date),t=d.getMonth(),r=d.getFullYear(),{data:o=[],isLoading:f}=S({queryKey:["/api/eventos-ambu",t,r],queryFn:async()=>{const s=new Date(r,t,1).toISOString().split("T")[0],a=new Date(r,t+1,0).toISOString().split("T")[0],i=new URLSearchParams({fecha_desde:s,fecha_hasta:a,limit:"100"}),n=await fetch(`/api/eventos-ambu?${i}`);if(!n.ok)throw new Error("Error al cargar eventos");return(await n.json()).eventos||[]}}),u=s=>{const a=new Date(d);s==="anterior"?a.setMonth(t-1):a.setMonth(t+1),p(a)},y=s=>{const a=new Date(r,t,s).toISOString().split("T")[0];return o.filter(i=>i.fechaEvento===a)},w=()=>{const s=new Date(r,t,1),a=new Date(r,t+1,0),i=s.getDay(),n=a.getDate(),l=[];for(let c=0;c<i;c++)l.push(null);for(let c=1;c<=n;c++)l.push(c);return l},D=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],C=["Dom","Lun","Mar","Mié","Jue","Vie","Sáb"];return f?e.jsx(N,{children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Cargando calendario..."})]})})}):e.jsx(N,{children:e.jsxs("div",{className:"container mx-auto py-6",children:[e.jsx("div",{className:"flex justify-between items-center mb-6",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Calendario de Eventos"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Vista mensual de eventos de bajo y alto impacto"})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"lg:col-span-3",children:e.jsxs(m,{children:[e.jsx(x,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(h,{className:"flex items-center gap-2",children:[e.jsx(b,{className:"h-5 w-5"}),D[t]," ",r]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(j,{variant:"outline",size:"sm",onClick:()=>u("anterior"),children:e.jsx(A,{className:"h-4 w-4"})}),e.jsx(j,{variant:"outline",size:"sm",onClick:()=>p(new Date),children:"Hoy"}),e.jsx(j,{variant:"outline",size:"sm",onClick:()=>u("siguiente"),children:e.jsx(T,{className:"h-4 w-4"})})]})]})}),e.jsxs(g,{children:[e.jsx("div",{className:"grid grid-cols-7 gap-1 mb-4",children:C.map(s=>e.jsx("div",{className:"p-2 text-center font-medium text-gray-500 text-sm",children:s},s))}),e.jsx("div",{className:"grid grid-cols-7 gap-1",children:w().map((s,a)=>{if(s===null)return e.jsx("div",{className:"h-24"},a);const i=y(s),n=new Date().toDateString()===new Date(r,t,s).toDateString();return e.jsxs("div",{className:`h-24 p-1 border border-gray-200 ${n?"bg-blue-50 border-blue-300":"bg-white"}`,children:[e.jsx("div",{className:`text-sm font-medium ${n?"text-blue-700":"text-gray-900"}`,children:s}),e.jsxs("div",{className:"space-y-1 mt-1",children:[i.slice(0,2).map(l=>e.jsx("div",{className:`text-xs p-1 rounded truncate ${l.impactoTipo==="bajo_impacto"?"bg-emerald-100 text-emerald-800":"bg-orange-100 text-orange-800"}`,title:l.titulo,children:l.titulo},l.id)),i.length>2&&e.jsxs("div",{className:"text-xs text-gray-500",children:["+",i.length-2," más"]})]})]},s)})})]})]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(m,{children:[e.jsx(x,{children:e.jsx(h,{className:"text-lg",children:"Próximos Eventos"})}),e.jsx(g,{children:e.jsxs("div",{className:"space-y-3",children:[o.filter(s=>new Date(s.fechaEvento)>=new Date).sort((s,a)=>new Date(s.fechaEvento).getTime()-new Date(a.fechaEvento).getTime()).slice(0,5).map(s=>e.jsxs("div",{className:"border-l-4 border-blue-500 pl-3 py-2",children:[e.jsxs("div",{className:"flex justify-between items-start mb-1",children:[e.jsx("h4",{className:"font-medium text-sm line-clamp-2",children:s.titulo}),e.jsx(v,{className:F[s.impactoTipo],variant:"secondary",children:s.impactoTipo==="bajo_impacto"?"Bajo":"Alto"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600",children:[e.jsx(b,{className:"h-3 w-3"}),new Date(s.fechaEvento).toLocaleDateString()]}),e.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600",children:[e.jsx(M,{className:"h-3 w-3"}),s.horaInicio," - ",s.horaFin]}),e.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600",children:[e.jsx(z,{className:"h-3 w-3"}),s.numeroAsistentes," asistentes"]}),s.costoTotal>0&&e.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600",children:[e.jsx(I,{className:"h-3 w-3"}),"$",s.costoTotal.toFixed(2)]})]}),e.jsx(v,{className:_[s.status],variant:"outline",size:"sm",children:s.status.replace("_"," ").toUpperCase()})]},s.id)),o.filter(s=>new Date(s.fechaEvento)>=new Date).length===0&&e.jsx("p",{className:"text-sm text-gray-500 text-center py-4",children:"No hay eventos próximos"})]})})]}),e.jsxs(m,{children:[e.jsx(x,{children:e.jsx(h,{className:"text-lg",children:"Leyenda"})}),e.jsx(g,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-sm mb-2",children:"Tipo de Impacto"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-emerald-500 rounded"}),e.jsx("span",{className:"text-sm",children:"Bajo Impacto (≤10 días)"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-orange-500 rounded"}),e.jsx("span",{className:"text-sm",children:"Alto Impacto (2 meses)"})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-sm mb-2",children:"Estados"}),e.jsxs("div",{className:"space-y-1 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),e.jsx("span",{children:"Solicitado"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-yellow-500 rounded-full"}),e.jsx("span",{children:"En Revisión"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e.jsx("span",{children:"Aprobado"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full"}),e.jsx("span",{children:"Rechazado"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full"}),e.jsx("span",{children:"Realizado"})]})]})]})]})})]})]})]})]})})}export{R as default};
