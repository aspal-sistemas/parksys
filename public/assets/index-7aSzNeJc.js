import{c as Z,az as ee,a2 as y,u as q,j as e,aX as se,B as f,O as i,Q as E,V as O,W as F,Y as I,_ as k,aw as ae,aW as le,dz as te,ay as ne,dx as _,bH as ie,dA as ce,bI as re,bJ as B,bK as x,bL as de,bM as h,a8 as oe,a9 as me,aa as xe,o as H,f as u,g as j,h as p,i as N,w as he,x as ue,aS as P,y as je,z as pe,I as Ne,J as ge,N as t,bC as fe,ab as ve,dB as be,dC as ye,cb as Ce}from"./index-D5qLf1ib.js";import{H as we}from"./Helmet-BNepwt1P.js";import{C as Ae}from"./cloud-rain-D34Iidk5.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Se=Z("Wind",[["path",{d:"M17.7 7.7a2.5 2.5 0 1 1 1.8 4.3H2",key:"1k4u03"}],["path",{d:"M9.6 4.6A2 2 0 1 1 11 8H2",key:"b7d0fd"}],["path",{d:"M12.6 19.4A2 2 0 1 0 14 16H2",key:"1p5cb3"}]]),V=[{value:"itree",label:"i-Tree"},{value:"citygreen",label:"CityGreen"},{value:"manual",label:"Cálculo Manual"},{value:"estimate",label:"Estimación Basada en Especie"}],l=(r,v="",g=2)=>r==null?"N/A":typeof r!="number"?`${r} ${v}`:`${r.toFixed(g)} ${v}`,ke=r=>r?new Date(r).toLocaleDateString("es-MX",{year:"numeric",month:"long",day:"numeric"}):"N/A";function Me(){var T,L;const[r,v]=ee(),[g,$]=y.useState(""),[C,z]=y.useState(""),[c,R]=y.useState(null),[G,w]=y.useState(!1),D=[{id:1,treeId:1,calculationDate:"2023-04-10",calculationMethod:"itree",co2SequestrationAnnual:25.7,co2SequestrationLifetime:1285,pollutantRemovalNO2:.25,pollutantRemovalSO2:.18,pollutantRemovalPM25:.32,stormwaterInterception:2.8,shadeAreaSummer:42.5,temperatureReduction:1.2,totalEconomicBenefitAnnual:156.87,notes:"Cálculo basado en condiciones climáticas locales y estado actual del árbol."},{id:2,treeId:1,calculationDate:"2022-05-15",calculationMethod:"citygreen",co2SequestrationAnnual:23.4,co2SequestrationLifetime:1170,pollutantRemovalNO2:.22,pollutantRemovalSO2:.15,pollutantRemovalPM25:.28,stormwaterInterception:2.5,shadeAreaSummer:38.2,temperatureReduction:1.1,totalEconomicBenefitAnnual:142.5,notes:"Evaluación anterior a la poda de mantenimiento."}],{data:A,isLoading:W,error:K}=q({queryKey:["/api/trees"],select:s=>s}),{data:S}=q({queryKey:["/api/parks"],select:s=>s}),b=[...((T=A==null?void 0:A.data)==null?void 0:T.filter(s=>{var a,d,m,M;const n=s.id.toString().includes(g.toLowerCase())||((d=(a=s.species)==null?void 0:a.common_name)==null?void 0:d.toLowerCase().includes(g.toLowerCase()))||((M=(m=s.park)==null?void 0:m.name)==null?void 0:M.toLowerCase().includes(g.toLowerCase())),o=C?s.park_id===parseInt(C):!0;return n&&o}))||[]].sort((s,n)=>s.height!==n.height?(n.height||0)-(s.height||0):(n.trunk_diameter||0)-(s.trunk_diameter||0)),X=s=>{R(s)},J=()=>{R(null)},Q=s=>{Ce({title:"Cálculo ambiental registrado",description:"El cálculo de servicios ambientales ha sido registrado correctamente."}),w(!1)},U=()=>W?e.jsx("div",{className:"flex justify-center p-8",children:"Cargando árboles..."}):K?e.jsxs(ae,{variant:"destructive",className:"my-4",children:[e.jsx(le,{className:"h-4 w-4"}),e.jsx(te,{children:"Error"}),e.jsx(ne,{children:"No se pudieron cargar los árboles. Por favor, intenta de nuevo."})]}):b!=null&&b.length?e.jsxs(ie,{children:[e.jsx(ce,{children:"Lista de árboles para gestión ambiental"}),e.jsx(re,{children:e.jsxs(B,{children:[e.jsx(x,{children:"ID"}),e.jsx(x,{children:"Especie"}),e.jsx(x,{children:"Parque"}),e.jsx(x,{children:"Altura"}),e.jsx(x,{children:"Diámetro"}),e.jsx(x,{children:"Último Cálculo"}),e.jsx(x,{className:"text-right",children:"Acciones"})]})}),e.jsx(de,{children:b.map(s=>{var n,o,a,d,m;return e.jsxs(B,{className:"cursor-pointer hover:bg-gray-50",children:[e.jsx(h,{className:"font-medium",children:s.id}),e.jsx(h,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[(n=s.species)!=null&&n.image_url?e.jsxs(oe,{className:"h-8 w-8",children:[e.jsx(me,{src:s.species.image_url,alt:s.species.common_name}),e.jsx(xe,{children:(o=s.species.common_name)==null?void 0:o.substring(0,2).toUpperCase()})]}):e.jsx(_,{className:"h-5 w-5 text-green-600"}),e.jsxs("div",{children:[e.jsx("div",{children:(a=s.species)==null?void 0:a.common_name}),e.jsx("div",{className:"text-xs text-gray-500 italic",children:(d=s.species)==null?void 0:d.scientific_name})]})]})}),e.jsx(h,{children:(m=s.park)==null?void 0:m.name}),e.jsx(h,{children:l(s.height,"m")}),e.jsx(h,{children:l(s.trunk_diameter,"cm")}),e.jsx(h,{children:e.jsx(H,{variant:"outline",children:"No calculado"})}),e.jsx(h,{className:"text-right",children:e.jsx(f,{variant:"ghost",size:"sm",onClick:()=>X(s),children:"Ver detalles"})})]},s.id)})})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center p-8 text-center",children:[e.jsx(_,{className:"h-12 w-12 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium",children:"No se encontraron árboles"}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"No hay árboles que coincidan con tus criterios de búsqueda."})]}),Y=()=>{var s,n,o;return c?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold",children:["Árbol #",c.id]}),e.jsxs("p",{className:"text-gray-500",children:[(s=c.species)==null?void 0:s.common_name," (",(n=c.species)==null?void 0:n.scientific_name,")"]})]}),e.jsx(f,{variant:"outline",onClick:J,children:"Volver a la lista"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs(u,{children:[e.jsx(j,{className:"pb-2",children:e.jsx(p,{className:"text-sm font-medium text-gray-500",children:"Parque"})}),e.jsx(N,{children:e.jsx("p",{className:"text-lg font-medium",children:(o=c.park)==null?void 0:o.name})})]}),e.jsxs(u,{children:[e.jsx(j,{className:"pb-2",children:e.jsx(p,{className:"text-sm font-medium text-gray-500",children:"Altura y Diámetro"})}),e.jsx(N,{children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Altura"}),e.jsx("p",{className:"text-lg font-medium",children:l(c.height,"m")})]}),e.jsx("div",{className:"h-8 border-l border-gray-200"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Diámetro"}),e.jsx("p",{className:"text-lg font-medium",children:l(c.trunk_diameter,"cm")})]})]})})]}),e.jsxs(u,{children:[e.jsx(j,{className:"pb-2",children:e.jsx(p,{className:"text-sm font-medium text-gray-500",children:"Condición"})}),e.jsx(N,{children:e.jsx("p",{className:"text-lg font-medium",children:c.condition||"No especificada"})})]})]}),e.jsxs("div",{className:"mt-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Historial de Cálculos Ambientales"}),e.jsxs(he,{open:G,onOpenChange:w,children:[e.jsx(ue,{asChild:!0,children:e.jsxs(f,{children:[e.jsx(P,{className:"h-4 w-4 mr-2"}),"Nuevo Cálculo"]})}),e.jsxs(je,{className:"sm:max-w-[700px]",children:[e.jsxs(pe,{children:[e.jsx(Ne,{children:"Nuevo Cálculo de Servicios Ambientales"}),e.jsxs(ge,{children:["Registra un nuevo cálculo de beneficios ambientales para el árbol #",c.id]})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"calculationDate",children:"Fecha de Cálculo"}),e.jsx(i,{id:"calculationDate",type:"date"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"calculationMethod",children:"Metodología"}),e.jsxs(E,{children:[e.jsx(O,{children:e.jsx(F,{placeholder:"Seleccionar"})}),e.jsx(I,{children:V.map(a=>e.jsx(k,{value:a.value,children:a.label},a.value))})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-medium",children:"Secuestro de Carbono"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"co2SequestrationAnnual",children:"Secuestro CO2 Anual (kg/año)"}),e.jsx(i,{id:"co2SequestrationAnnual",type:"number",step:"0.01"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"co2SequestrationLifetime",children:"Secuestro CO2 Vida Útil (kg)"}),e.jsx(i,{id:"co2SequestrationLifetime",type:"number",step:"0.01"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-medium",children:"Remoción de Contaminantes"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"pollutantRemovalNO2",children:"Remoción NO2 (kg/año)"}),e.jsx(i,{id:"pollutantRemovalNO2",type:"number",step:"0.01"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"pollutantRemovalSO2",children:"Remoción SO2 (kg/año)"}),e.jsx(i,{id:"pollutantRemovalSO2",type:"number",step:"0.01"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"pollutantRemovalPM25",children:"Remoción PM2.5 (kg/año)"}),e.jsx(i,{id:"pollutantRemovalPM25",type:"number",step:"0.01"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-medium",children:"Agua y Temperatura"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"stormwaterInterception",children:"Intercepción Agua Pluvial (m³/año)"}),e.jsx(i,{id:"stormwaterInterception",type:"number",step:"0.01"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"shadeAreaSummer",children:"Área de Sombra Verano (m²)"}),e.jsx(i,{id:"shadeAreaSummer",type:"number",step:"0.01"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"temperatureReduction",children:"Reducción de Temperatura (°C)"}),e.jsx(i,{id:"temperatureReduction",type:"number",step:"0.01"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-medium",children:"Valor Económico"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"totalEconomicBenefitAnnual",children:"Beneficio Económico Anual ($/año)"}),e.jsx(i,{id:"totalEconomicBenefitAnnual",type:"number",step:"0.01"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"notes",children:"Observaciones"}),e.jsx("textarea",{id:"notes",className:"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background",placeholder:"Detalles del cálculo"})]})]}),e.jsxs(fe,{children:[e.jsx(f,{variant:"outline",onClick:()=>w(!1),children:"Cancelar"}),e.jsx(f,{onClick:()=>Q(),children:"Guardar"})]})]})]})]}),D.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center p-8 text-center border rounded-md",children:[e.jsx(P,{className:"h-12 w-12 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium",children:"Sin cálculos ambientales"}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"No hay cálculos de servicios ambientales registrados para este árbol."})]}):e.jsx("div",{className:"space-y-6",children:D.map(a=>{var d;return e.jsxs(u,{children:[e.jsxs(j,{children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(p,{className:"text-lg",children:((d=V.find(m=>m.value===a.calculationMethod))==null?void 0:d.label)||a.calculationMethod}),e.jsx(H,{variant:"outline",children:ke(a.calculationDate)})]}),e.jsx(ve,{children:a.notes})]}),e.jsxs(N,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs(u,{className:"shadow-none border",children:[e.jsx(j,{className:"py-2 px-4",children:e.jsxs(p,{className:"text-sm flex items-center",children:[e.jsx(Ae,{className:"h-4 w-4 mr-2 text-blue-500"}),"Captura de CO2"]})}),e.jsxs(N,{className:"py-2 px-4 space-y-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Anual:"}),e.jsx("span",{className:"text-sm font-medium",children:l(a.co2SequestrationAnnual,"kg/año")})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Vida útil:"}),e.jsx("span",{className:"text-sm font-medium",children:l(a.co2SequestrationLifetime,"kg")})]})]})]}),e.jsxs(u,{className:"shadow-none border",children:[e.jsx(j,{className:"py-2 px-4",children:e.jsxs(p,{className:"text-sm flex items-center",children:[e.jsx(Se,{className:"h-4 w-4 mr-2 text-green-500"}),"Filtración de Contaminantes"]})}),e.jsxs(N,{className:"py-2 px-4 space-y-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"NO2:"}),e.jsx("span",{className:"text-sm font-medium",children:l(a.pollutantRemovalNO2,"kg/año")})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"SO2:"}),e.jsx("span",{className:"text-sm font-medium",children:l(a.pollutantRemovalSO2,"kg/año")})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"PM2.5:"}),e.jsx("span",{className:"text-sm font-medium",children:l(a.pollutantRemovalPM25,"kg/año")})]})]})]}),e.jsxs(u,{className:"shadow-none border",children:[e.jsx(j,{className:"py-2 px-4",children:e.jsxs(p,{className:"text-sm flex items-center",children:[e.jsx(be,{className:"h-4 w-4 mr-2 text-blue-500"}),"Agua y Temperatura"]})}),e.jsxs(N,{className:"py-2 px-4 space-y-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Intercepción:"}),e.jsx("span",{className:"text-sm font-medium",children:l(a.stormwaterInterception,"m³/año")})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Sombra:"}),e.jsx("span",{className:"text-sm font-medium",children:l(a.shadeAreaSummer,"m²")})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Reducción temp.:"}),e.jsx("span",{className:"text-sm font-medium",children:l(a.temperatureReduction,"°C")})]})]})]})]}),e.jsx("div",{className:"mt-4 p-3 bg-gray-50 rounded-md",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(ye,{className:"h-5 w-5 mr-2 text-green-600"}),e.jsx("span",{className:"font-medium",children:"Valor económico anual:"})]}),e.jsx("span",{className:"text-lg font-bold text-green-600",children:l(a.totalEconomicBenefitAnnual,"$")})]})})]})]},a.id)})})]})]}):null};return e.jsxs(se,{title:"Gestión Ambiental de Arbolado",subtitle:"Evalúa y gestiona los servicios ambientales proporcionados por árboles en parques",children:[e.jsx(we,{children:e.jsx("title",{children:"Gestión Ambiental de Arbolado | ParquesMX"})}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Gestión Ambiental de Arbolado"}),e.jsx("p",{className:"text-gray-500 mt-1",children:"Evalúa y gestiona los servicios ambientales proporcionados por árboles en parques"})]}),e.jsxs(f,{variant:"outline",onClick:()=>v("/admin/trees/catalog"),children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M9.707 14.707a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 1.414L7.414 9H15a1 1 0 110 2H7.414l2.293 2.293a1 1 0 010 1.414z",clipRule:"evenodd"})}),"Volver al Catálogo de Arbolado"]})]}),c?Y():e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx(i,{placeholder:"Buscar por ID, especie o parque...",value:g,onChange:s=>$(s.target.value),className:"w-full"})}),e.jsx("div",{className:"w-full md:w-64",children:e.jsxs(E,{value:C,onValueChange:z,children:[e.jsx(O,{children:e.jsx(F,{placeholder:"Todos los parques"})}),e.jsxs(I,{children:[e.jsx(k,{value:"all",children:"Todos los parques"}),(L=S==null?void 0:S.data)==null?void 0:L.map(s=>e.jsx(k,{value:s.id.toString(),children:s.name},s.id))]})]})})]}),U()]})]})}export{Me as default};
