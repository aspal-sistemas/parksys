import{am as K,e as V,a6 as L,Y as f,u as Q,a8 as H,j as e,aI as J,C as m,a as u,b as p,m as I,c as x,a0 as X,a1 as G,a2 as W,I as t,B as h,az as Z,a4 as _,z as S,H as P,J as q,K as D,N as c,f as $,as as E,M as ee,O as g}from"./index-Dzu3mJf5.js";import{F as k}from"./file-symlink-DROl84aY.js";function re(){var C,F;const[ae,N]=K(),{toast:n}=V(),v=L(),[A,M]=f.useState(null),[o,y]=f.useState(""),[i,R]=f.useState({firstName:"",lastName:"",email:"",phone:"",specialties:[],experienceYears:1,bio:"",preferredParkId:void 0,qualifications:"",availability:"",hourlyRate:0,experience:"",profileImageFile:null,curriculumFile:null}),{data:T=[]}=Q({queryKey:["/api/parks"]}),j=H({mutationFn:async a=>{const s=new FormData;s.append("firstName",a.firstName),s.append("lastName",a.lastName),s.append("email",a.email),s.append("phone",a.phone||""),s.append("specialties",JSON.stringify(a.specialties)),s.append("experienceYears",a.experienceYears.toString()),s.append("bio",a.bio||""),s.append("qualifications",a.qualifications||""),s.append("availability",a.availability||""),s.append("hourlyRate",(a.hourlyRate||0).toString()),s.append("experience",a.experience||""),a.preferredParkId&&s.append("preferredParkId",a.preferredParkId.toString()),a.profileImageFile&&s.append("profileImage",a.profileImageFile),a.curriculumFile&&s.append("curriculum",a.curriculumFile);const l=await fetch("/api/instructors",{method:"POST",body:s});if(!l.ok){const d=await l.json();throw new Error(d.message||"Error al crear instructor")}return l.json()},onSuccess:()=>{n({title:"Instructor creado exitosamente",description:"El instructor ha sido registrado y su usuario ha sido creado automáticamente."}),v.invalidateQueries({queryKey:["/api/instructors"]}),v.invalidateQueries({queryKey:["/public-api/instructors/public"]}),N("/admin/activities/instructors")},onError:a=>{n({title:"Error al crear instructor",description:a.message,variant:"destructive"})}}),r=(a,s)=>{R(l=>({...l,[a]:s}))},Y=a=>{var l;const s=(l=a.target.files)==null?void 0:l[0];if(s){const d=new FileReader;d.onload=z=>{var w;return M((w=z.target)==null?void 0:w.result)},d.readAsDataURL(s),r("profileImageFile",s)}},B=a=>{var l;const s=(l=a.target.files)==null?void 0:l[0];s&&r("curriculumFile",s)},b=()=>{if(o.trim()&&!i.specialties.includes(o.trim())){const a=[...i.specialties,o.trim()];r("specialties",a),y("")}},O=a=>{const s=i.specialties.filter(l=>l!==a);r("specialties",s)},U=a=>{if(a.preventDefault(),!i.firstName||!i.lastName||!i.email){n({title:"Campos requeridos",description:"Por favor completa los campos de nombre, apellido y email.",variant:"destructive"});return}if(i.specialties.length===0){n({title:"Especialidades requeridas",description:"Por favor agrega al menos una especialidad.",variant:"destructive"});return}j.mutate(i)};return e.jsx(J,{title:"Nuevo Instructor",children:e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Nuevo Instructor"}),e.jsx("p",{className:"text-gray-600",children:"Registra un nuevo instructor para las actividades de los parques. Se creará automáticamente su usuario del sistema."})]}),e.jsxs("form",{onSubmit:U,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsxs(m,{children:[e.jsx(u,{children:e.jsxs(p,{className:"flex items-center",children:[e.jsx(I,{className:"mr-2 h-5 w-5"}),"Foto de Perfil"]})}),e.jsx(x,{className:"space-y-4",children:e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[e.jsxs(X,{className:"h-32 w-32",children:[e.jsx(G,{src:A||void 0}),e.jsxs(W,{className:"text-2xl",children:[(C=i.firstName)==null?void 0:C[0],(F=i.lastName)==null?void 0:F[0]]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(t,{type:"file",accept:"image/*",onChange:Y,className:"hidden",id:"profile-image"}),e.jsx("label",{htmlFor:"profile-image",children:e.jsx(h,{type:"button",variant:"outline",size:"sm",asChild:!0,children:e.jsxs("span",{className:"cursor-pointer",children:[e.jsx(Z,{className:"mr-2 h-4 w-4"}),"Subir foto"]})})})]}),e.jsx("p",{className:"text-xs text-gray-500 text-center",children:"Formatos: JPG, PNG. Máx: 5MB"})]})})]})}),e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs(m,{children:[e.jsx(u,{children:e.jsxs(p,{className:"flex items-center",children:[e.jsx(I,{className:"mr-2 h-5 w-5"}),"Información Personal"]})}),e.jsxs(x,{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"firstName",className:"text-sm font-medium",children:"Nombre *"}),e.jsx(t,{id:"firstName",placeholder:"Nombre del instructor",value:i.firstName,onChange:a=>r("firstName",a.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"lastName",className:"text-sm font-medium",children:"Apellido *"}),e.jsx(t,{id:"lastName",placeholder:"Apellido del instructor",value:i.lastName,onChange:a=>r("lastName",a.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"email",className:"text-sm font-medium",children:"Email *"}),e.jsx(t,{id:"email",type:"email",placeholder:"email@ejemplo.com",value:i.email,onChange:a=>r("email",a.target.value),required:!0}),e.jsx("p",{className:"text-xs text-gray-500",children:"Se usará para crear automáticamente su usuario del sistema"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"phone",className:"text-sm font-medium",children:"Teléfono"}),e.jsx(t,{id:"phone",placeholder:"(33) 1234-5678",value:i.phone,onChange:a=>r("phone",a.target.value)})]})]})]}),e.jsxs(m,{children:[e.jsx(u,{children:e.jsxs(p,{className:"flex items-center",children:[e.jsx(_,{className:"mr-2 h-5 w-5"}),"Información Profesional"]})}),e.jsxs(x,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"experienceYears",className:"text-sm font-medium",children:"Años de Experiencia"}),e.jsx(t,{id:"experienceYears",type:"number",min:"0",max:"50",value:i.experienceYears,onChange:a=>r("experienceYears",parseInt(a.target.value)||0)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"hourlyRate",className:"text-sm font-medium",children:"Tarifa por Hora (MXN)"}),e.jsx(t,{id:"hourlyRate",type:"number",min:"0",placeholder:"0",value:i.hourlyRate,onChange:a=>r("hourlyRate",parseFloat(a.target.value)||0)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"availability",className:"text-sm font-medium",children:"Disponibilidad"}),e.jsxs(S,{onValueChange:a=>r("availability",a),children:[e.jsx(P,{children:e.jsx(q,{placeholder:"Selecciona disponibilidad"})}),e.jsxs(D,{children:[e.jsx(c,{value:"full-time",children:"Tiempo completo"}),e.jsx(c,{value:"part-time",children:"Medio tiempo"}),e.jsx(c,{value:"weekends",children:"Fines de semana"}),e.jsx(c,{value:"evenings",children:"Tardes"}),e.jsx(c,{value:"mornings",children:"Mañanas"}),e.jsx(c,{value:"flexible",children:"Flexible"})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Especialidades *"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(t,{placeholder:"Ej: Yoga, Danza, Deportes acuáticos",value:o,onChange:a=>y(a.target.value),onKeyPress:a=>a.key==="Enter"&&(a.preventDefault(),b())}),e.jsx(h,{type:"button",onClick:b,variant:"outline",children:"Agregar"})]}),i.specialties.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:i.specialties.map((a,s)=>e.jsxs($,{variant:"secondary",className:"bg-[#00a587]/10 text-[#00a587]",children:[a,e.jsx("button",{type:"button",onClick:()=>O(a),className:"ml-2 hover:text-red-600",children:e.jsx(E,{className:"h-3 w-3"})})]},s))})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Agrega las especialidades una por una"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"curriculumFile",className:"text-sm font-medium",children:"Curriculum Vitae"}),e.jsx("div",{className:"border border-gray-300 rounded-md p-4 bg-gray-50",children:i.curriculumFile?e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(k,{className:"h-5 w-5 text-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700 truncate max-w-[200px]",children:i.curriculumFile.name})]}),e.jsx("button",{type:"button",className:"text-red-500 hover:text-red-700",onClick:()=>r("curriculumFile",null),children:e.jsx(E,{className:"h-4 w-4"})})]}):e.jsxs("div",{className:"text-center",children:[e.jsxs("label",{htmlFor:"curriculumUpload",className:"cursor-pointer inline-flex items-center gap-2 py-2 px-4 bg-white border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50",children:[e.jsx(k,{className:"h-4 w-4"}),"Subir CV",e.jsx("input",{id:"curriculumUpload",type:"file",accept:".pdf,.doc,.docx",className:"hidden",onChange:B})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Formatos: PDF, DOC, DOCX. Máx: 5MB"})]})})]})]})]}),e.jsxs(m,{children:[e.jsx(u,{children:e.jsxs(p,{className:"flex items-center",children:[e.jsx(ee,{className:"mr-2 h-5 w-5"}),"Información Adicional"]})}),e.jsxs(x,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"preferredParkId",className:"text-sm font-medium",children:"Parque Preferido (Opcional)"}),e.jsxs(S,{onValueChange:a=>r("preferredParkId",parseInt(a)),children:[e.jsx(P,{children:e.jsx(q,{placeholder:"Selecciona un parque"})}),e.jsx(D,{children:T.map(a=>e.jsx(c,{value:a.id.toString(),children:a.name},a.id))})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"El parque donde el instructor prefiere dar sus actividades"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"qualifications",className:"text-sm font-medium",children:"Certificaciones y Cualificaciones"}),e.jsx(g,{id:"qualifications",placeholder:"Describe las certificaciones, títulos o cualificaciones del instructor...",value:i.qualifications,onChange:a=>r("qualifications",a.target.value),rows:3})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"experience",className:"text-sm font-medium",children:"Experiencia Profesional"}),e.jsx(g,{id:"experience",placeholder:"Describe la experiencia profesional, logros y áreas de especialización...",value:i.experience,onChange:a=>r("experience",a.target.value),rows:4})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"bio",className:"text-sm font-medium",children:"Biografía"}),e.jsx(g,{id:"bio",placeholder:"Describe la filosofía y enfoque del instructor...",value:i.bio,onChange:a=>r("bio",a.target.value),rows:3}),e.jsx("p",{className:"text-xs text-gray-500",children:"Esta información será visible en el perfil público del instructor"})]})]})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-4 pt-6 border-t",children:[e.jsx(h,{type:"button",variant:"outline",onClick:()=>N("/admin/activities/instructors"),children:"Cancelar"}),e.jsx(h,{type:"submit",disabled:j.isPending,className:"bg-[#00a587] hover:bg-[#067f5f]",children:j.isPending?"Creando...":"Crear Instructor"})]})]})]})})}export{re as default};
