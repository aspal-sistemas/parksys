import{c as we,az as Te,a2 as h,u as G,j as e,aX as Ce,B as o,O as S,Q as u,V as j,W as p,Y as g,_ as m,aw as ke,aW as I,dz as De,ay as Se,dx as K,bH as Ie,dA as Ae,bI as Ee,bJ as Q,bK as N,bL as Le,bM as y,a8 as Re,a9 as _e,aa as qe,o as v,f,g as w,h as T,i as C,b1 as Pe,b2 as Fe,b3 as J,aZ as q,b4 as U,w as W,x as X,y as Y,z as Z,I as $,J as ee,N as i,bC as se,n as ae,ab as le,cb as re}from"./index-D5qLf1ib.js";import{H as Me}from"./Helmet-BNepwt1P.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Be=we("CalendarCheck2",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M21 14V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h8",key:"bce9hv"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m16 20 2 2 4-4",key:"13tcca"}]]),te=[{value:"bajo",label:"Bajo"},{value:"moderado",label:"Moderado"},{value:"alto",label:"Alto"},{value:"critico",label:"Crítico"}],ie=[{value:"traq",label:"TRAQ"},{value:"qtra",label:"QTRA"},{value:"simple",label:"Evaluación Simple"},{value:"otro",label:"Otro"}],ne=[{value:"poda",label:"Poda"},{value:"retiro",label:"Retiro"},{value:"tratamiento",label:"Tratamiento"},{value:"sustitucion",label:"Sustitución"}],ce=[{value:"baja",label:"Baja"},{value:"media",label:"Media"},{value:"alta",label:"Alta"},{value:"urgente",label:"Urgente"}],de=[{value:"pendiente",label:"Pendiente"},{value:"programada",label:"Programada"},{value:"en_proceso",label:"En Proceso"},{value:"completada",label:"Completada"},{value:"cancelada",label:"Cancelada"}],He=n=>{switch(n){case"bajo":return"bg-green-100 text-green-800";case"moderado":return"bg-yellow-100 text-yellow-800";case"alto":return"bg-orange-100 text-orange-800";case"critico":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},Oe=n=>{switch(n){case"baja":return"bg-blue-100 text-blue-800";case"media":return"bg-yellow-100 text-yellow-800";case"alta":return"bg-orange-100 text-orange-800";case"urgente":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},Ve=n=>{switch(n){case"pendiente":return"bg-yellow-100 text-yellow-800";case"programada":return"bg-blue-100 text-blue-800";case"en_proceso":return"bg-purple-100 text-purple-800";case"completada":return"bg-green-100 text-green-800";case"cancelada":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},P=n=>n?new Date(n).toLocaleDateString("es-MX",{year:"numeric",month:"long",day:"numeric"}):"N/A";function Qe(){var V,z;const[n,F]=Te(),[k,oe]=h.useState(""),[A,xe]=h.useState("");h.useState("");const[t,M]=h.useState(null),[he,B]=h.useState("risk-assessments"),[me,E]=h.useState(!1),[ue,L]=h.useState(!1),H=[{id:1,treeId:1,assessmentDate:"2023-05-15",methodology:"traq",assessedBy:"Juan Pérez",riskLevel:"bajo",notes:"Árbol en buenas condiciones, no presenta riesgos significativos."},{id:2,treeId:1,assessmentDate:"2023-08-20",methodology:"qtra",assessedBy:"María López",riskLevel:"moderado",notes:"Se observa una rama con signos de deterioro que podría requerir poda preventiva."}],O=[{id:1,treeId:1,interventionType:"poda",priority:"media",status:"completada",plannedDate:"2023-09-10",completedDate:"2023-09-12",notes:"Poda de ramas con deterioro en el sector norte del árbol."},{id:2,treeId:1,interventionType:"tratamiento",priority:"alta",status:"pendiente",plannedDate:"2023-10-15",completedDate:null,notes:"Aplicación de tratamiento preventivo contra plagas."}],{data:R,isLoading:je,error:pe}=G({queryKey:["/api/trees"],select:a=>a}),{data:_}=G({queryKey:["/api/parks"],select:a=>a}),D=[...((V=R==null?void 0:R.data)==null?void 0:V.filter(a=>{var s,l,r,d;const c=a.id.toString().includes(k.toLowerCase())||((l=(s=a.species)==null?void 0:s.common_name)==null?void 0:l.toLowerCase().includes(k.toLowerCase()))||((d=(r=a.park)==null?void 0:r.name)==null?void 0:d.toLowerCase().includes(k.toLowerCase())),x=A?a.park_id===parseInt(A):!0;return c&&x}))||[]].sort((a,c)=>a.id-c.id),ge=a=>{M(a)},ve=()=>{M(null),B("risk-assessments")},be=a=>{re({title:"Evaluación de riesgo registrada",description:"La evaluación ha sido registrada correctamente."}),E(!1)},Ne=a=>{re({title:"Intervención registrada",description:"La intervención ha sido registrada correctamente."}),L(!1)},ye=()=>je?e.jsx("div",{className:"flex justify-center p-8",children:"Cargando árboles..."}):pe?e.jsxs(ke,{variant:"destructive",className:"my-4",children:[e.jsx(I,{className:"h-4 w-4"}),e.jsx(De,{children:"Error"}),e.jsx(Se,{children:"No se pudieron cargar los árboles. Por favor, intenta de nuevo."})]}):D!=null&&D.length?e.jsxs(Ie,{children:[e.jsx(Ae,{children:"Lista de árboles para gestión técnica"}),e.jsx(Ee,{children:e.jsxs(Q,{children:[e.jsx(N,{children:"ID"}),e.jsx(N,{children:"Especie"}),e.jsx(N,{children:"Parque"}),e.jsx(N,{children:"Estado"}),e.jsx(N,{className:"text-right",children:"Acciones"})]})}),e.jsx(Le,{children:D.map(a=>{var c,x,s,l,r;return e.jsxs(Q,{className:"cursor-pointer hover:bg-gray-50",children:[e.jsx(y,{className:"font-medium",children:a.id}),e.jsx(y,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[(c=a.species)!=null&&c.image_url?e.jsxs(Re,{className:"h-8 w-8",children:[e.jsx(_e,{src:a.species.image_url,alt:a.species.common_name}),e.jsx(qe,{children:(x=a.species.common_name)==null?void 0:x.substring(0,2).toUpperCase()})]}):e.jsx(K,{className:"h-5 w-5 text-green-600"}),e.jsxs("div",{children:[e.jsx("div",{children:(s=a.species)==null?void 0:s.common_name}),e.jsx("div",{className:"text-xs text-gray-500 italic",children:(l=a.species)==null?void 0:l.scientific_name})]})]})}),e.jsx(y,{children:(r=a.park)==null?void 0:r.name}),e.jsx(y,{children:e.jsx(v,{variant:a.health_status==="bueno"?"outline":"secondary",children:a.health_status||"No especificado"})}),e.jsx(y,{className:"text-right",children:e.jsx(o,{variant:"ghost",size:"sm",onClick:()=>ge(a),children:"Ver detalles"})})]},a.id)})})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center p-8 text-center",children:[e.jsx(K,{className:"h-12 w-12 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium",children:"No se encontraron árboles"}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"No hay árboles que coincidan con tus criterios de búsqueda."})]}),fe=()=>{var a,c,x;return t?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold",children:["Árbol #",t.id]}),e.jsxs("p",{className:"text-gray-500",children:[(a=t.species)==null?void 0:a.common_name," (",(c=t.species)==null?void 0:c.scientific_name,")"]})]}),e.jsx(o,{variant:"outline",onClick:ve,children:"Volver a la lista"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs(f,{children:[e.jsx(w,{className:"pb-2",children:e.jsx(T,{className:"text-sm font-medium text-gray-500",children:"Parque"})}),e.jsx(C,{children:e.jsx("p",{className:"text-lg font-medium",children:(x=t.park)==null?void 0:x.name})})]}),e.jsxs(f,{children:[e.jsx(w,{className:"pb-2",children:e.jsx(T,{className:"text-sm font-medium text-gray-500",children:"Estado de Salud"})}),e.jsx(C,{children:e.jsx(v,{variant:"outline",className:"text-lg font-medium",children:t.health_status||"No especificado"})})]}),e.jsxs(f,{children:[e.jsx(w,{className:"pb-2",children:e.jsx(T,{className:"text-sm font-medium text-gray-500",children:"Condición"})}),e.jsx(C,{children:e.jsx(v,{className:"text-lg",variant:"outline",children:t.condition||"No evaluada"})})]})]}),e.jsxs(Pe,{value:he,onValueChange:B,children:[e.jsxs(Fe,{className:"grid w-full grid-cols-2",children:[e.jsxs(J,{value:"risk-assessments",children:[e.jsx(I,{className:"h-4 w-4 mr-2"}),"Evaluaciones de Riesgo"]}),e.jsxs(J,{value:"interventions",children:[e.jsx(q,{className:"h-4 w-4 mr-2"}),"Intervenciones"]})]}),e.jsxs(U,{value:"risk-assessments",className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Historial de Evaluaciones de Riesgo"}),e.jsxs(W,{open:me,onOpenChange:E,children:[e.jsx(X,{asChild:!0,children:e.jsxs(o,{children:[e.jsx(I,{className:"h-4 w-4 mr-2"}),"Nueva Evaluación"]})}),e.jsxs(Y,{className:"sm:max-w-[600px]",children:[e.jsxs(Z,{children:[e.jsx($,{children:"Nueva Evaluación de Riesgo"}),e.jsxs(ee,{children:["Registra una nueva evaluación de riesgo para el árbol #",t.id]})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"assessmentDate",children:"Fecha de Evaluación"}),e.jsx(S,{id:"assessmentDate",type:"date"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"methodology",children:"Metodología"}),e.jsxs(u,{children:[e.jsx(j,{children:e.jsx(p,{placeholder:"Seleccionar"})}),e.jsx(g,{children:ie.map(s=>e.jsx(m,{value:s.value,children:s.label},s.value))})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"assessedBy",children:"Evaluado por"}),e.jsx(S,{id:"assessedBy",placeholder:"Nombre del evaluador"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"riskLevel",children:"Nivel de Riesgo"}),e.jsxs(u,{children:[e.jsx(j,{children:e.jsx(p,{placeholder:"Seleccionar"})}),e.jsx(g,{children:te.map(s=>e.jsx(m,{value:s.value,children:s.label},s.value))})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"notes",children:"Observaciones"}),e.jsx("textarea",{id:"notes",className:"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background",placeholder:"Detalles de la evaluación"})]})]}),e.jsxs(se,{children:[e.jsx(o,{variant:"outline",onClick:()=>E(!1),children:"Cancelar"}),e.jsx(o,{onClick:()=>be(),children:"Guardar"})]})]})]})]}),H.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center p-8 text-center border rounded-md",children:[e.jsx(I,{className:"h-12 w-12 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium",children:"Sin evaluaciones de riesgo"}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"No hay evaluaciones de riesgo registradas para este árbol."})]}):e.jsx("div",{className:"space-y-4",children:H.map(s=>{var l,r;return e.jsxs(f,{children:[e.jsxs(w,{className:"pb-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(v,{className:He(s.riskLevel),children:((l=te.find(d=>d.value===s.riskLevel))==null?void 0:l.label)||s.riskLevel}),e.jsx(T,{className:"text-base",children:((r=ie.find(d=>d.value===s.methodology))==null?void 0:r.label)||s.methodology})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[e.jsx(ae,{className:"h-4 w-4"}),P(s.assessmentDate)]})]}),e.jsxs(le,{children:["Evaluado por: ",s.assessedBy]})]}),e.jsx(C,{children:e.jsx("p",{className:"text-sm text-gray-700",children:s.notes})})]},s.id)})})]}),e.jsxs(U,{value:"interventions",className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Historial de Intervenciones"}),e.jsxs(W,{open:ue,onOpenChange:L,children:[e.jsx(X,{asChild:!0,children:e.jsxs(o,{children:[e.jsx(q,{className:"h-4 w-4 mr-2"}),"Nueva Intervención"]})}),e.jsxs(Y,{className:"sm:max-w-[600px]",children:[e.jsxs(Z,{children:[e.jsx($,{children:"Nueva Intervención"}),e.jsxs(ee,{children:["Registra una nueva intervención para el árbol #",t.id]})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"interventionType",children:"Tipo de Intervención"}),e.jsxs(u,{children:[e.jsx(j,{children:e.jsx(p,{placeholder:"Seleccionar"})}),e.jsx(g,{children:ne.map(s=>e.jsx(m,{value:s.value,children:s.label},s.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"priority",children:"Prioridad"}),e.jsxs(u,{children:[e.jsx(j,{children:e.jsx(p,{placeholder:"Seleccionar"})}),e.jsx(g,{children:ce.map(s=>e.jsx(m,{value:s.value,children:s.label},s.value))})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"status",children:"Estado"}),e.jsxs(u,{children:[e.jsx(j,{children:e.jsx(p,{placeholder:"Seleccionar"})}),e.jsx(g,{children:de.map(s=>e.jsx(m,{value:s.value,children:s.label},s.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"plannedDate",children:"Fecha Planificada"}),e.jsx(S,{id:"plannedDate",type:"date"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"notes",children:"Observaciones"}),e.jsx("textarea",{id:"notes",className:"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background",placeholder:"Detalles de la intervención"})]})]}),e.jsxs(se,{children:[e.jsx(o,{variant:"outline",onClick:()=>L(!1),children:"Cancelar"}),e.jsx(o,{onClick:()=>Ne(),children:"Guardar"})]})]})]})]}),O.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center p-8 text-center border rounded-md",children:[e.jsx(q,{className:"h-12 w-12 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium",children:"Sin intervenciones"}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"No hay intervenciones registradas para este árbol."})]}):e.jsx("div",{className:"space-y-4",children:O.map(s=>{var l,r,d;return e.jsxs(f,{children:[e.jsxs(w,{className:"pb-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(v,{className:Oe(s.priority),children:((l=ce.find(b=>b.value===s.priority))==null?void 0:l.label)||s.priority}),e.jsx(T,{className:"text-base",children:((r=ne.find(b=>b.value===s.interventionType))==null?void 0:r.label)||s.interventionType})]}),e.jsx(v,{className:Ve(s.status),children:((d=de.find(b=>b.value===s.status))==null?void 0:d.label)||s.status})]}),e.jsxs(le,{className:"flex gap-4",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Be,{className:"h-3 w-3"})," Planificada: ",P(s.plannedDate)]}),s.completedDate&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ae,{className:"h-3 w-3"})," Completada: ",P(s.completedDate)]})]})]}),e.jsx(C,{children:e.jsx("p",{className:"text-sm text-gray-700",children:s.notes})})]},s.id)})})]})]})]}):null};return e.jsxs(Ce,{title:"Gestión Técnica de Arbolado",subtitle:"Administra evaluaciones de riesgo e intervenciones para árboles en parques",children:[e.jsx(Me,{children:e.jsx("title",{children:"Gestión Técnica de Arbolado | ParquesMX"})}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Gestión Técnica de Arbolado"}),e.jsx("p",{className:"text-gray-500 mt-1",children:"Administra evaluaciones de riesgo e intervenciones para árboles en parques"})]}),e.jsxs(o,{variant:"outline",onClick:()=>F("/admin/trees/catalog"),children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M9.707 14.707a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 1.414L7.414 9H15a1 1 0 110 2H7.414l2.293 2.293a1 1 0 010 1.414z",clipRule:"evenodd"})}),"Volver al Catálogo de Arbolado"]})]}),t?fe():e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx(S,{placeholder:"Buscar por ID, especie o parque...",value:k,onChange:a=>oe(a.target.value),className:"w-full"})}),e.jsx("div",{className:"w-full md:w-64",children:e.jsxs(u,{value:A,onValueChange:xe,children:[e.jsx(j,{children:e.jsx(p,{placeholder:"Todos los parques"})}),e.jsxs(g,{children:[e.jsx(m,{value:"all",children:"Todos los parques"}),(z=_==null?void 0:_.data)==null?void 0:z.map(a=>e.jsx(m,{value:a.id.toString(),children:a.name},a.id))]})]})})]}),ye()]})]})}export{Qe as default};
