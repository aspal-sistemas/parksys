import{am as X,Y as x,u as E,R as _,j as e,aI as O,B as l,I as Q,z as J,H as Y,J as W,K as Z,N as P,_ as ee,$ as se,aO as ae,aP as re,aQ as le,aR as te,x as ie,at as ne,au as ce,C as A,a as k,b as q,a3 as z,f as r,c as I,M as S,h as b,l as f,X as y,i as F,U as T,bH as L}from"./index-Dzu3mJf5.js";const $=[{value:"todas",label:"Todas las Actividades"},{value:"Deportivo",label:"Deportivo"},{value:"Recreación y Bienestar",label:"Recreación y Bienestar"},{value:"Arte y Cultura",label:"Arte y Cultura"},{value:"Naturaleza y Ciencia",label:"Naturaleza y Ciencia"},{value:"Comunidad",label:"Comunidad"},{value:"Eventos de Temporada",label:"Eventos de Temporada"}],me=()=>{const[oe,h]=X(),[u,B]=x.useState("todas"),[c,R]=x.useState(""),[o,M]=x.useState("todos"),[t,g]=x.useState(1),[j,v]=x.useState(!1),p=10,{data:C=[]}=E({queryKey:["/api/parks"]}),{data:V=[],isLoading:G}=E({queryKey:["/api/activities"],select:s=>(console.log("🔍 Datos raw recibidos del API:",s),s.length>0&&(console.log("🔍 Primera actividad completa:",s[0]),console.log("🔍 Campos de precio de primera actividad:",{id:s[0].id,title:s[0].title,price:s[0].price,isFree:s[0].isFree})),s.map(a=>{var i;return{...a,parqueNombre:a.parkName||((i=C.find(n=>n.id===a.parkId))==null?void 0:i.name)||"Parque no disponible"}}))}),d=V.filter(s=>{const a=u==="todas"||s.category===u,i=c===""||s.title&&s.title.toLowerCase().includes(c.toLowerCase())||s.description&&s.description.toLowerCase().includes(c.toLowerCase()),n=o==="todos"||o===""||s.parkId&&s.parkId.toString()===o;return a&&i&&n}),m=Math.ceil(d.length/p),N=(t-1)*p,w=N+p,U=d.slice(N,w);_.useEffect(()=>{g(1)},[u,c,o]);const D=s=>{const a=new Date,i=new Date(s.startDate),n=s.endDate?new Date(s.endDate):null;return i>a?e.jsx(r,{variant:"outline",className:"bg-blue-50 text-blue-700 border-blue-200",children:"Programada"}):n&&n<a?e.jsx(r,{variant:"outline",className:"bg-gray-50 text-gray-700 border-gray-200",children:"Finalizada"}):e.jsx(r,{variant:"outline",className:"bg-green-50 text-green-700 border-green-200",children:"Activa"})},H=s=>e.jsxs(A,{className:"overflow-hidden",children:[e.jsx(k,{className:"bg-gray-50 pb-3",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(q,{className:"text-xl mb-2",children:s.title}),e.jsx(z,{className:"text-base",children:s.description})]}),e.jsxs("div",{className:"ml-4 flex flex-col gap-2",children:[D(s),s.isFree===!1?s.price?e.jsxs(r,{variant:"outline",className:"bg-yellow-50 text-yellow-700 border-yellow-200",children:["$",Number(s.price).toFixed(2)," MXN"]}):e.jsx(r,{variant:"outline",className:"bg-orange-50 text-orange-700 border-orange-200",children:"Precio: Consultar"}):s.isFree===!0?e.jsx(r,{className:"bg-green-50 text-green-700 border-green-200 border",children:"Gratuita"}):e.jsx(r,{variant:"outline",className:"bg-gray-50 text-gray-700 border-gray-200",children:"Sin información de precio"})]})]})}),e.jsx(I,{className:"pt-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:"Información General"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(S,{className:"h-4 w-4 mr-2 text-gray-500"}),e.jsx("span",{children:s.parqueNombre})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(b,{className:"h-4 w-4 mr-2 text-gray-500"}),e.jsx("span",{children:s.startDate&&f(new Date(s.startDate),"PPP",{locale:y})})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(F,{className:"h-4 w-4 mr-2 text-gray-500"}),e.jsx("span",{children:s.duration?`${s.duration} min`:"Consultar detalles"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:"Detalles"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[s.capacity&&e.jsxs("div",{className:"flex items-center",children:[e.jsx(T,{className:"h-4 w-4 mr-2 text-gray-500"}),e.jsxs("span",{children:["Capacidad: ",s.capacity," personas"]})]}),s.location&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Ubicación específica:"}),e.jsx(r,{variant:"secondary",className:"ml-2 text-xs",children:s.location})]}),s.isRecurring&&s.recurringDays&&s.recurringDays.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium block mb-1",children:"Días recurrentes:"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:s.recurringDays.map(a=>e.jsx(r,{variant:"outline",className:"text-xs",children:a.charAt(0).toUpperCase()+a.slice(1)},a))})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:"Requisitos"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[s.materials&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Materiales:"}),e.jsx("p",{className:"text-gray-600 mt-1",children:s.materials})]}),s.requirements&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Requisitos:"}),e.jsx("p",{className:"text-gray-600 mt-1",children:s.requirements})]}),!s.materials&&!s.requirements&&e.jsx("p",{className:"text-gray-400 italic",children:"No hay requisitos específicos"})]})]})]})}),e.jsxs(L,{className:"border-t bg-gray-50 flex justify-between",children:[e.jsx(l,{variant:"outline",size:"sm",className:"text-red-600 hover:text-red-800 hover:bg-red-50",onClick:()=>{window.confirm(`¿Estás seguro de que deseas eliminar la actividad "${s.title}"? Esta acción no se puede deshacer.`)&&fetch(`/api/activities/${s.id}`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}).then(a=>{a.ok?window.location.reload():alert("No se pudo eliminar la actividad. Inténtalo de nuevo.")}).catch(a=>{console.error("Error al eliminar la actividad:",a),alert("Error al eliminar la actividad. Inténtalo de nuevo.")})},children:"Borrar"}),e.jsx(l,{variant:"default",size:"sm",onClick:()=>h(`/admin/organizador/catalogo/editar/${s.id}`),children:"Editar"})]})]},s.id),K=s=>e.jsxs(A,{className:"overflow-hidden",children:[e.jsxs(k,{className:"bg-gray-50 pb-3",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx(q,{className:"text-lg",children:s.title}),D(s)]}),s.parqueNombre&&e.jsxs(z,{className:"flex items-center mt-1",children:[e.jsx(S,{className:"h-3.5 w-3.5 mr-1"}),s.parqueNombre]})]}),e.jsxs(I,{className:"pt-4",children:[e.jsx("p",{className:"text-sm mb-4",children:s.description}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(b,{className:"h-4 w-4 mr-2 text-gray-500"}),e.jsxs("span",{children:[s.startDate&&f(new Date(s.startDate),"PPP",{locale:y}),s.endDate&&` - ${f(new Date(s.endDate),"PPP",{locale:y})}`]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(F,{className:"h-4 w-4 mr-2 text-gray-500"}),s.duration?e.jsxs("span",{children:["Duración: ",s.duration," min"]}):e.jsx("span",{children:"Horario: Consultar detalles"})]}),s.capacity&&e.jsxs("div",{className:"flex items-center",children:[e.jsx(T,{className:"h-4 w-4 mr-2 text-gray-500"}),e.jsxs("span",{children:["Capacidad: ",s.capacity," personas"]})]}),s.isRecurring&&s.recurringDays&&s.recurringDays.length>0&&e.jsxs("div",{className:"flex items-start",children:[e.jsx(b,{className:"h-4 w-4 mr-2 text-gray-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("span",{className:"block",children:"Actividad recurrente:"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:s.recurringDays.map(a=>e.jsx(r,{variant:"outline",className:"text-xs",children:a.charAt(0).toUpperCase()+a.slice(1)},a))})]})]})]}),s.location&&e.jsxs("div",{className:"mt-4",children:[e.jsx("h4",{className:"text-sm font-medium mb-1",children:"Ubicación:"}),e.jsx(r,{variant:"secondary",className:"text-xs",children:s.location})]}),e.jsx("div",{className:"mt-4",children:s.isFree===!1?s.price?e.jsxs(r,{variant:"outline",className:"bg-yellow-50 text-yellow-700 border-yellow-200",children:["Precio: $",Number(s.price).toFixed(2)," MXN"]}):e.jsx(r,{variant:"outline",className:"bg-orange-50 text-orange-700 border-orange-200",children:"Precio: Consultar"}):s.isFree===!0?e.jsx(r,{className:"bg-green-50 text-green-700 border-green-200 border",children:"Gratuita"}):e.jsx(r,{variant:"outline",className:"bg-gray-50 text-gray-700 border-gray-200",children:"Sin información de precio"})})]}),e.jsxs(L,{className:"border-t bg-gray-50 flex justify-between",children:[e.jsx(l,{variant:"outline",size:"sm",className:"text-red-600 hover:text-red-800 hover:bg-red-50",onClick:()=>{window.confirm(`¿Estás seguro de que deseas eliminar la actividad "${s.title}"? Esta acción no se puede deshacer.`)&&fetch(`/api/activities/${s.id}`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}).then(a=>{a.ok?window.location.reload():alert("No se pudo eliminar la actividad. Inténtalo de nuevo.")}).catch(a=>{console.error("Error al eliminar la actividad:",a),alert("Error al eliminar la actividad. Inténtalo de nuevo.")})},children:"Borrar"}),e.jsx(l,{variant:"default",size:"sm",onClick:()=>h(`/admin/organizador/catalogo/editar/${s.id}`),children:"Editar"})]})]},s.id);return e.jsxs(O,{children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Actividades Disponibles"}),e.jsx(l,{onClick:()=>h("/admin/organizador/catalogo/crear"),children:"Crear Nueva Actividad"})]}),e.jsx("p",{className:"text-gray-500",children:"Visualiza todas las actividades disponibles en el catálogo por categoría"})]}),e.jsxs("div",{className:"mb-6 flex flex-col md:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx(Q,{placeholder:"Buscar por nombre o descripción",value:c,onChange:s=>R(s.target.value),className:"w-full"})}),e.jsx("div",{className:"min-w-[200px]",children:e.jsxs(J,{value:o,onValueChange:M,children:[e.jsx(Y,{children:e.jsx(W,{placeholder:"Filtrar por parque"})}),e.jsxs(Z,{children:[e.jsx(P,{value:"todos",children:"Todos los parques"}),C.map(s=>e.jsx(P,{value:s.id.toString(),children:s.name},s.id))]})]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(l,{variant:j?"outline":"default",size:"sm",onClick:()=>v(!1),children:[e.jsx(ee,{className:"h-4 w-4 mr-2"}),"Grid"]}),e.jsxs(l,{variant:j?"default":"outline",size:"sm",onClick:()=>v(!0),children:[e.jsx(se,{className:"h-4 w-4 mr-2"}),"Lista"]})]})]}),e.jsxs(ae,{defaultValue:"todas",value:u,onValueChange:s=>B(s),className:"w-full",children:[e.jsx(re,{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 xl:grid-cols-7 gap-1 mb-6 h-auto p-2",children:$.map(s=>e.jsx(le,{value:s.value,className:"text-xs sm:text-sm whitespace-normal h-auto py-2 px-3 data-[state=active]:bg-primary data-[state=active]:text-primary-foreground",children:s.label},s.value))}),$.map(s=>e.jsx(te,{value:s.value,className:"mt-0",children:G?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx("p",{children:"Cargando actividades..."})}):d.length===0?e.jsxs("div",{className:"bg-gray-50 rounded-lg p-8 text-center",children:[e.jsx(ie,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No hay actividades disponibles"}),e.jsxs("p",{className:"text-gray-500 mb-4",children:["No se encontraron actividades en la categoría ",s.label," con los filtros aplicados."]}),e.jsx(l,{variant:"outline",onClick:()=>h("/admin/organizador/catalogo/crear"),children:"Crear Nueva Actividad"})]}):e.jsxs("div",{children:[e.jsxs("div",{className:"mb-4 text-sm text-gray-600",children:["Mostrando ",N+1,"-",Math.min(w,d.length)," de ",d.length," actividades"]}),e.jsx("div",{className:j?"space-y-4":"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:U.map(a=>j?H(a):K(a))}),m>1&&e.jsxs("div",{className:"mt-8 flex justify-between items-center",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Página ",t," de ",m]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(l,{variant:"outline",size:"sm",onClick:()=>g(Math.max(1,t-1)),disabled:t===1,children:[e.jsx(ne,{className:"h-4 w-4 mr-1"}),"Anterior"]}),Array.from({length:m},(a,i)=>i+1).map(a=>e.jsx(l,{variant:a===t?"default":"outline",size:"sm",onClick:()=>g(a),className:a===t?"bg-primary text-primary-foreground":"",children:a},a)),e.jsxs(l,{variant:"outline",size:"sm",onClick:()=>g(Math.min(m,t+1)),disabled:t===m,children:["Siguiente",e.jsx(ce,{className:"h-4 w-4 ml-1"})]})]})]})]})},s.value))]})]})};export{me as default};
