import{e as ne,a6 as de,Y as x,u as xe,a8 as me,R as he,j as e,aB as oe,C as u,c as N,m as je,a4 as pe,h as ue,S as B,Z as Ne,I as fe,L as H,B as m,aW as ge,a as Q,b as K,aj as ve,z as E,H as P,J as I,K as D,N as r,a3 as ye,ba as be,bb as we,bc as V,bd as f,be as Ce,bf as g,a0 as U,a1 as G,a2 as O,n as J,P as W,f as w,M as Z,b0 as Se,b4 as Ae,aq as Ee,ar as Pe,D as Ie,r as De,t as Te,v as ke,bh as Me,bj as Fe,bk as Le,bl as qe,bm as Re,bn as Ye,bo as ze,bp as $e}from"./index-BBGHPKhn.js";import{P as Be}from"./pen-BW4wfSc2.js";function Ke(){const{toast:T}=ne(),k=de(),[h,M]=x.useState(""),[a,F]=x.useState(null),[_,C]=x.useState(!1),[d,L]=x.useState(null),[o,q]=x.useState(""),[j,R]=x.useState(""),[t,Y]=x.useState(""),[n,y]=x.useState(1),b=10,{data:c=[],isLoading:X}=xe({queryKey:["/api/instructors"]}),S=me({mutationFn:async s=>{const i=await fetch(`/api/instructors/${s}`,{method:"DELETE"});if(!i.ok)throw new Error("Error al eliminar instructor");return i.json()},onSuccess:()=>{T({title:"Instructor eliminado",description:"El instructor ha sido eliminado exitosamente."}),k.invalidateQueries({queryKey:["/api/instructors"]}),k.invalidateQueries({queryKey:["/public-api/instructors/public"]}),C(!1),L(null)},onError:s=>{T({title:"Error al eliminar instructor",description:s.message,variant:"destructive"})}}),ee=Array.from(new Set(c.flatMap(s=>Array.isArray(s.specialties)?s.specialties:[]))).sort();let v=c.filter(s=>{const i=h===""||`${s.firstName} ${s.lastName}`.toLowerCase().includes(h.toLowerCase())||s.email.toLowerCase().includes(h.toLowerCase())||(Array.isArray(s.specialties)?s.specialties:[]).some(ce=>ce.toLowerCase().includes(h.toLowerCase())),l=o==="all"||o===""||(Array.isArray(s.specialties)?s.specialties:[]).includes(o),re=j==="all"||j===""||s.rating&&s.rating>=parseFloat(j),te=t==="all"||t===""||t==="0-2"&&s.experienceYears<=2||t==="3-5"&&s.experienceYears>=3&&s.experienceYears<=5||t==="6-10"&&s.experienceYears>=6&&s.experienceYears<=10||t==="10+"&&s.experienceYears>10;return i&&l&&re&&te});const p=Math.ceil(v.length/b),A=(n-1)*b,z=A+b,se=v.slice(A,z);he.useEffect(()=>{y(1)},[h,o,j,t]);const ae=s=>{L(s),C(!0)},ie=()=>{d&&S.mutate(d.id)},le=s=>!s||!Array.isArray(s)?e.jsx(w,{variant:"outline",className:"text-gray-500",children:"Sin especialidades"}):s.slice(0,3).map((i,l)=>e.jsx(w,{variant:"secondary",className:"bg-[#00a587]/10 text-[#00a587] mr-1 mb-1",children:i},l)),$=s=>e.jsxs("div",{className:"flex items-center",children:[[1,2,3,4,5].map(i=>e.jsx(B,{className:`h-4 w-4 ${i<=s?"text-yellow-400 fill-current":"text-gray-300"}`},i)),e.jsxs("span",{className:"ml-1 text-sm text-gray-600",children:["(",s.toFixed(1),")"]})]});return e.jsxs(oe,{title:"Gestión de Instructores",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(u,{children:e.jsx(N,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Instructores"}),e.jsx("p",{className:"text-2xl font-bold text-[#00a587]",children:c.length})]}),e.jsx(je,{className:"h-8 w-8 text-[#00a587]"})]})})}),e.jsx(u,{children:e.jsx(N,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Especialidades"}),e.jsx("p",{className:"text-2xl font-bold text-[#067f5f]",children:new Set(c.flatMap(s=>s.specialties)).size})]}),e.jsx(pe,{className:"h-8 w-8 text-[#067f5f]"})]})})}),e.jsx(u,{children:e.jsx(N,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Promedio Experiencia"}),e.jsxs("p",{className:"text-2xl font-bold text-[#8498a5]",children:[c.length>0?Math.round(c.reduce((s,i)=>s+i.experienceYears,0)/c.length):0," años"]})]}),e.jsx(ue,{className:"h-8 w-8 text-[#8498a5]"})]})})}),e.jsx(u,{children:e.jsx(N,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Calificación Promedio"}),e.jsx("p",{className:"text-2xl font-bold text-[#bcd256]",children:c.length>0?(c.reduce((s,i)=>s+(i.rating||0),0)/c.length).toFixed(1):"0.0"})]}),e.jsx(B,{className:"h-8 w-8 text-[#bcd256]"})]})})})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{className:"relative w-full sm:w-96",children:[e.jsx(Ne,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e.jsx(fe,{placeholder:"Buscar instructores...",value:h,onChange:s=>M(s.target.value),className:"pl-10"})]}),e.jsx(H,{href:"/admin/activities/instructors/new",children:e.jsxs(m,{className:"bg-[#00a587] hover:bg-[#067f5f]",children:[e.jsx(ge,{className:"mr-2 h-4 w-4"}),"Nuevo Instructor"]})})]}),e.jsxs(u,{children:[e.jsx(Q,{children:e.jsxs(K,{className:"flex items-center gap-2",children:[e.jsx(ve,{className:"h-5 w-5"}),"Filtros"]})}),e.jsx(N,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Especialidad"}),e.jsxs(E,{value:o,onValueChange:q,children:[e.jsx(P,{children:e.jsx(I,{placeholder:"Todas las especialidades"})}),e.jsxs(D,{children:[e.jsx(r,{value:"all",children:"Todas las especialidades"}),ee.map(s=>e.jsx(r,{value:s,children:s},s))]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Calificación mínima"}),e.jsxs(E,{value:j,onValueChange:R,children:[e.jsx(P,{children:e.jsx(I,{placeholder:"Todas las calificaciones"})}),e.jsxs(D,{children:[e.jsx(r,{value:"all",children:"Todas las calificaciones"}),e.jsx(r,{value:"4.5",children:"4.5+ estrellas"}),e.jsx(r,{value:"4.0",children:"4.0+ estrellas"}),e.jsx(r,{value:"3.5",children:"3.5+ estrellas"}),e.jsx(r,{value:"3.0",children:"3.0+ estrellas"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Años de experiencia"}),e.jsxs(E,{value:t,onValueChange:Y,children:[e.jsx(P,{children:e.jsx(I,{placeholder:"Toda la experiencia"})}),e.jsxs(D,{children:[e.jsx(r,{value:"all",children:"Toda la experiencia"}),e.jsx(r,{value:"0-2",children:"0-2 años"}),e.jsx(r,{value:"3-5",children:"3-5 años"}),e.jsx(r,{value:"6-10",children:"6-10 años"}),e.jsx(r,{value:"10+",children:"Más de 10 años"})]})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsx(m,{variant:"outline",onClick:()=>{q("all"),R("all"),Y("all"),M(""),y(1)},className:"w-full",children:"Limpiar filtros"})})]})})]}),e.jsxs(u,{children:[e.jsxs(Q,{children:[e.jsx(K,{children:"Lista de Instructores"}),e.jsx(ye,{children:"Gestiona los instructores que imparten actividades en los parques"})]}),e.jsx(N,{children:X?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-[#00a587]"})}):se.length===0?e.jsx("div",{className:"text-center py-8 text-gray-500",children:h||o!=="all"&&o!==""||j!=="all"&&j!==""||t!=="all"&&t!==""?"No se encontraron instructores que coincidan con los filtros aplicados":"No hay instructores registrados"}):e.jsxs(be,{children:[e.jsx(we,{children:e.jsxs(V,{children:[e.jsx(f,{children:"Instructor"}),e.jsx(f,{children:"Contacto"}),e.jsx(f,{children:"Especialidades"}),e.jsx(f,{children:"Experiencia"}),e.jsx(f,{children:"Calificación"}),e.jsx(f,{children:"Parque Preferido"}),e.jsx(f,{children:"Acciones"})]})}),e.jsx(Ce,{children:v.map(s=>{var i,l;return e.jsxs(V,{children:[e.jsxs(g,{className:"flex items-center space-x-3",children:[e.jsxs(U,{children:[e.jsx(G,{src:s.profileImageUrl}),e.jsxs(O,{children:[((i=s.firstName)==null?void 0:i[0])||"I",((l=s.lastName)==null?void 0:l[0])||"N"]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium",children:[s.firstName||"Sin nombre"," ",s.lastName||""]}),e.jsxs("div",{className:"text-sm text-gray-500",children:[s.activitiesCount||0," actividades"]})]})]}),e.jsx(g,{children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(J,{className:"mr-1 h-3 w-3"}),s.email]}),s.phone&&e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsx(W,{className:"mr-1 h-3 w-3"}),s.phone]})]})}),e.jsx(g,{children:e.jsxs("div",{className:"flex flex-wrap",children:[le(s.specialties),s.specialties.length>3&&e.jsxs(w,{variant:"outline",className:"text-xs",children:["+",s.specialties.length-3]})]})}),e.jsx(g,{children:e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium",children:[s.experienceYears," años"]}),s.hourlyRate&&e.jsxs("div",{className:"text-sm text-gray-600",children:["$",s.hourlyRate,"/hr"]})]})}),e.jsx(g,{children:s.rating?$(s.rating):e.jsx("span",{className:"text-gray-400 text-sm",children:"Sin calificar"})}),e.jsx(g,{children:s.preferredParkName?e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(Z,{className:"mr-1 h-3 w-3"}),s.preferredParkName]}):e.jsx("span",{className:"text-gray-400 text-sm",children:"No especificado"})}),e.jsx(g,{children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(m,{variant:"ghost",size:"sm",onClick:()=>F(s),children:e.jsx(Se,{className:"h-4 w-4"})}),e.jsx(H,{href:`/admin/activities/instructors/${s.id}/edit`,children:e.jsx(m,{variant:"ghost",size:"sm",children:e.jsx(Be,{className:"h-4 w-4"})})}),e.jsx(m,{variant:"ghost",size:"sm",onClick:()=>ae(s),className:"text-red-600 hover:text-red-700",children:e.jsx(Ae,{className:"h-4 w-4"})})]})})]},s.id)})})]})})]}),v.length>b&&e.jsx(u,{children:e.jsx(N,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-700",children:["Página ",n," de ",p," - Mostrando ",A+1,"-",Math.min(z,v.length)," de ",v.length," instructores"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(m,{variant:"outline",size:"sm",onClick:()=>y(s=>Math.max(s-1,1)),disabled:n===1,className:"flex items-center space-x-1",children:[e.jsx(Ee,{className:"h-4 w-4"}),e.jsx("span",{children:"Anterior"})]}),e.jsx("div",{className:"flex space-x-1",children:Array.from({length:Math.min(5,p)},(s,i)=>{let l;return p<=5||n<=3?l=i+1:n>=p-2?l=p-4+i:l=n-2+i,e.jsx(m,{variant:n===l?"default":"outline",size:"sm",onClick:()=>y(l),className:`w-8 h-8 p-0 ${n===l?"bg-[#00a587] hover:bg-[#067f5f] text-white":"hover:bg-gray-100"}`,children:l},l)})}),e.jsxs(m,{variant:"outline",size:"sm",onClick:()=>y(s=>Math.min(s+1,p)),disabled:n===p,className:"flex items-center space-x-1",children:[e.jsx("span",{children:"Siguiente"}),e.jsx(Pe,{className:"h-4 w-4"})]})]})]})})})]}),a&&e.jsx(Ie,{open:!0,onOpenChange:()=>F(null),children:e.jsxs(De,{className:"max-w-2xl","aria-describedby":"instructor-assignment-description",children:[e.jsxs(Te,{children:[e.jsx("div",{id:"instructor-assignment-description",className:"sr-only",children:"Perfil completo del instructor con información de contacto y especialidades"}),e.jsxs(ke,{className:"flex items-center space-x-3",children:[e.jsxs(U,{className:"h-12 w-12",children:[e.jsx(G,{src:a.profileImageUrl}),e.jsxs(O,{children:[a.firstName[0],a.lastName[0]]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-xl font-bold",children:[a.firstName," ",a.lastName]}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Instructor - ",a.experienceYears," años de experiencia"]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 py-4",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Información de Contacto"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(J,{className:"mr-2 h-4 w-4 text-gray-400"}),e.jsx("span",{children:a.email})]}),a.phone&&e.jsxs("div",{className:"flex items-center",children:[e.jsx(W,{className:"mr-2 h-4 w-4 text-gray-400"}),e.jsx("span",{children:a.phone})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Especialidades"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:a.specialties.map((s,i)=>e.jsx(w,{variant:"secondary",className:"bg-[#00a587]/10 text-[#00a587]",children:s},i))})]}),a.preferredParkName&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Parque Preferido"}),e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(Z,{className:"mr-2 h-4 w-4 text-gray-400"}),e.jsx("span",{children:a.preferredParkName})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Información Profesional"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Experiencia:"})," ",a.experienceYears," años"]}),a.hourlyRate&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Tarifa:"})," $",a.hourlyRate,"/hora"]}),a.availability&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Disponibilidad:"})," ",a.availability]}),a.rating&&e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"font-medium mr-2",children:"Calificación:"}),$(a.rating)]})]})]}),a.activitiesCount!==void 0&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Estadísticas"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"font-medium",children:"Actividades impartidas:"})," ",a.activitiesCount]})]})]})]}),a.bio&&e.jsxs("div",{className:"pt-4 border-t",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Biografía"}),e.jsx("p",{className:"text-sm text-gray-700",children:a.bio})]}),a.experience&&e.jsxs("div",{className:"pt-4 border-t",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Experiencia y Certificaciones"}),e.jsx("p",{className:"text-sm text-gray-700",children:a.experience})]})]})}),e.jsx(Me,{open:_,onOpenChange:C,children:e.jsxs(Fe,{children:[e.jsxs(Le,{children:[e.jsx(qe,{children:"¿Eliminar instructor?"}),e.jsxs(Re,{children:['Esta acción eliminará permanentemente el instructor "',d==null?void 0:d.firstName," ",d==null?void 0:d.lastName,'" y su usuario asociado del sistema. Esta acción no se puede deshacer.']})]}),e.jsxs(Ye,{children:[e.jsx(ze,{children:"Cancelar"}),e.jsx($e,{onClick:ie,className:"bg-red-600 hover:bg-red-700",disabled:S.isPending,children:S.isPending?"Eliminando...":"Eliminar"})]})]})})]})}export{Ke as default};
