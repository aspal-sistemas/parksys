import{c as U,l as _,ae as H,a2 as k,u as X,ag as b,j as e,aX as Y,f,bp as A,w as F,x as I,B as m,bh as D,y as z,z as R,I as P,i as L,o,bq as Z,bn as ee,N as t,O as p,$ as ae,Q as C,V as N,W as S,Y as q,_ as j,br as B,b as T,S as se,e as le,aZ as ie,M as ne,m as re,U as te,aS as ce,ah as oe,aq as w,s as de}from"./index-D5qLf1ib.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=U("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=U("Type",[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]),V=[{value:"Sparkles",label:"Limpieza",icon:se},{value:"Shield",label:"Seguridad",icon:le},{value:"Wrench",label:"Mantenimiento",icon:ie},{value:"MapPin",label:"Ubicación/Amenidades",icon:ne},{value:"Calendar",label:"Actividades",icon:re},{value:"Users",label:"Personal",icon:te},{value:"Leaf",label:"Naturaleza",icon:ce},{value:"Star",label:"Calidad",icon:T},{value:"CheckCircle",label:"Satisfacción",icon:oe},{value:"Type",label:"Información",icon:me}],E=[{value:"infraestructura",label:"Infraestructura",color:"bg-blue-100 text-blue-800"},{value:"seguridad",label:"Seguridad",color:"bg-red-100 text-red-800"},{value:"servicios",label:"Servicios",color:"bg-green-100 text-green-800"},{value:"accesibilidad",label:"Accesibilidad",color:"bg-purple-100 text-purple-800"},{value:"ambiente",label:"Ambiente",color:"bg-yellow-100 text-yellow-800"},{value:"experiencia",label:"Experiencia",color:"bg-pink-100 text-pink-800"}],Q=({criteria:a,onSubmit:u,onCancel:g})=>{const[i,n]=k.useState({name:(a==null?void 0:a.name)||"",label:(a==null?void 0:a.label)||"",description:(a==null?void 0:a.description)||"",fieldType:(a==null?void 0:a.fieldType)||"rating",minValue:(a==null?void 0:a.minValue)||1,maxValue:(a==null?void 0:a.maxValue)||5,isRequired:(a==null?void 0:a.isRequired)!==void 0?a.isRequired:!0,isActive:(a==null?void 0:a.isActive)!==void 0?a.isActive:!0,sortOrder:(a==null?void 0:a.sortOrder)||0,icon:(a==null?void 0:a.icon)||"Star",category:(a==null?void 0:a.category)||"experiencia"}),x=l=>{l.preventDefault(),u(i)},v=l=>{const c=V.find(d=>d.value===l);if(c){const d=c.icon;return e.jsx(d,{className:"h-4 w-4"})}return e.jsx(T,{className:"h-4 w-4"})},y=l=>{const c=E.find(d=>d.value===l);return c?e.jsx(o,{className:c.color,children:c.label}):e.jsx(o,{children:"Sin categoría"})};return e.jsxs("form",{onSubmit:x,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(t,{htmlFor:"name",children:"Nombre técnico"}),e.jsx(p,{id:"name",value:i.name,onChange:l=>n({...i,name:l.target.value}),placeholder:"ej: cleanliness",required:!0}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Identificador único en minúsculas (sin espacios)"})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"label",children:"Etiqueta"}),e.jsx(p,{id:"label",value:i.label,onChange:l=>n({...i,label:l.target.value}),placeholder:"ej: Limpieza",required:!0}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Texto visible en el formulario"})]})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"description",children:"Descripción"}),e.jsx(ae,{id:"description",value:i.description,onChange:l=>n({...i,description:l.target.value}),placeholder:"Describe qué evalúa este criterio...",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(t,{htmlFor:"fieldType",children:"Tipo de campo"}),e.jsxs(C,{value:i.fieldType,onValueChange:l=>n({...i,fieldType:l}),children:[e.jsx(N,{children:e.jsx(S,{})}),e.jsxs(q,{children:[e.jsx(j,{value:"rating",children:"Calificación (1-5 estrellas)"}),e.jsx(j,{value:"boolean",children:"Sí/No"}),e.jsx(j,{value:"text",children:"Texto libre"})]})]})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"icon",children:"Icono"}),e.jsxs(C,{value:i.icon,onValueChange:l=>n({...i,icon:l}),children:[e.jsx(N,{children:e.jsx(S,{})}),e.jsx(q,{children:V.map(l=>e.jsx(j,{value:l.value,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(l.icon,{className:"h-4 w-4"}),l.label]})},l.value))})]})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"category",children:"Categoría"}),e.jsxs(C,{value:i.category,onValueChange:l=>n({...i,category:l}),children:[e.jsx(N,{children:e.jsx(S,{})}),e.jsx(q,{children:E.map(l=>e.jsx(j,{value:l.value,children:l.label},l.value))})]})]})]}),i.fieldType==="rating"&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(t,{htmlFor:"minValue",children:"Valor mínimo"}),e.jsx(p,{id:"minValue",type:"number",min:"1",max:"10",value:i.minValue,onChange:l=>n({...i,minValue:parseInt(l.target.value)})})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"maxValue",children:"Valor máximo"}),e.jsx(p,{id:"maxValue",type:"number",min:"1",max:"10",value:i.maxValue,onChange:l=>n({...i,maxValue:parseInt(l.target.value)})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(t,{htmlFor:"sortOrder",children:"Orden de visualización"}),e.jsx(p,{id:"sortOrder",type:"number",min:"0",value:i.sortOrder,onChange:l=>n({...i,sortOrder:parseInt(l.target.value)})})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(B,{id:"isRequired",checked:i.isRequired,onCheckedChange:l=>n({...i,isRequired:l})}),e.jsx(t,{htmlFor:"isRequired",children:"Campo obligatorio"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(B,{id:"isActive",checked:i.isActive,onCheckedChange:l=>n({...i,isActive:l})}),e.jsx(t,{htmlFor:"isActive",children:"Activo"})]})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-medium mb-2",children:"Vista previa"}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[v(i.icon),e.jsx("span",{className:"font-medium",children:i.label||"Sin etiqueta"}),y(i.category),i.isRequired&&e.jsx(o,{variant:"outline",children:"Obligatorio"}),!i.isActive&&e.jsx(o,{variant:"secondary",children:"Inactivo"})]}),i.description&&e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:i.description})]}),e.jsxs("div",{className:"flex gap-2 pt-4",children:[e.jsx(m,{type:"submit",className:"flex-1",children:a?"Actualizar Criterio":"Crear Criterio"}),e.jsx(m,{type:"button",variant:"outline",onClick:g,children:"Cancelar"})]})]})};function he(){const{toast:a}=_(),u=H(),[g,i]=k.useState(!1),[n,x]=k.useState(null),{data:v,isLoading:y,error:l}=X({queryKey:["/api/evaluation-criteria/admin"],queryFn:()=>de("/api/evaluation-criteria/admin")}),c=Array.isArray(v)?v:[],d=b({mutationFn:s=>w("/api/evaluation-criteria",{method:"POST",body:JSON.stringify(s)}),onSuccess:()=>{u.invalidateQueries({queryKey:["/api/evaluation-criteria/admin"]}),a({title:"Criterio creado",description:"El criterio de evaluación ha sido creado exitosamente."}),i(!1)},onError:s=>{a({title:"Error",description:s.message||"No se pudo crear el criterio",variant:"destructive"})}}),M=b({mutationFn:({id:s,data:r})=>w(`/api/evaluation-criteria/${s}`,{method:"PUT",body:JSON.stringify(r)}),onSuccess:()=>{u.invalidateQueries({queryKey:["/api/evaluation-criteria/admin"]}),a({title:"Criterio actualizado",description:"El criterio de evaluación ha sido actualizado exitosamente."}),x(null)},onError:s=>{a({title:"Error",description:s.message||"No se pudo actualizar el criterio",variant:"destructive"})}}),O=b({mutationFn:s=>w(`/api/evaluation-criteria/${s}`,{method:"DELETE"}),onSuccess:()=>{u.invalidateQueries({queryKey:["/api/evaluation-criteria/admin"]}),a({title:"Criterio eliminado",description:"El criterio de evaluación ha sido eliminado exitosamente."})},onError:s=>{a({title:"Error",description:s.message||"No se pudo eliminar el criterio",variant:"destructive"})}}),K=s=>{d.mutate(s)},$=s=>{n&&M.mutate({id:n.id,data:s})},W=s=>{confirm("¿Está seguro de que desea eliminar este criterio? Esta acción no se puede deshacer.")&&O.mutate(s)},G=s=>{const r=V.find(h=>h.value===s);if(r){const h=r.icon;return e.jsx(h,{className:"h-4 w-4"})}return e.jsx(T,{className:"h-4 w-4"})},J=s=>{const r=E.find(h=>h.value===s);return r?e.jsx(o,{className:r.color,children:r.label}):e.jsx(o,{children:"Sin categoría"})};return y?e.jsx("div",{className:"p-8",children:e.jsxs("div",{className:"animate-pulse space-y-4",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/4"}),e.jsx("div",{className:"space-y-2",children:[...Array(5)].map((s,r)=>e.jsx("div",{className:"h-16 bg-gray-200 rounded"},r))})]})}):e.jsx(Y,{children:e.jsxs("div",{className:"p-8 max-w-6xl mx-auto",children:[e.jsx(f,{className:"p-4 bg-gray-50 mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(A,{className:"w-8 h-8 text-gray-900"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Criterios"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Configura los criterios que aparecerán en los formularios de evaluación"})]})]}),e.jsxs(F,{open:g,onOpenChange:i,children:[e.jsx(I,{asChild:!0,children:e.jsxs(m,{children:[e.jsx(D,{className:"h-4 w-4 mr-2"}),"Nuevo Criterio"]})}),e.jsxs(z,{className:"max-w-2xl",children:[e.jsx(R,{children:e.jsx(P,{children:"Crear Criterio de Evaluación"})}),e.jsx(Q,{onSubmit:K,onCancel:()=>i(!1)})]})]})]})}),e.jsx("div",{className:"space-y-4",children:c.map(s=>e.jsx(f,{className:`${s.isActive?"":"opacity-60"}`,children:e.jsxs(L,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(xe,{className:"h-4 w-4 text-gray-400"}),e.jsxs("span",{className:"text-sm font-medium text-gray-500",children:["#",s.sortOrder]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[G(s.icon),e.jsx("span",{className:"font-medium",children:s.label})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[J(s.category),e.jsx(o,{variant:"outline",children:s.fieldType}),s.isRequired&&e.jsx(o,{variant:"outline",children:"Obligatorio"}),!s.isActive&&e.jsx(o,{variant:"secondary",children:"Inactivo"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(F,{open:(n==null?void 0:n.id)===s.id,onOpenChange:r=>!r&&x(null),children:[e.jsx(I,{asChild:!0,children:e.jsx(m,{variant:"ghost",size:"sm",onClick:()=>x(s),children:e.jsx(Z,{className:"h-4 w-4"})})}),e.jsxs(z,{className:"max-w-2xl",children:[e.jsx(R,{children:e.jsx(P,{children:"Editar Criterio de Evaluación"})}),e.jsx(Q,{criteria:s,onSubmit:$,onCancel:()=>x(null)})]})]}),e.jsx(m,{variant:"ghost",size:"sm",onClick:()=>W(s.id),disabled:O.isPending,children:e.jsx(ee,{className:"h-4 w-4 text-red-500"})})]})]}),s.description&&e.jsx("p",{className:"text-sm text-gray-600 mt-2 ml-8",children:s.description}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 ml-8 text-xs text-gray-500",children:[e.jsxs("span",{children:["Nombre: ",s.name]}),s.fieldType==="rating"&&e.jsxs("span",{children:["Rango: ",s.minValue,"-",s.maxValue]})]})]})},s.id))}),c.length===0&&e.jsx(f,{children:e.jsxs(L,{className:"p-8 text-center",children:[e.jsx(A,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No hay criterios configurados"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Comience creando criterios de evaluación para personalizar los formularios"}),e.jsxs(m,{onClick:()=>i(!0),children:[e.jsx(D,{className:"h-4 w-4 mr-2"}),"Crear Primer Criterio"]})]})})]})})}export{he as default};
