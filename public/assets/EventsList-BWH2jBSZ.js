import{a2 as i,l as re,ae as ce,u as E,ag as ne,j as e,aX as B,f as o,i as x,d0 as de,a4 as xe,O as me,Q as S,V as L,W as A,Y as D,_ as l,B as t,a5 as oe,a6 as he,m as u,o as k,M as z,U as K,au as Q,bq as q,bn as G,w as je,y as ge,z as ue,I as Ne,aq as pe}from"./index-D5qLf1ib.js";const ye=()=>{const[m,O]=i.useState(""),[N,R]=i.useState("all"),[p,_]=i.useState("all"),[h,H]=i.useState("all"),[j,T]=i.useState("grid"),[a,W]=i.useState(null),[Y,f]=i.useState(!1);i.useState(!1);const{toast:P}=re(),J=ce(),{data:c=[],isLoading:Z}=E({queryKey:["/api/events"],suspense:!1,retry:1}),{data:n=[]}=E({queryKey:["/api/parks"],suspense:!1,retry:1}),{data:d=[]}=E({queryKey:["/api/events/categories"],suspense:!1,retry:1}),ee=ne({mutationFn:s=>pe(`/api/events/${s}`,{method:"DELETE"}),onSuccess:()=>{J.invalidateQueries({queryKey:["/api/events"]}),P({title:"Evento eliminado",description:"El evento ha sido eliminado exitosamente."})},onError:()=>{P({title:"Error",description:"No se pudo eliminar el evento.",variant:"destructive"})}}),F=s=>{W(s),f(!0)},y=s=>{window.location.href=`/admin/events/edit/${s.id}`},M=s=>{window.confirm("¿Estás seguro de que deseas eliminar este evento?")&&ee.mutate(s)},r=Array.isArray(c==null?void 0:c.data)?c.data:Array.isArray(c)?c:[],se=Array.isArray(n==null?void 0:n.data)?n.data:Array.isArray(n)?n:[],ae=Array.isArray(d==null?void 0:d.data)?d.data:Array.isArray(d)?d:[],v={upcoming:"Próximo",ongoing:"En curso",completed:"Completado",cancelled:"Cancelado"},w={upcoming:"bg-blue-100 text-blue-800",ongoing:"bg-green-100 text-green-800",completed:"bg-gray-100 text-gray-800",cancelled:"bg-red-100 text-red-800"},V=r.filter(s=>{var U,I,X,$;const g=((U=s.title)==null?void 0:U.toLowerCase().includes(m.toLowerCase()))||((I=s.description)==null?void 0:I.toLowerCase().includes(m.toLowerCase()))||((X=s.location)==null?void 0:X.toLowerCase().includes(m.toLowerCase()))||(($=s.organizer)==null?void 0:$.toLowerCase().includes(m.toLowerCase())),te=N==="all"||s.category===N,le=p==="all"||s.status===p,ie=h==="all"||s.location===h||s.parkName===h;return g&&te&&le&&ie}),b=s=>new Date(s).toLocaleDateString("es-MX",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),C=s=>s===0?"Gratuito":`$${s==null?void 0:s.toLocaleString()} MXN`;return Z?e.jsx(B,{children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/3 mb-4"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[...Array(6)].map((s,g)=>e.jsx("div",{className:"h-96 bg-gray-200 rounded-lg"},g))})]})})}):e.jsxs(B,{children:[e.jsxs("div",{className:"p-6",children:[e.jsx(o,{className:"bg-gray-50 mb-6",children:e.jsx(x,{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(de,{className:"w-8 h-8 text-gray-900"}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Listado de Eventos"})]})})}),e.jsx(o,{className:"mb-6",children:e.jsx(x,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 items-center justify-between",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 flex-1",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(xe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(me,{type:"text",placeholder:"Buscar eventos...",value:m,onChange:s=>O(s.target.value),className:"pl-10"})]}),e.jsxs(S,{value:N,onValueChange:R,children:[e.jsx(L,{className:"w-full sm:w-48",children:e.jsx(A,{placeholder:"Categoría"})}),e.jsxs(D,{children:[e.jsx(l,{value:"all",children:"Todas las categorías"}),ae.map(s=>e.jsx(l,{value:s.name,children:s.name},s.id))]})]}),e.jsxs(S,{value:p,onValueChange:_,children:[e.jsx(L,{className:"w-full sm:w-48",children:e.jsx(A,{placeholder:"Estado"})}),e.jsxs(D,{children:[e.jsx(l,{value:"all",children:"Todos los estados"}),e.jsx(l,{value:"upcoming",children:"Próximos"}),e.jsx(l,{value:"ongoing",children:"En curso"}),e.jsx(l,{value:"completed",children:"Completados"}),e.jsx(l,{value:"cancelled",children:"Cancelados"})]})]}),e.jsxs(S,{value:h,onValueChange:H,children:[e.jsx(L,{className:"w-full sm:w-48",children:e.jsx(A,{placeholder:"Parque"})}),e.jsxs(D,{children:[e.jsx(l,{value:"all",children:"Todos los parques"}),se.map(s=>e.jsx(l,{value:s.name,children:s.name},s.id))]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(t,{variant:j==="grid"?"default":"outline",size:"sm",onClick:()=>T("grid"),className:"bg-[#00a587] hover:bg-[#067f5f] text-white",children:e.jsx(oe,{className:"h-4 w-4"})}),e.jsx(t,{variant:j==="list"?"default":"outline",size:"sm",onClick:()=>T("list"),className:"bg-[#00a587] hover:bg-[#067f5f] text-white",children:e.jsx(he,{className:"h-4 w-4"})})]})]})})}),V.length===0?e.jsx(o,{children:e.jsxs(x,{className:"p-12 text-center",children:[e.jsx(u,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No se encontraron eventos"}),e.jsx("p",{className:"text-gray-600",children:r.length===0?"No hay eventos creados aún. Crea tu primer evento desde 'Nuevo Evento'.":"Intenta ajustar los filtros o buscar con otros términos."})]})}):e.jsx("div",{className:j==="grid"?"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6":"space-y-4",children:V.map(s=>e.jsx(o,{className:"overflow-hidden hover:shadow-lg transition-shadow",children:j==="grid"?e.jsxs(e.Fragment,{children:[s.imageUrl&&e.jsx("div",{className:"h-48 overflow-hidden",children:e.jsx("img",{src:s.imageUrl,alt:s.title,className:"w-full h-full object-cover"})}),e.jsxs(x,{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 line-clamp-2",children:s.title}),e.jsx(k,{className:`ml-2 ${w[s.status]}`,children:v[s.status]})]}),e.jsx("p",{className:"text-gray-600 text-sm mb-4 line-clamp-2",children:s.description}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-500 mb-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(u,{className:"h-4 w-4 mr-2"}),b(s.date)," a las ",s.time]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(z,{className:"h-4 w-4 mr-2"}),s.location]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(K,{className:"h-4 w-4 mr-2"}),s.registeredCount||0," / ",s.capacity," participantes"]}),s.price!==void 0&&e.jsx("div",{className:"flex items-center",children:e.jsx("span",{className:"font-medium text-green-600",children:C(s.price)})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(t,{size:"sm",variant:"outline",className:"flex-1",onClick:()=>F(s),children:[e.jsx(Q,{className:"h-4 w-4 mr-1"}),"Ver"]}),e.jsxs(t,{size:"sm",variant:"outline",className:"flex-1",onClick:()=>y(s),children:[e.jsx(q,{className:"h-4 w-4 mr-1"}),"Editar"]}),e.jsx(t,{size:"sm",variant:"outline",onClick:()=>M(s.id),className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:e.jsx(G,{className:"h-4 w-4"})})]})]})]}):e.jsx(x,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:s.title}),e.jsx(k,{className:w[s.status],children:v[s.status]}),e.jsx("span",{className:"text-sm text-gray-500",children:s.category})]}),e.jsxs("div",{className:"flex items-center gap-6 text-sm text-gray-500",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(u,{className:"h-4 w-4 mr-1"}),b(s.date)," - ",s.time]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(z,{className:"h-4 w-4 mr-1"}),s.location]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(K,{className:"h-4 w-4 mr-1"}),s.registeredCount||0,"/",s.capacity]}),s.price!==void 0&&e.jsx("span",{className:"font-medium text-green-600",children:C(s.price)})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(t,{size:"sm",variant:"outline",onClick:()=>F(s),children:e.jsx(Q,{className:"h-4 w-4"})}),e.jsx(t,{size:"sm",variant:"outline",onClick:()=>y(s),children:e.jsx(q,{className:"h-4 w-4"})}),e.jsx(t,{size:"sm",variant:"outline",onClick:()=>M(s.id),className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:e.jsx(G,{className:"h-4 w-4"})})]})]})})},s.id))}),r.length>0&&e.jsx(o,{className:"mt-6",children:e.jsx(x,{className:"p-6",children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:r.length}),e.jsx("div",{className:"text-sm text-gray-500",children:"Total de eventos"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:r.filter(s=>s.status==="upcoming").length}),e.jsx("div",{className:"text-sm text-gray-500",children:"Próximos"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:r.filter(s=>s.status==="ongoing").length}),e.jsx("div",{className:"text-sm text-gray-500",children:"En curso"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-gray-600",children:r.filter(s=>s.status==="completed").length}),e.jsx("div",{className:"text-sm text-gray-500",children:"Completados"})]})]})})})]}),e.jsx(je,{open:Y,onOpenChange:f,children:e.jsxs(ge,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsx(ue,{children:e.jsx(Ne,{className:"text-2xl font-bold text-gray-900",children:"Detalles del Evento"})}),a&&e.jsxs("div",{className:"space-y-6",children:[a.imageUrl&&e.jsx("div",{className:"w-full h-64 overflow-hidden rounded-lg",children:e.jsx("img",{src:a.imageUrl,alt:a.title,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Información General"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Título:"}),e.jsx("span",{className:"text-sm text-gray-900",children:a.title})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Estado:"}),e.jsx(k,{className:w[a.status],children:v[a.status]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Categoría:"}),e.jsx("span",{className:"text-sm text-gray-900",children:a.category})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Organizador:"}),e.jsx("span",{className:"text-sm text-gray-900",children:a.organizer})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Fecha y Ubicación"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(u,{className:"h-4 w-4 mr-2 text-gray-500"}),e.jsxs("span",{className:"text-sm text-gray-900",children:[b(a.date)," a las ",a.time]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(z,{className:"h-4 w-4 mr-2 text-gray-500"}),e.jsx("span",{className:"text-sm text-gray-900",children:a.location})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Capacidad y Participantes"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Capacidad total:"}),e.jsxs("span",{className:"text-sm text-gray-900",children:[a.capacity," personas"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Registrados:"}),e.jsxs("span",{className:"text-sm text-gray-900",children:[a.registeredCount||0," personas"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Disponibles:"}),e.jsxs("span",{className:"text-sm text-gray-900",children:[a.capacity-(a.registeredCount||0)," personas"]})]}),a.price!==void 0&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Precio:"}),e.jsx("span",{className:"text-sm font-medium text-green-600",children:C(a.price)})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Fechas del Sistema"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Creado:"}),e.jsx("span",{className:"text-sm text-gray-900",children:new Date(a.createdAt).toLocaleDateString("es-MX")})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Actualizado:"}),e.jsx("span",{className:"text-sm text-gray-900",children:new Date(a.updatedAt).toLocaleDateString("es-MX")})]})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Descripción"}),e.jsx("p",{className:"text-sm text-gray-700 leading-relaxed",children:a.description})]}),e.jsxs("div",{className:"flex gap-3 pt-4 border-t",children:[e.jsxs(t,{onClick:()=>y(a),className:"bg-[#00a587] hover:bg-[#067f5f] text-white",children:[e.jsx(q,{className:"h-4 w-4 mr-2"}),"Editar Evento"]}),e.jsx(t,{variant:"outline",onClick:()=>f(!1),children:"Cerrar"})]})]})]})})]})};export{ye as default};
