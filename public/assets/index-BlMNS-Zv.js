import{l as ne,ae as de,a2 as x,u as xe,ag as me,R as he,j as e,aX as oe,f as N,i as u,t as je,a3 as pe,m as Ne,b as Q,a4 as ue,O as fe,L as B,B as m,bh as ge,g as H,h as V,a7 as ve,Q as E,V as I,W as P,Y as D,_ as r,ab as ye,bH as be,bI as we,bJ as K,bK as f,bL as Ce,bM as g,a8 as O,a9 as U,aa as G,p as _,P as J,o as w,M as W,au as Se,bn as Ae,aM as Ee,aN as Ie,w as Pe,y as De,z as Te,I as Me,b$ as ke,c1 as Le,c2 as Fe,c3 as Re,c4 as Ye,c5 as qe,c6 as $e,c7 as ze}from"./index-D5qLf1ib.js";import{P as Qe}from"./pen-DCU0qVnc.js";function Ve(){const{toast:T}=ne(),M=de(),[h,k]=x.useState(""),[a,L]=x.useState(null),[X,C]=x.useState(!1),[d,F]=x.useState(null),[o,R]=x.useState(""),[j,Y]=x.useState(""),[t,q]=x.useState(""),[n,y]=x.useState(1),b=10,{data:c=[],isLoading:Z}=xe({queryKey:["/api/instructors"]}),S=me({mutationFn:async s=>{const l=await fetch(`/api/instructors/${s}`,{method:"DELETE"});if(!l.ok)throw new Error("Error al eliminar instructor");return l.json()},onSuccess:()=>{T({title:"Instructor eliminado",description:"El instructor ha sido eliminado exitosamente."}),M.invalidateQueries({queryKey:["/api/instructors"]}),M.invalidateQueries({queryKey:["/public-api/instructors/public"]}),C(!1),F(null)},onError:s=>{T({title:"Error al eliminar instructor",description:s.message,variant:"destructive"})}}),ee=Array.from(new Set(c.flatMap(s=>Array.isArray(s.specialties)?s.specialties:[]))).sort();let v=c.filter(s=>{const l=h===""||`${s.firstName} ${s.lastName}`.toLowerCase().includes(h.toLowerCase())||s.email.toLowerCase().includes(h.toLowerCase())||(Array.isArray(s.specialties)?s.specialties:[]).some(ce=>ce.toLowerCase().includes(h.toLowerCase())),i=o==="all"||o===""||(Array.isArray(s.specialties)?s.specialties:[]).includes(o),re=j==="all"||j===""||s.rating&&s.rating>=parseFloat(j),te=t==="all"||t===""||t==="0-2"&&s.experienceYears<=2||t==="3-5"&&s.experienceYears>=3&&s.experienceYears<=5||t==="6-10"&&s.experienceYears>=6&&s.experienceYears<=10||t==="10+"&&s.experienceYears>10;return l&&i&&re&&te});const p=Math.ceil(v.length/b),A=(n-1)*b,$=A+b,se=v.slice(A,$);he.useEffect(()=>{y(1)},[h,o,j,t]);const ae=s=>{F(s),C(!0)},le=()=>{d&&S.mutate(d.id)},ie=s=>!s||!Array.isArray(s)?e.jsx(w,{variant:"outline",className:"text-gray-500",children:"Sin especialidades"}):s.slice(0,3).map((l,i)=>e.jsx(w,{variant:"secondary",className:"bg-[#00a587]/10 text-[#00a587] mr-1 mb-1",children:l},i)),z=s=>e.jsxs("div",{className:"flex items-center",children:[[1,2,3,4,5].map(l=>e.jsx(Q,{className:`h-4 w-4 ${l<=s?"text-yellow-400 fill-current":"text-gray-300"}`},l)),e.jsxs("span",{className:"ml-1 text-sm text-gray-600",children:["(",s.toFixed(1),")"]})]});return e.jsxs(oe,{title:"Gestión de Instructores",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(N,{children:e.jsx(u,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Instructores"}),e.jsx("p",{className:"text-2xl font-bold text-[#00a587]",children:c.length})]}),e.jsx(je,{className:"h-8 w-8 text-[#00a587]"})]})})}),e.jsx(N,{children:e.jsx(u,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Especialidades"}),e.jsx("p",{className:"text-2xl font-bold text-[#067f5f]",children:new Set(c.flatMap(s=>s.specialties)).size})]}),e.jsx(pe,{className:"h-8 w-8 text-[#067f5f]"})]})})}),e.jsx(N,{children:e.jsx(u,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Promedio Experiencia"}),e.jsxs("p",{className:"text-2xl font-bold text-[#8498a5]",children:[c.length>0?Math.round(c.reduce((s,l)=>s+l.experienceYears,0)/c.length):0," años"]})]}),e.jsx(Ne,{className:"h-8 w-8 text-[#8498a5]"})]})})}),e.jsx(N,{children:e.jsx(u,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Calificación Promedio"}),e.jsx("p",{className:"text-2xl font-bold text-[#bcd256]",children:c.length>0?(c.reduce((s,l)=>s+(l.rating||0),0)/c.length).toFixed(1):"0.0"})]}),e.jsx(Q,{className:"h-8 w-8 text-[#bcd256]"})]})})})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{className:"relative w-full sm:w-96",children:[e.jsx(ue,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e.jsx(fe,{placeholder:"Buscar instructores...",value:h,onChange:s=>k(s.target.value),className:"pl-10"})]}),e.jsx(B,{href:"/admin/activities/instructors/new",children:e.jsxs(m,{className:"bg-[#00a587] hover:bg-[#067f5f]",children:[e.jsx(ge,{className:"mr-2 h-4 w-4"}),"Nuevo Instructor"]})})]}),e.jsxs(N,{children:[e.jsx(H,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(ve,{className:"h-5 w-5"}),"Filtros"]})}),e.jsx(u,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Especialidad"}),e.jsxs(E,{value:o,onValueChange:R,children:[e.jsx(I,{children:e.jsx(P,{placeholder:"Todas las especialidades"})}),e.jsxs(D,{children:[e.jsx(r,{value:"all",children:"Todas las especialidades"}),ee.map(s=>e.jsx(r,{value:s,children:s},s))]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Calificación mínima"}),e.jsxs(E,{value:j,onValueChange:Y,children:[e.jsx(I,{children:e.jsx(P,{placeholder:"Todas las calificaciones"})}),e.jsxs(D,{children:[e.jsx(r,{value:"all",children:"Todas las calificaciones"}),e.jsx(r,{value:"4.5",children:"4.5+ estrellas"}),e.jsx(r,{value:"4.0",children:"4.0+ estrellas"}),e.jsx(r,{value:"3.5",children:"3.5+ estrellas"}),e.jsx(r,{value:"3.0",children:"3.0+ estrellas"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Años de experiencia"}),e.jsxs(E,{value:t,onValueChange:q,children:[e.jsx(I,{children:e.jsx(P,{placeholder:"Toda la experiencia"})}),e.jsxs(D,{children:[e.jsx(r,{value:"all",children:"Toda la experiencia"}),e.jsx(r,{value:"0-2",children:"0-2 años"}),e.jsx(r,{value:"3-5",children:"3-5 años"}),e.jsx(r,{value:"6-10",children:"6-10 años"}),e.jsx(r,{value:"10+",children:"Más de 10 años"})]})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsx(m,{variant:"outline",onClick:()=>{R("all"),Y("all"),q("all"),k(""),y(1)},className:"w-full",children:"Limpiar filtros"})})]})})]}),e.jsxs(N,{children:[e.jsxs(H,{children:[e.jsx(V,{children:"Lista de Instructores"}),e.jsx(ye,{children:"Gestiona los instructores que imparten actividades en los parques"})]}),e.jsx(u,{children:Z?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-[#00a587]"})}):se.length===0?e.jsx("div",{className:"text-center py-8 text-gray-500",children:h||o!=="all"&&o!==""||j!=="all"&&j!==""||t!=="all"&&t!==""?"No se encontraron instructores que coincidan con los filtros aplicados":"No hay instructores registrados"}):e.jsxs(be,{children:[e.jsx(we,{children:e.jsxs(K,{children:[e.jsx(f,{children:"Instructor"}),e.jsx(f,{children:"Contacto"}),e.jsx(f,{children:"Especialidades"}),e.jsx(f,{children:"Experiencia"}),e.jsx(f,{children:"Calificación"}),e.jsx(f,{children:"Parque Preferido"}),e.jsx(f,{children:"Acciones"})]})}),e.jsx(Ce,{children:v.map(s=>{var l,i;return e.jsxs(K,{children:[e.jsxs(g,{className:"flex items-center space-x-3",children:[e.jsxs(O,{children:[e.jsx(U,{src:s.profileImageUrl}),e.jsxs(G,{children:[((l=s.firstName)==null?void 0:l[0])||"I",((i=s.lastName)==null?void 0:i[0])||"N"]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium",children:[s.firstName||"Sin nombre"," ",s.lastName||""]}),e.jsxs("div",{className:"text-sm text-gray-500",children:[s.activitiesCount||0," actividades"]})]})]}),e.jsx(g,{children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(_,{className:"mr-1 h-3 w-3"}),s.email]}),s.phone&&e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsx(J,{className:"mr-1 h-3 w-3"}),s.phone]})]})}),e.jsx(g,{children:e.jsxs("div",{className:"flex flex-wrap",children:[ie(s.specialties),s.specialties.length>3&&e.jsxs(w,{variant:"outline",className:"text-xs",children:["+",s.specialties.length-3]})]})}),e.jsx(g,{children:e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium",children:[s.experienceYears," años"]}),s.hourlyRate&&e.jsxs("div",{className:"text-sm text-gray-600",children:["$",s.hourlyRate,"/hr"]})]})}),e.jsx(g,{children:s.rating?z(s.rating):e.jsx("span",{className:"text-gray-400 text-sm",children:"Sin calificar"})}),e.jsx(g,{children:s.preferredParkName?e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(W,{className:"mr-1 h-3 w-3"}),s.preferredParkName]}):e.jsx("span",{className:"text-gray-400 text-sm",children:"No especificado"})}),e.jsx(g,{children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(m,{variant:"ghost",size:"sm",onClick:()=>L(s),children:e.jsx(Se,{className:"h-4 w-4"})}),e.jsx(B,{href:`/admin/activities/instructors/${s.id}/edit`,children:e.jsx(m,{variant:"ghost",size:"sm",children:e.jsx(Qe,{className:"h-4 w-4"})})}),e.jsx(m,{variant:"ghost",size:"sm",onClick:()=>ae(s),className:"text-red-600 hover:text-red-700",children:e.jsx(Ae,{className:"h-4 w-4"})})]})})]},s.id)})})]})})]}),v.length>b&&e.jsx(N,{children:e.jsx(u,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-700",children:["Página ",n," de ",p," - Mostrando ",A+1,"-",Math.min($,v.length)," de ",v.length," instructores"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(m,{variant:"outline",size:"sm",onClick:()=>y(s=>Math.max(s-1,1)),disabled:n===1,className:"flex items-center space-x-1",children:[e.jsx(Ee,{className:"h-4 w-4"}),e.jsx("span",{children:"Anterior"})]}),e.jsx("div",{className:"flex space-x-1",children:Array.from({length:Math.min(5,p)},(s,l)=>{let i;return p<=5||n<=3?i=l+1:n>=p-2?i=p-4+l:i=n-2+l,e.jsx(m,{variant:n===i?"default":"outline",size:"sm",onClick:()=>y(i),className:`w-8 h-8 p-0 ${n===i?"bg-[#00a587] hover:bg-[#067f5f] text-white":"hover:bg-gray-100"}`,children:i},i)})}),e.jsxs(m,{variant:"outline",size:"sm",onClick:()=>y(s=>Math.min(s+1,p)),disabled:n===p,className:"flex items-center space-x-1",children:[e.jsx("span",{children:"Siguiente"}),e.jsx(Ie,{className:"h-4 w-4"})]})]})]})})})]}),a&&e.jsx(Pe,{open:!0,onOpenChange:()=>L(null),children:e.jsxs(De,{className:"max-w-2xl",children:[e.jsx(Te,{children:e.jsxs(Me,{className:"flex items-center space-x-3",children:[e.jsxs(O,{className:"h-12 w-12",children:[e.jsx(U,{src:a.profileImageUrl}),e.jsxs(G,{children:[a.firstName[0],a.lastName[0]]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-xl font-bold",children:[a.firstName," ",a.lastName]}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Instructor - ",a.experienceYears," años de experiencia"]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 py-4",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Información de Contacto"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(_,{className:"mr-2 h-4 w-4 text-gray-400"}),e.jsx("span",{children:a.email})]}),a.phone&&e.jsxs("div",{className:"flex items-center",children:[e.jsx(J,{className:"mr-2 h-4 w-4 text-gray-400"}),e.jsx("span",{children:a.phone})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Especialidades"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:a.specialties.map((s,l)=>e.jsx(w,{variant:"secondary",className:"bg-[#00a587]/10 text-[#00a587]",children:s},l))})]}),a.preferredParkName&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Parque Preferido"}),e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(W,{className:"mr-2 h-4 w-4 text-gray-400"}),e.jsx("span",{children:a.preferredParkName})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Información Profesional"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Experiencia:"})," ",a.experienceYears," años"]}),a.hourlyRate&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Tarifa:"})," $",a.hourlyRate,"/hora"]}),a.availability&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Disponibilidad:"})," ",a.availability]}),a.rating&&e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"font-medium mr-2",children:"Calificación:"}),z(a.rating)]})]})]}),a.activitiesCount!==void 0&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Estadísticas"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"font-medium",children:"Actividades impartidas:"})," ",a.activitiesCount]})]})]})]}),a.bio&&e.jsxs("div",{className:"pt-4 border-t",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Biografía"}),e.jsx("p",{className:"text-sm text-gray-700",children:a.bio})]}),a.experience&&e.jsxs("div",{className:"pt-4 border-t",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Experiencia y Certificaciones"}),e.jsx("p",{className:"text-sm text-gray-700",children:a.experience})]})]})}),e.jsx(ke,{open:X,onOpenChange:C,children:e.jsxs(Le,{children:[e.jsxs(Fe,{children:[e.jsx(Re,{children:"¿Eliminar instructor?"}),e.jsxs(Ye,{children:['Esta acción eliminará permanentemente el instructor "',d==null?void 0:d.firstName," ",d==null?void 0:d.lastName,'" y su usuario asociado del sistema. Esta acción no se puede deshacer.']})]}),e.jsxs(qe,{children:[e.jsx($e,{children:"Cancelar"}),e.jsx(ze,{onClick:le,className:"bg-red-600 hover:bg-red-700",disabled:S.isPending,children:S.isPending?"Eliminando...":"Eliminar"})]})]})})]})}export{Ve as default};
