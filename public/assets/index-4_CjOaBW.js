import{a2 as S,u as _,j as e,aX as P,B as p,D as E,m as G,f as r,i as t,U as M,e as N,ar as v,au as b,b1 as Z,b2 as H,b3 as m,b4 as h,g as n,h as c,ab as o,bH as w,bI as A,bJ as u,bK as a,bL as T,bM as i,o as d,aY as z}from"./index-D5qLf1ib.js";const I=[{id:1,action:'Rol "Coordinador de Parques" creado',user:"Admin Sistema",role:"Super Administrador",timestamp:"2024-08-04T10:30:00Z",type:"role_created",details:"Nuevo rol creado con 65 permisos asignados"},{id:2,action:'Usuario "Ana García" asignado como "Coordinador de Parques"',user:"Director General",role:"Director General",timestamp:"2024-08-04T09:15:00Z",type:"role_assigned",details:"Asignación de rol con nivel 8 de autoridad"},{id:3,action:'Permisos de "Gestión de Activos" modificados',user:"Admin Sistema",role:"Super Administrador",timestamp:"2024-08-03T16:45:00Z",type:"permissions_modified",details:"Se agregaron 3 nuevos permisos al módulo"},{id:4,action:"Intento de acceso denegado a módulo Finanzas",user:"Juan Rodríguez",role:"Operador de Parque",timestamp:"2024-08-03T14:20:00Z",type:"access_denied",details:"Usuario intentó acceder sin permisos suficientes"},{id:5,action:"Sesión iniciada con éxito",user:"Carlos Martínez",role:"Director General",timestamp:"2024-08-03T08:30:00Z",type:"login_success",details:"Inicio de sesión desde IP 192.168.1.100"}],j={totalUsers:45,activeUsers:42,rolesCreated:10,permissionsTotal:85,sessionsDailyAvg:28,accessDeniedCount:12,lastWeekActivity:156,mostUsedRole:"Operador de Parque",leastUsedRole:"Consultor/Auditor"},q=[{role:"Super Administrador",users:2,permissions:85,usage:95,effectiveness:"Alta",lastUsed:"2024-08-04T10:30:00Z"},{role:"Director General",users:1,permissions:68,usage:88,effectiveness:"Alta",lastUsed:"2024-08-04T09:15:00Z"},{role:"Coordinador de Parques",users:5,permissions:52,usage:76,effectiveness:"Media",lastUsed:"2024-08-03T16:45:00Z"},{role:"Coordinador de Actividades",users:3,permissions:45,usage:82,effectiveness:"Alta",lastUsed:"2024-08-04T08:20:00Z"},{role:"Operador de Parque",users:15,permissions:28,usage:91,effectiveness:"Alta",lastUsed:"2024-08-03T14:30:00Z"},{role:"Administrador Financiero",users:2,permissions:38,usage:65,effectiveness:"Media",lastUsed:"2024-08-04T11:00:00Z"},{role:"Consultor/Auditor",users:4,permissions:25,usage:23,effectiveness:"Baja",lastUsed:"2024-08-02T13:15:00Z"}];function O(){const[f,U]=S.useState("7d"),{data:y=I}=_({queryKey:["/api/admin-roles/reports/activity",f],enabled:!1}),C=s=>{switch(s){case"role_created":return"bg-green-100 text-green-700";case"role_assigned":return"bg-blue-100 text-blue-700";case"permissions_modified":return"bg-yellow-100 text-yellow-700";case"access_denied":return"bg-red-100 text-red-700";case"login_success":return"bg-gray-100 text-gray-700";default:return"bg-gray-100 text-gray-700"}},R=s=>{switch(s){case"role_created":return"Rol Creado";case"role_assigned":return"Rol Asignado";case"permissions_modified":return"Permisos Modificados";case"access_denied":return"Acceso Denegado";case"login_success":return"Inicio de Sesión";default:return"Otro"}},D=s=>{switch(s){case"Alta":return"bg-green-100 text-green-700";case"Media":return"bg-yellow-100 text-yellow-700";case"Baja":return"bg-red-100 text-red-700";default:return"bg-gray-100 text-gray-700"}},g=s=>{const l=new Date(s),x=Math.floor((new Date().getTime()-l.getTime())/(1e3*60*60));return x<1?"Hace menos de 1 hora":x<24?`Hace ${x} horas`:`Hace ${Math.floor(x/24)} días`};return e.jsx(P,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Reportes y Auditoría"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Analizar el uso y efectividad del sistema de roles"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(p,{variant:"outline",children:[e.jsx(E,{className:"w-4 h-4 mr-2"}),"Exportar Datos"]}),e.jsxs(p,{variant:"outline",children:[e.jsx(G,{className:"w-4 h-4 mr-2"}),"Programar Reporte"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx(r,{children:e.jsx(t,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Usuarios Totales"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:j.totalUsers}),e.jsx("p",{className:"text-sm text-green-600",children:"+3 esta semana"})]}),e.jsx(M,{className:"h-8 w-8 text-blue-500"})]})})}),e.jsx(r,{children:e.jsx(t,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Roles Activos"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:j.rolesCreated}),e.jsx("p",{className:"text-sm text-green-600",children:"2 nuevos este mes"})]}),e.jsx(N,{className:"h-8 w-8 text-green-500"})]})})}),e.jsx(r,{children:e.jsx(t,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Actividad Semanal"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:j.lastWeekActivity}),e.jsx("p",{className:"text-sm text-green-600",children:"+12% vs semana anterior"})]}),e.jsx(v,{className:"h-8 w-8 text-purple-500"})]})})}),e.jsx(r,{children:e.jsx(t,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Accesos Denegados"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:j.accessDeniedCount}),e.jsx("p",{className:"text-sm text-red-600",children:"-5 vs semana anterior"})]}),e.jsx(b,{className:"h-8 w-8 text-red-500"})]})})})]}),e.jsx(r,{children:e.jsx(t,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Período de Análisis"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Selecciona el rango de fechas para los reportes"})]}),e.jsx("div",{className:"flex gap-2",children:["7d","30d","90d"].map(s=>e.jsx(p,{variant:f===s?"default":"outline",size:"sm",onClick:()=>U(s),children:s==="7d"?"Últimos 7 días":s==="30d"?"Últimos 30 días":"Últimos 90 días"},s))})]})})}),e.jsxs(Z,{defaultValue:"activity",className:"space-y-4",children:[e.jsxs(H,{children:[e.jsx(m,{value:"activity",children:"Actividad del Sistema"}),e.jsx(m,{value:"usage",children:"Uso de Permisos"}),e.jsx(m,{value:"effectiveness",children:"Efectividad de Roles"}),e.jsx(m,{value:"security",children:"Eventos de Seguridad"})]}),e.jsx(h,{value:"activity",className:"space-y-4",children:e.jsxs(r,{children:[e.jsxs(n,{children:[e.jsxs(c,{className:"flex items-center gap-2",children:[e.jsx(v,{className:"h-5 w-5"}),"Registro de Actividad"]}),e.jsx(o,{children:"Historial completo de acciones realizadas en el sistema de roles"})]}),e.jsx(t,{children:e.jsxs(w,{children:[e.jsx(A,{children:e.jsxs(u,{children:[e.jsx(a,{children:"Acción"}),e.jsx(a,{children:"Usuario"}),e.jsx(a,{children:"Rol"}),e.jsx(a,{children:"Tipo"}),e.jsx(a,{children:"Fecha"}),e.jsx(a,{children:"Detalles"})]})}),e.jsx(T,{children:y.map(s=>e.jsxs(u,{children:[e.jsx(i,{children:e.jsx("p",{className:"font-medium text-gray-900",children:s.action})}),e.jsx(i,{children:e.jsx("p",{className:"text-gray-900",children:s.user})}),e.jsx(i,{children:e.jsx("p",{className:"text-sm text-gray-600",children:s.role})}),e.jsx(i,{children:e.jsx(d,{className:C(s.type),children:R(s.type)})}),e.jsx(i,{children:e.jsx("p",{className:"text-sm text-gray-600",children:g(s.timestamp)})}),e.jsx(i,{children:e.jsx("p",{className:"text-sm text-gray-600",children:s.details})})]},s.id))})]})})]})}),e.jsx(h,{value:"usage",className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(r,{children:[e.jsxs(n,{children:[e.jsx(c,{children:"Permisos Más Utilizados"}),e.jsx(o,{children:"Top 5 permisos con mayor uso en el sistema"})]}),e.jsx(t,{children:e.jsx("div",{className:"space-y-4",children:[{name:"Ver Dashboards",usage:95,module:"Gestión"},{name:"Gestionar Parques",usage:87,module:"Gestión"},{name:"Gestionar Activos",usage:73,module:"Operaciones"},{name:"Ver Usuarios",usage:68,module:"Seguridad"},{name:"Gestionar Actividades",usage:62,module:"Gestión"}].map((s,l)=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:s.name}),e.jsx("p",{className:"text-sm text-gray-600",children:s.module})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-medium text-gray-900",children:[s.usage,"%"]}),e.jsx("div",{className:"w-20 h-2 bg-gray-200 rounded-full mt-1",children:e.jsx("div",{className:"h-2 bg-blue-500 rounded-full",style:{width:`${s.usage}%`}})})]})]},l))})})]}),e.jsxs(r,{children:[e.jsxs(n,{children:[e.jsx(c,{children:"Módulos por Actividad"}),e.jsx(o,{children:"Uso relativo de cada módulo del sistema"})]}),e.jsx(t,{children:e.jsx("div",{className:"space-y-4",children:[{name:"Gestión",usage:89,color:"bg-blue-500"},{name:"Operaciones",usage:76,color:"bg-green-500"},{name:"Finanzas",usage:54,color:"bg-yellow-500"},{name:"Seguridad",usage:43,color:"bg-red-500"},{name:"Marketing",usage:38,color:"bg-purple-500"},{name:"RH",usage:29,color:"bg-teal-500"},{name:"Configuración",usage:22,color:"bg-gray-500"}].map((s,l)=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-4 h-4 rounded ${s.color}`}),e.jsx("p",{className:"font-medium text-gray-900",children:s.name})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-medium text-gray-900",children:[s.usage,"%"]}),e.jsx("div",{className:"w-20 h-2 bg-gray-200 rounded-full mt-1",children:e.jsx("div",{className:`h-2 rounded-full ${s.color}`,style:{width:`${s.usage}%`}})})]})]},l))})})]})]})}),e.jsx(h,{value:"effectiveness",className:"space-y-4",children:e.jsxs(r,{children:[e.jsxs(n,{children:[e.jsxs(c,{className:"flex items-center gap-2",children:[e.jsx(z,{className:"h-5 w-5"}),"Efectividad de Roles"]}),e.jsx(o,{children:"Análisis de la utilización y efectividad de cada rol"})]}),e.jsx(t,{children:e.jsxs(w,{children:[e.jsx(A,{children:e.jsxs(u,{children:[e.jsx(a,{children:"Rol"}),e.jsx(a,{children:"Usuarios"}),e.jsx(a,{children:"Permisos"}),e.jsx(a,{children:"Uso (%)"}),e.jsx(a,{children:"Efectividad"}),e.jsx(a,{children:"Último Uso"})]})}),e.jsx(T,{children:q.map((s,l)=>e.jsxs(u,{children:[e.jsx(i,{children:e.jsx("p",{className:"font-medium text-gray-900",children:s.role})}),e.jsx(i,{children:e.jsxs(d,{variant:"outline",children:[s.users," usuarios"]})}),e.jsx(i,{children:e.jsx("p",{className:"text-gray-900",children:s.permissions})}),e.jsx(i,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-12 h-2 bg-gray-200 rounded-full",children:e.jsx("div",{className:"h-2 bg-blue-500 rounded-full",style:{width:`${s.usage}%`}})}),e.jsxs("span",{className:"text-sm font-medium",children:[s.usage,"%"]})]})}),e.jsx(i,{children:e.jsx(d,{className:D(s.effectiveness),children:s.effectiveness})}),e.jsx(i,{children:e.jsx("p",{className:"text-sm text-gray-600",children:g(s.lastUsed)})})]},l))})]})})]})}),e.jsx(h,{value:"security",className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(r,{children:[e.jsxs(n,{children:[e.jsx(c,{children:"Eventos de Seguridad Recientes"}),e.jsx(o,{children:"Últimos eventos relacionados con la seguridad del sistema"})]}),e.jsx(t,{children:e.jsx("div",{className:"space-y-4",children:y.filter(s=>s.type==="access_denied"||s.type==="login_success").slice(0,5).map(s=>e.jsxs("div",{className:"flex items-start gap-3 p-3 border rounded-lg",children:[e.jsx("div",{className:`p-1 rounded-full ${s.type==="access_denied"?"bg-red-100":"bg-green-100"}`,children:s.type==="access_denied"?e.jsx(b,{className:"h-3 w-3 text-red-600"}):e.jsx(N,{className:"h-3 w-3 text-green-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:s.action}),e.jsxs("p",{className:"text-xs text-gray-600",children:[s.user," • ",g(s.timestamp)]})]})]},s.id))})})]}),e.jsxs(r,{children:[e.jsxs(n,{children:[e.jsx(c,{children:"Resumen de Seguridad"}),e.jsx(o,{children:"Métricas clave de seguridad del sistema"})]}),e.jsx(t,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:"Intentos Fallidos"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Últimas 24 horas"})]}),e.jsx(d,{variant:"outline",className:"bg-red-50 text-red-700",children:"3 intentos"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:"Sesiones Activas"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Usuarios conectados"})]}),e.jsx(d,{variant:"outline",className:"bg-green-50 text-green-700",children:"28 sesiones"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:"Accesos Denegados"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Esta semana"})]}),e.jsx(d,{variant:"outline",className:"bg-yellow-50 text-yellow-700",children:"12 eventos"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:"Cambios de Roles"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Este mes"})]}),e.jsx(d,{variant:"outline",className:"bg-blue-50 text-blue-700",children:"5 cambios"})]})]})})]})]})})]})]})})}export{O as default};
