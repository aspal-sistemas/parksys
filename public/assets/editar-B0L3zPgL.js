import{ad as i,az as he,k as je,l as pe,ae as ge,a2 as k,u as P,af as ye,r as p,ag as ve,j as e,aX as L,f as b,g as N,h as f,ab as C,cc as be,B as A,ai as Ne,i as I,aj as t,ak as o,al as c,am as d,O as g,an as u,$,aF as m,Q as H,V as B,W as O,Y as K,_ as w,bU as Q,bV as U,bt as X,m as J,bW as W,bX as Y,ao as E,br as R,ap as fe,s as Ce,a1 as _}from"./index-D5qLf1ib.js";import{S as ie}from"./Spinner-DBMNTNX4.js";import{A as De}from"./ActivityImageManager-DaRh2cl-.js";import"./star-off-C3XMYBqW.js";const Ae=i.object({title:i.string().min(3,"El t√≠tulo debe tener al menos 3 caracteres"),description:i.string().min(10,"La descripci√≥n debe tener al menos 10 caracteres"),category:i.string().min(1,"Debes seleccionar una categor√≠a"),parkId:i.coerce.number().int().positive("Debes seleccionar un parque"),startDate:i.string().min(1,"La fecha de inicio es obligatoria"),endDate:i.string().optional(),startTime:i.string().min(1,"La hora de inicio es obligatoria"),endTime:i.string().min(1,"La hora de finalizaci√≥n es obligatoria"),location:i.string().optional(),capacity:i.coerce.number().int().positive().optional(),duration:i.coerce.number().int().positive().optional(),price:i.coerce.number().min(0).optional(),isPriceRandom:i.boolean().default(!1),isFree:i.boolean().default(!1),materials:i.string().optional(),requirements:i.string().optional(),isRecurring:i.boolean().default(!1),recurringDays:i.array(i.string()).optional(),targetMarket:i.array(i.string()).optional(),specialNeeds:i.array(i.string()).optional(),instructorId:i.coerce.number().optional().nullable(),instructorName:i.string().optional(),instructorContact:i.string().optional(),registrationEnabled:i.boolean().default(!1),maxRegistrations:i.coerce.number().int().positive().optional(),registrationDeadline:i.string().optional(),requiresApproval:i.boolean().default(!1)});function G(y){if(!y)return"";try{if(y.match(/^\d{4}-\d{2}-\d{2}$/))return y;const h=new Date(y),j=h.getFullYear(),v=(h.getMonth()+1).toString().padStart(2,"0"),D=h.getDate().toString().padStart(2,"0");return`${j}-${v}-${D}`}catch(h){return console.error("Error al formatear fecha:",h),""}}function Z(y,h){if(!y||!h)return 0;try{const[j,v]=y.split(":").map(Number),[D,q]=h.split(":").map(Number);if(isNaN(j)||isNaN(v)||isNaN(D)||isNaN(q))return console.error("Error en formato de horas:",{horaInicio:y,horaFin:h}),0;const F=j*60+v,S=D*60+q;return S<F?24*60-F+S:S-F}catch(j){return console.error("Error al calcular duraci√≥n:",j),0}}const ke=()=>{const[y,h]=he(),j=je(),v=j==null?void 0:j.id,{toast:D}=pe(),q=ge(),[F,S]=k.useState("09:00"),[Ie,ee]=k.useState("10:00"),{data:M,isLoading:ae}=P({queryKey:[`/api/activities/${v}`],enabled:!!v}),{data:V,isLoading:re,error:Se}=P({queryKey:["/api/parks"]}),{data:T,isLoading:te}=P({queryKey:["/api/instructors"]}),{data:se=[]}=P({queryKey:["/api/activity-categories"]}),s=ye({resolver:fe(Ae),defaultValues:{title:"",description:"",parkId:0,startDate:"",endDate:"",startTime:"09:00",endTime:"10:00",category:"",location:"",capacity:20,price:0,isPriceRandom:!1,isFree:!0,materials:"",requirements:"",isRecurring:!1,recurringDays:[],targetMarket:[],specialNeeds:[],instructorId:null,instructorName:"",instructorContact:"",duration:60,registrationEnabled:!1,maxRegistrations:20,registrationDeadline:"",requiresApproval:!0},mode:"onChange"});k.useEffect(()=>{if(M&&typeof M=="object"){const a=M;let r="",n="09:00",l="10:00";if(console.log("üìÖ Datos de actividad recibidos:",{startDate:a.startDate,startTime:a.startTime,endTime:a.endTime,duration:a.duration}),a.startDate)try{if(a.startDate.includes("T")||a.startDate.includes(" ")){const x=new Date(a.startDate);r=p(x,"yyyy-MM-dd"),a.startTime||(n=p(x,"HH:mm"))}else r=a.startDate}catch(x){console.error("‚ùå Error al parsear fecha de inicio:",x),r=""}if(a.startTime&&typeof a.startTime=="string"&&(n=a.startTime),a.endTime&&typeof a.endTime=="string")l=a.endTime;else if(a.duration&&n)try{const[x,ue]=n.split(":").map(Number),ne=x*60+ue+(a.duration||60),me=Math.floor(ne/60)%24,xe=ne%60;l=`${me.toString().padStart(2,"0")}:${xe.toString().padStart(2,"0")}`}catch(x){console.error("‚ùå Error al calcular hora de fin:",x),l="10:00"}console.log("‚úÖ Fechas procesadas:",{startDate:r,startTime:n,endTime:l}),S(n),ee(l),s.reset({title:a.title||"",description:a.description||"",parkId:Number(a.parkId)||0,startDate:r||"",endDate:a.endDate?p(new Date(a.endDate),"yyyy-MM-dd"):"",startTime:n||"09:00",endTime:l||"10:00",category:a.categoryId?a.categoryId.toString():"",location:a.location||"",capacity:Number(a.capacity)||20,price:Number(a.price)||0,isPriceRandom:!!a.isPriceRandom,isFree:!!a.isFree,materials:a.materials||"",requirements:a.requirements||"",isRecurring:!!a.isRecurring,recurringDays:Array.isArray(a.recurringDays)?a.recurringDays:[],targetMarket:Array.isArray(a.targetMarket)?a.targetMarket:[],specialNeeds:Array.isArray(a.specialNeeds)?a.specialNeeds:[],instructorId:a.instructorId&&a.instructorId!==0?Number(a.instructorId):null,instructorName:a.instructorName||"",instructorContact:a.instructorContact||"",duration:Number(a.duration)||Z(n,l),registrationEnabled:!!a.registrationEnabled,maxRegistrations:Number(a.maxRegistrations)||20,registrationDeadline:a.registrationDeadline?p(new Date(a.registrationDeadline),"yyyy-MM-dd"):"",requiresApproval:!!a.requiresApproval})}},[M,s]),k.useEffect(()=>{const a=s.watch("startTime"),r=s.watch("endTime");if(a&&r){const n=Z(a,r);s.setValue("duration",n)}},[s.watch("startTime"),s.watch("endTime"),s]);const z=ve({mutationFn:async a=>{const r={title:a.title,description:a.description,parkId:a.parkId,startDate:G(a.startDate),endDate:a.endDate?G(a.endDate):null,startTime:a.startTime,endTime:a.endTime,category_id:parseInt(a.category),location:a.location||null,capacity:a.capacity||null,duration:a.duration||Z(a.startTime,a.endTime),price:a.isFree?0:a.price,isPriceRandom:a.isPriceRandom||!1,isFree:a.isFree||!1,materials:a.materials||null,requirements:a.requirements||null,isRecurring:a.isRecurring||!1,recurringDays:a.isRecurring?a.recurringDays:[],targetMarket:a.targetMarket||[],specialNeeds:a.specialNeeds||[],registrationEnabled:a.registrationEnabled||!1,maxRegistrations:a.maxRegistrations||null,registrationDeadline:a.registrationDeadline?G(a.registrationDeadline):null,requiresApproval:a.requiresApproval||!0};let n={};a.instructorId&&a.instructorId!==0?n={instructorId:a.instructorId,instructorName:a.instructorName,instructorContact:a.instructorContact}:n={instructorId:null,instructorName:null,instructorContact:null};const l={...r,...n};return console.log("Enviando datos a la API:",l),await Ce(`/api/activities/${v}`,{method:"PUT",data:l})},onSuccess:()=>{D({title:"Actividad actualizada",description:"La actividad se ha actualizado correctamente"}),q.invalidateQueries({queryKey:["/api/activities"]}),q.invalidateQueries({queryKey:[`/api/activities/${v}`]}),h("/admin/organizador/catalogo/ver")},onError:a=>{console.error("Error al actualizar actividad:",a),D({title:"Error",description:"No se pudo actualizar la actividad. Intente nuevamente.",variant:"destructive"})}}),oe=a=>{console.log("üöÄ onSubmit ejecutado con valores:",a),console.log("üîç Errores del formulario:",s.formState.errors),console.log("üîç Estado del formulario v√°lido:",s.formState.isValid),console.log("üîç Campos sucios:",s.formState.dirtyFields),z.mutate(a)},ce=[{id:"Lunes",label:"Lunes"},{id:"Martes",label:"Martes"},{id:"Mi√©rcoles",label:"Mi√©rcoles"},{id:"Jueves",label:"Jueves"},{id:"Viernes",label:"Viernes"},{id:"S√°bado",label:"S√°bado"},{id:"Domingo",label:"Domingo"}],le=[{id:"preescolar",label:"Preescolar - 0 a 5 a√±os"},{id:"ninos",label:"Ni√±os - 6 a 12 a√±os"},{id:"adolescentes",label:"Adolescentes - 13 a 18 a√±os"},{id:"adultos",label:"Adultos - 19 a 65 a√±os"},{id:"adultosmayores",label:"Adultos Mayores - +65 a√±os"}],de=[{id:"fisica",label:"F√≠sica / Motriz"},{id:"visual",label:"Visual"},{id:"auditiva",label:"Auditiva"},{id:"intelectual",label:"Intelectual / Cognitiva"},{id:"psicosocial",label:"Psicosocial / Mental"},{id:"neurodivergencias",label:"Neurodivergencias"},{id:"multiple",label:"M√∫ltiple / Combinada"},{id:"temporal",label:"Temporal"}];return ae||re||te?e.jsx(L,{children:e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx(ie,{})})}):!M&&!ae?e.jsx(L,{children:e.jsxs(b,{className:"w-full max-w-3xl mx-auto",children:[e.jsxs(N,{children:[e.jsx(f,{children:"Actividad no encontrada"}),e.jsx(C,{children:"No se pudo encontrar la actividad con el ID proporcionado"})]}),e.jsx(be,{children:e.jsx(A,{onClick:()=>h("/admin/organizador/catalogo/ver"),children:"Volver al cat√°logo"})})]})}):e.jsx(L,{children:e.jsxs("div",{className:"container mx-auto py-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Editar Actividad"}),e.jsx(A,{variant:"outline",onClick:()=>h("/admin/organizador/catalogo/ver"),children:"Volver al cat√°logo"})]}),e.jsx(Ne,{...s,children:e.jsxs("form",{onSubmit:s.handleSubmit(oe),className:"space-y-8",children:[e.jsxs(b,{children:[e.jsxs(N,{children:[e.jsx(f,{children:"Informaci√≥n B√°sica"}),e.jsx(C,{children:"Informaci√≥n general sobre la actividad"})]}),e.jsxs(I,{className:"space-y-6",children:[e.jsx(t,{control:s.control,name:"title",render:({field:a})=>e.jsxs(o,{children:[e.jsx(c,{children:"Nombre de la actividad *"}),e.jsx(d,{children:e.jsx(g,{placeholder:"Ej. Taller de Pintura",...a})}),e.jsx(u,{})]})}),e.jsx(t,{control:s.control,name:"description",render:({field:a})=>e.jsxs(o,{children:[e.jsx(c,{children:"Descripci√≥n *"}),e.jsx(d,{children:e.jsx($,{placeholder:"Describe la actividad...",className:"resize-none min-h-32",...a})}),e.jsx(m,{children:"Incluye detalles importantes sobre lo que los participantes har√°n y aprender√°n."}),e.jsx(u,{})]})}),e.jsx(t,{control:s.control,name:"parkId",render:({field:a})=>{var r;return e.jsxs(o,{children:[e.jsx(c,{children:"Parque *"}),e.jsxs(H,{onValueChange:n=>a.onChange(parseInt(n)),value:((r=a.value)==null?void 0:r.toString())||"0",children:[e.jsx(d,{children:e.jsx(B,{children:e.jsx(O,{placeholder:"Selecciona un parque"})})}),e.jsx(K,{children:re?e.jsx(w,{value:"loading",disabled:!0,children:"Cargando parques..."}):Array.isArray(V)&&V.length>0?V.map(n=>e.jsx(w,{value:n.id.toString(),children:n.name||"Parque sin nombre"},n.id)):e.jsx(w,{value:"no-parks",disabled:!0,children:"No hay parques disponibles"})})]}),e.jsx(u,{})]})}}),e.jsx(t,{control:s.control,name:"category",render:({field:a})=>e.jsxs(o,{children:[e.jsx(c,{children:"Categor√≠a *"}),e.jsxs(H,{onValueChange:a.onChange,value:a.value,children:[e.jsx(d,{children:e.jsx(B,{children:e.jsx(O,{placeholder:"Selecciona una categor√≠a"})})}),e.jsx(K,{children:Array.isArray(se)&&se.map(r=>e.jsx(w,{value:r.id.toString(),children:r.name},r.id))})]}),e.jsx(u,{})]})}),e.jsx(t,{control:s.control,name:"location",render:({field:a})=>e.jsxs(o,{children:[e.jsx(c,{children:"Ubicaci√≥n dentro del parque"}),e.jsx(d,{children:e.jsx(g,{placeholder:"Ej. √Årea central del parque",...a,value:a.value||""})}),e.jsx(m,{children:"Especifica d√≥nde dentro del parque se realizar√° la actividad."}),e.jsx(u,{})]})})]})]}),e.jsxs(b,{children:[e.jsxs(N,{children:[e.jsx(f,{children:"Fechas y Horarios"}),e.jsx(C,{children:"Cu√°ndo se realizar√° la actividad"})]}),e.jsxs(I,{className:"space-y-6",children:[e.jsx(t,{control:s.control,name:"startDate",render:({field:a})=>e.jsxs(o,{className:"flex flex-col",children:[e.jsx(c,{children:"Fecha de inicio *"}),e.jsxs(Q,{children:[e.jsx(U,{asChild:!0,children:e.jsx(d,{children:e.jsxs(A,{variant:"outline",className:X("w-full pl-3 text-left font-normal",!a.value&&"text-muted-foreground"),children:[a.value?p(new Date(a.value),"PPP",{locale:_}):e.jsx("span",{children:"Selecciona una fecha"}),e.jsx(J,{className:"ml-auto h-4 w-4 opacity-50"})]})})}),e.jsx(W,{className:"w-auto p-0",align:"start",children:e.jsx(Y,{mode:"single",selected:a.value?new Date(a.value):void 0,onSelect:r=>{r&&a.onChange(p(r,"yyyy-MM-dd"))},disabled:r=>r<new Date("1900-01-01"),initialFocus:!0})})]}),e.jsx(u,{})]})}),e.jsx(t,{control:s.control,name:"endDate",render:({field:a})=>e.jsxs(o,{className:"flex flex-col",children:[e.jsx(c,{children:"Fecha de fin (opcional)"}),e.jsxs(Q,{children:[e.jsx(U,{asChild:!0,children:e.jsx(d,{children:e.jsxs(A,{variant:"outline",className:X("w-full pl-3 text-left font-normal",!a.value&&"text-muted-foreground"),children:[a.value?p(new Date(a.value),"PPP",{locale:_}):e.jsx("span",{children:"Selecciona una fecha"}),e.jsx(J,{className:"ml-auto h-4 w-4 opacity-50"})]})})}),e.jsx(W,{className:"w-auto p-0",align:"start",children:e.jsx(Y,{mode:"single",selected:a.value?new Date(a.value):void 0,onSelect:r=>{r?a.onChange(p(r,"yyyy-MM-dd")):a.onChange("")},disabled:r=>{const n=s.getValues("startDate");return!!(r<new Date("1900-01-01")||n&&r<new Date(n))},initialFocus:!0})})]}),e.jsx(m,{children:"Para actividades de un solo d√≠a, deja este campo vac√≠o."}),e.jsx(u,{})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(t,{control:s.control,name:"startTime",render:({field:a})=>e.jsxs(o,{children:[e.jsx(c,{children:"Hora de inicio *"}),e.jsx(d,{children:e.jsx(g,{type:"time",...a,onChange:r=>{a.onChange(r.target.value),S(r.target.value)},className:"mt-1"})}),e.jsx(u,{})]})}),e.jsx(t,{control:s.control,name:"endTime",render:({field:a})=>e.jsxs(o,{children:[e.jsx(c,{children:"Hora de fin *"}),e.jsx(d,{children:e.jsx(g,{type:"time",...a,onChange:r=>{a.onChange(r.target.value),ee(r.target.value)},className:"mt-1"})}),e.jsx(u,{})]})})]}),e.jsx(t,{control:s.control,name:"duration",render:({field:a})=>e.jsxs(o,{children:[e.jsx(c,{children:"Duraci√≥n (en minutos)"}),e.jsx(d,{children:e.jsx(g,{type:"number",...a,min:0,readOnly:!0})}),e.jsx(m,{children:"La duraci√≥n se calcula autom√°ticamente en base a las horas de inicio y fin."}),e.jsx(u,{})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(t,{control:s.control,name:"isRecurring",render:({field:a})=>e.jsxs(o,{className:"flex flex-row items-start space-x-3 space-y-0 rounded-md border p-4",children:[e.jsx(d,{children:e.jsx(E,{checked:a.value,onCheckedChange:a.onChange})}),e.jsxs("div",{className:"space-y-1 leading-none",children:[e.jsx(c,{children:"Actividad recurrente"}),e.jsx(m,{children:"Marca esta opci√≥n si la actividad se repetir√° en d√≠as espec√≠ficos."})]})]})}),s.watch("isRecurring")&&e.jsx(t,{control:s.control,name:"recurringDays",render:()=>e.jsxs(o,{children:[e.jsxs("div",{className:"mb-4",children:[e.jsx(c,{className:"text-base",children:"D√≠as de la semana"}),e.jsx(m,{children:"Selecciona los d√≠as en que se repetir√° la actividad."})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:ce.map(a=>e.jsx(t,{control:s.control,name:"recurringDays",render:({field:r})=>e.jsxs(o,{className:"flex flex-row items-start space-x-3 space-y-0",children:[e.jsx(d,{children:e.jsx(E,{checked:Array.isArray(r.value)&&r.value.includes(a.id),onCheckedChange:n=>{const l=Array.isArray(r.value)?r.value:[];return n?r.onChange([...l,a.id]):r.onChange(l.filter(x=>x!==a.id))}})}),e.jsx(c,{className:"font-normal",children:a.label})]})},a.id))}),e.jsx(u,{})]})})]})]})]}),e.jsxs(b,{children:[e.jsxs(N,{children:[e.jsx(f,{children:"Detalles Adicionales"}),e.jsx(C,{children:"Informaci√≥n complementaria sobre la actividad"})]}),e.jsx(I,{className:"space-y-6",children:e.jsx(t,{control:s.control,name:"capacity",render:({field:a})=>e.jsxs(o,{children:[e.jsx(c,{children:"Capacidad (n√∫mero de participantes)"}),e.jsx(d,{children:e.jsx(g,{type:"number",...a,min:1,value:a.value||"",onChange:r=>a.onChange(r.target.value===""?void 0:parseInt(r.target.value))})}),e.jsx(m,{children:"N√∫mero m√°ximo de personas que pueden participar."}),e.jsx(u,{})]})})})]}),e.jsxs(b,{children:[e.jsxs(N,{children:[e.jsx(f,{children:"Configuraci√≥n de Precios y Pagos"}),e.jsx(C,{children:"Configura el precio y las opciones de pago para la actividad"})]}),e.jsxs(I,{className:"space-y-6",children:[e.jsx(t,{control:s.control,name:"isFree",render:({field:a})=>e.jsxs(o,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(c,{className:"text-base",children:"Actividad gratuita"}),e.jsx(m,{children:"Esta actividad no tiene costo para los participantes"})]}),e.jsx(d,{children:e.jsx(R,{checked:a.value,onCheckedChange:r=>{a.onChange(r),r&&s.setValue("price",0)}})})]})}),!s.watch("isFree")&&e.jsxs("div",{className:"space-y-4",children:[e.jsx(t,{control:s.control,name:"price",render:({field:a})=>e.jsxs(o,{children:[e.jsx(c,{children:"Precio (MXN)"}),e.jsx(d,{children:e.jsx(g,{type:"number",min:0,step:"0.01",value:a.value||"",onChange:r=>{const n=r.target.value;if(n==="")a.onChange(0);else{const l=parseFloat(n);isNaN(l)||a.onChange(l)}},placeholder:"0.00"})}),e.jsx(m,{children:"Precio que pagar√°n los participantes para inscribirse"}),e.jsx(u,{})]})}),e.jsx(t,{control:s.control,name:"isPriceRandom",render:({field:a})=>e.jsxs(o,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(c,{className:"text-base",children:"Cuota de recuperaci√≥n voluntaria"}),e.jsx(m,{children:"El precio es sugerido, los participantes pueden aportar una cantidad diferente"})]}),e.jsx(d,{children:e.jsx(R,{checked:a.value,onCheckedChange:a.onChange})})]})})]})]})]}),e.jsxs(b,{children:[e.jsxs(N,{children:[e.jsx(f,{children:"Detalles Complementarios"}),e.jsx(C,{children:"Informaci√≥n adicional sobre materiales y requisitos"})]}),e.jsxs(I,{className:"space-y-6",children:[e.jsx(t,{control:s.control,name:"materials",render:({field:a})=>e.jsxs(o,{children:[e.jsx(c,{children:"Materiales"}),e.jsx(d,{children:e.jsx($,{placeholder:"Enlista los materiales necesarios...",className:"resize-none",...a,value:a.value||""})}),e.jsx(m,{children:"Materiales que se utilizar√°n o que deben traer los participantes."}),e.jsx(u,{})]})}),e.jsx(t,{control:s.control,name:"requirements",render:({field:a})=>e.jsxs(o,{children:[e.jsx(c,{children:"Requisitos"}),e.jsx(d,{children:e.jsx($,{placeholder:"Describe los requisitos para participar...",className:"resize-none",...a,value:a.value||""})}),e.jsx(m,{children:"Requisitos previos, habilidades necesarias o condiciones para participar."}),e.jsx(u,{})]})}),e.jsx(t,{control:s.control,name:"targetMarket",render:()=>e.jsxs(o,{children:[e.jsxs("div",{className:"mb-4",children:[e.jsx(c,{className:"text-base",children:"P√∫blico objetivo"}),e.jsx(m,{children:"Selecciona los grupos de edad a los que est√° dirigida la actividad."})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:le.map(a=>e.jsx(t,{control:s.control,name:"targetMarket",render:({field:r})=>e.jsxs(o,{className:"flex flex-row items-start space-x-3 space-y-0",children:[e.jsx(d,{children:e.jsx(E,{checked:Array.isArray(r.value)&&r.value.includes(a.id),onCheckedChange:n=>{const l=Array.isArray(r.value)?r.value:[];return n?r.onChange([...l,a.id]):r.onChange(l.filter(x=>x!==a.id))}})}),e.jsx(c,{className:"font-normal",children:a.label})]})},a.id))}),e.jsx(u,{})]})}),e.jsx(t,{control:s.control,name:"specialNeeds",render:()=>e.jsxs(o,{children:[e.jsxs("div",{className:"mb-4",children:[e.jsx(c,{className:"text-base",children:"Adaptaciones para necesidades especiales"}),e.jsx(m,{children:"Selecciona si la actividad est√° adaptada para personas con necesidades especiales."})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:de.map(a=>e.jsx(t,{control:s.control,name:"specialNeeds",render:({field:r})=>e.jsxs(o,{className:"flex flex-row items-start space-x-3 space-y-0",children:[e.jsx(d,{children:e.jsx(E,{checked:Array.isArray(r.value)&&r.value.includes(a.id),onCheckedChange:n=>{const l=Array.isArray(r.value)?r.value:[];return n?r.onChange([...l,a.id]):r.onChange(l.filter(x=>x!==a.id))}})}),e.jsx(c,{className:"font-normal",children:a.label})]})},a.id))}),e.jsx(u,{})]})})]})]}),e.jsxs(b,{children:[e.jsxs(N,{children:[e.jsx(f,{children:"Informaci√≥n del Instructor"}),e.jsx(C,{children:"Datos del instructor que impartir√° la actividad (opcional)"})]}),e.jsxs(I,{className:"space-y-6",children:[e.jsx(t,{control:s.control,name:"instructorId",render:({field:a})=>e.jsxs(o,{children:[e.jsx(c,{children:"Instructor"}),e.jsxs(H,{onValueChange:r=>{if(r==="0")a.onChange(void 0),s.setValue("instructorName",""),s.setValue("instructorContact","");else{const n=parseInt(r);a.onChange(n);const l=Array.isArray(T)?T.find(x=>x.id===n):null;l&&(s.setValue("instructorName",l.fullName||`${l.firstName} ${l.lastName}`),s.setValue("instructorContact",l.email||l.contactEmail||""))}},value:a.value!==void 0&&a.value!==null&&a.value!==0?String(a.value):"0",children:[e.jsx(d,{children:e.jsx(B,{children:e.jsx(O,{placeholder:"Selecciona un instructor (opcional)"})})}),e.jsxs(K,{children:[e.jsx(w,{value:"0",children:"Sin instructor asignado"}),Array.isArray(T)?T.map(r=>e.jsx(w,{value:r.id.toString(),children:r.fullName||`${r.firstName} ${r.lastName}`},r.id)):null]})]}),e.jsx(m,{children:"Selecciona un instructor de la lista o d√©jalo en blanco si no aplica."}),e.jsx(u,{})]})}),s.watch("instructorId")&&s.watch("instructorId")!==0&&s.watch("instructorId")!==void 0&&e.jsxs(e.Fragment,{children:[e.jsx(t,{control:s.control,name:"instructorName",render:({field:a})=>e.jsxs(o,{children:[e.jsx(c,{children:"Nombre del instructor"}),e.jsx(d,{children:e.jsx(g,{...a,readOnly:!0})}),e.jsx(u,{})]})}),e.jsx(t,{control:s.control,name:"instructorContact",render:({field:a})=>e.jsxs(o,{children:[e.jsx(c,{children:"Contacto del instructor"}),e.jsx(d,{children:e.jsx(g,{...a,readOnly:!0})}),e.jsx(u,{})]})})]})]})]}),e.jsxs(b,{children:[e.jsxs(N,{children:[e.jsx(f,{children:"Configuraci√≥n de Inscripciones"}),e.jsx(C,{children:"Configuraci√≥n para permitir inscripciones ciudadanas a esta actividad"})]}),e.jsxs(I,{className:"space-y-6",children:[e.jsx(t,{control:s.control,name:"registrationEnabled",render:({field:a})=>e.jsxs(o,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(c,{className:"text-base",children:"Permitir inscripciones p√∫blicas"}),e.jsx(m,{children:"Los ciudadanos podr√°n inscribirse a esta actividad desde las p√°ginas p√∫blicas"})]}),e.jsx(d,{children:e.jsx(R,{checked:a.value,onCheckedChange:a.onChange})})]})}),s.watch("registrationEnabled")&&e.jsxs(e.Fragment,{children:[e.jsx(t,{control:s.control,name:"maxRegistrations",render:({field:a})=>e.jsxs(o,{children:[e.jsx(c,{children:"Capacidad m√°xima de inscripciones"}),e.jsx(d,{children:e.jsx(g,{type:"number",...a,min:1,max:1e3,value:a.value||"",onChange:r=>a.onChange(r.target.value===""?void 0:parseInt(r.target.value))})}),e.jsx(m,{children:"N√∫mero m√°ximo de personas que pueden inscribirse"}),e.jsx(u,{})]})}),e.jsx(t,{control:s.control,name:"registrationDeadline",render:({field:a})=>e.jsxs(o,{className:"flex flex-col",children:[e.jsx(c,{children:"Fecha l√≠mite de inscripci√≥n"}),e.jsxs(Q,{children:[e.jsx(U,{asChild:!0,children:e.jsx(d,{children:e.jsxs(A,{variant:"outline",className:X("w-full pl-3 text-left font-normal",!a.value&&"text-muted-foreground"),children:[a.value?p(new Date(a.value),"PPP",{locale:_}):e.jsx("span",{children:"Selecciona una fecha"}),e.jsx(J,{className:"ml-auto h-4 w-4 opacity-50"})]})})}),e.jsx(W,{className:"w-auto p-0",align:"start",children:e.jsx(Y,{mode:"single",selected:a.value?new Date(a.value):void 0,onSelect:r=>{a.onChange(r?p(r,"yyyy-MM-dd"):"")},disabled:r=>r<new Date,initialFocus:!0})})]}),e.jsx(m,{children:"Fecha l√≠mite para que los ciudadanos se inscriban"}),e.jsx(u,{})]})}),e.jsx(t,{control:s.control,name:"requiresApproval",render:({field:a})=>e.jsxs(o,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(c,{className:"text-base",children:"Requiere aprobaci√≥n administrativa"}),e.jsx(m,{children:"Las inscripciones quedar√°n pendientes hasta ser aprobadas por un administrador"})]}),e.jsx(d,{children:e.jsx(R,{checked:a.value,onCheckedChange:a.onChange})})]})})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-4",children:[e.jsx(A,{type:"button",variant:"outline",onClick:()=>h("/admin/organizador/catalogo/ver"),children:"Cancelar"}),e.jsx(A,{type:"submit",disabled:z.isPending,onClick:a=>{console.log("üî• Bot√≥n clickeado - evento submit"),console.log("üîç Form valid:",s.formState.isValid),console.log("üîç Form errors:",s.formState.errors)},children:z.isPending?e.jsxs(e.Fragment,{children:[e.jsx(ie,{className:"mr-2 h-4 w-4"}),"Actualizando..."]}):"Actualizar Actividad"})]})]})}),e.jsx("div",{className:"mt-8",children:e.jsx(De,{activityId:parseInt(j.id||"0")})})]})})};export{ke as default};
