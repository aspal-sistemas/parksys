const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/dashboard-charts-C3pyYjUT.js","assets/index-BBGHPKhn.js","assets/index-b8PYtmeo.css","assets/RadarChart-Dui5H1ru.js","assets/BarChart-BuBcT4O5.js"])))=>i.map(i=>d[i]);
import{aw as K,R as d,ci as O,al as J,u as p,j as e,aB as X,B as I,A as H,cj as Q,C as r,c as t,a9 as f,i as v,aY as U,a as o,b as m,a3 as x,bw as h,aC as E,f as S,M as T,l as z,X as L}from"./index-BBGHPKhn.js";import{A as N,a as y}from"./arrow-up-right-BXNV1YVo.js";import{C as _}from"./circle-x-BonrdJvp.js";import{s as Y}from"./subMonths-BHu6PBkA.js";import"./addMonths-FaidB020.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=K("SquareStack",[["path",{d:"M4 10c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h4c1.1 0 2 .9 2 2",key:"4i38lg"}],["path",{d:"M10 16c-1.1 0-2-.9-2-2v-4c0-1.1.9-2 2-2h4c1.1 0 2 .9 2 2",key:"mlte4a"}],["rect",{width:"8",height:"8",x:"14",y:"14",rx:"2",key:"1fa9i4"}]]),u=d.lazy(()=>O(()=>import("./dashboard-charts-C3pyYjUT.js"),__vite__mapDeps([0,1,2,3,4]))),ie=()=>{const[Z,b]=J(),w=new Date;Y(w,1);const B=a=>z(a,"MMMM yyyy",{locale:L}),{data:s={total:0,pending:0,inProgress:0,resolved:0,rejected:0,byPriority:{low:0,medium:0,high:0,critical:0},byCategory:[],byPark:[],byMonth:[],resolutionTime:0,mostRecentIncidents:[]},isLoading:ee,isError:se}=p({queryKey:["/api/incidents/stats"],onError:a=>{console.error("Error al cargar estadísticas:",a)}}),{data:G=[]}=p({queryKey:["/api/incident-categories"],onError:a=>{console.error("Error al cargar categorías:",a)}}),{data:V=[]}=p({queryKey:["/api/parks"],onError:a=>{console.error("Error al cargar parques:",a)}}),j=d.useMemo(()=>{var M,R,A,q;const a=[{name:"Pendientes",value:s.pending||12,color:"#fbbf24"},{name:"En proceso",value:s.inProgress||18,color:"#3b82f6"},{name:"Resueltas",value:s.resolved||34,color:"#22c55e"},{name:"Rechazadas",value:s.rejected||8,color:"#ef4444"}],n=[{name:"Baja",value:((M=s.byPriority)==null?void 0:M.low)||15,color:"#3b82f6"},{name:"Media",value:((R=s.byPriority)==null?void 0:R.medium)||25,color:"#fbbf24"},{name:"Alta",value:((A=s.byPriority)==null?void 0:A.high)||20,color:"#f97316"},{name:"Crítica",value:((q=s.byPriority)==null?void 0:q.critical)||12,color:"#ef4444"}],i=s.byCategory&&s.byCategory.length>0?s.byCategory.map(c=>({name:c.name,value:c.count,color:c.color||"#3b82f6"})):[{name:"Daños",value:24,color:"#3b82f6"},{name:"Seguridad",value:18,color:"#f97316"},{name:"Mantenimiento",value:15,color:"#22c55e"},{name:"Vandalismo",value:9,color:"#ef4444"},{name:"Otros",value:6,color:"#a855f7"}],$=s.byPark&&s.byPark.length>0?s.byPark.map(c=>({name:c.name||`Parque ${c.id}`,value:c.count})):[{name:"Parque Metropolitano",value:28},{name:"Parque Agua Azul",value:22},{name:"Parque González Gallo",value:16},{name:"Parque Colomos",value:14},{name:"Otros parques",value:12}],F=s.byMonth&&s.byMonth.length>0?s.byMonth:[{name:"Ene",pending:5,inProgress:8,resolved:12},{name:"Feb",pending:7,inProgress:10,resolved:15},{name:"Mar",pending:4,inProgress:12,resolved:18},{name:"Abr",pending:8,inProgress:9,resolved:20},{name:"May",pending:10,inProgress:15,resolved:25},{name:"Jun",pending:12,inProgress:18,resolved:30}];return{statusData:a,priorityData:n,categoryData:i,parkData:$,monthlyData:F}},[s,G,V]),g=(a,n)=>n===0?100:Math.round((a-n)/n*100),l={total:g(s.total||72,65),resolved:g(s.resolved||34,29),avgResolutionTime:g(s.resolutionTime||3.2,3.8)},P=a=>z(new Date(a),"d MMM yyyy",{locale:L}),k=a=>({pending:"Pendiente",in_progress:"En proceso",resolved:"Resuelto",rejected:"Rechazado"})[a]||a,C=a=>{switch(a){case"pending":return"bg-yellow-100 text-yellow-700";case"in_progress":return"bg-blue-100 text-blue-700";case"resolved":return"bg-green-100 text-green-700";case"rejected":return"bg-red-100 text-red-700";default:return"bg-gray-100 text-gray-700"}},D=a=>{switch(a){case"pending":return e.jsx(E,{className:"h-4 w-4 text-yellow-500"});case"in_progress":return e.jsx(v,{className:"h-4 w-4 text-blue-500"});case"resolved":return e.jsx(f,{className:"h-4 w-4 text-green-500"});case"rejected":return e.jsx(_,{className:"h-4 w-4 text-red-500"});default:return null}};return e.jsx(X,{children:e.jsxs("div",{className:"container mx-auto py-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs(I,{variant:"ghost",className:"mb-4",onClick:()=>b("/admin/incidents"),children:[e.jsx(H,{className:"h-4 w-4 mr-2"}),"Volver a incidencias"]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Panel de control de incidencias"}),e.jsx("p",{className:"text-gray-500",children:"Estadísticas y métricas clave para la gestión de incidencias"})]}),e.jsx("div",{className:"flex items-center mt-4 md:mt-0",children:e.jsxs("div",{className:"text-sm text-gray-500",children:[e.jsx(Q,{className:"h-4 w-4 inline-block mr-1"}),"Datos actualizados: ",B(w)]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[e.jsx(r,{children:e.jsx(t,{className:"pt-6",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Total de incidencias"}),e.jsx("h3",{className:"text-3xl font-bold mt-1",children:s.total||72}),e.jsxs("div",{className:`flex items-center mt-1 text-sm ${l.total>=0?"text-green-600":"text-red-600"}`,children:[l.total>=0?e.jsx(N,{className:"h-3 w-3 mr-1"}):e.jsx(y,{className:"h-3 w-3 mr-1"}),e.jsxs("span",{children:[Math.abs(l.total),"% vs. mes anterior"]})]})]}),e.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:e.jsx(W,{className:"h-6 w-6 text-blue-600"})})]})})}),e.jsx(r,{children:e.jsx(t,{className:"pt-6",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Incidencias resueltas"}),e.jsx("h3",{className:"text-3xl font-bold mt-1",children:s.resolved||34}),e.jsxs("div",{className:`flex items-center mt-1 text-sm ${l.resolved>=0?"text-green-600":"text-red-600"}`,children:[l.resolved>=0?e.jsx(N,{className:"h-3 w-3 mr-1"}):e.jsx(y,{className:"h-3 w-3 mr-1"}),e.jsxs("span",{children:[Math.abs(l.resolved),"% vs. mes anterior"]})]})]}),e.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:e.jsx(f,{className:"h-6 w-6 text-green-600"})})]})})}),e.jsx(r,{children:e.jsx(t,{className:"pt-6",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Tiempo medio de resolución"}),e.jsxs("h3",{className:"text-3xl font-bold mt-1",children:[s.resolutionTime||3.2," días"]}),e.jsxs("div",{className:`flex items-center mt-1 text-sm ${l.avgResolutionTime<=0?"text-green-600":"text-red-600"}`,children:[l.avgResolutionTime<=0?e.jsx(y,{className:"h-3 w-3 mr-1"}):e.jsx(N,{className:"h-3 w-3 mr-1"}),e.jsxs("span",{children:[Math.abs(l.avgResolutionTime),"% vs. mes anterior"]})]})]}),e.jsx("div",{className:"p-3 bg-orange-100 rounded-lg",children:e.jsx(v,{className:"h-6 w-6 text-orange-600"})})]})})}),e.jsx(r,{children:e.jsx(t,{className:"pt-6",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Tasa de resolución"}),e.jsxs("h3",{className:"text-3xl font-bold mt-1",children:[s.total?Math.round(s.resolved/s.total*100):47,"%"]}),e.jsx("div",{className:"text-sm text-gray-500 mt-1",children:e.jsxs("span",{children:[s.resolved||34," de ",s.total||72," incidencias"]})})]}),e.jsx("div",{className:"p-3 bg-purple-100 rounded-lg",children:e.jsx(U,{className:"h-6 w-6 text-purple-600"})})]})})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[e.jsxs(r,{className:"overflow-hidden",children:[e.jsxs(o,{children:[e.jsx(m,{children:"Incidencias por estado"}),e.jsx(x,{children:"Distribución actual de las incidencias según su estado"})]}),e.jsx(t,{className:"p-0",children:e.jsx("div",{className:"h-80 w-full",children:e.jsx(d.Suspense,{fallback:e.jsx("div",{className:"flex items-center justify-center h-full",children:"Cargando gráfico..."}),children:e.jsx(u,{type:"pie",data:j.statusData})})})}),e.jsxs(h,{className:"flex justify-between text-sm text-gray-500 border-t",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(E,{className:"h-3 w-3 text-yellow-500 mr-1"}),e.jsxs("span",{children:["Pendientes: ",s.pending||12]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(v,{className:"h-3 w-3 text-blue-500 mr-1"}),e.jsxs("span",{children:["En proceso: ",s.inProgress||18]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(f,{className:"h-3 w-3 text-green-500 mr-1"}),e.jsxs("span",{children:["Resueltas: ",s.resolved||34]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(_,{className:"h-3 w-3 text-red-500 mr-1"}),e.jsxs("span",{children:["Rechazadas: ",s.rejected||8]})]})]})]}),e.jsxs(r,{className:"overflow-hidden",children:[e.jsxs(o,{children:[e.jsx(m,{children:"Tendencia mensual"}),e.jsx(x,{children:"Evolución de incidencias en los últimos meses"})]}),e.jsx(t,{className:"p-0",children:e.jsx("div",{className:"h-80 w-full",children:e.jsx(d.Suspense,{fallback:e.jsx("div",{className:"flex items-center justify-center h-full",children:"Cargando gráfico..."}),children:e.jsx(u,{type:"line",data:j.monthlyData})})})}),e.jsx(h,{className:"text-sm text-gray-500 border-t",children:e.jsx("div",{className:"w-full flex justify-between",children:e.jsx("span",{children:"La tendencia muestra un aumento del 8% en la resolución de incidencias."})})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[e.jsxs(r,{className:"overflow-hidden",children:[e.jsxs(o,{children:[e.jsx(m,{children:"Incidencias por prioridad"}),e.jsx(x,{children:"Distribución de incidencias según nivel de prioridad"})]}),e.jsx(t,{className:"p-0",children:e.jsx("div",{className:"h-80 w-full",children:e.jsx(d.Suspense,{fallback:e.jsx("div",{className:"flex items-center justify-center h-full",children:"Cargando gráfico..."}),children:e.jsx(u,{type:"bar",data:j.priorityData})})})}),e.jsx(h,{className:"flex justify-between text-sm text-gray-500 border-t",children:e.jsx("div",{children:"Las incidencias de prioridad media son las más comunes (35%)."})})]}),e.jsxs(r,{className:"overflow-hidden",children:[e.jsxs(o,{children:[e.jsx(m,{children:"Incidencias por categoría"}),e.jsx(x,{children:"Distribución de incidencias por tipo de categoría"})]}),e.jsx(t,{className:"p-0",children:e.jsx("div",{className:"h-80 w-full",children:e.jsx(d.Suspense,{fallback:e.jsx("div",{className:"flex items-center justify-center h-full",children:"Cargando gráfico..."}),children:e.jsx(u,{type:"donut",data:j.categoryData})})})}),e.jsx(h,{className:"text-sm text-gray-500 border-t",children:e.jsx("div",{children:"Los daños físicos representan la mayoría de las incidencias reportadas."})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(r,{className:"overflow-hidden",children:[e.jsxs(o,{children:[e.jsx(m,{children:"Incidencias por parque"}),e.jsx(x,{children:"Distribución de incidencias por ubicación"})]}),e.jsx(t,{className:"p-0",children:e.jsx("div",{className:"h-80 w-full",children:e.jsx(d.Suspense,{fallback:e.jsx("div",{className:"flex items-center justify-center h-full",children:"Cargando gráfico..."}),children:e.jsx(u,{type:"horizontalBar",data:j.parkData})})})}),e.jsx(h,{className:"text-sm text-gray-500 border-t",children:e.jsx("div",{children:"El Parque Metropolitano concentra el mayor número de incidencias reportadas."})})]}),e.jsxs(r,{children:[e.jsxs(o,{className:"pb-2",children:[e.jsx(m,{children:"Incidencias recientes"}),e.jsx(x,{children:"Últimas incidencias reportadas en el sistema"})]}),e.jsx(t,{children:e.jsx("div",{className:"space-y-4",children:s.mostRecentIncidents&&s.mostRecentIncidents.length>0?s.mostRecentIncidents.map((a,n)=>{var i;return e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-100 flex items-center justify-center flex-shrink-0",children:D(a.status)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:a.title}),e.jsx("p",{className:"text-xs text-gray-500",children:P(a.createdAt)})]}),e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsx(S,{className:C(a.status),children:k(a.status)}),e.jsx("span",{className:"mx-2 text-gray-300",children:"•"}),e.jsxs("span",{className:"text-xs text-gray-500 flex items-center",children:[e.jsx(T,{className:"h-3 w-3 mr-1"}),((i=a.park)==null?void 0:i.name)||`Parque ${a.parkId}`]})]})]})]},a.id)}):[{id:1,title:"Juegos infantiles dañados",status:"pending",createdAt:new Date,parkId:1,park:{name:"Parque Metropolitano"}},{id:2,title:"Falta de iluminación en sendero norte",status:"in_progress",createdAt:new Date(Date.now()-864e5),parkId:2,park:{name:"Parque Agua Azul"}},{id:3,title:"Banca rota en área de picnic",status:"resolved",createdAt:new Date(Date.now()-864e5*2),parkId:3,park:{name:"Parque González Gallo"}},{id:4,title:"Grafiti en monumento central",status:"rejected",createdAt:new Date(Date.now()-864e5*3),parkId:4,park:{name:"Parque Colomos"}}].map((a,n)=>{var i;return e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-100 flex items-center justify-center flex-shrink-0",children:D(a.status)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:a.title}),e.jsx("p",{className:"text-xs text-gray-500",children:P(a.createdAt)})]}),e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsx(S,{className:C(a.status),children:k(a.status)}),e.jsx("span",{className:"mx-2 text-gray-300",children:"•"}),e.jsxs("span",{className:"text-xs text-gray-500 flex items-center",children:[e.jsx(T,{className:"h-3 w-3 mr-1"}),(i=a.park)==null?void 0:i.name]})]})]})]},n)})})}),e.jsx(h,{className:"pt-0",children:e.jsx(I,{variant:"outline",className:"w-full",onClick:()=>b("/admin/incidents"),children:"Ver todas las incidencias"})})]})]})]})})};export{ie as default};
