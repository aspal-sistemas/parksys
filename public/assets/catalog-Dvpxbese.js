import{e as ae,a6 as se,Y as u,u as O,a8 as d,j as e,aI as ie,aO as ne,aP as re,aQ as Q,aR as K,C as M,a as $,b as B,al as R,a3 as U,D as b,p as H,B as t,b2 as G,r as w,t as D,v as P,w as T,y as g,I as q,O as I,c as V,f as j,ba as Y,bb as J,ai as m}from"./index-VG22aPDC.js";import{T as W}from"./trending-down-CpXUJmlr.js";function oe(){const{toast:r}=ae(),o=se(),[L,l]=u.useState(!1),[s,x]=u.useState(null),[X,p]=u.useState(!1),[i,c]=u.useState({name:"",description:"",type:"ingreso"}),{data:v,isLoading:Z}=O({queryKey:["/api/finance/income-categories"]}),{data:N,isLoading:_}=O({queryKey:["/api/finance/expense-categories"]}),C=d({mutationFn:async a=>m("/api/finance/income-categories",{method:"POST",data:a}),onSuccess:()=>{o.invalidateQueries({queryKey:["/api/finance/income-categories"]}),r({title:"Categoría creada",description:"La categoría de ingresos se ha creado exitosamente."}),l(!1),c({name:"",description:"",type:"ingreso"})},onError:a=>{r({title:"Error",description:"No se pudo crear la categoría. Inténtalo de nuevo.",variant:"destructive"}),console.error("Error creando categoría:",a)}}),y=d({mutationFn:async a=>m("/api/finance/expense-categories",{method:"POST",data:a}),onSuccess:()=>{o.invalidateQueries({queryKey:["/api/finance/expense-categories"]}),r({title:"Categoría creada",description:"La categoría de egresos se ha creado exitosamente."}),l(!1),c({name:"",description:"",type:"ingreso"})},onError:a=>{r({title:"Error",description:"No se pudo crear la categoría. Inténtalo de nuevo.",variant:"destructive"}),console.error("Error creando categoría:",a)}}),f=d({mutationFn:async({id:a,categoryData:n})=>await m(`/api/finance/income-categories/${a}`,{method:"PUT",data:n}),onSuccess:()=>{o.invalidateQueries({queryKey:["/api/finance/income-categories"]}),r({title:"Categoría actualizada",description:"La categoría se ha actualizado exitosamente."}),p(!1),x(null)}}),E=d({mutationFn:async({id:a,categoryData:n})=>await m(`/api/finance/expense-categories/${a}`,{method:"PUT",data:n}),onSuccess:()=>{o.invalidateQueries({queryKey:["/api/finance/expense-categories"]}),r({title:"Categoría actualizada",description:"La categoría se ha actualizado exitosamente."}),p(!1),x(null)}}),S=d({mutationFn:async a=>await m(`/api/income-categories/${a}`,{method:"DELETE"}),onSuccess:()=>{o.invalidateQueries({queryKey:["/api/finance/income-categories"]}),r({title:"Categoría eliminada",description:"La categoría de ingresos se ha eliminado exitosamente."})},onError:a=>{var n,h;r({title:"Error",description:((h=(n=a==null?void 0:a.response)==null?void 0:n.data)==null?void 0:h.message)||"No se pudo eliminar la categoría. Puede estar siendo usada en registros.",variant:"destructive"})}}),k=d({mutationFn:async a=>await m(`/api/expense-categories/${a}`,{method:"DELETE"}),onSuccess:()=>{o.invalidateQueries({queryKey:["/api/finance/expense-categories"]}),r({title:"Categoría eliminada",description:"La categoría de egresos se ha eliminado exitosamente."})},onError:a=>{var n,h;r({title:"Error",description:((h=(n=a==null?void 0:a.response)==null?void 0:n.data)==null?void 0:h.message)||"No se pudo eliminar la categoría. Puede estar siendo usada en registros.",variant:"destructive"})}}),F=()=>{if(!i.name.trim()){r({title:"Error",description:"El nombre de la categoría es requerido.",variant:"destructive"});return}i.type==="ingreso"?C.mutate({name:i.name,description:i.description}):y.mutate({name:i.name,description:i.description})},z=(a,n)=>{x({...a,type:n}),p(!0)},ee=()=>{var n;if(!((n=s==null?void 0:s.name)!=null&&n.trim())){r({title:"Error",description:"El nombre de la categoría es requerido.",variant:"destructive"});return}const a={name:s.name,description:s.description||""};s.type==="ingreso"?f.mutate({id:s.id,categoryData:a}):E.mutate({id:s.id,categoryData:a})},A=(a,n)=>{window.confirm("¿Estás seguro de que quieres eliminar esta categoría? Esta acción no se puede deshacer.")&&(n==="ingreso"?S.mutate(a):k.mutate(a))};return e.jsx(ie,{children:e.jsxs("div",{className:"container mx-auto p-6",children:[e.jsx("div",{className:"flex justify-between items-center mb-6",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Catálogo Financiero"}),e.jsx("p",{className:"text-muted-foreground",children:"Gestiona las categorías de ingresos y egresos del sistema"})]})}),e.jsxs(ne,{defaultValue:"income-categories",className:"space-y-6",children:[e.jsxs(re,{className:"grid w-full grid-cols-2",children:[e.jsx(Q,{value:"income-categories",children:"Categorías de Ingresos"}),e.jsx(Q,{value:"expense-categories",children:"Categorías de Egresos"})]}),e.jsx(K,{value:"income-categories",className:"space-y-6",children:e.jsxs(M,{children:[e.jsx($,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs(B,{className:"flex items-center gap-2",children:[e.jsx(R,{className:"h-5 w-5 text-green-600"}),"Categorías de Ingresos"]}),e.jsx(U,{children:"Administra las categorías para clasificar los diferentes tipos de ingresos"})]}),e.jsxs(b,{open:L,onOpenChange:l,children:[e.jsx(H,{asChild:!0,children:e.jsxs(t,{onClick:()=>c({...i,type:"ingreso"}),children:[e.jsx(G,{className:"h-4 w-4 mr-2"}),"Nueva Categoría"]})}),e.jsxs(w,{children:[e.jsxs(D,{children:[e.jsx(P,{children:"Nueva Categoría de Ingresos"}),e.jsx(T,{children:"Crear una nueva categoría para organizar los conceptos de ingresos."})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(g,{htmlFor:"categoryName",className:"text-right",children:"Nombre"}),e.jsx(q,{id:"categoryName",value:i.name,onChange:a=>c({...i,name:a.target.value}),className:"col-span-3",placeholder:"Nombre de la categoría"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(g,{htmlFor:"categoryDescription",className:"text-right",children:"Descripción"}),e.jsx(I,{id:"categoryDescription",value:i.description,onChange:a=>c({...i,description:a.target.value}),className:"col-span-3",placeholder:"Descripción de la categoría"})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(t,{variant:"outline",onClick:()=>l(!1),children:"Cancelar"}),e.jsx(t,{onClick:F,disabled:C.isPending,children:C.isPending?"Creando...":"Crear Categoría"})]})]})]})]})}),e.jsx(V,{children:Z?e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{children:"Cargando categorías..."})}):e.jsx("div",{className:"space-y-4",children:v&&v.length>0?v.map(a=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsx("div",{className:"flex-1",children:e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:a.name}),e.jsx("p",{className:"text-sm text-gray-500",children:a.description}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx(j,{variant:"secondary",children:a.code}),e.jsx(j,{variant:a.isActive?"default":"secondary",children:a.isActive?"Activo":"Inactivo"})]})]})})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(t,{variant:"outline",size:"sm",onClick:()=>z(a,"ingreso"),children:e.jsx(Y,{className:"h-4 w-4"})}),e.jsx(t,{variant:"outline",size:"sm",onClick:()=>A(a.id,"ingreso"),disabled:S.isPending,children:e.jsx(J,{className:"h-4 w-4"})})]})]},a.id)):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(R,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"No hay categorías de ingresos registradas"})]})})})]})}),e.jsx(K,{value:"expense-categories",className:"space-y-6",children:e.jsxs(M,{children:[e.jsx($,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs(B,{className:"flex items-center gap-2",children:[e.jsx(W,{className:"h-5 w-5 text-red-600"}),"Categorías de Egresos"]}),e.jsx(U,{children:"Administra las categorías para clasificar los diferentes tipos de gastos"})]}),e.jsxs(b,{open:L,onOpenChange:l,children:[e.jsx(H,{asChild:!0,children:e.jsxs(t,{onClick:()=>c({...i,type:"egreso"}),children:[e.jsx(G,{className:"h-4 w-4 mr-2"}),"Nueva Categoría"]})}),e.jsxs(w,{children:[e.jsxs(D,{children:[e.jsx(P,{children:"Nueva Categoría de Egresos"}),e.jsx(T,{children:"Crear una nueva categoría para organizar los conceptos de gastos."})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(g,{htmlFor:"categoryName",className:"text-right",children:"Nombre"}),e.jsx(q,{id:"categoryName",value:i.name,onChange:a=>c({...i,name:a.target.value}),className:"col-span-3",placeholder:"Nombre de la categoría"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(g,{htmlFor:"categoryDescription",className:"text-right",children:"Descripción"}),e.jsx(I,{id:"categoryDescription",value:i.description,onChange:a=>c({...i,description:a.target.value}),className:"col-span-3",placeholder:"Descripción de la categoría"})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(t,{variant:"outline",onClick:()=>l(!1),children:"Cancelar"}),e.jsx(t,{onClick:F,disabled:y.isPending,children:y.isPending?"Creando...":"Crear Categoría"})]})]})]})]})}),e.jsx(V,{children:_?e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{children:"Cargando categorías..."})}):e.jsx("div",{className:"space-y-4",children:N&&N.length>0?N.map(a=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsx("div",{className:"flex-1",children:e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:a.name}),e.jsx("p",{className:"text-sm text-gray-500",children:a.description}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx(j,{variant:"secondary",children:a.code}),e.jsx(j,{variant:a.isActive?"default":"secondary",children:a.isActive?"Activo":"Inactivo"})]})]})})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(t,{variant:"outline",size:"sm",onClick:()=>z(a,"egreso"),children:e.jsx(Y,{className:"h-4 w-4"})}),e.jsx(t,{variant:"outline",size:"sm",onClick:()=>A(a.id,"egreso"),disabled:k.isPending,children:e.jsx(J,{className:"h-4 w-4"})})]})]},a.id)):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(W,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"No hay categorías de egresos registradas"})]})})})]})})]}),e.jsx(b,{open:X,onOpenChange:p,children:e.jsxs(w,{children:[e.jsxs(D,{children:[e.jsxs(P,{children:["Editar Categoría de ",(s==null?void 0:s.type)==="ingreso"?"Ingresos":"Egresos"]}),e.jsx(T,{children:"Modifica los datos de la categoría seleccionada."})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(g,{htmlFor:"editCategoryName",className:"text-right",children:"Nombre"}),e.jsx(q,{id:"editCategoryName",value:(s==null?void 0:s.name)||"",onChange:a=>x({...s,name:a.target.value}),className:"col-span-3",placeholder:"Nombre de la categoría"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(g,{htmlFor:"editCategoryDescription",className:"text-right",children:"Descripción"}),e.jsx(I,{id:"editCategoryDescription",value:(s==null?void 0:s.description)||"",onChange:a=>x({...s,description:a.target.value}),className:"col-span-3",placeholder:"Descripción de la categoría"})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(t,{variant:"outline",onClick:()=>p(!1),children:"Cancelar"}),e.jsx(t,{onClick:ee,disabled:f.isPending||E.isPending,children:f.isPending||E.isPending?"Actualizando...":"Actualizar Categoría"})]})]})})]})})}export{oe as default};
