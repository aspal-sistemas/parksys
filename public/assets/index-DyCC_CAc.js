import{aC as pe,az as Ne,l as ve,ae as ye,a2 as v,u as z,ag as fe,j as e,aX as O,aw as G,aW as V,dz as K,ay as U,B as n,A as J,bq as be,w as Q,x as _,bn as we,y as W,z as X,I as Z,J as Y,bC as ee,du as Ce,M as C,o as c,b1 as De,b2 as Ee,b3 as y,b4 as D,f as x,g as h,h as j,ab as E,i as u,cc as k,m as Me,bH as se,dA as Te,bI as ae,bJ as M,bK as o,bL as ne,bM as f,bF as Se,bh as re,E as Pe,aq as ie,r as Re,a1 as qe,aZ as Ie,aS as $e,dw as Fe,K as ke,ax as Ae,dx as Le}from"./index-D5qLf1ib.js";import{H as Be}from"./Helmet-BNepwt1P.js";import{S as l}from"./skeleton-XQWc31Aw.js";import{S as T}from"./separator-Bek7HtsH.js";import{S,a as te}from"./sprout-B66yx9Pz.js";import{R as He}from"./ruler-CydzKUS0.js";import{C as A}from"./circle-check-BnS-MIcE.js";function _e(){var B,H;const[ze,P]=pe("/admin/trees/inventory/:id"),[,b]=Ne(),{toast:g}=ve(),L=ye(),i=P==null?void 0:P.id,[le,w]=v.useState(!1),[t,p]=v.useState({maintenanceType:"",maintenanceDate:"",performedBy:"",notes:""});console.log("ID del árbol:",i);const{data:R,isLoading:q,error:ce}=z({queryKey:[`/api/trees/${i}`],queryFn:async()=>{const a=await fetch(`/api/trees/${i}`);if(!a.ok)throw new Error("Error al cargar la información del árbol");const r=await a.json();return console.log("Datos del árbol:",r),r},enabled:!!i}),s=R==null?void 0:R.data,{data:m,isLoading:de,refetch:oe}=z({queryKey:[`/api/trees/${i}/maintenances`],queryFn:async()=>{const a=await fetch(`/api/trees/${i}/maintenances`);if(!a.ok)throw new Error("Error al cargar los mantenimientos del árbol");return a.json()},enabled:!!i}),me=async a=>{try{await ie(`/api/trees/${i}`,{method:"DELETE",body:JSON.stringify({removalReason:a})}),g({title:"Árbol eliminado",description:"El árbol ha sido marcado como removido correctamente.",variant:"success"}),L.invalidateQueries({queryKey:["/api/trees"]}),b("/admin/trees/inventory")}catch(r){console.error("Error al eliminar el árbol:",r),g({title:"Error",description:"No se pudo eliminar el árbol. Por favor, intenta nuevamente.",variant:"destructive"})}},d=a=>{if(!a)return"No disponible";try{return Re(new Date(a),"dd/MM/yyyy",{locale:qe})}catch{return"Fecha inválida"}},I=fe({mutationFn:async a=>ie(`/api/trees/${i}/maintenances`,{method:"POST",body:JSON.stringify(a)}),onSuccess:()=>{w(!1),p({maintenanceType:"",maintenanceDate:"",performedBy:"",notes:""}),g({title:"Mantenimiento registrado",description:"El mantenimiento ha sido registrado correctamente.",variant:"success"}),oe(),L.invalidateQueries({queryKey:[`/api/trees/${i}`]})},onError:a=>{console.error("Error al registrar mantenimiento:",a),g({title:"Error",description:"No se pudo registrar el mantenimiento. Por favor, intenta nuevamente.",variant:"destructive"})}}),xe=a=>{if(a.preventDefault(),!t.maintenanceType||!t.maintenanceDate){g({title:"Campos requeridos",description:"Por favor completa el tipo de mantenimiento y la fecha.",variant:"destructive"});return}I.mutate(t)},he=a=>{switch(a.toLowerCase()){case"poda":return e.jsx(Fe,{className:"h-4 w-4"});case"plantación":return e.jsx(te,{className:"h-4 w-4"});case"riego":return e.jsx(S,{className:"h-4 w-4"});case"tratamiento fitosanitario":return e.jsx($e,{className:"h-4 w-4"});case"reparación":return e.jsx(Ie,{className:"h-4 w-4"});default:return e.jsx(A,{className:"h-4 w-4"})}},$=a=>{if(!a)return e.jsx(c,{variant:"outline",children:"No evaluado"});switch(a.toLowerCase()){case"bueno":return e.jsxs(c,{variant:"outline",className:"bg-green-50 text-green-700 hover:bg-green-100",children:[e.jsx(A,{className:"h-3 w-3 mr-1"})," Bueno"]});case"regular":return e.jsxs(c,{variant:"outline",className:"bg-yellow-50 text-yellow-700 hover:bg-yellow-100",children:[e.jsx(Ae,{className:"h-3 w-3 mr-1"})," Regular"]});case"malo":return e.jsxs(c,{variant:"outline",className:"bg-orange-50 text-orange-700 hover:bg-orange-100",children:[e.jsx(V,{className:"h-3 w-3 mr-1"})," Malo"]});case"crítico":return e.jsxs(c,{variant:"destructive",children:[e.jsx(ke,{className:"h-3 w-3 mr-1"})," Crítico"]});default:return e.jsx(c,{variant:"outline",children:a})}},je=({tree:a})=>{const[r,ue]=v.useState(null),[ge,F]=v.useState(!1);return v.useEffect(()=>{a.speciesId&&(F(!0),fetch(`/api/tree-species/${a.speciesId}`).then(N=>N.json()).then(N=>{ue(N),F(!1)}).catch(N=>{console.error("Error cargando especie:",N),F(!1)}))},[a.speciesId]),ge?e.jsx("div",{className:"aspect-square bg-gray-100 rounded-md flex items-center justify-center mb-4",children:e.jsx(S,{className:"h-16 w-16 text-gray-300 animate-pulse"})}):r&&r.photoUrl?e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsx("div",{className:"aspect-square overflow-hidden rounded-md",children:e.jsx("img",{src:r.photoUrl,alt:`${r.commonName} (${r.scientificName})`,className:"object-cover w-full h-full"})}),e.jsxs("p",{className:"text-sm text-gray-600 text-center",children:["Foto de la especie: ",r.commonName]})]}):e.jsxs("div",{className:"aspect-square bg-gray-100 rounded-md flex items-center justify-center mb-4",children:[e.jsx(Le,{className:"h-16 w-16 text-gray-400"}),e.jsx("div",{className:"absolute bottom-2 bg-white/90 px-2 py-1 rounded text-xs text-gray-600",children:"Sin foto disponible"})]})};return ce?e.jsx(O,{children:e.jsxs("div",{className:"container mx-auto px-4 py-6",children:[e.jsxs(G,{variant:"destructive",className:"mb-4",children:[e.jsx(V,{className:"h-4 w-4"}),e.jsx(K,{children:"Error"}),e.jsx(U,{children:"No se pudo cargar la información del árbol. Verifica que el ID sea correcto."})]}),e.jsxs(n,{onClick:()=>b("/admin/trees/inventory"),variant:"outline",className:"mt-4",children:[e.jsx(J,{className:"mr-2 h-4 w-4"})," Volver al Inventario"]})]})}):e.jsxs(O,{children:[e.jsxs(Be,{children:[e.jsx("title",{children:q?"Cargando detalles...":`Árbol ${s.code} | Inventario Arbóreo | ParquesMX`}),e.jsx("meta",{name:"description",content:"Detalles del árbol en el inventario de parques municipales"})]}),e.jsxs("div",{className:"container mx-auto px-4 py-6",children:[e.jsxs("div",{className:"flex items-start mb-6",children:[e.jsx(n,{variant:"ghost",size:"icon",onClick:()=>b("/admin/trees/inventory"),className:"mr-4 mt-1",children:e.jsx(J,{className:"h-5 w-5"})}),q?e.jsxs("div",{className:"space-y-2 flex-1",children:[e.jsx(l,{className:"h-8 w-64"}),e.jsx(l,{className:"h-4 w-48"})]}):e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h1",{className:"text-3xl font-bold text-green-800 flex items-center",children:[e.jsx(S,{className:"mr-2 h-8 w-8"}),`${s.code} - ${s.speciesName}`]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(n,{variant:"outline",className:"flex items-center",onClick:()=>b(`/admin/trees/inventory/${i}/edit`),children:[e.jsx(be,{className:"mr-2 h-4 w-4"}),"Editar"]}),e.jsxs(Q,{children:[e.jsx(_,{asChild:!0,children:e.jsxs(n,{variant:"destructive",className:"flex items-center",children:[e.jsx(we,{className:"mr-2 h-4 w-4"}),"Eliminar"]})}),e.jsxs(W,{children:[e.jsxs(X,{children:[e.jsx(Z,{children:"Confirmar eliminación"}),e.jsx(Y,{children:"¿Estás seguro de que deseas marcar este árbol como removido? Esta acción no eliminará el registro, pero lo marcará como removido del inventario."})]}),e.jsxs("div",{className:"py-4",children:[e.jsx("p",{className:"text-sm font-medium mb-2",children:"Motivo de la remoción:"}),e.jsxs("select",{className:"w-full p-2 border rounded-md",id:"removalReason",defaultValue:"Tala programada",children:[e.jsx("option",{value:"Tala programada",children:"Tala programada"}),e.jsx("option",{value:"Árbol enfermo",children:"Árbol enfermo"}),e.jsx("option",{value:"Árbol caído",children:"Árbol caído"}),e.jsx("option",{value:"Riesgo de caída",children:"Riesgo de caída"}),e.jsx("option",{value:"Reubicación",children:"Reubicación"}),e.jsx("option",{value:"Otro",children:"Otro"})]})]}),e.jsxs(ee,{children:[e.jsx(Ce,{asChild:!0,children:e.jsx(n,{variant:"outline",children:"Cancelar"})}),e.jsx(n,{variant:"destructive",onClick:()=>{const a=document.getElementById("removalReason").value;me(a)},children:"Confirmar eliminación"})]})]})]})]})]}),e.jsxs("p",{className:"text-gray-600 mt-1 flex items-center",children:[e.jsx(C,{className:"h-4 w-4 mr-1"}),s.parkName," • ",s.scientificName,e.jsx("span",{className:"mx-2",children:"•"}),$(s.healthStatus),s.isProtected&&e.jsx(c,{variant:"secondary",className:"ml-2",children:"Protección Especial"})]})]})]}),q?e.jsxs("div",{className:"space-y-6",children:[e.jsx(l,{className:"h-[300px] w-full rounded-lg"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx(l,{className:"h-12 w-full rounded-md"}),e.jsx(l,{className:"h-12 w-full rounded-md"}),e.jsx(l,{className:"h-12 w-full rounded-md"})]}),e.jsx(l,{className:"h-[400px] w-full rounded-lg"})]}):e.jsxs(De,{defaultValue:"general",className:"space-y-6",children:[e.jsxs(Ee,{className:"grid grid-cols-5",children:[e.jsx(y,{value:"general",children:"Información General"}),e.jsx(y,{value:"physical",children:"Estado Físico"}),e.jsx(y,{value:"location",children:"Ubicación"}),e.jsx(y,{value:"maintenance",children:"Mantenimiento"}),e.jsx(y,{value:"environmental",children:"Servicios Ambientales"})]}),e.jsx(D,{value:"general",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs(x,{className:"md:col-span-2",children:[e.jsxs(h,{children:[e.jsx(j,{children:"Datos Generales"}),e.jsx(E,{children:"Información general del árbol en el inventario"})]}),e.jsxs(u,{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900",children:"Código Identificador"}),e.jsx("p",{className:"mt-1 text-gray-700",children:s.code})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900",children:"Especie"}),e.jsx("p",{className:"mt-1 text-gray-700",children:s.speciesName}),e.jsx("p",{className:"text-sm italic text-gray-500",children:s.scientificName})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900",children:"Parque"}),e.jsx("p",{className:"mt-1 text-gray-700",children:s.parkName})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900",children:"Estado de Salud"}),e.jsx("p",{className:"mt-1",children:$(s.healthStatus)})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900",children:"Etapa de Desarrollo"}),e.jsx("p",{className:"mt-1 text-gray-700",children:s.developmentStage||"No especificado"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900",children:"Edad Estimada"}),e.jsx("p",{className:"mt-1 text-gray-700",children:s.ageEstimate?`${s.ageEstimate} años`:"No especificado"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900",children:"Fecha de Plantación"}),e.jsx("p",{className:"mt-1 text-gray-700",children:d(s.plantingDate)})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900",children:"Última Inspección"}),e.jsx("p",{className:"mt-1 text-gray-700",children:d(s.lastInspectionDate)})]})]}),e.jsx(T,{}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900",children:"Dimensiones"}),e.jsxs("div",{className:"mt-2 grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg flex flex-col items-center justify-center",children:[e.jsx(He,{className:"h-5 w-5 text-green-600 mb-1"}),e.jsx("span",{className:"text-sm text-gray-500",children:"Altura"}),e.jsx("span",{className:"font-medium text-lg text-gray-800",children:s.height?`${s.height} m`:"-"})]}),e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg flex flex-col items-center justify-center",children:[e.jsx("span",{className:"font-medium text-2xl text-green-600 mb-1",children:"Ø"}),e.jsx("span",{className:"text-sm text-gray-500",children:"Diámetro (DAP)"}),e.jsx("span",{className:"font-medium text-lg text-gray-800",children:s.diameter?`${s.diameter} cm`:"-"})]}),e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg flex flex-col items-center justify-center",children:[e.jsx(S,{className:"h-5 w-5 text-green-600 mb-1"}),e.jsx("span",{className:"text-sm text-gray-500",children:"Cobertura Copa"}),e.jsx("span",{className:"font-medium text-lg text-gray-800",children:s.canopyCoverage?`${s.canopyCoverage} m²`:"-"})]})]})]}),s.observations&&e.jsxs(e.Fragment,{children:[e.jsx(T,{}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900",children:"Observaciones"}),e.jsx("p",{className:"mt-2 text-gray-700 whitespace-pre-wrap",children:s.observations})]})]})]})]}),e.jsxs(x,{children:[e.jsx(h,{children:e.jsx(j,{children:"Información Adicional"})}),e.jsxs(u,{className:"space-y-4",children:[e.jsx(je,{tree:s}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium",children:"Creado"}),e.jsx("p",{className:"text-sm text-gray-500",children:d(s.createdAt)})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium",children:"Última Actualización"}),e.jsx("p",{className:"text-sm text-gray-500",children:d(s.updatedAt)})]}),s.isProtected&&e.jsxs(G,{className:"bg-green-50 border-green-200",children:[e.jsx(A,{className:"h-4 w-4 text-green-600"}),e.jsx(K,{children:"Árbol Protegido"}),e.jsx(U,{children:"Este ejemplar cuenta con protección especial."})]})]}),e.jsx(k,{className:"flex justify-center",children:e.jsxs(n,{variant:"outline",className:"w-full",onClick:()=>window.open(`https://www.google.com/maps/search/?api=1&query=${s.latitude},${s.longitude}`,"_blank"),children:[e.jsx(C,{className:"mr-2 h-4 w-4"}),"Ver en Google Maps"]})})]})]})}),e.jsx(D,{value:"physical",children:e.jsxs(x,{children:[e.jsxs(h,{children:[e.jsx(j,{children:"Estado Físico y Condiciones"}),e.jsx(E,{children:"Información sobre el estado y condiciones del árbol"})]}),e.jsxs(u,{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Estado General"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:"Estado de Salud"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Evaluación general del árbol"})]}),e.jsx("div",{children:$(s.healthStatus)})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:"Etapa de Desarrollo"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Fase actual del ciclo de vida"})]}),e.jsx("div",{children:e.jsx(c,{variant:"outline",children:s.developmentStage||"No especificado"})})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:"Última Inspección"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Fecha de la evaluación más reciente"})]}),e.jsx("div",{children:e.jsxs(c,{variant:"secondary",children:[e.jsx(Me,{className:"mr-1 h-3 w-3"}),d(s.lastInspectionDate)]})})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Condiciones Específicas"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center p-4 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:`h-4 w-4 rounded-full mr-3 ${s.hasHollows?"bg-orange-500":"bg-gray-300"}`}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:"Presencia de Huecos"}),e.jsx("p",{className:"text-sm text-gray-500",children:s.hasHollows?"El árbol presenta huecos o cavidades":"No se han detectado huecos o cavidades"})]})]}),e.jsxs("div",{className:"flex items-center p-4 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:`h-4 w-4 rounded-full mr-3 ${s.hasExposedRoots?"bg-orange-500":"bg-gray-300"}`}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:"Raíces Expuestas"}),e.jsx("p",{className:"text-sm text-gray-500",children:s.hasExposedRoots?"El árbol tiene raíces expuestas en la superficie":"No se observan raíces expuestas"})]})]}),e.jsxs("div",{className:"flex items-center p-4 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:`h-4 w-4 rounded-full mr-3 ${s.hasPests?"bg-red-500":"bg-gray-300"}`}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:"Presencia de Plagas"}),e.jsx("p",{className:"text-sm text-gray-500",children:s.hasPests?"Se han detectado plagas o enfermedades":"No se han detectado plagas o enfermedades"})]})]})]})]})]}),s.physicalCondition&&e.jsxs(e.Fragment,{children:[e.jsx(T,{}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Descripción de Condición Física"}),e.jsx("div",{className:"p-4 bg-gray-50 rounded-lg",children:e.jsx("p",{className:"text-gray-700 whitespace-pre-wrap",children:s.physicalCondition})})]})]}),e.jsx(T,{}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Historial de Evaluaciones"}),e.jsxs(se,{children:[e.jsx(Te,{children:"No hay registros de evaluaciones anteriores"}),e.jsx(ae,{children:e.jsxs(M,{children:[e.jsx(o,{children:"Fecha"}),e.jsx(o,{children:"Estado"}),e.jsx(o,{children:"Evaluador"}),e.jsx(o,{children:"Notas"})]})}),e.jsx(ne,{children:e.jsx(M,{children:e.jsx(f,{className:"text-muted-foreground",colSpan:4,children:"No hay datos disponibles"})})})]})]})]}),e.jsx(k,{className:"flex justify-end",children:e.jsxs(n,{variant:"outline",children:[e.jsx(Se,{className:"mr-2 h-4 w-4"}),"Registrar Nueva Evaluación"]})})]})}),e.jsx(D,{value:"maintenance",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Registro de Mantenimiento"}),e.jsxs(Q,{open:le,onOpenChange:w,children:[e.jsx(_,{asChild:!0,children:e.jsxs(n,{className:"bg-green-600 hover:bg-green-700",children:[e.jsx(re,{className:"h-4 w-4 mr-2"}),"Registrar Mantenimiento"]})}),e.jsxs(W,{className:"sm:max-w-[500px]",children:[e.jsxs(X,{children:[e.jsx(Z,{children:"Registrar Nuevo Mantenimiento"}),e.jsx(Y,{children:"Ingresa los detalles del mantenimiento realizado al árbol."})]}),e.jsxs("form",{onSubmit:xe,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"maintenanceType",className:"text-sm font-medium",children:"Tipo de Mantenimiento *"}),e.jsxs("select",{id:"maintenanceType",className:"w-full p-2 border rounded-md",value:t.maintenanceType,onChange:a=>p({...t,maintenanceType:a.target.value}),required:!0,children:[e.jsx("option",{value:"",children:"Seleccionar tipo"}),e.jsx("option",{value:"Poda",children:"Poda"}),e.jsx("option",{value:"Plantación",children:"Plantación"}),e.jsx("option",{value:"Riego",children:"Riego"}),e.jsx("option",{value:"Tratamiento Fitosanitario",children:"Tratamiento Fitosanitario"}),e.jsx("option",{value:"Reparación",children:"Reparación"}),e.jsx("option",{value:"Inspección",children:"Inspección"}),e.jsx("option",{value:"Otro",children:"Otro"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"maintenanceDate",className:"text-sm font-medium",children:"Fecha de Mantenimiento *"}),e.jsx("input",{type:"date",id:"maintenanceDate",className:"w-full p-2 border rounded-md",value:t.maintenanceDate,onChange:a=>p({...t,maintenanceDate:a.target.value}),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"performedBy",className:"text-sm font-medium",children:"Realizado por"}),e.jsx("input",{type:"text",id:"performedBy",className:"w-full p-2 border rounded-md",value:t.performedBy,onChange:a=>p({...t,performedBy:a.target.value}),placeholder:"Nombre de la persona o equipo"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"notes",className:"text-sm font-medium",children:"Notas y observaciones"}),e.jsx("textarea",{id:"notes",className:"w-full p-2 border rounded-md h-24",value:t.notes,onChange:a=>p({...t,notes:a.target.value}),placeholder:"Detalles adicionales sobre el mantenimiento realizado"})]}),e.jsxs(ee,{children:[e.jsx(n,{type:"button",variant:"outline",onClick:()=>w(!1),children:"Cancelar"}),e.jsx(n,{type:"submit",disabled:I.isPending,className:"bg-green-600 hover:bg-green-700",children:I.isPending?"Guardando...":"Guardar Mantenimiento"})]})]})]})]})]}),e.jsxs(x,{children:[e.jsxs(h,{children:[e.jsx(j,{children:"Historial de Mantenimientos"}),e.jsx(E,{children:"Registro de todas las actividades de mantenimiento realizadas en este árbol"})]}),e.jsx(u,{children:de?e.jsxs("div",{className:"space-y-3",children:[e.jsx(l,{className:"h-12 w-full"}),e.jsx(l,{className:"h-12 w-full"}),e.jsx(l,{className:"h-12 w-full"})]}):((B=m==null?void 0:m.data)==null?void 0:B.length)>0?e.jsxs(se,{children:[e.jsx(ae,{children:e.jsxs(M,{children:[e.jsx(o,{children:"Tipo"}),e.jsx(o,{children:"Fecha"}),e.jsx(o,{children:"Realizado por"}),e.jsx(o,{children:"Notas"})]})}),e.jsx(ne,{children:m.data.map(a=>e.jsxs(M,{children:[e.jsxs(f,{className:"font-medium flex items-center",children:[e.jsx("div",{className:"mr-2 text-green-600",children:he(a.maintenanceType)}),a.maintenanceType]}),e.jsx(f,{children:d(a.maintenanceDate)}),e.jsx(f,{children:a.performedBy||"-"}),e.jsx(f,{className:"max-w-xs truncate",children:a.notes||"Sin observaciones"})]},a.id))})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"mx-auto h-12 w-12 text-gray-400 mb-4",children:e.jsx(te,{className:"h-12 w-12"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-1",children:"No hay mantenimientos registrados"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"No se han registrado actividades de mantenimiento para este árbol todavía."}),e.jsxs(n,{onClick:()=>w(!0),className:"bg-green-600 hover:bg-green-700",children:[e.jsx(re,{className:"h-4 w-4 mr-2"}),"Registrar el primer mantenimiento"]})]})})]}),e.jsxs(x,{children:[e.jsx(h,{children:e.jsx(j,{children:"Información de Mantenimiento"})}),e.jsx(u,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"text-sm text-gray-500 mb-1",children:"Último mantenimiento"}),e.jsx("p",{className:"font-medium text-gray-900",children:s.lastMaintenanceDate?d(s.lastMaintenanceDate):"No registrado"})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"text-sm text-gray-500 mb-1",children:"Mantenimientos registrados"}),e.jsxs("p",{className:"font-medium text-gray-900",children:[((H=m==null?void 0:m.data)==null?void 0:H.length)||0," en total"]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"text-sm text-gray-500 mb-1",children:"Próximo mantenimiento sugerido"}),e.jsx("p",{className:"font-medium text-gray-900",children:s.lastMaintenanceDate?d(new Date(new Date(s.lastMaintenanceDate).setMonth(new Date(s.lastMaintenanceDate).getMonth()+3))):"No aplica"})]})]})})]})]})}),e.jsx(D,{value:"location",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs(x,{className:"md:col-span-1",children:[e.jsxs(h,{children:[e.jsx(j,{children:"Datos de Ubicación"}),e.jsx(E,{children:"Coordenadas y detalles de ubicación"})]}),e.jsxs(u,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium",children:"Parque"}),e.jsx("p",{className:"text-gray-700 font-medium mt-1",children:s.parkName})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium",children:"Coordenadas"}),e.jsxs("p",{className:"text-gray-700 mt-1",children:["Latitud: ",e.jsx("span",{className:"font-mono",children:s.latitude})]}),e.jsxs("p",{className:"text-gray-700",children:["Longitud: ",e.jsx("span",{className:"font-mono",children:s.longitude})]})]}),s.locationDescription&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium",children:"Descripción de la Ubicación"}),e.jsx("p",{className:"text-gray-700 mt-1",children:s.locationDescription})]})]}),e.jsx(k,{className:"flex flex-col gap-2",children:e.jsxs(n,{className:"w-full",onClick:()=>window.open(`https://www.google.com/maps/search/?api=1&query=${s.latitude},${s.longitude}`,"_blank"),children:[e.jsx(C,{className:"mr-2 h-4 w-4"}),"Ver en Google Maps"]})})]}),e.jsxs(x,{className:"md:col-span-2",children:[e.jsx(h,{children:e.jsx(j,{children:"Mapa"})}),e.jsx(u,{className:"min-h-[400px]",children:e.jsx("div",{className:"h-[400px] bg-gray-100 rounded-lg flex items-center justify-center",children:e.jsxs("div",{className:"text-center p-6",children:[e.jsx(C,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-700",children:"Vista previa del mapa no disponible"}),e.jsx("p",{className:"text-gray-500 mt-2 max-w-md mx-auto",children:'Utiliza el botón "Ver en Google Maps" para visualizar la ubicación exacta del árbol.'}),e.jsxs(n,{variant:"outline",className:"mt-4",onClick:()=>window.open(`https://www.google.com/maps/search/?api=1&query=${s.latitude},${s.longitude}`,"_blank"),children:[e.jsx(Pe,{className:"mr-2 h-4 w-4"}),"Abrir en Google Maps"]})]})})})]})]})})]})]})]})}export{_e as default};
