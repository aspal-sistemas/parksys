import{al as J,Y as f,u as C,j as e,aB as D,B as h,aW as A,C as i,a as c,aq as B,ar as K,z as O,H as V,J as W,K as Y,N as _,b as m,h as j,c as d,ak as S,D as Q,r as G,t as U,v as X,M as Z,i as ee,f as k}from"./index-BBGHPKhn.js";const N={pending:"bg-yellow-100 text-yellow-800 border-yellow-300",confirmed:"bg-green-100 text-green-800 border-green-300",cancelled:"bg-red-100 text-red-800 border-red-300",completed:"bg-blue-100 text-blue-800 border-blue-300"},L={pending:"Pendiente",confirmed:"Confirmada",cancelled:"Cancelada",completed:"Completada"},se={playground:"Área de Juegos",kiosk:"Kiosco",picnic_area:"Área de Picnic",open_area:"Área Abierta",pavilion:"Pabellón"},ae=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],te=["Dom","Lun","Mar","Mié","Jue","Vie","Sáb"];function ie(){const[re,M]=J(),[p,v]=f.useState(new Date),[a,b]=f.useState(null),[x,R]=f.useState("all"),l=p.getFullYear(),n=p.getMonth(),{data:$=[],isLoading:E}=C({queryKey:["/api/space-reservations",l,n+1],queryFn:async()=>{const s=await fetch(`/api/space-reservations?month=${n+1}&year=${l}`);if(!s.ok)throw new Error("Error al cargar las reservas");return s.json()}}),{data:F=[]}=C({queryKey:["/api/parks"],queryFn:async()=>{const s=await fetch("/api/parks");if(!s.ok)throw new Error("Error al cargar los parques");return s.json()}}),o=$.filter(s=>x==="all"?!0:s.space_name.toLowerCase().includes(x.toLowerCase())||s.park_name.toLowerCase().includes(x.toLowerCase())),y=s=>{const t=new Date(p);t.setMonth(t.getMonth()+s),v(t)},q=()=>{v(new Date)},P=()=>{M("/admin/space-reservations/new")},T=new Date(l,n,1),z=new Date(l,n+1,0).getDate(),I=T.getDay(),u=[];for(let s=0;s<I;s++)u.push(null);for(let s=1;s<=z;s++)u.push(s);const g=s=>{const t=`${l}-${(n+1).toString().padStart(2,"0")}-${s.toString().padStart(2,"0")}`;return o.filter(r=>r.reservation_date.startsWith(t))},w=s=>{const t=new Date;return t.getFullYear()===l&&t.getMonth()===n&&t.getDate()===s},H=s=>{b(s)};return E?e.jsx(D,{children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})}):e.jsx(D,{children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Calendario de Reservas"}),e.jsx("p",{className:"text-gray-600",children:"Visualiza las reservas de espacios en formato calendario"})]}),e.jsxs(h,{onClick:P,className:"bg-[#00a587] hover:bg-[#067f5f] text-white",children:[e.jsx(A,{className:"h-4 w-4 mr-2"}),"Nueva Reserva"]})]}),e.jsx(i,{children:e.jsx(c,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(h,{variant:"outline",size:"sm",onClick:()=>y(-1),children:e.jsx(B,{className:"h-4 w-4"})}),e.jsxs("h2",{className:"text-xl font-semibold",children:[ae[n]," ",l]}),e.jsx(h,{variant:"outline",size:"sm",onClick:()=>y(1),children:e.jsx(K,{className:"h-4 w-4"})}),e.jsx(h,{variant:"outline",size:"sm",onClick:q,children:"Hoy"})]}),e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs(O,{value:x,onValueChange:R,children:[e.jsx(V,{className:"w-[200px]",children:e.jsx(W,{placeholder:"Filtrar por parque"})}),e.jsxs(Y,{children:[e.jsx(_,{value:"all",children:"Todos los parques"}),F.map(s=>e.jsx(_,{value:s.name,children:s.name},s.id))]})]})})]})})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs(i,{children:[e.jsxs(c,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(m,{className:"text-sm font-medium",children:"Reservas Este Mes"}),e.jsx(j,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(d,{children:e.jsx("div",{className:"text-2xl font-bold",children:o.length})})]}),e.jsxs(i,{children:[e.jsxs(c,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(m,{className:"text-sm font-medium",children:"Confirmadas"}),e.jsx(j,{className:"h-4 w-4 text-green-600"})]}),e.jsx(d,{children:e.jsx("div",{className:"text-2xl font-bold text-green-600",children:o.filter(s=>s.status==="confirmed").length})})]}),e.jsxs(i,{children:[e.jsxs(c,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(m,{className:"text-sm font-medium",children:"Pendientes"}),e.jsx(j,{className:"h-4 w-4 text-yellow-600"})]}),e.jsx(d,{children:e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:o.filter(s=>s.status==="pending").length})})]}),e.jsxs(i,{children:[e.jsxs(c,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(m,{className:"text-sm font-medium",children:"Ingresos del Mes"}),e.jsx(S,{className:"h-4 w-4 text-[#00a587]"})]}),e.jsx(d,{children:e.jsxs("div",{className:"text-2xl font-bold text-[#00a587]",children:["$",o.reduce((s,t)=>s+parseFloat(t.total_cost||"0"),0).toFixed(2)]})})]})]}),e.jsx(i,{children:e.jsxs(d,{className:"p-0",children:[e.jsx("div",{className:"grid grid-cols-7 border-b",children:te.map(s=>e.jsx("div",{className:"p-4 text-center font-medium text-gray-700 border-r last:border-r-0",children:s},s))}),e.jsx("div",{className:"grid grid-cols-7",children:u.map((s,t)=>e.jsx("div",{className:`min-h-[120px] border-r border-b last:border-r-0 p-2 ${s?"bg-white hover:bg-gray-50":"bg-gray-50"} ${w(s||0)?"bg-blue-50":""}`,children:s&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`text-sm font-medium mb-1 ${w(s)?"text-blue-600":"text-gray-900"}`,children:s}),e.jsxs("div",{className:"space-y-1",children:[g(s).slice(0,3).map(r=>e.jsxs("div",{onClick:()=>H(r),className:`text-xs p-1 rounded cursor-pointer border ${N[r.status]} hover:opacity-80`,children:[e.jsxs("div",{className:"font-medium truncate",children:[r.start_time," - ",r.space_name]}),e.jsx("div",{className:"truncate text-gray-600",children:r.customer_name})]},r.id)),g(s).length>3&&e.jsxs("div",{className:"text-xs text-gray-500 font-medium",children:["+",g(s).length-3," más..."]})]})]})},t))})]})}),e.jsxs(i,{children:[e.jsx(c,{children:e.jsx(m,{className:"text-base",children:"Leyenda de Estados"})}),e.jsx(d,{children:e.jsx("div",{className:"flex flex-wrap gap-4",children:Object.entries(N).map(([s,t])=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-4 h-4 rounded border ${t}`}),e.jsx("span",{className:"text-sm",children:L[s]})]},s))})})]}),e.jsx(Q,{open:!!a,onOpenChange:s=>!s&&b(null),children:e.jsxs(G,{className:"max-w-2xl","aria-describedby":"reservation-details-description",children:[e.jsxs(U,{children:[e.jsx(X,{children:"Detalles de la Reserva"}),e.jsx("div",{id:"reservation-details-description",className:"sr-only",children:"Información completa de la reserva seleccionada con detalles del cliente y espacio"})]}),a&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Información del Cliente"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Nombre:"})," ",a.customer_name]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Email:"})," ",a.customer_email]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Teléfono:"})," ",a.customer_phone]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Información del Espacio"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"h-3 w-3"}),e.jsx("span",{children:a.space_name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Parque:"})," ",a.park_name]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Tipo:"})," ",se[a.space_type]]})]})]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Detalles de la Reserva"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(j,{className:"h-3 w-3"}),e.jsx("span",{className:"font-medium",children:"Fecha:"}),e.jsx("span",{children:new Date(a.reservation_date).toLocaleDateString()})]}),e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ee,{className:"h-3 w-3"}),e.jsx("span",{className:"font-medium",children:"Horario:"}),e.jsxs("span",{children:[a.start_time," - ",a.end_time]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"font-medium",children:"Duración:"}),e.jsxs("span",{children:[a.total_hours," horas"]})]}),e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(S,{className:"h-3 w-3"}),e.jsx("span",{className:"font-medium",children:"Total:"}),e.jsxs("span",{className:"text-lg font-bold text-[#00a587]",children:["$",a.total_cost]})]})]})]})]}),a.special_requests&&e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Solicitudes Especiales"}),e.jsx("p",{className:"text-sm text-gray-600",children:a.special_requests})]}),e.jsx("div",{className:"border-t pt-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Estado:"}),e.jsx(k,{className:`ml-2 ${N[a.status]}`,children:L[a.status]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Depósito:"}),e.jsx(k,{className:`ml-2 ${a.deposit_paid?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:a.deposit_paid?"Pagado":"Pendiente"})]})]})})]})]})})]})})}export{ie as default};
