const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/jspdf.es.min-C24sEDDH.js","assets/index-Dzu3mJf5.js","assets/index-D-u1ClXe.css"])))=>i.map(i=>d[i]);
import{am as ot,e as lt,a6 as ct,Y as f,u as le,R as Q,a8 as dt,j as e,aI as mt,C as h,c as g,an as ce,b$ as Y,B as m,b2 as xt,W as ut,D as Pe,p as ht,az as gt,r as Te,t as jt,v as pt,w as vt,F as bt,a9 as $e,c7 as yt,a as T,b as $,ak as ft,I as Nt,z as J,H as Z,J as ee,K as te,N as p,a3 as Ct,bh as wt,bi as St,bj as Ie,bk as C,bl as Ft,bm as w,f as ke,ba as Dt,h as At,x as Mt,bb as Et,as as Pt,aj as Tt,al as $t,aK as It,aS as B,a_ as qe,a$ as Ve,b0 as Re,aX as O,aU as de,aV as me,aW as xe,aZ as ue,ai as kt,bW as qt}from"./index-Dzu3mJf5.js";import{H as Vt}from"./Helmet-BWphdh6I.js";import{S as Rt}from"./skeleton-Die7Hc3c.js";import{C as _t}from"./circle-x-C53LJYQf.js";import{P as zt}from"./printer-BlfCQWfq.js";import{B as he}from"./BarChart-Bu_4ahC_.js";const k=x=>x?new Date(x).toLocaleDateString("es-MX",{year:"numeric",month:"2-digit",day:"2-digit"}):"N/A",ge=x=>({active:"Activo",maintenance:"Mantenimiento",retired:"Retirado",damaged:"Dañado"})[x]||x,je=x=>({excellent:"Excelente",good:"Bueno",fair:"Regular",poor:"Malo"})[x]||x,Lt=x=>{switch(x.toLowerCase()){case"activo":return"bg-green-100 text-green-800 hover:bg-green-200";case"mantenimiento":return"bg-yellow-100 text-yellow-800 hover:bg-yellow-200";case"dañado":return"bg-red-100 text-red-800 hover:bg-red-200";case"retirado":return"bg-gray-100 text-gray-800 hover:bg-gray-200";default:return"bg-gray-100 text-gray-800 hover:bg-gray-200"}},Xt=x=>{switch(x.toLowerCase()){case"excelente":return"bg-green-100 text-green-800 hover:bg-green-200";case"bueno":return"bg-blue-100 text-blue-800 hover:bg-blue-200";case"regular":return"bg-yellow-100 text-yellow-800 hover:bg-yellow-200";case"malo":return"bg-red-100 text-red-800 hover:bg-red-200";default:return"bg-gray-100 text-gray-800 hover:bg-gray-200"}},Qt=()=>{const[,x]=ot(),{toast:u}=lt(),pe=ct(),[q,ve]=f.useState(""),[V,be]=f.useState("all"),[R,ye]=f.useState("all"),[_,fe]=f.useState("all"),[z,Ne]=f.useState("all"),[v,L]=f.useState(1),U=10,[_e,Ce]=f.useState(!1),[X,we]=f.useState(null),[Se,K]=f.useState(0),[se,Fe]=f.useState(!1),[S,ae]=f.useState(null),[ze,re]=f.useState(!1),{data:F,isLoading:Le,isError:Xe}=le({queryKey:["/api/assets/inventory",v,q,V,R,_,z],queryFn:async()=>{const t=new URLSearchParams({page:v.toString(),limit:U.toString(),search:q,status:V,condition:R,park:_,category:z}),i=await fetch(`/api/assets/inventory?${t}`);if(!i.ok)throw new Error("Error al cargar inventario");return i.json()},enabled:!0}),{data:ie}=le({queryKey:["/api/parks"],enabled:!0}),{data:ne}=le({queryKey:["/api/asset-categories"],enabled:!0}),Be=Q.useMemo(()=>Array.isArray(ne)?ne.filter(t=>t&&typeof t=="object"&&t.id&&t.name&&t.id.toString().trim()!==""&&t.name.trim()!==""):[],[ne]),Oe=Q.useMemo(()=>Array.isArray(ie)?ie.filter(t=>t&&typeof t=="object"&&t.id&&t.name&&t.id.toString().trim()!==""&&t.name.trim()!==""):[],[ie]),b=(F==null?void 0:F.assets)||[],E=parseInt((F==null?void 0:F.totalAssets)||"0",10),P=Math.ceil(E/U),De=(v-1)*U+1,Ae=Math.min(v*U,E),N=Q.useMemo(()=>{if(!b||b.length===0)return null;const t=b.reduce((n,l)=>{const o=ge(l.status);return n[o]=(n[o]||0)+1,n},{}),i=b.reduce((n,l)=>{const o=je(l.condition);return n[o]=(n[o]||0)+1,n},{}),c=b.reduce((n,l)=>{const o=l.categoryName||"Sin categoría";return n[o]=(n[o]||0)+1,n},{}),s=b.reduce((n,l)=>{const o=l.categoryName||"Sin categoría",r=parseFloat(l.acquisitionCost)||0;return n[o]=(n[o]||0)+r,n},{}),d=b.reduce((n,l)=>{const o=l.parkName||"Sin parque",r=parseFloat(l.acquisitionCost)||0;return n[o]=(n[o]||0)+r,n},{});return{statusData:Object.entries(t).map(([n,l])=>({name:n,value:l})),conditionData:Object.entries(i).map(([n,l])=>({name:n,value:l})),categoryData:Object.entries(c).map(([n,l])=>({name:n,value:l})),categoryValueData:Object.entries(s).map(([n,l])=>({name:n,value:l,formattedValue:new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN",minimumFractionDigits:0,maximumFractionDigits:0}).format(l)})),parkValueData:Object.entries(d).map(([n,l])=>({name:n,value:l,formattedValue:new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN",minimumFractionDigits:0,maximumFractionDigits:0}).format(l)}))}},[b]),Ue=b;Q.useEffect(()=>{L(1)},[q,V,R,_,z]);const Me=()=>{ve(""),be("all"),ye("all"),fe("all"),Ne("all"),L(1)},Ke=t=>{x(`/admin/assets/${t}/edit`)},He=t=>{x(`/admin/incidents/new?assetId=${t}`)},Ge=t=>{x(`/admin/assets/${t}`)},We=dt({mutationFn:async t=>kt(`/api/assets/${t}`,{method:"DELETE"}),onSuccess:()=>{pe.invalidateQueries({queryKey:["/api/assets/inventory"]}),u({title:"Activo eliminado",description:"El activo ha sido eliminado correctamente."})},onError:t=>{u({title:"Error",description:t.message||"No se pudo eliminar el activo.",variant:"destructive"})}}),Qe=t=>{confirm("¿Estás seguro de que deseas eliminar este activo?")&&We.mutate(t)},Ye=async()=>{try{const t=await fetch("/api/assets/export");if(!t.ok)throw new Error("Error al obtener datos para exportar");const i=await t.json();if(!i||i.length===0){u({title:"Sin datos",description:"No hay activos para exportar.",variant:"destructive"});return}const c=["ID","Nombre","Descripción","Número de Serie","Categoría","Parque","Amenidad","Ubicación Descripción","Latitud","Longitud","Estado","Condición","Fabricante","Modelo","Fecha de Adquisición","Costo de Adquisición (MXN)","Valor Actual (MXN)","Frecuencia de Mantenimiento","Último Mantenimiento","Próximo Mantenimiento","Vida Útil Esperada (meses)","Código QR","Persona Responsable","Notas","Fecha de Creación","Última Actualización"],s=[];s.push(c.join(","));for(const a of i){const H=[a.id||"",`"${(a.name||"").replace(/"/g,'""')}"`,`"${(a.description||"").replace(/"/g,'""')}"`,`"${(a.serialNumber||"").replace(/"/g,'""')}"`,`"${(a.categoryName||"").replace(/"/g,'""')}"`,`"${(a.parkName||"").replace(/"/g,'""')}"`,`"${(a.amenityName||"").replace(/"/g,'""')}"`,`"${(a.locationDescription||"").replace(/"/g,'""')}"`,`"${a.latitude||""}"`,`"${a.longitude||""}"`,`"${ge(a.status)}"`,`"${je(a.condition)}"`,`"${(a.manufacturer||"").replace(/"/g,'""')}"`,`"${(a.model||"").replace(/"/g,'""')}"`,a.acquisitionDate?k(a.acquisitionDate):"",a.acquisitionCost!==null&&a.acquisitionCost!==void 0?`"$${Number(a.acquisitionCost).toLocaleString("es-MX",{minimumFractionDigits:0,maximumFractionDigits:0})}"`:"",a.currentValue!==null&&a.currentValue!==void 0?`"$${Number(a.currentValue).toLocaleString("es-MX",{minimumFractionDigits:0,maximumFractionDigits:0})}"`:"",`"${(a.maintenanceFrequency||"").replace(/"/g,'""')}"`,a.lastMaintenanceDate?k(a.lastMaintenanceDate):"",a.nextMaintenanceDate?k(a.nextMaintenanceDate):"",a.expectedLifespan||"",`"${(a.qrCode||"").replace(/"/g,'""')}"`,`"${(a.responsiblePersonName||"").replace(/"/g,'""')}"`,`"${(a.notes||"").replace(/"/g,'""')}"`,a.createdAt?k(a.createdAt):"",a.updatedAt?k(a.updatedAt):""];s.push(H.join(","))}const l="\uFEFF"+s.join(`\r
`),o=new Blob([l],{type:"text/csv;charset=utf-8;"}),r=URL.createObjectURL(o),A=document.createElement("a");A.setAttribute("href",r),A.setAttribute("download",`inventario_completo_activos_${new Date().toISOString().split("T")[0]}.csv`),A.style.visibility="hidden",document.body.appendChild(A),A.click(),document.body.removeChild(A),URL.revokeObjectURL(r),u({title:"Exportación exitosa",description:`Se ha exportado el inventario completo con ${i.length} activos y ${c.length} campos.`})}catch(t){console.error("Error al exportar inventario:",t),u({title:"Error de exportación",description:"Hubo un problema al generar el archivo de exportación.",variant:"destructive"})}},Je=t=>{var c;const i=(c=t.target.files)==null?void 0:c[0];i&&i.type==="text/csv"?(we(i),ae(null)):u({title:"Archivo inválido",description:"Por favor selecciona un archivo CSV válido.",variant:"destructive"})},Ze=async()=>{if(!X){u({title:"No hay archivo",description:"Por favor selecciona un archivo CSV primero.",variant:"destructive"});return}Fe(!0),K(0);try{const t=new FormData;t.append("file",X);const i=setInterval(()=>{K(d=>Math.min(d+10,90))},100),c=await fetch("/api/assets/import",{method:"POST",body:t});if(clearInterval(i),K(100),!c.ok)throw new Error("Error al procesar el archivo");const s=await c.json();ae({success:s.success||0,errors:s.errors||[]}),pe.invalidateQueries({queryKey:["/api/assets/inventory"]}),u({title:"Importación completada",description:`Se procesaron ${s.success} registros exitosamente.`})}catch(t){console.error("Error al importar CSV:",t),u({title:"Error de importación",description:"Hubo un problema al procesar el archivo CSV.",variant:"destructive"})}finally{Fe(!1),K(0)}},et=async()=>{try{u({title:"Generando reporte",description:"Preparando reporte ejecutivo de inventario..."});const t=await fetch("/api/assets/report-data",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({filters:{search:q,status:V,condition:R,park:_,category:z}})});if(!t.ok)throw new Error("Error al obtener datos del reporte");const i=await t.json(),{jsPDF:c}=await qt(async()=>{const{jsPDF:j}=await import("./jspdf.es.min-C24sEDDH.js").then(D=>D.j);return{jsPDF:j}},__vite__mapDeps([0,1,2])),s=new c,d=s.internal.pageSize.getWidth(),n=s.internal.pageSize.getHeight(),l="#00a587",o=20;let r=o;s.setFontSize(22),s.setTextColor(0,165,135),s.text("Reporte Ejecutivo de Inventario",d/2,r,{align:"center"}),r+=10,s.setFontSize(14),s.setTextColor(100,100,100),s.text("Bosques Urbanos de Guadalajara",d/2,r,{align:"center"}),r+=8;const A=new Date().toLocaleDateString("es-MX",{year:"numeric",month:"long",day:"numeric"});s.text(`Generado el ${A}`,d/2,r,{align:"center"}),r+=15,s.setDrawColor(0,165,135),s.setLineWidth(1),s.line(o,r,d-o,r),r+=15,s.setFontSize(16),s.setTextColor(0,165,135),s.text("Resumen Ejecutivo",o,r),r+=15;const a=i.statistics,H=j=>new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN",minimumFractionDigits:0,maximumFractionDigits:0}).format(j),st=[{label:"Total de Activos",value:a.total_assets},{label:"Activos Activos",value:a.active_assets},{label:"En Mantenimiento",value:a.maintenance_assets},{label:"Valor Total",value:H(a.total_current_value)}];s.setFontSize(12);const Ee=(d-o*2-10)/2,oe=25;st.forEach((j,D)=>{const I=Math.floor(D/2),nt=D%2,G=o+nt*(Ee+10),W=r+I*(oe+10);s.setFillColor(248,249,250),s.rect(G,W,Ee,oe,"F"),s.setFillColor(0,165,135),s.rect(G,W,3,oe,"F"),s.setTextColor(0,165,135),s.setFontSize(10),s.text(j.label,G+8,W+8),s.setTextColor(50,50,50),s.setFontSize(14),s.text(j.value.toString(),G+8,W+18)}),r+=70,s.setFontSize(16),s.setTextColor(0,165,135),s.text("Distribución por Categorías",o,r),r+=15,s.setFontSize(12),s.setTextColor(50,50,50);const y=[80,40,60],M=o;s.setFillColor(0,165,135),s.rect(M,r,y[0]+y[1]+y[2],8,"F"),s.setTextColor(255,255,255),s.setFontSize(10),s.text("Categoría",M+2,r+6),s.text("Cantidad",M+y[0]+2,r+6),s.text("Valor Total",M+y[0]+y[1]+2,r+6),r+=10,i.categoriesStats.forEach((j,D)=>{r>n-30&&(s.addPage(),r=o);const I=r+D*8;D%2===0&&(s.setFillColor(249,249,249),s.rect(M,I,y[0]+y[1]+y[2],8,"F")),s.setTextColor(50,50,50),s.setFontSize(9),s.text(j.category||"Sin categoría",M+2,I+6),s.text(j.count.toString(),M+y[0]+2,I+6),s.text(H(j.total_value),M+y[0]+y[1]+2,I+6)}),r+=i.categoriesStats.length*8+20,r>n-60&&(s.addPage(),r=o),s.setFontSize(16),s.setTextColor(0,165,135),s.text("Estado y Condición de Activos",o,r),r+=15,s.setFontSize(12),s.setTextColor(50,50,50),s.text("Estado Operativo:",o,r),r+=8,s.setFontSize(10);const at=a.total_assets>0?(a.active_assets/a.total_assets*100).toFixed(1):"0",rt=a.total_assets>0?(a.maintenance_assets/a.total_assets*100).toFixed(1):"0";s.text(`• Activos: ${a.active_assets} (${at}%)`,o+10,r),r+=6,s.text(`• En Mantenimiento: ${a.maintenance_assets} (${rt}%)`,o+10,r),r+=15,s.setFontSize(12),s.text("Condición Física:",o,r),r+=8,s.setFontSize(10),[{name:"Excelente",count:a.excellent_condition},{name:"Bueno",count:a.good_condition},{name:"Regular",count:a.fair_condition},{name:"Malo",count:a.poor_condition}].forEach(j=>{const D=a.total_assets>0?(j.count/a.total_assets*100).toFixed(1):"0";s.text(`• ${j.name}: ${j.count} (${D}%)`,o+10,r),r+=6}),r=n-20,s.setFontSize(8),s.setTextColor(100,100,100),s.text("Sistema de Gestión de Activos - Bosques Urbanos de Guadalajara",d/2,r,{align:"center"}),s.text("Av. Alcalde 1351, Guadalajara, Jalisco | Tel: 33 3837-4400 | bosques@guadalajara.gob.mx",d/2,r+4,{align:"center"});const it=new Date().toISOString().split("T")[0];s.save(`reporte_ejecutivo_inventario_${it}.pdf`),u({title:"Reporte generado",description:"El reporte ejecutivo se ha descargado exitosamente."})}catch(t){console.error("Error al generar reporte:",t),u({title:"Error en reporte",description:"Hubo un problema al generar el reporte ejecutivo.",variant:"destructive"})}},tt=()=>{const i="\uFEFF"+["ID","Nombre","Descripción","Número de Serie","Categoría","Parque","Amenidad","Ubicación Descripción","Latitud","Longitud","Estado","Condición","Fabricante","Modelo","Fecha de Adquisición","Costo de Adquisición (MXN)","Valor Actual (MXN)","Frecuencia de Mantenimiento","Último Mantenimiento","Próximo Mantenimiento","Vida Útil Esperada (meses)","Código QR","Persona Responsable","Notas","Fecha de Creación","Última Actualización"].join(",")+`\r
`,c=new Blob([i],{type:"text/csv;charset=utf-8;"}),s=URL.createObjectURL(c),d=document.createElement("a");d.setAttribute("href",s),d.setAttribute("download","plantilla_importacion_activos.csv"),d.style.visibility="hidden",document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(s),u({title:"Plantilla descargada",description:"Usa esta plantilla para preparar tus datos de importación."})};return e.jsxs(mt,{children:[e.jsx(Vt,{children:e.jsx("title",{children:"Inventario de Activos - ParkSys"})}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Inventario de Activos"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Gestión completa del inventario de activos de los parques"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsx(h,{children:e.jsx(g,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Activos"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:E})]}),e.jsx(ce,{className:"h-8 w-8 text-blue-600"})]})})}),e.jsx(h,{children:e.jsx(g,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Activos Activos"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:b.filter(t=>t.status==="active").length})]}),e.jsx("div",{className:"h-8 w-8 bg-green-100 rounded-full flex items-center justify-center",children:e.jsx("div",{className:"h-4 w-4 bg-green-600 rounded-full"})})]})})}),e.jsx(h,{children:e.jsx(g,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"En Mantenimiento"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:b.filter(t=>t.status==="maintenance").length})]}),e.jsx("div",{className:"h-8 w-8 bg-yellow-100 rounded-full flex items-center justify-center",children:e.jsx("div",{className:"h-4 w-4 bg-yellow-600 rounded-full"})})]})})}),e.jsx(h,{children:e.jsx(g,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Valor Total"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:["$",((F==null?void 0:F.totalValue)||0).toLocaleString("es-MX",{minimumFractionDigits:0,maximumFractionDigits:0})]})]}),e.jsx(Y,{className:"h-8 w-8 text-purple-600"})]})})})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-6",children:[e.jsxs(m,{onClick:()=>x("/admin/assets/new"),className:"bg-[#00a587] hover:bg-[#067f5f]",children:[e.jsx(xt,{className:"h-4 w-4 mr-2"}),"Nuevo Activo"]}),e.jsxs(m,{variant:"outline",onClick:Ye,children:[e.jsx(ut,{className:"h-4 w-4 mr-2"}),"Exportar Inventario"]}),e.jsxs(Pe,{open:_e,onOpenChange:Ce,children:[e.jsx(ht,{asChild:!0,children:e.jsxs(m,{variant:"outline",children:[e.jsx(gt,{className:"h-4 w-4 mr-2"}),"Importar Datos"]})}),e.jsxs(Te,{className:"max-w-2xl",children:[e.jsxs(jt,{children:[e.jsx(pt,{children:"Importar Inventario de Activos"}),e.jsx(vt,{children:"Importa datos masivamente desde un archivo CSV usando el mismo formato de la exportación."})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:[e.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"1. Descarga la Plantilla"}),e.jsx("p",{className:"text-sm text-blue-700 mb-3",children:"Usa la plantilla oficial con los 26 campos requeridos y formato correcto."}),e.jsxs(m,{variant:"outline",size:"sm",onClick:tt,className:"border-blue-300 text-blue-700 hover:bg-blue-100",children:[e.jsx(bt,{className:"h-4 w-4 mr-2"}),"Descargar Plantilla CSV"]})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"2. Selecciona tu Archivo"}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Sube el archivo CSV preparado con los datos de inventario."}),e.jsx("input",{type:"file",accept:".csv",onChange:Je,className:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-medium file:bg-[#00a587] file:text-white hover:file:bg-[#067f5f] file:cursor-pointer cursor-pointer"}),X&&e.jsxs("div",{className:"mt-2 flex items-center text-sm text-green-600",children:[e.jsx($e,{className:"h-4 w-4 mr-1"}),"Archivo seleccionado: ",X.name]})]}),se&&e.jsxs("div",{className:"bg-yellow-50 p-4 rounded-lg border border-yellow-200",children:[e.jsx("h4",{className:"font-medium text-yellow-900 mb-2",children:"Procesando Importación..."}),e.jsx(yt,{value:Se,className:"w-full"}),e.jsxs("p",{className:"text-sm text-yellow-700 mt-2",children:[Se,"% completado"]})]}),S&&e.jsxs("div",{className:`p-4 rounded-lg border ${S.errors.length===0?"bg-green-50 border-green-200":"bg-orange-50 border-orange-200"}`,children:[e.jsx("h4",{className:`font-medium mb-2 ${S.errors.length===0?"text-green-900":"text-orange-900"}`,children:"Resultados de la Importación"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx($e,{className:"h-4 w-4 mr-1 text-green-600"}),e.jsxs("span",{className:"text-green-700",children:[S.success," registros procesados exitosamente"]})]}),S.errors.length>0&&e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(_t,{className:"h-4 w-4 mr-1 text-red-600"}),e.jsxs("span",{className:"text-red-700",children:[S.errors.length," errores encontrados:"]})]}),e.jsxs("div",{className:"max-h-32 overflow-y-auto bg-white p-2 rounded border",children:[S.errors.slice(0,5).map((t,i)=>e.jsxs("div",{className:"text-xs text-red-600",children:["Fila ",t.row,": ",t.message]},i)),S.errors.length>5&&e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["... y ",S.errors.length-5," errores más"]})]})]})]})]}),e.jsxs("div",{className:"flex justify-between pt-4",children:[e.jsx(m,{variant:"outline",onClick:()=>{Ce(!1),we(null),ae(null)},children:"Cancelar"}),e.jsx(m,{onClick:Ze,disabled:!X||se,className:"bg-[#00a587] hover:bg-[#067f5f]",children:se?"Procesando...":"Importar Datos"})]})]})]})]}),e.jsxs(m,{variant:"outline",onClick:et,children:[e.jsx(zt,{className:"h-4 w-4 mr-2"}),"Exportar Reporte"]}),e.jsxs(m,{variant:"outline",onClick:()=>re(!0),children:[e.jsx(Y,{className:"h-4 w-4 mr-2"}),"Analytics"]})]}),e.jsxs(h,{className:"mb-6",children:[e.jsx(T,{children:e.jsxs($,{className:"flex items-center gap-2",children:[e.jsx(ft,{className:"h-5 w-5"}),"Filtros de Búsqueda"]})}),e.jsx(g,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-6 gap-4",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsx(Nt,{placeholder:"Buscar por nombre, número de serie, categoría...",value:q,onChange:t=>ve(t.target.value)})}),e.jsx("div",{children:e.jsxs(J,{value:z,onValueChange:Ne,children:[e.jsx(Z,{children:e.jsx(ee,{placeholder:"Categoría"})}),e.jsxs(te,{children:[e.jsx(p,{value:"all",children:"Todas las categorías"}),Be.map(t=>e.jsx(p,{value:t.id.toString(),children:t.name},t.id))]})]})}),e.jsx("div",{children:e.jsxs(J,{value:V,onValueChange:be,children:[e.jsx(Z,{children:e.jsx(ee,{placeholder:"Estado"})}),e.jsxs(te,{children:[e.jsx(p,{value:"all",children:"Todos los estados"}),e.jsx(p,{value:"active",children:"Activo"}),e.jsx(p,{value:"maintenance",children:"Mantenimiento"}),e.jsx(p,{value:"retired",children:"Retirado"}),e.jsx(p,{value:"damaged",children:"Dañado"})]})]})}),e.jsx("div",{children:e.jsxs(J,{value:R,onValueChange:ye,children:[e.jsx(Z,{children:e.jsx(ee,{placeholder:"Condición"})}),e.jsxs(te,{children:[e.jsx(p,{value:"all",children:"Todas las condiciones"}),e.jsx(p,{value:"excellent",children:"Excelente"}),e.jsx(p,{value:"good",children:"Bueno"}),e.jsx(p,{value:"fair",children:"Regular"}),e.jsx(p,{value:"poor",children:"Malo"})]})]})}),e.jsx("div",{children:e.jsxs(J,{value:_,onValueChange:fe,children:[e.jsx(Z,{children:e.jsx(ee,{placeholder:"Parque"})}),e.jsxs(te,{children:[e.jsx(p,{value:"all",children:"Todos los parques"}),Oe.map(t=>e.jsx(p,{value:t.id.toString(),children:t.name},t.id))]})]})}),e.jsx("div",{children:e.jsx(m,{variant:"outline",onClick:Me,children:"Limpiar Filtros"})})]})})]}),e.jsxs(h,{children:[e.jsxs(T,{children:[e.jsx($,{children:"Inventario Detallado"}),e.jsxs(Ct,{children:["Página ",v," de ",P," - Mostrando ",De,"-",Ae," de ",E," activos"]})]}),e.jsx(g,{children:Le?e.jsx("div",{className:"space-y-2",children:Array.from({length:5}).map((t,i)=>e.jsx(Rt,{className:"h-12 w-full"},i))}):Xe?e.jsx("div",{className:"text-center py-4 text-red-500",children:e.jsx("p",{children:"Error al cargar los datos de inventario."})}):E===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(ce,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),e.jsx("p",{children:"No se encontraron activos con los criterios seleccionados."}),e.jsx(m,{variant:"outline",className:"mt-4",onClick:Me,children:"Limpiar Filtros"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-auto",children:e.jsxs(wt,{children:[e.jsx(St,{children:e.jsxs(Ie,{children:[e.jsx(C,{children:"ID"}),e.jsx(C,{children:"Nombre"}),e.jsx(C,{children:"Categoría"}),e.jsx(C,{children:"Parque"}),e.jsx(C,{children:"Núm. Serie"}),e.jsx(C,{children:"Estado"}),e.jsx(C,{children:"Condición"}),e.jsx(C,{children:"Fecha Adquisición"}),e.jsx(C,{className:"text-right",children:"Valor"}),e.jsx(C,{className:"text-center",children:"Acciones"})]})}),e.jsx(Ft,{children:Ue.map(t=>e.jsxs(Ie,{children:[e.jsx(w,{children:t.id}),e.jsx(w,{className:"font-medium",children:t.name}),e.jsx(w,{children:t.categoryName}),e.jsx(w,{children:t.parkName}),e.jsx(w,{children:t.serialNumber||"N/A"}),e.jsx(w,{children:e.jsx(ke,{className:Lt(t.status),children:ge(t.status)})}),e.jsx(w,{children:e.jsx(ke,{className:Xt(t.condition),children:je(t.condition)})}),e.jsx(w,{children:k(t.acquisitionDate)}),e.jsx(w,{className:"text-right",children:t.acquisitionCost?`$${Number(t.acquisitionCost).toLocaleString("es-MX",{minimumFractionDigits:0,maximumFractionDigits:0})}`:"N/A"}),e.jsx(w,{className:"text-center",children:e.jsxs("div",{className:"flex justify-center gap-1",children:[e.jsx(m,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 text-green-600 hover:text-green-700",title:"Gestionar activo (editar, ver detalles)",onClick:()=>Ke(t.id),children:e.jsx(Dt,{className:"h-4 w-4"})}),e.jsx(m,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 text-blue-600 hover:text-blue-700",title:"Programar mantenimiento",onClick:()=>Ge(t.id),children:e.jsx(At,{className:"h-4 w-4"})}),e.jsx(m,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 text-orange-600 hover:text-orange-700",title:"Reportar incidencia",onClick:()=>He(t.id),children:e.jsx(Mt,{className:"h-4 w-4"})}),e.jsx(m,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 text-red-600 hover:text-red-700",title:"Eliminar",onClick:()=>Qe(t.id),children:e.jsx(Et,{className:"h-4 w-4"})})]})})]},t.id))})]})}),P>1&&e.jsxs("div",{className:"flex items-center justify-between mt-4 pt-4 border-t",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Mostrando ",De,"-",Ae," de ",E," activos"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(m,{variant:"outline",size:"sm",onClick:()=>L(Math.max(1,v-1)),disabled:v===1,children:"Anterior"}),e.jsx("div",{className:"flex items-center space-x-1",children:Array.from({length:Math.min(5,P)},(t,i)=>{let c;if(P<=5)c=i+1;else{const s=Math.max(1,v-2),d=Math.min(P,s+4);if(c=s+i,c>d)return null}return e.jsx(m,{variant:v===c?"default":"outline",size:"sm",onClick:()=>L(c),className:v===c?"bg-[#00a587] hover:bg-[#067f5f]":"",children:c},c)}).filter(Boolean)}),e.jsx(m,{variant:"outline",size:"sm",onClick:()=>L(Math.min(P,v+1)),disabled:v===P,children:"Siguiente"})]})]})]})})]}),e.jsx(Pe,{open:ze,onOpenChange:re,children:e.jsxs(Te,{className:"max-w-6xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h2",{className:"text-2xl font-bold text-[#00a587] flex items-center gap-2",children:[e.jsx(Y,{className:"h-6 w-6"}),"Analytics de Inventario de Activos"]}),e.jsx(m,{variant:"outline",size:"sm",onClick:()=>re(!1),className:"h-8 w-8 p-0",children:e.jsx(Pt,{className:"h-4 w-4"})})]}),N?e.jsxs("div",{className:"space-y-8 mt-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(h,{children:e.jsx(g,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Activos"}),e.jsx("p",{className:"text-2xl font-bold text-[#00a587]",children:E})]}),e.jsx(Tt,{className:"h-8 w-8 text-[#00a587]"})]})})}),e.jsx(h,{children:e.jsx(g,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Valor Total"}),e.jsx("p",{className:"text-lg font-bold text-[#00a587]",children:new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN",minimumFractionDigits:0,maximumFractionDigits:0}).format(b.reduce((t,i)=>t+(parseFloat(i.acquisitionCost)||0),0))})]}),e.jsx($t,{className:"h-8 w-8 text-[#00a587]"})]})})}),e.jsx(h,{children:e.jsx(g,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Categorías"}),e.jsx("p",{className:"text-2xl font-bold text-[#00a587]",children:N.categoryData.length})]}),e.jsx(ce,{className:"h-8 w-8 text-[#00a587]"})]})})}),e.jsx(h,{children:e.jsx(g,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Parques"}),e.jsx("p",{className:"text-2xl font-bold text-[#00a587]",children:N.parkValueData.length})]}),e.jsx(It,{className:"h-8 w-8 text-[#00a587]"})]})})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(h,{children:[e.jsx(T,{children:e.jsx($,{className:"text-[#00a587]",children:"Distribución por Estado"})}),e.jsx(g,{children:e.jsx(B,{width:"100%",height:300,children:e.jsxs(qe,{children:[e.jsx(Ve,{data:N.statusData,cx:"50%",cy:"50%",outerRadius:80,fill:"#8884d8",dataKey:"value",label:({name:t,value:i})=>`${t}: ${i}`,children:N.statusData.map((t,i)=>e.jsx(Re,{fill:["#00a587","#bcd256","#f39c12","#e74c3c"][i%4]},`cell-${i}`))}),e.jsx(O,{})]})})})]}),e.jsxs(h,{children:[e.jsx(T,{children:e.jsx($,{className:"text-[#00a587]",children:"Distribución por Condición"})}),e.jsx(g,{children:e.jsx(B,{width:"100%",height:300,children:e.jsxs(qe,{children:[e.jsx(Ve,{data:N.conditionData,cx:"50%",cy:"50%",outerRadius:80,fill:"#8884d8",dataKey:"value",label:({name:t,value:i})=>`${t}: ${i}`,children:N.conditionData.map((t,i)=>e.jsx(Re,{fill:["#2ecc71","#3498db","#f39c12","#e74c3c"][i%4]},`cell-${i}`))}),e.jsx(O,{})]})})})]}),e.jsxs(h,{children:[e.jsx(T,{children:e.jsx($,{className:"text-[#00a587]",children:"Cantidad de Activos por Categoría"})}),e.jsx(g,{children:e.jsx(B,{width:"100%",height:300,children:e.jsxs(he,{data:N.categoryData,children:[e.jsx(de,{strokeDasharray:"3 3"}),e.jsx(me,{dataKey:"name",angle:-45,textAnchor:"end",height:100}),e.jsx(xe,{}),e.jsx(O,{}),e.jsx(ue,{dataKey:"value",fill:"#00a587"})]})})})]}),e.jsxs(h,{children:[e.jsx(T,{children:e.jsx($,{className:"text-[#00a587]",children:"Valor Monetario por Categoría"})}),e.jsx(g,{children:e.jsx(B,{width:"100%",height:300,children:e.jsxs(he,{data:N.categoryValueData,children:[e.jsx(de,{strokeDasharray:"3 3"}),e.jsx(me,{dataKey:"name",angle:-45,textAnchor:"end",height:100}),e.jsx(xe,{tickFormatter:t=>new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN",notation:"compact",maximumFractionDigits:1}).format(t)}),e.jsx(O,{formatter:t=>[new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN",minimumFractionDigits:0,maximumFractionDigits:0}).format(t),"Valor"]}),e.jsx(ue,{dataKey:"value",fill:"#067f5f"})]})})})]})]}),e.jsxs(h,{children:[e.jsx(T,{children:e.jsx($,{className:"text-[#00a587]",children:"Distribución de Valor por Parque"})}),e.jsx(g,{children:e.jsx(B,{width:"100%",height:400,children:e.jsxs(he,{data:N.parkValueData.slice(0,10),layout:"horizontal",children:[e.jsx(de,{strokeDasharray:"3 3"}),e.jsx(me,{type:"number",tickFormatter:t=>new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN",notation:"compact",maximumFractionDigits:1}).format(t)}),e.jsx(xe,{type:"category",dataKey:"name",width:150}),e.jsx(O,{formatter:t=>[new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN",minimumFractionDigits:0,maximumFractionDigits:0}).format(t),"Valor Total"]}),e.jsx(ue,{dataKey:"value",fill:"#bcd256"})]})})})]})]}):e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Y,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"No hay datos disponibles para mostrar analytics"})]})})]})})]})};export{Qt as default};
