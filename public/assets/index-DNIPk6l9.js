import{a2 as g,l as H,ae as Z,u as O,ag as G,j as e,L as m,B as N,a_ as f,f as n,i as o,U as A,e as P,au as y,a4 as $,O as V,Q as C,V as S,W as T,Y as L,_ as x,o as v,g as B,h as Q,ab as K,bH as J,bI as _,bJ as D,bK as i,bL as W,bM as t,cN as Y,cO as X,cV as ee,cP as se,cS as j,bq as ae,cR as re,bp as U,b as ie,Z as te,a3 as le}from"./index-D5qLf1ib.js";import{D as ne}from"./DynamicAdminLayout-FWhFap-u.js";import{U as oe}from"./user-plus-De6O1CpJ.js";import{C as ce,G as de}from"./gem-dXiyKzl3.js";import"./RoleBadge-D5voYAx-.js";const r=[{id:"super-admin",name:"super-admin",displayName:"Super Administrador",level:10,badge:{color:"bg-red-500",icon:e.jsx(ce,{className:"w-3 h-3"})}},{id:"director-general",name:"director-general",displayName:"Director General",level:9,badge:{color:"bg-purple-500",icon:e.jsx(ie,{className:"w-3 h-3"})}},{id:"coordinador-parques",name:"coordinador-parques",displayName:"Coordinador de Parques",level:8,badge:{color:"bg-green-500",icon:e.jsx(de,{className:"w-3 h-3"})}},{id:"coordinador-actividades",name:"coordinador-actividades",displayName:"Coordinador de Actividades",level:7,badge:{color:"bg-blue-500",icon:e.jsx(te,{className:"w-3 h-3"})}},{id:"operador-parque",name:"operador-parque",displayName:"Operador de Parque",level:4,badge:{color:"bg-orange-500",icon:e.jsx(le,{className:"w-3 h-3"})}},{id:"admin-financiero",name:"admin-financiero",displayName:"Administrador Financiero",level:6,badge:{color:"bg-yellow-500",icon:e.jsx(U,{className:"w-3 h-3"})}},{id:"consultor-auditor",name:"consultor-auditor",displayName:"Consultor/Auditor",level:1,badge:{color:"bg-gray-500",icon:e.jsx(y,{className:"w-3 h-3"})}}],me=[{id:1,username:"admin",email:"admin@parksys.com",firstName:"Administrador",lastName:"Sistema",isActive:!0,createdAt:"2024-01-15",lastLogin:"2024-08-04T10:30:00Z",roles:[r[0]],department:"IT",position:"Administrador del Sistema"},{id:2,username:"director.martinez",email:"director@parksys.com",firstName:"Carlos",lastName:"Martínez",isActive:!0,createdAt:"2024-01-20",lastLogin:"2024-08-04T09:15:00Z",roles:[r[1]],department:"Dirección",position:"Director General"},{id:3,username:"coord.parques",email:"parques@parksys.com",firstName:"Ana",lastName:"García",isActive:!0,createdAt:"2024-02-01",lastLogin:"2024-08-03T16:45:00Z",roles:[r[2]],department:"Operaciones",position:"Coordinadora de Parques"},{id:4,username:"coord.actividades",email:"actividades@parksys.com",firstName:"Miguel",lastName:"López",isActive:!0,createdAt:"2024-02-10",lastLogin:"2024-08-04T08:20:00Z",roles:[r[3]],department:"Eventos",position:"Coordinador de Actividades"},{id:5,username:"operador.juan",email:"juan.operador@parksys.com",firstName:"Juan",lastName:"Rodríguez",isActive:!0,createdAt:"2024-03-01",lastLogin:"2024-08-03T14:30:00Z",roles:[r[4]],department:"Operaciones",position:"Operador de Campo"},{id:6,username:"admin.finanzas",email:"finanzas@parksys.com",firstName:"María",lastName:"Hernández",isActive:!0,createdAt:"2024-02-15",lastLogin:"2024-08-04T11:00:00Z",roles:[r[5]],department:"Finanzas",position:"Administradora Financiera"},{id:7,username:"consultor.ext",email:"consultor@external.com",firstName:"Roberto",lastName:"Sánchez",isActive:!0,createdAt:"2024-03-15",lastLogin:"2024-08-02T13:15:00Z",roles:[r[6]],department:"Externo",position:"Consultor Externo"},{id:8,username:"operador.maria",email:"maria.operador@parksys.com",firstName:"María Elena",lastName:"Torres",isActive:!1,createdAt:"2024-03-20",lastLogin:"2024-07-28T16:00:00Z",roles:[r[4]],department:"Operaciones",position:"Operadora de Campo"}];function Ne(){const[c,M]=g.useState(""),[p,q]=g.useState("all"),[h,k]=g.useState("all"),{toast:E}=H(),R=Z(),{data:d=me,isLoading:xe}=O({queryKey:["/api/admin-roles/users"],enabled:!1}),z=G({mutationFn:async({userId:s,newStatus:a})=>(await new Promise(u=>setTimeout(u,1e3)),{success:!0}),onSuccess:()=>{R.invalidateQueries({queryKey:["/api/admin-roles/users"]}),E({title:"Estado actualizado",description:"El estado del usuario se ha actualizado correctamente."})}}),w=d.filter(s=>{const a=s.firstName.toLowerCase().includes(c.toLowerCase())||s.lastName.toLowerCase().includes(c.toLowerCase())||s.email.toLowerCase().includes(c.toLowerCase())||s.username.toLowerCase().includes(c.toLowerCase()),u=p==="all"||s.roles.some(b=>b.id===p),l=h==="all"||h==="active"&&s.isActive||h==="inactive"&&!s.isActive;return a&&u&&l}),F=(s,a)=>{z.mutate({userId:s,newStatus:!a})},I=s=>{const a=new Date(s),l=Math.floor((new Date().getTime()-a.getTime())/(1e3*60*60));return l<1?"Hace menos de 1 hora":l<24?`Hace ${l} horas`:`Hace ${Math.floor(l/24)} días`};return e.jsx(ne,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Gestión de Usuarios y Roles"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Administrar usuarios y asignar roles del sistema"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(m,{href:"/admin-roles/users/bulk-assign",children:e.jsxs(N,{variant:"outline",children:[e.jsx(f,{className:"w-4 h-4 mr-2"}),"Asignación Masiva"]})}),e.jsx(m,{href:"/admin-roles/users/create",children:e.jsxs(N,{children:[e.jsx(oe,{className:"w-4 h-4 mr-2"}),"Crear Usuario"]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx(n,{children:e.jsx(o,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Usuarios"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:d.length})]}),e.jsx(A,{className:"h-8 w-8 text-blue-500"})]})})}),e.jsx(n,{children:e.jsx(o,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Usuarios Activos"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:d.filter(s=>s.isActive).length})]}),e.jsx(f,{className:"h-8 w-8 text-green-500"})]})})}),e.jsx(n,{children:e.jsx(o,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Con Roles Asignados"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:d.filter(s=>s.roles.length>0).length})]}),e.jsx(P,{className:"h-8 w-8 text-purple-500"})]})})}),e.jsx(n,{children:e.jsx(o,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Sin Roles"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:d.filter(s=>s.roles.length===0).length})]}),e.jsx(y,{className:"h-8 w-8 text-orange-500"})]})})})]}),e.jsx(n,{children:e.jsx(o,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx($,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(V,{placeholder:"Buscar usuarios por nombre, email o usuario...",value:c,onChange:s=>M(s.target.value),className:"pl-10"})]}),e.jsxs(C,{value:p,onValueChange:q,children:[e.jsx(S,{className:"w-full md:w-[200px]",children:e.jsx(T,{placeholder:"Filtrar por rol"})}),e.jsxs(L,{children:[e.jsx(x,{value:"all",children:"Todos los roles"}),r.map(s=>e.jsx(x,{value:s.id,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`inline-flex items-center justify-center rounded text-white w-6 h-6 ${s.badge.color}`,children:s.badge.icon}),e.jsx("span",{className:"text-xs font-medium",children:s.name.toUpperCase()})]})},s.id))]})]}),e.jsxs(C,{value:h,onValueChange:k,children:[e.jsx(S,{className:"w-full md:w-[200px]",children:e.jsx(T,{placeholder:"Filtrar por estado"})}),e.jsxs(L,{children:[e.jsx(x,{value:"all",children:"Todos los estados"}),e.jsx(x,{value:"active",children:"Activos"}),e.jsx(x,{value:"inactive",children:"Inactivos"})]})]}),e.jsxs(v,{variant:"outline",className:"self-center px-3 py-1",children:[w.length," usuarios encontrados"]})]})})}),e.jsxs(n,{children:[e.jsxs(B,{children:[e.jsxs(Q,{className:"flex items-center gap-2",children:[e.jsx(A,{className:"h-5 w-5"}),"Usuarios del Sistema"]}),e.jsx(K,{children:"Lista completa de usuarios con sus roles asignados"})]}),e.jsx(o,{children:e.jsxs(J,{children:[e.jsx(_,{children:e.jsxs(D,{children:[e.jsx(i,{children:"Usuario"}),e.jsx(i,{children:"Departamento"}),e.jsx(i,{children:"Roles Asignados"}),e.jsx(i,{children:"Estado"}),e.jsx(i,{children:"Último Acceso"}),e.jsx(i,{children:"Fecha Creación"}),e.jsx(i,{className:"text-right",children:"Acciones"})]})}),e.jsx(W,{children:w.map(s=>e.jsxs(D,{children:[e.jsx(t,{children:e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-gray-900",children:[s.firstName," ",s.lastName]}),e.jsx("p",{className:"text-sm text-gray-600",children:s.email}),e.jsxs("p",{className:"text-xs text-gray-500",children:["@",s.username]})]})}),e.jsx(t,{children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:s.department}),e.jsx("p",{className:"text-sm text-gray-600",children:s.position})]})}),e.jsx(t,{children:e.jsx("div",{className:"flex flex-wrap gap-1",children:s.roles.length>0?s.roles.map(a=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`inline-flex items-center justify-center rounded text-white w-6 h-6 ${a.badge.color}`,children:a.badge.icon}),e.jsx("span",{className:"text-xs font-medium",children:a.name.toUpperCase()})]},a.id)):e.jsx(v,{variant:"outline",className:"text-gray-500",children:"Sin roles"})})}),e.jsx(t,{children:e.jsx(v,{variant:s.isActive?"default":"secondary",children:s.isActive?"Activo":"Inactivo"})}),e.jsx(t,{children:e.jsx("span",{className:"text-sm text-gray-600",children:I(s.lastLogin)})}),e.jsx(t,{children:e.jsx("span",{className:"text-sm text-gray-600",children:new Date(s.createdAt).toLocaleDateString("es-ES")})}),e.jsx(t,{className:"text-right",children:e.jsxs(Y,{children:[e.jsx(X,{asChild:!0,children:e.jsx(N,{variant:"ghost",size:"sm",children:e.jsx(ee,{className:"h-4 w-4"})})}),e.jsxs(se,{align:"end",children:[e.jsx(m,{href:`/admin-roles/users/${s.id}/roles`,children:e.jsxs(j,{children:[e.jsx(f,{className:"h-4 w-4 mr-2"}),"Gestionar Roles"]})}),e.jsx(m,{href:`/admin-roles/users/${s.id}/edit`,children:e.jsxs(j,{children:[e.jsx(ae,{className:"h-4 w-4 mr-2"}),"Editar Usuario"]})}),e.jsx(m,{href:`/admin-roles/users/${s.id}/history`,children:e.jsxs(j,{children:[e.jsx(y,{className:"h-4 w-4 mr-2"}),"Ver Historial"]})}),e.jsx(re,{}),e.jsxs(j,{onClick:()=>F(s.id,s.isActive),children:[e.jsx(U,{className:"h-4 w-4 mr-2"}),s.isActive?"Desactivar":"Activar"]})]})]})})]},s.id))})]})})]})]})})}export{Ne as default};
