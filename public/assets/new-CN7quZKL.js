import{az as R,l as P,ae as T,a2 as V,af as z,u as B,ag as _,j as e,aX as K,B as p,A as Q,f as N,g as C,h as f,M as U,ab as k,i as E,ai as J,aj as i,ak as l,al as c,am as o,O as m,an as t,Q as S,V as w,W as L,Y as q,_ as d,$ as g,U as O,as as W,n as I,br as A,ad as n,ap as X,aq as $}from"./index-D5qLf1ib.js";import{S as Y}from"./SpaceMediaManager-BPIuC-1B.js";import{C as G}from"./camera-CeZ3mmMV.js";const Z=n.object({name:n.string().min(1,"El nombre es obligatorio"),description:n.string().min(1,"La descripción es obligatoria"),parkId:n.string().min(1,"Debe seleccionar un parque"),spaceType:n.string().min(1,"Debe seleccionar un tipo de espacio"),capacity:n.number().min(1,"La capacidad debe ser mayor a 0"),hourlyRate:n.number().min(0,"La tarifa debe ser mayor o igual a 0"),minimumHours:n.number().min(1,"Las horas mínimas deben ser mayor a 0"),maximumHours:n.number().min(1,"Las horas máximas deben ser mayor a 0"),amenities:n.string().optional(),rules:n.string().optional(),isActive:n.boolean(),requiresApproval:n.boolean(),advanceBookingDays:n.number().min(1,"Los días de anticipación deben ser mayor a 0")});function re(){const[,h]=R(),{toast:u}=P(),M=T(),[x,D]=V.useState(null),r=z({resolver:X(Z),defaultValues:{name:"",description:"",parkId:"",spaceType:"",capacity:1,hourlyRate:0,minimumHours:1,maximumHours:8,amenities:"",rules:"",isActive:!0,requiresApproval:!1,advanceBookingDays:30}}),{data:b=[],isLoading:H}=B({queryKey:["/api/parks?simple=true"]}),v=Array.isArray(b)?b:[],j=_({mutationFn:async s=>await $("/api/reservable-spaces",{method:"POST",data:{...s,parkId:parseInt(s.parkId)}}),onSuccess:s=>{var a;(a=s==null?void 0:s.space)!=null&&a.id?(D(s.space.id),u({title:"Espacio creado exitosamente",description:"Ahora puedes agregar imágenes y documentos en la sección de multimedia que aparece a continuación."}),setTimeout(()=>{var y;(y=document.querySelector('[data-section="multimedia"]'))==null||y.scrollIntoView({behavior:"smooth",block:"start"})},100)):u({title:"Espacio creado",description:"El espacio reservable ha sido creado exitosamente."}),M.invalidateQueries({queryKey:["/api/reservable-spaces"]})},onError:s=>{u({title:"Error",description:s.message||"Error al crear el espacio",variant:"destructive"})}}),F=s=>{if(s.maximumHours<=s.minimumHours){u({title:"Error de validación",description:"Las horas máximas deben ser mayores que las horas mínimas",variant:"destructive"});return}j.mutate(s)};return e.jsx(K,{children:e.jsxs("div",{className:"p-6 max-w-4xl mx-auto",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"flex items-center gap-3 mb-2",children:e.jsxs(p,{variant:"ghost",size:"sm",onClick:()=>h("/admin/space-reservations/spaces"),className:"flex items-center gap-2",children:[e.jsx(Q,{className:"w-4 h-4"}),"Volver"]})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Nuevo Espacio Reservable"}),e.jsx("p",{className:"text-gray-600",children:"Crea un nuevo espacio que los ciudadanos pueden reservar para eventos"}),!x&&e.jsx("div",{className:"mt-3 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("p",{className:"text-sm text-blue-700",children:[e.jsx("strong",{children:"Nota:"})," Después de crear el espacio básico, podrás agregar imágenes y documentos en la sección de multimedia."]})})]}),e.jsxs(N,{children:[e.jsxs(C,{children:[e.jsxs(f,{className:"flex items-center gap-2",children:[e.jsx(U,{className:"w-5 h-5 text-green-600"}),"Información del Espacio"]}),e.jsx(k,{children:"Define las características y reglas del nuevo espacio reservable"})]}),e.jsx(E,{children:e.jsx(J,{...r,children:e.jsxs("form",{onSubmit:r.handleSubmit(F),className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(i,{control:r.control,name:"name",render:({field:s})=>e.jsxs(l,{children:[e.jsx(c,{children:"Nombre del Espacio"}),e.jsx(o,{children:e.jsx(m,{placeholder:"Ej: Kiosco Principal",...s})}),e.jsx(t,{})]})}),e.jsx(i,{control:r.control,name:"parkId",render:({field:s})=>e.jsxs(l,{children:[e.jsx(c,{children:"Parque"}),e.jsxs(S,{onValueChange:s.onChange,defaultValue:s.value,children:[e.jsx(o,{children:e.jsx(w,{children:e.jsx(L,{placeholder:"Seleccionar parque"})})}),e.jsx(q,{children:H?e.jsx(d,{value:"loading",disabled:!0,children:"Cargando parques..."}):v.length>0?v.map(a=>e.jsx(d,{value:a.id.toString(),children:a.name},a.id)):e.jsx(d,{value:"no-parks",disabled:!0,children:"No hay parques disponibles"})})]}),e.jsx(t,{})]})}),e.jsx(i,{control:r.control,name:"spaceType",render:({field:s})=>e.jsxs(l,{children:[e.jsx(c,{children:"Tipo de Espacio"}),e.jsxs(S,{onValueChange:s.onChange,defaultValue:s.value,children:[e.jsx(o,{children:e.jsx(w,{children:e.jsx(L,{placeholder:"Selecciona el tipo de espacio"})})}),e.jsxs(q,{children:[e.jsx(d,{value:"kiosco",children:"Kiosco"}),e.jsx(d,{value:"area_juegos",children:"Área de Juegos"}),e.jsx(d,{value:"picnic",children:"Área de Picnic"}),e.jsx(d,{value:"jardin_eventos",children:"Jardín de Eventos"}),e.jsx(d,{value:"pabellon",children:"Pabellón"}),e.jsx(d,{value:"cancha_deportiva",children:"Cancha Deportiva"}),e.jsx(d,{value:"anfiteatro",children:"Anfiteatro"}),e.jsx(d,{value:"salon_usos_multiples",children:"Salón de Usos Múltiples"})]})]}),e.jsx(t,{})]})})]}),e.jsx(i,{control:r.control,name:"description",render:({field:s})=>e.jsxs(l,{children:[e.jsx(c,{children:"Descripción"}),e.jsx(o,{children:e.jsx(g,{placeholder:"Describe las características del espacio...",rows:3,...s})}),e.jsx(t,{})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(i,{control:r.control,name:"capacity",render:({field:s})=>e.jsxs(l,{children:[e.jsxs(c,{className:"flex items-center gap-2",children:[e.jsx(O,{className:"w-4 h-4"}),"Capacidad Máxima"]}),e.jsx(o,{children:e.jsx(m,{type:"number",placeholder:"50",...s,onChange:a=>s.onChange(parseInt(a.target.value)||0)})}),e.jsx(t,{})]})}),e.jsx(i,{control:r.control,name:"hourlyRate",render:({field:s})=>e.jsxs(l,{children:[e.jsxs(c,{className:"flex items-center gap-2",children:[e.jsx(W,{className:"w-4 h-4"}),"Tarifa por Hora (MXN)"]}),e.jsx(o,{children:e.jsx(m,{type:"number",step:"0.01",placeholder:"250.00",...s,onChange:a=>s.onChange(parseFloat(a.target.value)||0)})}),e.jsx(t,{})]})}),e.jsx(i,{control:r.control,name:"minimumHours",render:({field:s})=>e.jsxs(l,{children:[e.jsxs(c,{className:"flex items-center gap-2",children:[e.jsx(I,{className:"w-4 h-4"}),"Horas Mínimas de Reserva"]}),e.jsx(o,{children:e.jsx(m,{type:"number",placeholder:"2",...s,onChange:a=>s.onChange(parseInt(a.target.value)||1)})}),e.jsx(t,{})]})}),e.jsx(i,{control:r.control,name:"maximumHours",render:({field:s})=>e.jsxs(l,{children:[e.jsxs(c,{className:"flex items-center gap-2",children:[e.jsx(I,{className:"w-4 h-4"}),"Horas Máximas de Reserva"]}),e.jsx(o,{children:e.jsx(m,{type:"number",placeholder:"8",...s,onChange:a=>s.onChange(parseInt(a.target.value)||1)})}),e.jsx(t,{})]})}),e.jsx(i,{control:r.control,name:"advanceBookingDays",render:({field:s})=>e.jsxs(l,{children:[e.jsx(c,{children:"Días de Anticipación para Reserva"}),e.jsx(o,{children:e.jsx(m,{type:"number",placeholder:"30",...s,onChange:a=>s.onChange(parseInt(a.target.value)||1)})}),e.jsx(t,{})]})})]}),e.jsx(i,{control:r.control,name:"amenities",render:({field:s})=>e.jsxs(l,{children:[e.jsx(c,{children:"Amenidades Incluidas"}),e.jsx(o,{children:e.jsx(g,{placeholder:"Ej: Electricidad, agua potable, mesas, sillas, estacionamiento...",className:"min-h-[80px]",...s})}),e.jsx(t,{})]})}),e.jsx(i,{control:r.control,name:"rules",render:({field:s})=>e.jsxs(l,{children:[e.jsx(c,{children:"Reglas y Restricciones"}),e.jsx(o,{children:e.jsx(g,{placeholder:"Ej: Prohibido el consumo de alcohol, música hasta las 20:00 hrs...",className:"min-h-[80px]",...s})}),e.jsx(t,{})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(i,{control:r.control,name:"isActive",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(c,{className:"text-base",children:"Espacio Activo"}),e.jsx("div",{className:"text-sm text-gray-600",children:"El espacio estará disponible para reservas públicas"})]}),e.jsx(o,{children:e.jsx(A,{checked:s.value,onCheckedChange:s.onChange})})]})}),e.jsx(i,{control:r.control,name:"requiresApproval",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(c,{className:"text-base",children:"Requiere Aprobación"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Las reservas deben ser aprobadas manualmente"})]}),e.jsx(o,{children:e.jsx(A,{checked:s.value,onCheckedChange:s.onChange})})]})})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-6 border-t",children:[e.jsx(p,{type:"button",variant:"outline",onClick:()=>h("/admin/space-reservations/spaces"),children:"Cancelar"}),e.jsx(p,{type:"submit",disabled:j.isPending,className:"bg-green-600 hover:bg-green-700",children:j.isPending?"Creando...":"Crear Espacio"})]})]})})})]}),e.jsxs(N,{"data-section":"multimedia",children:[e.jsxs(C,{children:[e.jsxs(f,{className:"flex items-center gap-2",children:[e.jsx(G,{className:"w-5 h-5 text-blue-600"}),"Multimedia del Espacio"]}),e.jsx(k,{children:x?"Agrega imágenes y documentos al espacio reservable":"Una vez creado el espacio, podrás agregar imágenes y documentos aquí"})]}),e.jsx(E,{children:x?e.jsxs(e.Fragment,{children:[e.jsx(Y,{spaceId:x,isEditMode:!0}),e.jsxs("div",{className:"flex justify-end gap-3 pt-6 border-t mt-6",children:[e.jsx(p,{type:"button",variant:"outline",onClick:()=>h("/admin/space-reservations/spaces"),children:"Finalizar y Volver a la Lista"}),e.jsx(p,{type:"button",onClick:()=>h(`/admin/space-reservations/spaces/edit/${x}`),className:"bg-blue-600 hover:bg-blue-700",children:"Continuar Editando"})]})]}):e.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-lg border-2 border-dashed border-gray-300",children:[e.jsx("div",{className:"mx-auto w-12 h-12 text-gray-400 mb-4",children:e.jsx("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",className:"w-full h-full",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Multimedia no disponible aún"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Primero debes crear el espacio reservable para poder agregar imágenes y documentos."}),e.jsx("p",{className:"text-sm text-gray-500",children:'Completa el formulario de arriba y haz clic en "Crear Espacio" para habilitar esta sección.'})]})})]})]})})}export{re as default};
