import{aw as F,Y as p,a6 as Y,u as Z,a8 as _,j as e,aB as P,aA as j,B as d,C as N,c as v,x as G,ah as J,bv as E,a as R,b as q,a3 as A,bu as W,bI as X,f as K,br as ee,b0 as I,b3 as $,ay as se,M as ae,co as ne,ak as ie,am as te,aD as re,h as M,ai as O,cp as T,U,b5 as ce,m as o}from"./index-BBGHPKhn.js";import{C as g}from"./checkbox-DK4Ni3Jp.js";import{R as le}from"./rotate-ccw-CYLnTdL1.js";import{S as de}from"./save-BO66L-dX.js";import{T as oe}from"./trending-down-_xwArPfc.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=F("Box",[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]),xe={dashboard:{name:"Dashboard",icon:se,path:"/admin",children:{}},operations:{name:"Operaciones",icon:ae,children:{parks:{name:"Parques",icon:ne,path:"/admin/parks"},assets:{name:"Activos",icon:me,path:"/admin/assets"},incidents:{name:"Incidentes",icon:G,path:"/admin/incidents"}}},finance:{name:"Finanzas",icon:ie,children:{catalog:{name:"Catálogo",icon:te,path:"/admin/finance/catalog"},incomes:{name:"Ingresos",icon:re,path:"/admin/finance/incomes"},expenses:{name:"Egresos",icon:oe,path:"/admin/finance/expenses"}}},activities:{name:"Actividades",icon:M,children:{list:{name:"Listado",icon:O,path:"/admin/activities"},calendar:{name:"Calendario",icon:M,path:"/admin/activities/calendar"},instructors:{name:"Instructores",icon:T,path:"/admin/instructors"}}},users:{name:"Personal",icon:U,path:"/admin/users",children:{}},settings:{name:"Configuración",icon:ce,path:"/admin/settings",children:{}}},D=[{id:"admin",name:"Administrador",color:"bg-red-100 text-red-800",icon:j},{id:"director",name:"Director",color:"bg-purple-100 text-purple-800",icon:o},{id:"manager",name:"Manager",color:"bg-blue-100 text-blue-800",icon:U},{id:"instructor",name:"Instructor",color:"bg-green-100 text-green-800",icon:T},{id:"supervisor",name:"Supervisor",color:"bg-yellow-100 text-yellow-800",icon:O},{id:"user",name:"Usuario",color:"bg-gray-100 text-gray-800",icon:o},{id:"ciudadano",name:"Ciudadano",color:"bg-indigo-100 text-indigo-800",icon:o},{id:"voluntario",name:"Voluntario",color:"bg-teal-100 text-teal-800",icon:o},{id:"guardaparques",name:"Guardaparques",color:"bg-emerald-100 text-emerald-800",icon:j},{id:"guardia",name:"Guardia",color:"bg-orange-100 text-orange-800",icon:j},{id:"concesionario",name:"Concesionario",color:"bg-pink-100 text-pink-800",icon:o}],fe=()=>{var S;const[C,u]=p.useState({}),[t,B]=p.useState("admin"),[b,f]=p.useState(!1),L=Y(),{data:l,isLoading:H}=Z({queryKey:["/api/role-permissions"],enabled:!0});p.useEffect(()=>{l&&u(l)},[l]);const m=_({mutationFn:async s=>J("/api/role-permissions",{method:"PUT",data:s}),onSuccess:()=>{E({title:"Permisos guardados exitosamente"}),f(!1),L.invalidateQueries({queryKey:["/api/role-permissions"]})},onError:()=>{E({title:"Error al guardar permisos",variant:"destructive"})}}),x=(s,a,n)=>{const r=n?`${s}.${n}`:s;u(i=>{var c;return{...i,[t]:{...i[t],[`${r}.${a}`]:!((c=i[t])!=null&&c[`${r}.${a}`])}}}),f(!0)},h=(s,a,n)=>{var i;const r=n?`${s}.${n}`:s;return((i=C[t])==null?void 0:i[`${r}.${a}`])||!1},y=()=>{l&&(u(l),f(!1))},w=()=>{m.mutate(C)},k=()=>D.find(s=>s.id===t),V=()=>e.jsxs(N,{children:[e.jsxs(R,{children:[e.jsx(q,{className:"text-xl",children:"Seleccionar Rol"}),e.jsx(A,{children:"Elige el rol del cual deseas configurar los permisos de acceso"})]}),e.jsx(v,{children:e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-3",children:D.map(s=>{const a=s.icon;return e.jsxs(d,{variant:t===s.id?"default":"outline",className:W("h-auto p-4 flex flex-col items-center gap-2 transition-all",t===s.id&&"ring-2 ring-blue-500"),onClick:()=>B(s.id),children:[e.jsx(a,{className:"w-6 h-6"}),e.jsx("span",{className:"text-xs font-medium text-center",children:s.name}),t===s.id&&e.jsx(X,{className:"w-4 h-4 text-green-600"})]},s.id)})})})]}),z=()=>{const s=k();return s?e.jsxs(N,{children:[e.jsxs(R,{children:[e.jsxs(q,{className:"flex items-center gap-3",children:[e.jsxs(K,{className:s.color,variant:"secondary",children:[e.jsx(s.icon,{className:"w-4 h-4 mr-2"}),s.name]}),e.jsx("span",{className:"text-lg",children:"Configuración de Permisos"})]}),e.jsx(A,{children:"Configura qué secciones del dashboard puede acceder este rol"})]}),e.jsx(v,{children:e.jsx(ee,{className:"h-[600px] pr-4",children:e.jsx("div",{className:"space-y-6",children:Object.entries(xe).map(([a,n])=>{const r=n.icon;return e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(r,{className:"w-6 h-6 text-blue-600"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg",children:n.name}),e.jsx("p",{className:"text-sm text-gray-600",children:n.path?`Ruta: ${n.path}`:"Módulo principal"})]})]}),Object.keys(n.children||{}).length===0&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(g,{checked:h(a,"view"),onCheckedChange:()=>x(a,"view"),className:"h-4 w-4"}),e.jsxs("div",{className:"flex items-center gap-1 text-sm text-gray-600",children:[e.jsx(I,{className:"w-3 h-3"}),e.jsx("span",{children:"Ver"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(g,{checked:h(a,"edit"),onCheckedChange:()=>x(a,"edit"),className:"h-4 w-4"}),e.jsxs("div",{className:"flex items-center gap-1 text-sm text-gray-600",children:[e.jsx($,{className:"w-3 h-3"}),e.jsx("span",{children:"Editar"})]})]})]})]}),Object.keys(n.children||{}).length>0&&e.jsx("div",{className:"ml-6 space-y-3",children:Object.entries(n.children||{}).map(([i,c])=>{const Q=c.icon;return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-md",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Q,{className:"w-5 h-5 text-gray-600"}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:c.name}),e.jsx("p",{className:"text-sm text-gray-500",children:c.path})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(g,{checked:h(a,"view",i),onCheckedChange:()=>x(a,"view",i),className:"h-4 w-4"}),e.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600",children:[e.jsx(I,{className:"w-3 h-3"}),e.jsx("span",{children:"Ver"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(g,{checked:h(a,"edit",i),onCheckedChange:()=>x(a,"edit",i),className:"h-4 w-4"}),e.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600",children:[e.jsx($,{className:"w-3 h-3"}),e.jsx("span",{children:"Editar"})]})]})]})]},i)})})]},a)})})})})]}):null};return H?e.jsx(P,{children:e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"text-center",children:"Cargando permisos..."})})}):e.jsx(P,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(j,{className:"w-8 h-8"}),"Gestión de Permisos"]}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Selecciona un rol y configura qué secciones del dashboard puede acceder"})]}),b&&e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(d,{variant:"outline",onClick:y,className:"flex items-center gap-2",children:[e.jsx(le,{className:"w-4 h-4"}),"Revertir"]}),e.jsxs(d,{onClick:w,disabled:m.isPending,className:"flex items-center gap-2",children:[e.jsx(de,{className:"w-4 h-4"}),m.isPending?"Guardando...":"Guardar Cambios"]})]})]}),V(),z(),b&&e.jsx(N,{className:"border-yellow-200 bg-yellow-50",children:e.jsx(v,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(G,{className:"w-5 h-5 text-yellow-600"}),e.jsxs("span",{className:"text-yellow-800 font-medium",children:["Hay cambios sin guardar en los permisos del rol ",(S=k())==null?void 0:S.name]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(d,{variant:"outline",size:"sm",onClick:y,children:"Revertir"}),e.jsx(d,{size:"sm",onClick:w,disabled:m.isPending,children:"Guardar"})]})]})})})]})})};export{fe as default};
