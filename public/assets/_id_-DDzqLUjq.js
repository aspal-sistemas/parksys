import{az as T,k as z,l as B,ae as K,af as V,u as k,a2 as _,ag as Q,j as e,aX as v,f as b,i as y,K as U,B as j,A as $,g as A,h as S,M as G,ab as q,ai as J,aj as c,ak as l,al as o,am as t,O as x,an as d,Q as w,V as I,W as L,Y as H,_ as m,U as X,as as O,n as D,$ as N,br as M,ad as i,ap as W,aq as Y}from"./index-D5qLf1ib.js";import{S as Z}from"./SpaceMediaManager-BPIuC-1B.js";const ee=i.object({name:i.string().min(1,"El nombre es obligatorio"),description:i.string().min(1,"La descripción es obligatoria"),parkId:i.string().min(1,"Debe seleccionar un parque"),spaceType:i.string().min(1,"Debe seleccionar un tipo de espacio"),capacity:i.number().min(1,"La capacidad debe ser mayor a 0"),hourlyRate:i.number().min(0,"La tarifa debe ser mayor o igual a 0"),minimumHours:i.number().min(1,"Las horas mínimas deben ser mayor a 0"),maximumHours:i.number().min(1,"Las horas máximas deben ser mayor a 0"),amenities:i.string().optional(),rules:i.string().optional(),isActive:i.boolean(),requiresApproval:i.boolean(),advanceBookingDays:i.number().min(1,"Los días de anticipación deben ser mayor a 0")});function re(){const[,h]=T(),{id:p}=z(),{toast:g}=B(),C=K(),s=V({resolver:W(ee),defaultValues:{name:"",description:"",parkId:"",spaceType:"",capacity:1,hourlyRate:0,minimumHours:1,maximumHours:8,amenities:"",rules:"",isActive:!0,requiresApproval:!1,advanceBookingDays:30}}),{data:r,isLoading:R}=k({queryKey:[`/api/reservable-spaces/${p}`],enabled:!!p}),{data:f=[],isLoading:F}=k({queryKey:["/api/parks?simple=true"]}),E=Array.isArray(f)?f:[];_.useEffect(()=>{r&&s.reset({name:r.name,description:r.description,parkId:r.parkId.toString(),spaceType:r.spaceType,capacity:r.capacity,hourlyRate:parseFloat(r.hourlyRate),minimumHours:r.minimumHours,maximumHours:r.maximumHours,amenities:r.amenities||"",rules:r.rules||"",isActive:r.isActive,requiresApproval:r.requiresApproval,advanceBookingDays:r.advanceBookingDays})},[r,s]);const u=Q({mutationFn:async a=>await Y(`/api/reservable-spaces/${p}`,{method:"PUT",data:{...a,parkId:parseInt(a.parkId)}}),onSuccess:()=>{g({title:"Espacio actualizado",description:"El espacio reservable ha sido actualizado exitosamente"}),C.invalidateQueries({queryKey:["/api/reservable-spaces"]}),C.invalidateQueries({queryKey:[`/api/reservable-spaces/${p}`]}),h("/admin/space-reservations/spaces")},onError:a=>{g({title:"Error",description:a.message||"Error al actualizar el espacio",variant:"destructive"})}}),P=a=>{if(a.maximumHours<=a.minimumHours){g({title:"Error de validación",description:"Las horas máximas deben ser mayores que las horas mínimas",variant:"destructive"});return}u.mutate(a)};return R?e.jsx(v,{children:e.jsx("div",{className:"p-6 max-w-4xl mx-auto",children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Cargando espacio..."})]})})})}):r?e.jsx(v,{children:e.jsxs("div",{className:"p-6 max-w-4xl mx-auto",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"flex items-center gap-3 mb-2",children:e.jsxs(j,{variant:"ghost",size:"sm",onClick:()=>h("/admin/space-reservations/spaces"),className:"flex items-center gap-2",children:[e.jsx($,{className:"w-4 h-4"}),"Volver"]})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Editar Espacio Reservable"}),e.jsxs("p",{className:"text-gray-600",children:["Modifica la información del espacio: ",r.name]})]}),e.jsxs(b,{children:[e.jsxs(A,{children:[e.jsxs(S,{className:"flex items-center gap-2",children:[e.jsx(G,{className:"w-5 h-5 text-green-600"}),"Información del Espacio"]}),e.jsx(q,{children:"Actualiza las características y reglas del espacio reservable"})]}),e.jsx(y,{children:e.jsx(J,{...s,children:e.jsxs("form",{onSubmit:s.handleSubmit(P),className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(c,{control:s.control,name:"name",render:({field:a})=>e.jsxs(l,{children:[e.jsx(o,{children:"Nombre del Espacio"}),e.jsx(t,{children:e.jsx(x,{placeholder:"Ej: Kiosco Principal",...a})}),e.jsx(d,{})]})}),e.jsx(c,{control:s.control,name:"parkId",render:({field:a})=>e.jsxs(l,{children:[e.jsx(o,{children:"Parque"}),e.jsxs(w,{onValueChange:a.onChange,value:a.value,children:[e.jsx(t,{children:e.jsx(I,{children:e.jsx(L,{placeholder:"Seleccionar parque"})})}),e.jsx(H,{children:F?e.jsx(m,{value:"loading",disabled:!0,children:"Cargando parques..."}):E.length>0?E.map(n=>e.jsx(m,{value:n.id.toString(),children:n.name},n.id)):e.jsx(m,{value:"no-parks",disabled:!0,children:"No hay parques disponibles"})})]}),e.jsx(d,{})]})}),e.jsx(c,{control:s.control,name:"spaceType",render:({field:a})=>e.jsxs(l,{children:[e.jsx(o,{children:"Tipo de Espacio"}),e.jsxs(w,{onValueChange:a.onChange,value:a.value,children:[e.jsx(t,{children:e.jsx(I,{children:e.jsx(L,{placeholder:"Selecciona el tipo de espacio"})})}),e.jsxs(H,{children:[e.jsx(m,{value:"kiosco",children:"Kiosco"}),e.jsx(m,{value:"area_juegos",children:"Área de Juegos"}),e.jsx(m,{value:"picnic",children:"Área de Picnic"}),e.jsx(m,{value:"jardin_eventos",children:"Jardín de Eventos"}),e.jsx(m,{value:"pabellon",children:"Pabellón"}),e.jsx(m,{value:"cancha_deportiva",children:"Cancha Deportiva"}),e.jsx(m,{value:"anfiteatro",children:"Anfiteatro"}),e.jsx(m,{value:"salon_usos_multiples",children:"Salón de Usos Múltiples"})]})]}),e.jsx(d,{})]})}),e.jsx(c,{control:s.control,name:"capacity",render:({field:a})=>e.jsxs(l,{children:[e.jsxs(o,{className:"flex items-center gap-2",children:[e.jsx(X,{className:"w-4 h-4"}),"Capacidad Máxima"]}),e.jsx(t,{children:e.jsx(x,{type:"number",placeholder:"50",...a,onChange:n=>a.onChange(parseInt(n.target.value)||0)})}),e.jsx(d,{})]})}),e.jsx(c,{control:s.control,name:"hourlyRate",render:({field:a})=>e.jsxs(l,{children:[e.jsxs(o,{className:"flex items-center gap-2",children:[e.jsx(O,{className:"w-4 h-4"}),"Tarifa por Hora (MXN)"]}),e.jsx(t,{children:e.jsx(x,{type:"number",step:"0.01",placeholder:"250.00",...a,onChange:n=>a.onChange(parseFloat(n.target.value)||0)})}),e.jsx(d,{})]})}),e.jsx(c,{control:s.control,name:"minimumHours",render:({field:a})=>e.jsxs(l,{children:[e.jsxs(o,{className:"flex items-center gap-2",children:[e.jsx(D,{className:"w-4 h-4"}),"Horas Mínimas de Reserva"]}),e.jsx(t,{children:e.jsx(x,{type:"number",placeholder:"2",...a,onChange:n=>a.onChange(parseInt(n.target.value)||1)})}),e.jsx(d,{})]})}),e.jsx(c,{control:s.control,name:"maximumHours",render:({field:a})=>e.jsxs(l,{children:[e.jsxs(o,{className:"flex items-center gap-2",children:[e.jsx(D,{className:"w-4 h-4"}),"Horas Máximas de Reserva"]}),e.jsx(t,{children:e.jsx(x,{type:"number",placeholder:"8",...a,onChange:n=>a.onChange(parseInt(n.target.value)||1)})}),e.jsx(d,{})]})}),e.jsx(c,{control:s.control,name:"advanceBookingDays",render:({field:a})=>e.jsxs(l,{children:[e.jsx(o,{children:"Días de Anticipación para Reserva"}),e.jsx(t,{children:e.jsx(x,{type:"number",placeholder:"30",...a,onChange:n=>a.onChange(parseInt(n.target.value)||1)})}),e.jsx(d,{})]})})]}),e.jsx(c,{control:s.control,name:"description",render:({field:a})=>e.jsxs(l,{children:[e.jsx(o,{children:"Descripción"}),e.jsx(t,{children:e.jsx(N,{placeholder:"Describe las características principales del espacio...",className:"min-h-[100px]",...a})}),e.jsx(d,{})]})}),e.jsx(c,{control:s.control,name:"amenities",render:({field:a})=>e.jsxs(l,{children:[e.jsx(o,{children:"Amenidades Incluidas"}),e.jsx(t,{children:e.jsx(N,{placeholder:"Ej: Electricidad, agua potable, mesas, sillas, estacionamiento...",className:"min-h-[80px]",...a})}),e.jsx(d,{})]})}),e.jsx(c,{control:s.control,name:"rules",render:({field:a})=>e.jsxs(l,{children:[e.jsx(o,{children:"Reglas y Restricciones"}),e.jsx(t,{children:e.jsx(N,{placeholder:"Ej: Prohibido el consumo de alcohol, música hasta las 20:00 hrs...",className:"min-h-[80px]",...a})}),e.jsx(d,{})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(c,{control:s.control,name:"isActive",render:({field:a})=>e.jsxs(l,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(o,{className:"text-base",children:"Espacio Activo"}),e.jsx("div",{className:"text-sm text-gray-600",children:"El espacio estará disponible para reservas públicas"})]}),e.jsx(t,{children:e.jsx(M,{checked:a.value,onCheckedChange:a.onChange})})]})}),e.jsx(c,{control:s.control,name:"requiresApproval",render:({field:a})=>e.jsxs(l,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(o,{className:"text-base",children:"Requiere Aprobación"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Las reservas deben ser aprobadas manualmente"})]}),e.jsx(t,{children:e.jsx(M,{checked:a.value,onCheckedChange:a.onChange})})]})})]}),e.jsxs("div",{className:"flex gap-4 pt-6",children:[e.jsx(j,{type:"button",variant:"outline",onClick:()=>h("/admin/space-reservations/spaces"),className:"flex-1",disabled:u.isPending,children:"Cancelar"}),e.jsx(j,{type:"submit",className:"flex-1 bg-green-600 hover:bg-green-700",disabled:u.isPending,children:u.isPending?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin w-4 h-4 border-2 border-white border-t-transparent rounded-full mr-2"}),"Actualizando..."]}):"Guardar Cambios"})]})]})})})]}),e.jsxs(b,{children:[e.jsxs(A,{children:[e.jsx(S,{children:"Multimedia del Espacio"}),e.jsx(q,{children:"Gestiona las imágenes y documentos del espacio reservable"})]}),e.jsx(y,{children:e.jsx(Z,{spaceId:parseInt(p),isEditMode:!0})})]})]})}):e.jsx(v,{children:e.jsx("div",{className:"p-6 max-w-4xl mx-auto",children:e.jsx(b,{children:e.jsxs(y,{className:"p-6 text-center",children:[e.jsx(U,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Espacio no encontrado"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"El espacio que buscas no existe o ha sido eliminado."}),e.jsx(j,{onClick:()=>h("/admin/space-reservations/spaces"),variant:"outline",children:"Volver a la lista"})]})})})})}export{re as default};
