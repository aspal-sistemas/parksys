import{az as $,l as G,ae as q,af as O,ag as U,j as e,aX as Q,L as p,B as h,A as _,f as b,g as v,h as f,e as R,ab as N,i as y,ai as Z,aj as o,ak as i,al as c,Q as C,am as t,V as w,W as S,Y as A,_ as I,aF as d,O as E,an as m,$ as H,ao as K,bG as W,au as k,o as L,ad as n,b as X,Z as Y,a3 as J,bp as ee,U as ae,ap as se}from"./index-D5qLf1ib.js";import{C as re,G as le}from"./gem-dXiyKzl3.js";const ne=n.object({name:n.string().min(3,"El nombre debe tener al menos 3 caracteres").max(50,"El nombre no puede exceder 50 caracteres").regex(/^[a-z0-9-_]+$/,"Solo se permiten letras minúsculas, números, guiones y guiones bajos"),displayName:n.string().min(3,"El nombre para mostrar debe tener al menos 3 caracteres").max(100,"El nombre para mostrar no puede exceder 100 caracteres"),description:n.string().min(10,"La descripción debe tener al menos 10 caracteres").max(500,"La descripción no puede exceder 500 caracteres"),level:n.number().min(1,"El nivel debe ser al menos 1").max(10,"El nivel no puede exceder 10"),badgeColor:n.string(),badgeIcon:n.string(),isActive:n.boolean().default(!0),copyFromRole:n.string().optional(),templateType:n.string().optional()}),oe=[{value:"bg-red-500",label:"Rojo",color:"bg-red-500"},{value:"bg-blue-500",label:"Azul",color:"bg-blue-500"},{value:"bg-green-500",label:"Verde",color:"bg-green-500"},{value:"bg-purple-500",label:"Morado",color:"bg-purple-500"},{value:"bg-orange-500",label:"Naranja",color:"bg-orange-500"},{value:"bg-yellow-500",label:"Amarillo",color:"bg-yellow-500"},{value:"bg-teal-500",label:"Verde Azulado",color:"bg-teal-500"},{value:"bg-indigo-500",label:"Índigo",color:"bg-indigo-500"},{value:"bg-gray-500",label:"Gris",color:"bg-gray-500"}],V=[{value:"crown",label:"Corona",icon:e.jsx(re,{className:"w-4 h-4"})},{value:"star",label:"Estrella",icon:e.jsx(X,{className:"w-4 h-4"})},{value:"gem",label:"Gema",icon:e.jsx(le,{className:"w-4 h-4"})},{value:"zap",label:"Rayo",icon:e.jsx(Y,{className:"w-4 h-4"})},{value:"award",label:"Premio",icon:e.jsx(J,{className:"w-4 h-4"})},{value:"shield",label:"Escudo",icon:e.jsx(R,{className:"w-4 h-4"})},{value:"eye",label:"Ojo",icon:e.jsx(k,{className:"w-4 h-4"})},{value:"settings",label:"Configuración",icon:e.jsx(ee,{className:"w-4 h-4"})},{value:"users",label:"Usuarios",icon:e.jsx(ae,{className:"w-4 h-4"})}],F=[{value:"coordinator",label:"Coordinador",description:"Gestión y coordinación de áreas específicas",defaultLevel:7,defaultColor:"bg-blue-500",defaultIcon:"gem"},{value:"operator",label:"Operador",description:"Personal operativo y de campo",defaultLevel:4,defaultColor:"bg-orange-500",defaultIcon:"award"},{value:"admin",label:"Administrador",description:"Administración de módulos específicos",defaultLevel:6,defaultColor:"bg-purple-500",defaultIcon:"settings"},{value:"readonly",label:"Solo Lectura",description:"Acceso de consulta únicamente",defaultLevel:2,defaultColor:"bg-gray-500",defaultIcon:"eye"}];function te(){const[,T]=$(),{toast:j}=G(),z=q(),r=O({resolver:se(ne),defaultValues:{name:"",displayName:"",description:"",level:5,badgeColor:"bg-blue-500",badgeIcon:"shield",isActive:!0}}),x=U({mutationFn:async s=>(await new Promise(a=>setTimeout(a,1500)),console.log("Creando rol:",s),{success:!0,id:`role-${Date.now()}`}),onSuccess:s=>{z.invalidateQueries({queryKey:["/api/admin-roles/roles"]}),j({title:"Rol creado exitosamente",description:"El nuevo rol se ha creado y está disponible para asignación."}),T("/admin-roles/roles")},onError:s=>{j({title:"Error al crear rol",description:s.message,variant:"destructive"})}}),D=s=>{x.mutate(s)},B=s=>{const a=F.find(l=>l.value===s);a&&(r.setValue("level",a.defaultLevel),r.setValue("badgeColor",a.defaultColor),r.setValue("badgeIcon",a.defaultIcon),r.setValue("description",a.description))},M=()=>{var g;const s=r.watch("badgeColor"),a=r.watch("badgeIcon"),l=(g=V.find(P=>P.value===a))==null?void 0:g.icon,u=r.watch("displayName")||"Nuevo Rol";return e.jsxs("div",{className:`inline-flex items-center gap-2 px-3 py-1 rounded-lg ${s} text-white`,children:[l,e.jsx("span",{className:"text-sm font-medium",children:u})]})};return e.jsx(Q,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(p,{href:"/admin-roles/roles",children:e.jsxs(h,{variant:"outline",size:"sm",children:[e.jsx(_,{className:"w-4 h-4 mr-2"}),"Volver"]})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Crear Nuevo Rol"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Define un nuevo rol con permisos específicos para el sistema"})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs(b,{children:[e.jsxs(v,{children:[e.jsxs(f,{className:"flex items-center gap-2",children:[e.jsx(R,{className:"h-5 w-5"}),"Información del Rol"]}),e.jsx(N,{children:"Configura los datos básicos del nuevo rol"})]}),e.jsx(y,{children:e.jsx(Z,{...r,children:e.jsxs("form",{onSubmit:r.handleSubmit(D),className:"space-y-6",children:[e.jsx(o,{control:r.control,name:"templateType",render:({field:s})=>e.jsxs(i,{children:[e.jsx(c,{children:"Plantilla Base (Opcional)"}),e.jsxs(C,{onValueChange:a=>{s.onChange(a),B(a)},children:[e.jsx(t,{children:e.jsx(w,{children:e.jsx(S,{placeholder:"Seleccionar plantilla..."})})}),e.jsx(A,{children:F.map(a=>e.jsx(I,{value:a.value,children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:a.label}),e.jsx("p",{className:"text-sm text-gray-500",children:a.description})]})},a.value))})]}),e.jsx(d,{children:"Usa una plantilla para configurar valores por defecto"})]})}),e.jsx(o,{control:r.control,name:"name",render:({field:s})=>e.jsxs(i,{children:[e.jsx(c,{children:"Nombre del Sistema *"}),e.jsx(t,{children:e.jsx(E,{placeholder:"coordinador-marketing",...s,className:"font-mono"})}),e.jsx(d,{children:"Identificador único del rol (solo letras minúsculas, números y guiones)"}),e.jsx(m,{})]})}),e.jsx(o,{control:r.control,name:"displayName",render:({field:s})=>e.jsxs(i,{children:[e.jsx(c,{children:"Nombre para Mostrar *"}),e.jsx(t,{children:e.jsx(E,{placeholder:"Coordinador de Marketing",...s})}),e.jsx(d,{children:"Nombre que se mostrará en la interfaz de usuario"}),e.jsx(m,{})]})}),e.jsx(o,{control:r.control,name:"description",render:({field:s})=>e.jsxs(i,{children:[e.jsx(c,{children:"Descripción *"}),e.jsx(t,{children:e.jsx(H,{placeholder:"Descripción detallada de las responsabilidades y alcance del rol...",className:"resize-none",rows:4,...s})}),e.jsx(d,{children:"Explica las responsabilidades y funciones de este rol"}),e.jsx(m,{})]})}),e.jsx(o,{control:r.control,name:"level",render:({field:s})=>{var a;return e.jsxs(i,{children:[e.jsx(c,{children:"Nivel de Autoridad *"}),e.jsxs(C,{onValueChange:l=>s.onChange(parseInt(l)),defaultValue:(a=s.value)==null?void 0:a.toString(),children:[e.jsx(t,{children:e.jsx(w,{children:e.jsx(S,{})})}),e.jsx(A,{children:Array.from({length:10},(l,u)=>u+1).map(l=>e.jsxs(I,{value:l.toString(),children:["Nivel ",l," ",l===10?"(Máximo)":l===1?"(Mínimo)":""]},l))})]}),e.jsx(d,{children:"Define la jerarquía del rol (1 = menor autoridad, 10 = mayor autoridad)"}),e.jsx(m,{})]})}}),e.jsx(o,{control:r.control,name:"badgeColor",render:({field:s})=>e.jsxs(i,{children:[e.jsx(c,{children:"Color del Badge"}),e.jsx("div",{className:"grid grid-cols-3 gap-3",children:oe.map(a=>e.jsxs("div",{className:`cursor-pointer p-3 rounded-lg border-2 transition-all ${s.value===a.value?"border-gray-900 ring-2 ring-gray-200":"border-gray-200 hover:border-gray-300"}`,onClick:()=>s.onChange(a.value),children:[e.jsx("div",{className:`w-full h-8 rounded ${a.color} mb-2`}),e.jsx("p",{className:"text-sm text-center font-medium",children:a.label})]},a.value))}),e.jsx(m,{})]})}),e.jsx(o,{control:r.control,name:"badgeIcon",render:({field:s})=>e.jsxs(i,{children:[e.jsx(c,{children:"Icono del Badge"}),e.jsx("div",{className:"grid grid-cols-3 gap-3",children:V.map(a=>e.jsxs("div",{className:`cursor-pointer p-3 rounded-lg border-2 transition-all ${s.value===a.value?"border-gray-900 ring-2 ring-gray-200":"border-gray-200 hover:border-gray-300"}`,onClick:()=>s.onChange(a.value),children:[e.jsx("div",{className:"flex justify-center mb-2 text-gray-600",children:a.icon}),e.jsx("p",{className:"text-sm text-center font-medium",children:a.label})]},a.value))}),e.jsx(m,{})]})}),e.jsx(o,{control:r.control,name:"isActive",render:({field:s})=>e.jsxs(i,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(c,{className:"text-base",children:"Rol Activo"}),e.jsx(d,{children:"El rol estará disponible para asignación inmediatamente"})]}),e.jsx(t,{children:e.jsx(K,{checked:s.value,onCheckedChange:s.onChange})})]})}),e.jsxs("div",{className:"flex justify-end gap-3 pt-6 border-t",children:[e.jsx(p,{href:"/admin-roles/roles",children:e.jsx(h,{variant:"outline",children:"Cancelar"})}),e.jsx(h,{type:"submit",disabled:x.isPending,children:x.isPending?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 mr-2 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Creando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(W,{className:"w-4 h-4 mr-2"}),"Crear Rol"]})})]})]})})})]})}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs(b,{className:"sticky top-6",children:[e.jsxs(v,{children:[e.jsxs(f,{className:"flex items-center gap-2",children:[e.jsx(k,{className:"h-5 w-5"}),"Vista Previa"]}),e.jsx(N,{children:"Cómo se verá el rol en el sistema"})]}),e.jsxs(y,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Badge:"}),e.jsx("div",{className:"flex justify-center",children:M()})]}),e.jsxs("div",{className:"space-y-3 p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Nombre:"}),e.jsx("p",{className:"text-gray-900",children:r.watch("displayName")||"Sin nombre"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Descripción:"}),e.jsx("p",{className:"text-sm text-gray-600",children:r.watch("description")||"Sin descripción"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Nivel:"}),e.jsxs(L,{variant:"outline",children:["Nivel ",r.watch("level")]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Estado:"}),e.jsx(L,{variant:r.watch("isActive")?"default":"secondary",children:r.watch("isActive")?"Activo":"Inactivo"})]})]}),e.jsxs("div",{className:"text-sm text-gray-600 space-y-2",children:[e.jsxs("p",{children:["💡 ",e.jsx("strong",{children:"Tip:"})," Después de crear el rol, podrás configurar los permisos específicos."]}),e.jsx("p",{children:"⚠️ El nombre del sistema no puede cambiarse después de la creación."})]})]})]})})]})]})})}export{te as default};
