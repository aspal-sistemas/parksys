import{d as z,al as A,e as w,a6 as P,u as _,a7 as L,ag as R,a8 as B,j as e,B as c,aB as T,A as D,C as m,a as v,b as h,c as x,y as t,I as n,O as d,z as p,H as j,J as b,K as g,N as f,ap as V,a5 as o}from"./index-BBGHPKhn.js";import{S as M}from"./save-BO66L-dX.js";const G=o.object({titulo:o.string().min(5,"Título debe tener al menos 5 caracteres"),descripcion:o.string().min(10,"Descripción debe tener al menos 10 caracteres"),categoria:o.string().min(1,"Categoría requerida"),fechaEvento:o.string().min(1,"Fecha requerida"),horaInicio:o.string().min(1,"Hora de inicio requerida"),horaFin:o.string().min(1,"Hora de fin requerida"),numeroAsistentes:o.number().min(1,"Debe haber al menos 1 asistente"),status:o.enum(["borrador","solicitado","en_revision","aprobado","rechazado","cancelado","realizado"]),parqueId:o.number().min(1,"Debe seleccionar un parque"),zonasRequeridas:o.string().optional(),equipamiento:o.string().optional(),observaciones:o.string().optional()}),H=[{value:"evento_familiar",label:"Evento Familiar"},{value:"sesion_fotografia",label:"Sesión Fotográfica"},{value:"convivencia_escolar",label:"Convivencia Escolar"},{value:"sendero_interpretativo",label:"Sendero Interpretativo"},{value:"recorrido_educativo",label:"Recorrido Educativo"}],$=[{value:"evento_masivo",label:"Evento Masivo"},{value:"evento_comercial",label:"Evento Comercial"},{value:"evento_cooperativo",label:"Evento Cooperativo"},{value:"carrera_deportiva",label:"Carrera Deportiva"},{value:"actividad_fisica_grupal",label:"Actividad Física Grupal"},{value:"evento_corporativo",label:"Evento Corporativo"}],O=[{value:"borrador",label:"Borrador"},{value:"solicitado",label:"Solicitado"},{value:"en_revision",label:"En Revisión"},{value:"aprobado",label:"Aprobado"},{value:"rechazado",label:"Rechazado"},{value:"cancelado",label:"Cancelado"},{value:"realizado",label:"Realizado"}],k=[{value:1,label:"Parque Metropolitano de Guadalajara"},{value:2,label:"Parque Deán o de La Liberación"},{value:3,label:"Parque González Gallo"},{value:4,label:"Bosque Los Colomos"},{value:5,label:"Parque Natural Huentitán"},{value:6,label:"Parque Agua Azul"},{value:7,label:"Parque Ávila Camacho"},{value:8,label:"Parque Puerta La Barranca"},{value:9,label:"Parque Morelos"},{value:10,label:"Parque Alcalde"},{value:11,label:"Bosque Urbano Tlaquepaque"},{value:12,label:"Parque Roberto Montenegro"},{value:13,label:"Parque General Luis Quintanar"}];function J(){var N;const i=z().id,[,l]=A(),{toast:q}=w(),y=P(),{data:s,isLoading:C}=_({queryKey:[`/api/eventos-ambu/${i}`],queryFn:async()=>{const r=await fetch(`/api/eventos-ambu/${i}`);if(!r.ok)throw new Error("Error al cargar evento");return r.json()}}),a=L({resolver:R(G),values:s!=null&&s.evento?{titulo:s.evento.titulo||"",descripcion:s.evento.descripcion||"",categoria:s.evento.categoria||"",fechaEvento:s.evento.fechaEvento||"",horaInicio:s.evento.horaInicio||"",horaFin:s.evento.horaFin||"",numeroAsistentes:s.evento.numeroAsistentes||1,status:s.evento.status||"borrador",parqueId:s.evento.parqueId||1,zonasRequeridas:s.evento.zonasRequeridas||"",equipamiento:s.evento.equipamiento||"",observaciones:s.evento.observaciones||""}:void 0}),u=B({mutationFn:async r=>{const E=await fetch(`/api/eventos-ambu/${i}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!E.ok)throw new Error("Error al actualizar evento");return E.json()},onSuccess:()=>{q({title:"Evento actualizado",description:"Los cambios se han guardado exitosamente"}),y.invalidateQueries({queryKey:[`/api/eventos-ambu/${i}`]}),y.invalidateQueries({queryKey:["/api/eventos-ambu"]}),l(`/admin/eventos-ambu/${i}`)},onError:r=>{q({title:"Error al actualizar",description:r.message||"Ocurrió un error inesperado",variant:"destructive"})}}),F=async r=>{await u.mutateAsync(r)};if(C)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Cargando evento..."})]})});if(!s)return e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{className:"text-red-600",children:"Evento no encontrado"}),e.jsx(c,{className:"mt-4",onClick:()=>l("/admin/eventos-ambu"),children:"Volver al listado"})]});const S=s.evento.impactoTipo,I=S==="bajo_impacto"?H:$;return e.jsx(T,{children:e.jsxs("div",{className:"container mx-auto py-6 max-w-4xl",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsxs(c,{variant:"outline",size:"sm",onClick:()=>l(`/admin/eventos-ambu/${i}`),children:[e.jsx(D,{className:"h-4 w-4 mr-2"}),"Volver"]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Editar Evento AMBU"}),e.jsxs("p",{className:"text-gray-600",children:["Modificar información del evento de ",S==="bajo_impacto"?"bajo":"alto"," impacto"]})]})]}),e.jsxs("form",{onSubmit:a.handleSubmit(F),className:"space-y-6",children:[e.jsxs(m,{children:[e.jsx(v,{children:e.jsx(h,{children:"Información Básica del Evento"})}),e.jsxs(x,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(t,{htmlFor:"titulo",children:"Título del evento *"}),e.jsx(n,{id:"titulo",...a.register("titulo"),placeholder:"Nombre descriptivo del evento"}),a.formState.errors.titulo&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:a.formState.errors.titulo.message})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"descripcion",children:"Descripción *"}),e.jsx(d,{id:"descripcion",...a.register("descripcion"),placeholder:"Descripción detallada del evento",rows:4}),a.formState.errors.descripcion&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:a.formState.errors.descripcion.message})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"categoria",children:"Categoría *"}),e.jsxs(p,{value:a.watch("categoria"),onValueChange:r=>a.setValue("categoria",r),children:[e.jsx(j,{children:e.jsx(b,{placeholder:"Seleccionar categoría"})}),e.jsx(g,{children:I.map(r=>e.jsx(f,{value:r.value,children:r.label},r.value))})]}),a.formState.errors.categoria&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:a.formState.errors.categoria.message})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"status",children:"Estado del evento *"}),e.jsxs(p,{value:a.watch("status"),onValueChange:r=>a.setValue("status",r),children:[e.jsx(j,{children:e.jsx(b,{placeholder:"Seleccionar estado"})}),e.jsx(g,{children:O.map(r=>e.jsx(f,{value:r.value,children:r.label},r.value))})]}),a.formState.errors.status&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:a.formState.errors.status.message})]})]})]}),e.jsxs(m,{children:[e.jsx(v,{children:e.jsx(h,{children:"Fecha y Ubicación"})}),e.jsxs(x,{className:"space-y-4",children:[e.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(t,{htmlFor:"fechaEvento",children:"Fecha del evento *"}),e.jsx(n,{id:"fechaEvento",type:"date",...a.register("fechaEvento")}),a.formState.errors.fechaEvento&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:a.formState.errors.fechaEvento.message})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"horaInicio",children:"Hora de inicio *"}),e.jsx(n,{id:"horaInicio",type:"time",...a.register("horaInicio")}),a.formState.errors.horaInicio&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:a.formState.errors.horaInicio.message})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"horaFin",children:"Hora de fin *"}),e.jsx(n,{id:"horaFin",type:"time",...a.register("horaFin")}),a.formState.errors.horaFin&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:a.formState.errors.horaFin.message})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(t,{htmlFor:"parqueId",children:"Bosque Urbano *"}),e.jsxs(p,{value:(N=a.watch("parqueId"))==null?void 0:N.toString(),onValueChange:r=>a.setValue("parqueId",parseInt(r)),children:[e.jsx(j,{children:e.jsx(b,{placeholder:"Seleccionar parque"})}),e.jsx(g,{children:k.map(r=>e.jsx(f,{value:r.value.toString(),children:r.label},r.value))})]}),a.formState.errors.parqueId&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:a.formState.errors.parqueId.message})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"numeroAsistentes",children:"Número de asistentes *"}),e.jsx(n,{id:"numeroAsistentes",type:"number",min:"1",...a.register("numeroAsistentes",{valueAsNumber:!0})}),a.formState.errors.numeroAsistentes&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:a.formState.errors.numeroAsistentes.message})]})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"zonasRequeridas",children:"Zonas requeridas"}),e.jsx(d,{id:"zonasRequeridas",...a.register("zonasRequeridas"),placeholder:"Especifique las zonas del parque que utilizará",rows:2})]})]})]}),e.jsxs(m,{children:[e.jsx(v,{children:e.jsx(h,{children:"Logística y Equipamiento"})}),e.jsxs(x,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(t,{htmlFor:"equipamiento",children:"Equipamiento y materiales"}),e.jsx(d,{id:"equipamiento",...a.register("equipamiento"),placeholder:"Describa el equipamiento, materiales y mobiliario que utilizará",rows:3})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"observaciones",children:"Observaciones adicionales"}),e.jsx(d,{id:"observaciones",...a.register("observaciones"),placeholder:"Comentarios, observaciones o notas especiales sobre el evento",rows:3})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-4",children:[e.jsxs(c,{type:"button",variant:"outline",onClick:()=>l(`/admin/eventos-ambu/${i}`),children:[e.jsx(V,{className:"h-4 w-4 mr-2"}),"Cancelar"]}),e.jsxs(c,{type:"submit",disabled:u.isPending,className:"bg-emerald-600 hover:bg-emerald-700",children:[e.jsx(M,{className:"h-4 w-4 mr-2"}),u.isPending?"Guardando...":"Guardar Cambios"]})]})]})]})})}export{J as default};
