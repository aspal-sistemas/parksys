import{Y as i,u as he,ap as A,aq as _,ar as G,j as e,ak as pe,z as v,H as f,J as w,K as C,N as t,B as o,as as X,at as ge,l as p,au as ue,av as $,C as J,a as je,b as be,a3 as Ne,c as K,aj as ye,f as Y,i as Q,M as W,m as Z,U as ee,D as ve,r as fe,t as we,v as Ce,w as De,h as Me,aw as ke,X as D}from"./index-Dzu3mJf5.js";import{P as Se}from"./PublicLayout-BIy-G5o-.js";import{e as Ie}from"./eachDayOfInterval-DXiyoVfy.js";import{g as Pe}from"./getDay-BGvNE9nu.js";import{p as m}from"./parseISO-CNPmwbB6.js";import{s as Fe}from"./subMonths-AhCjVDFT.js";const Ae="/assets/People_23-02_1752941117659-CaRTYBo1.jpg",ze=()=>{var L,B,U;const[l,T]=i.useState(new Date),[c,M]=i.useState(null),[r,se]=i.useState(null),[re,k]=i.useState(!1),[g,E]=i.useState("all"),[u,q]=i.useState("all"),[j,O]=i.useState("all"),[x,R]=i.useState("all"),{data:n=[],isLoading:ae}=he({queryKey:["/api/activities"]}),z=Array.from(new Set(n.map(s=>s.category||"Sin categoría"))),te=Array.from(new Set(n.map(s=>s.parkName||"Sin parque"))),S=new Map;n.filter(s=>s.instructorId&&s.instructorName).forEach(s=>{S.has(s.instructorId)||S.set(s.instructorId,{id:s.instructorId,name:s.instructorName||`Instructor ${s.instructorId}`})});const le=Array.from(S.values()).sort((s,a)=>s.name.localeCompare(a.name)),ie=()=>T(ke(l,1)),ce=()=>T(Fe(l,1)),b=s=>n.filter(a=>{if(!a.startDate||!G(m(a.startDate)))return!1;const N=m(a.startDate),P=$(s,N),h=g==="all"||a.category===g,d=u==="all"||a.parkName===u,F=j==="all"||a.instructorId&&a.instructorId.toString()===j;let y=!0;return x==="free"?y=!a.price||a.price===0:x==="paid"?y=a.price!==void 0&&a.price>0:x==="all"&&(y=!0),P&&h&&d&&F&&y}),V=s=>{se(s),k(!0)},ne=Ie({start:A(l),end:_(l)}),de=Pe(A(l)),oe=["Dom","Lun","Mar","Mié","Jue","Vie","Sáb"],H=s=>{if(s==null||s===0||s==="0.00")return"Gratis";const a=typeof s=="string"?parseFloat(s):s;return isNaN(a)||a===0?"Gratis":`$${a.toFixed(2)} MXN`},I=s=>{if(!s)return"bg-gray-100 text-gray-800 border-gray-200";switch(s.toLowerCase()){case"arte y cultura":return"bg-purple-100 text-purple-800 border-purple-200";case"deportes":case"deporte y bienestar":case"deportivo":return"bg-emerald-100 text-emerald-800 border-emerald-200";case"educación":case"educativo":return"bg-blue-100 text-blue-800 border-blue-200";case"recreación":case"recreación y bienestar":return"bg-amber-100 text-amber-800 border-amber-200";case"eventos de temporada":return"bg-red-100 text-red-800 border-red-200";case"naturaleza":case"naturaleza y ciencia":case"naturaleza, ciencia y conservación":return"bg-teal-100 text-teal-800 border-teal-200";case"fitness y ejercicio":return"bg-indigo-100 text-indigo-800 border-indigo-200";case"actividades familiares":return"bg-pink-100 text-pink-800 border-pink-200";case"comunidad":return"bg-violet-100 text-violet-800 border-violet-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}};n.length;const me=new Set(n.map(s=>s.parkName)).size,xe=n.filter(s=>{if(!s.startDate||!G(m(s.startDate)))return!1;const a=m(s.startDate);return a>=A(l)&&a<=_(l)}).length;return ae?e.jsx("div",{className:"min-h-screen bg-gray-50 py-12",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Cargando calendario..."})]})})}):e.jsx(Se,{children:e.jsxs("div",{className:"bg-gray-50",children:[e.jsxs("div",{className:"relative text-white",style:{backgroundImage:`url(${Ae})`,backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"},children:[e.jsx("div",{className:"absolute inset-0 bg-black/50"}),e.jsx("div",{className:"relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-24",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("h1",{className:"text-4xl md:text-6xl font-bold mb-6",children:["Calendario de ",e.jsx("span",{className:"text-yellow-300",children:"Actividades"})]}),e.jsx("p",{className:"text-xl md:text-2xl text-blue-100 max-w-3xl mx-auto",children:"Descubre eventos y actividades programadas en todos nuestros parques durante el mes"}),e.jsxs("div",{className:"mt-8 flex justify-center items-center space-x-8 text-blue-100",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold",children:xe}),e.jsx("div",{className:"text-sm",children:"Este Mes"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold",children:me}),e.jsx("div",{className:"text-sm",children:"Parques Activos"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold",children:z.length}),e.jsx("div",{className:"text-sm",children:"Categorías"})]})]})]})})]}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(pe,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Filtros de Búsqueda"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs(v,{value:g,onValueChange:E,children:[e.jsx(f,{className:"border-gray-200 focus:border-primary focus:ring-primary",children:e.jsx(w,{placeholder:"Categoría"})}),e.jsxs(C,{children:[e.jsx(t,{value:"all",children:"Todas las categorías"}),z.map(s=>e.jsx(t,{value:s,children:s},s))]})]}),e.jsxs(v,{value:u,onValueChange:q,children:[e.jsx(f,{className:"border-gray-200 focus:border-primary focus:ring-primary",children:e.jsx(w,{placeholder:"Parque"})}),e.jsxs(C,{children:[e.jsx(t,{value:"all",children:"Todos los parques"}),te.map(s=>e.jsx(t,{value:s,children:s},s))]})]}),e.jsxs(v,{value:j,onValueChange:O,children:[e.jsx(f,{className:"border-gray-200 focus:border-primary focus:ring-primary",children:e.jsx(w,{placeholder:"Instructor"})}),e.jsxs(C,{children:[e.jsx(t,{value:"all",children:"Todos los instructores"}),le.map(s=>e.jsx(t,{value:s.id.toString(),children:s.name},s.id))]})]}),e.jsxs(v,{value:x,onValueChange:R,children:[e.jsx(f,{className:"border-gray-200 focus:border-primary focus:ring-primary",children:e.jsx(w,{placeholder:"Precio"})}),e.jsxs(C,{children:[e.jsx(t,{value:"all",children:"Todos los precios"}),e.jsx(t,{value:"free",children:"Gratis"}),e.jsx(t,{value:"paid",children:"De pago"})]})]})]}),(g!=="all"||u!=="all"||j!=="all"||x!=="all")&&e.jsx("div",{className:"flex justify-center mt-4",children:e.jsxs(o,{variant:"outline",onClick:()=>{E("all"),q("all"),O("all"),R("all")},className:"text-primary border-primary hover:bg-primary hover:text-white",children:[e.jsx(X,{className:"h-4 w-4 mr-2"}),"Limpiar Filtros"]})})]})}),e.jsx("div",{className:"bg-white rounded-2xl shadow-sm border p-6 mb-8",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs(o,{variant:"outline",onClick:ce,className:"text-primary border-primary hover:bg-primary hover:text-white",children:[e.jsx(ge,{className:"h-4 w-4 mr-1"}),"Mes Anterior"]}),e.jsx("h2",{className:"text-2xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:p(l,"MMMM yyyy",{locale:D}).replace(/^\w/,s=>s.toUpperCase())}),e.jsxs(o,{variant:"outline",onClick:ie,className:"text-primary border-primary hover:bg-primary hover:text-white",children:["Mes Siguiente",e.jsx(ue,{className:"h-4 w-4 ml-1"})]})]})}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border overflow-hidden",children:[e.jsx("div",{className:"grid grid-cols-7 gap-0 bg-gradient-to-r from-blue-50 to-purple-50",children:oe.map(s=>e.jsx("div",{className:"text-center font-semibold text-sm py-4 text-gray-700 border-r border-gray-200 last:border-r-0",children:s},s))}),e.jsxs("div",{className:"grid grid-cols-7 gap-0",children:[Array.from({length:de}).map((s,a)=>e.jsx("div",{className:"h-32 bg-gray-50 border-r border-b border-gray-200"},`empty-${a}`)),ne.map(s=>{const a=b(s),N=a.length>0,P=c&&$(s,c),h=$(s,new Date);return e.jsxs("div",{className:`h-32 border-r border-b border-gray-200 p-2 overflow-hidden transition-all duration-200 ${N?"hover:bg-blue-50 cursor-pointer":"bg-gray-50/50"} ${P?"ring-2 ring-primary ring-inset bg-primary/5":""} ${h?"bg-gradient-to-br from-blue-50 to-purple-50":""}`,onClick:()=>{N&&M(s)},children:[e.jsxs("div",{className:`text-right text-sm font-semibold mb-1 ${h?"text-primary":"text-gray-700"}`,children:[p(s,"d"),h&&e.jsx("div",{className:"w-2 h-2 bg-primary rounded-full inline-block ml-1"})]}),e.jsxs("div",{className:"space-y-1 overflow-y-auto max-h-20 text-xs",children:[a.slice(0,2).map(d=>e.jsx("div",{className:`${I(d.category)} px-2 py-1 rounded-md truncate border cursor-pointer hover:shadow-sm transition-shadow`,onClick:F=>{F.stopPropagation(),V(d)},title:d.title,children:d.title},d.id)),a.length>2&&e.jsxs("div",{className:"text-center text-primary text-xs font-medium cursor-pointer hover:underline",onClick:()=>M(s),children:["+",a.length-2," más"]})]})]},s.toString())})]})]}),c&&e.jsxs(J,{className:"mt-8 border-0 shadow-lg",children:[e.jsx(je,{className:"bg-gradient-to-r from-blue-50 to-purple-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(be,{className:"text-xl text-gray-900",children:["Actividades para ",p(c,"EEEE d 'de' MMMM",{locale:D})]}),e.jsxs(Ne,{className:"text-gray-600",children:[b(c).length," actividades encontradas"]})]}),e.jsx(o,{variant:"ghost",size:"sm",onClick:()=>M(null),className:"text-gray-500 hover:text-gray-700",children:e.jsx(X,{className:"h-4 w-4"})})]})}),e.jsx(K,{className:"p-6",children:b(c).length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ye,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No hay actividades"}),e.jsx("p",{className:"text-gray-600",children:"No se encontraron actividades para esta fecha con los filtros seleccionados."})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:b(c).map(s=>e.jsx(J,{className:"cursor-pointer hover:shadow-md transition-all duration-200 border-l-4 border-l-primary",onClick:()=>V(s),children:e.jsxs(K,{className:"p-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsx("h3",{className:"font-semibold text-gray-900 line-clamp-2",children:s.title}),e.jsx(Y,{className:`${I(s.category)} ml-2 flex-shrink-0`,children:s.category})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center text-gray-600",children:[e.jsx(Q,{className:"h-4 w-4 mr-2 text-primary"}),e.jsx("span",{children:p(m(s.startDate),"HH:mm",{locale:D})})]}),e.jsxs("div",{className:"flex items-center text-gray-600",children:[e.jsx(W,{className:"h-4 w-4 mr-2 text-primary"}),e.jsx("span",{children:s.parkName})]}),s.instructorName&&e.jsxs("div",{className:"flex items-center text-gray-600",children:[e.jsx(Z,{className:"h-4 w-4 mr-2 text-primary"}),e.jsx("span",{children:s.instructorName})]}),(s.capacity||s.price!==void 0)&&e.jsxs("div",{className:"flex items-center justify-between pt-2 border-t border-gray-100",children:[s.capacity&&e.jsxs("div",{className:"flex items-center text-gray-600",children:[e.jsx(ee,{className:"h-4 w-4 mr-1 text-primary"}),e.jsxs("span",{className:"text-xs",children:[s.capacity," personas"]})]}),s.price!==void 0&&e.jsx("div",{className:"text-sm font-semibold text-primary",children:H(s.price)})]})]})]})},s.id))})})]}),e.jsx(ve,{open:re,onOpenChange:k,children:e.jsx(fe,{className:"sm:max-w-lg",children:r&&e.jsxs(e.Fragment,{children:[e.jsxs(we,{children:[e.jsx(Ce,{className:"text-xl text-gray-900",children:r.title}),e.jsx(De,{children:e.jsx(Y,{className:I(r.category),children:r.category})})]}),e.jsxs("div",{className:"space-y-4",children:[r.description&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Descripción"}),e.jsx("p",{className:"text-gray-600",children:r.description})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Fecha y Hora"}),e.jsxs("div",{className:"space-y-1 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Me,{className:"h-4 w-4 mr-2 text-primary"}),e.jsx("span",{children:p(m(r.startDate),"EEEE d 'de' MMMM",{locale:D})})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(Q,{className:"h-4 w-4 mr-2 text-primary"}),e.jsxs("span",{children:[r.startTime&&`Inicio: ${r.startTime}`,r.endTime&&` - Fin: ${r.endTime}`]})]}),r.duration&&e.jsxs("div",{className:"text-xs text-gray-500",children:["Duración: ",r.duration," minutos"]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Ubicación"}),e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsx(W,{className:"h-4 w-4 mr-2 text-primary"}),e.jsx("span",{children:r.parkName})]}),r.location&&e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:r.location})]})]}),r.instructorName&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Instructor"}),e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsx(Z,{className:"h-4 w-4 mr-2 text-primary"}),e.jsx("span",{children:r.instructorName})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.capacity&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Capacidad"}),e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsx(ee,{className:"h-4 w-4 mr-2 text-primary"}),e.jsxs("span",{children:[r.capacity," personas"]})]})]}),r.price!==void 0&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Precio"}),e.jsx("div",{className:"text-lg font-bold text-primary",children:H(r.price)})]})]}),(r.isRecurring||r.targetMarket||r.specialNeeds)&&e.jsxs("div",{className:"space-y-3 pt-4 border-t border-gray-100",children:[r.isRecurring&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-1",children:"Recurrencia"}),e.jsx("p",{className:"text-sm text-gray-600",children:((L=r.recurringDays)==null?void 0:L.length)>0?`Se repite: ${r.recurringDays.join(", ")}`:"Actividad recurrente"})]}),((B=r.targetMarket)==null?void 0:B.length)>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-1",children:"Público Objetivo"}),e.jsx("p",{className:"text-sm text-gray-600",children:r.targetMarket.join(", ")})]}),((U=r.specialNeeds)==null?void 0:U.length)>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-1",children:"Requerimientos Especiales"}),e.jsx("div",{className:"space-y-1",children:r.specialNeeds.map((s,a)=>e.jsxs("p",{className:"text-sm text-gray-600 flex items-center gap-2",children:[e.jsx("span",{className:"w-1 h-1 bg-gray-400 rounded-full"}),s]},a))})]})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(o,{className:"flex-1 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700",onClick:()=>{window.open(`/activity/${r.id}`,"_blank")},children:"Más Información"}),e.jsx(o,{variant:"outline",onClick:()=>k(!1),className:"text-primary border-primary hover:bg-primary hover:text-white",children:"Cerrar"})]})]})})})]})]})})};export{ze as default};
