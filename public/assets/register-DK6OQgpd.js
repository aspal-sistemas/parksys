import{az as z,l as O,ae as B,a2 as k,af as G,ag as _,j as e,aX as Q,f as u,ai as H,g as p,h as g,ab as f,i as v,aj as r,ak as l,al as o,am as t,O as h,an as i,Q as F,V,W as M,Y as R,_ as m,aR as W,B as C,X,$ as E,ao as d,bG as J,ad as n,aq as T,ap as K}from"./index-D5qLf1ib.js";import{U as Y}from"./user-plus-De6O1CpJ.js";import{C as $}from"./camera-CeZ3mmMV.js";const Z=n.object({firstName:n.string().min(2,"El nombre debe tener al menos 2 caracteres"),lastName:n.string().min(2,"El apellido debe tener al menos 2 caracteres"),email:n.string().email("Debe ser un email válido"),phone:n.string().min(10,"El teléfono debe tener al menos 10 dígitos"),birthDate:n.string().min(1,"La fecha de nacimiento es requerida"),gender:n.enum(["masculino","femenino","no_especificar"]),address:n.string().min(10,"La dirección debe tener al menos 10 caracteres"),emergencyContactName:n.string().min(2,"El nombre del contacto de emergencia es requerido"),emergencyContactPhone:n.string().min(10,"El teléfono de emergencia debe tener al menos 10 dígitos"),preferredParkId:n.string().optional(),volunteerExperience:n.string().optional(),skills:n.string().optional(),availability:n.enum(["weekdays","weekends","evenings","mornings","flexible"]),profileImage:n.any().optional(),interestNature:n.boolean().optional(),interestEvents:n.boolean().optional(),interestEducation:n.boolean().optional(),interestMaintenance:n.boolean().optional(),interestSports:n.boolean().optional(),interestCultural:n.boolean().optional(),legalConsent:n.boolean().refine(x=>x===!0,"Debe aceptar los términos legales"),ageConsent:n.boolean().refine(x=>x===!0,"Debe confirmar ser mayor de edad"),conductConsent:n.boolean().refine(x=>x===!0,"Debe aceptar el código de conducta"),municipalityId:n.number().optional()});function re(){const[,x]=z(),{toast:b}=O(),U=B(),[N,I]=k.useState(null),[ee,w]=k.useState(null),[S,D]=k.useState(!1),a=G({resolver:K(Z),defaultValues:{firstName:"",lastName:"",email:"",phone:"",birthDate:"",gender:"no_especificar",address:"",emergencyContactName:"",emergencyContactPhone:"",preferredParkId:"",volunteerExperience:"",skills:"",availability:"flexible",interestNature:!1,interestEvents:!1,interestEducation:!1,interestMaintenance:!1,interestSports:!1,interestCultural:!1,legalConsent:!1,ageConsent:!1,conductConsent:!1,municipalityId:2,profileImage:null}}),A=async s=>{D(!0);try{const c=new FormData;c.append("file",s);const j=await T("/api/upload/volunteer-profile",{method:"POST",data:c,headers:{}});j.url&&(I(j.url),w(s),a.setValue("profileImage",s),b({title:"Imagen subida",description:"La fotografía del voluntario se ha subido correctamente"}))}catch(c){console.error("Error subiendo imagen:",c),b({title:"Error",description:"No se pudo subir la imagen",variant:"destructive"})}finally{D(!1)}},L=()=>{I(null),w(null),a.setValue("profileImage",null)},y=_({mutationFn:async s=>{const c={...s,role:"voluntario",username:s.email,password:"temp123",profileImageUrl:N};return await T("/api/users",{method:"POST",data:c})},onSuccess:()=>{b({title:"Voluntario registrado",description:"El voluntario ha sido registrado exitosamente"}),U.invalidateQueries({queryKey:["/api/volunteers"]}),x("/admin/volunteers")},onError:s=>{b({title:"Error",description:"No se pudo registrar el voluntario",variant:"destructive"}),console.error("Error registrando voluntario:",s)}}),q=s=>{y.mutate(s)};return e.jsx(Q,{children:e.jsxs("div",{className:"p-6 max-w-4xl mx-auto",children:[e.jsx(u,{className:"p-4 bg-gray-50 mb-6",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Y,{className:"w-8 h-8 text-gray-900"}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Registro de Nuevo Voluntario"})]}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Complete la información del voluntario para registrarlo en el sistema"})]})})}),e.jsx(H,{...a,children:e.jsxs("form",{onSubmit:a.handleSubmit(q),className:"space-y-6",children:[e.jsxs(u,{children:[e.jsxs(p,{children:[e.jsx(g,{children:"Información Personal"}),e.jsx(f,{children:"Datos básicos del voluntario"})]}),e.jsxs(v,{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(r,{control:a.control,name:"firstName",render:({field:s})=>e.jsxs(l,{children:[e.jsx(o,{children:"Nombre"}),e.jsx(t,{children:e.jsx(h,{placeholder:"Nombre",...s})}),e.jsx(i,{})]})}),e.jsx(r,{control:a.control,name:"lastName",render:({field:s})=>e.jsxs(l,{children:[e.jsx(o,{children:"Apellido"}),e.jsx(t,{children:e.jsx(h,{placeholder:"Apellido",...s})}),e.jsx(i,{})]})}),e.jsx(r,{control:a.control,name:"email",render:({field:s})=>e.jsxs(l,{children:[e.jsx(o,{children:"Email"}),e.jsx(t,{children:e.jsx(h,{type:"email",placeholder:"correo@ejemplo.com",...s})}),e.jsx(i,{})]})}),e.jsx(r,{control:a.control,name:"phone",render:({field:s})=>e.jsxs(l,{children:[e.jsx(o,{children:"Teléfono"}),e.jsx(t,{children:e.jsx(h,{placeholder:"33-1234-5678",...s})}),e.jsx(i,{})]})}),e.jsx(r,{control:a.control,name:"birthDate",render:({field:s})=>e.jsxs(l,{children:[e.jsx(o,{children:"Fecha de Nacimiento"}),e.jsx(t,{children:e.jsx(h,{type:"date",...s})}),e.jsx(i,{})]})}),e.jsx(r,{control:a.control,name:"gender",render:({field:s})=>e.jsxs(l,{children:[e.jsx(o,{children:"Género"}),e.jsxs(F,{onValueChange:s.onChange,defaultValue:s.value,children:[e.jsx(t,{children:e.jsx(V,{children:e.jsx(M,{placeholder:"Seleccionar género"})})}),e.jsxs(R,{children:[e.jsx(m,{value:"masculino",children:"Masculino"}),e.jsx(m,{value:"femenino",children:"Femenino"}),e.jsx(m,{value:"no_especificar",children:"Prefiero no especificar"})]})]}),e.jsx(i,{})]})}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(r,{control:a.control,name:"profileImage",render:({field:s})=>e.jsxs(l,{children:[e.jsxs(o,{className:"flex items-center gap-2",children:[e.jsx($,{className:"h-4 w-4"}),"Fotografía del Voluntario (Opcional)"]}),e.jsx(t,{children:e.jsx("div",{className:"space-y-4",children:N?e.jsxs("div",{className:"relative inline-block",children:[e.jsx("img",{src:N,alt:"Foto del voluntario",className:"w-32 h-32 object-cover rounded-lg border"}),e.jsx(C,{type:"button",variant:"destructive",size:"sm",className:"absolute -top-2 -right-2 h-6 w-6 p-0",onClick:L,children:e.jsx(X,{className:"h-3 w-3"})})]}):e.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx(W,{className:"h-8 w-8 text-gray-400"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Subir fotografía del voluntario"}),e.jsx("p",{className:"text-xs text-gray-500",children:"JPG, PNG o WEBP (máx. 5MB)"}),e.jsx("input",{type:"file",accept:"image/*",onChange:c=>{var P;const j=(P=c.target.files)==null?void 0:P[0];j&&A(j)},className:"hidden",id:"volunteer-image-upload"}),e.jsx(C,{type:"button",variant:"outline",size:"sm",onClick:()=>{var c;return(c=document.getElementById("volunteer-image-upload"))==null?void 0:c.click()},disabled:S,children:S?"Subiendo...":"Seleccionar Imagen"})]})})})}),e.jsx(i,{})]})})})]})]}),e.jsxs(u,{children:[e.jsxs(p,{children:[e.jsx(g,{children:"Información de Contacto"}),e.jsx(f,{children:"Datos de contacto y emergencia"})]}),e.jsxs(v,{className:"space-y-4",children:[e.jsx(r,{control:a.control,name:"address",render:({field:s})=>e.jsxs(l,{children:[e.jsx(o,{children:"Dirección"}),e.jsx(t,{children:e.jsx(E,{placeholder:"Dirección completa",...s})}),e.jsx(i,{})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(r,{control:a.control,name:"emergencyContactName",render:({field:s})=>e.jsxs(l,{children:[e.jsx(o,{children:"Contacto de Emergencia"}),e.jsx(t,{children:e.jsx(h,{placeholder:"Nombre completo",...s})}),e.jsx(i,{})]})}),e.jsx(r,{control:a.control,name:"emergencyContactPhone",render:({field:s})=>e.jsxs(l,{children:[e.jsx(o,{children:"Teléfono de Emergencia"}),e.jsx(t,{children:e.jsx(h,{placeholder:"33-1234-5678",...s})}),e.jsx(i,{})]})})]})]})]}),e.jsxs(u,{children:[e.jsxs(p,{children:[e.jsx(g,{children:"Información de Voluntariado"}),e.jsx(f,{children:"Experiencia y preferencias"})]}),e.jsxs(v,{className:"space-y-4",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.jsx(r,{control:a.control,name:"availability",render:({field:s})=>e.jsxs(l,{children:[e.jsx(o,{children:"Disponibilidad"}),e.jsxs(F,{onValueChange:s.onChange,defaultValue:s.value,children:[e.jsx(t,{children:e.jsx(V,{children:e.jsx(M,{placeholder:"Seleccionar disponibilidad"})})}),e.jsxs(R,{children:[e.jsx(m,{value:"weekdays",children:"Entre semana"}),e.jsx(m,{value:"weekends",children:"Fines de semana"}),e.jsx(m,{value:"evenings",children:"Tardes/Noches"}),e.jsx(m,{value:"mornings",children:"Mañanas"}),e.jsx(m,{value:"flexible",children:"Flexible"})]})]}),e.jsx(i,{})]})})}),e.jsx(r,{control:a.control,name:"volunteerExperience",render:({field:s})=>e.jsxs(l,{children:[e.jsx(o,{children:"Experiencia como Voluntario (Opcional)"}),e.jsx(t,{children:e.jsx(E,{placeholder:"Describa su experiencia previa...",...s})}),e.jsx(i,{})]})}),e.jsx(r,{control:a.control,name:"skills",render:({field:s})=>e.jsxs(l,{children:[e.jsx(o,{children:"Habilidades y Talentos (Opcional)"}),e.jsx(t,{children:e.jsx(E,{placeholder:"Describa sus habilidades...",...s})}),e.jsx(i,{})]})})]})]}),e.jsxs(u,{children:[e.jsxs(p,{children:[e.jsx(g,{children:"Áreas de Interés"}),e.jsx(f,{children:"Seleccione las actividades de su interés"})]}),e.jsx(v,{children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[e.jsx(r,{control:a.control,name:"interestNature",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-start space-x-3 space-y-0",children:[e.jsx(t,{children:e.jsx(d,{checked:s.value,onCheckedChange:s.onChange})}),e.jsx(o,{className:"text-sm font-normal",children:"Naturaleza y Medio Ambiente"})]})}),e.jsx(r,{control:a.control,name:"interestEvents",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-start space-x-3 space-y-0",children:[e.jsx(t,{children:e.jsx(d,{checked:s.value,onCheckedChange:s.onChange})}),e.jsx(o,{className:"text-sm font-normal",children:"Eventos y Actividades"})]})}),e.jsx(r,{control:a.control,name:"interestEducation",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-start space-x-3 space-y-0",children:[e.jsx(t,{children:e.jsx(d,{checked:s.value,onCheckedChange:s.onChange})}),e.jsx(o,{className:"text-sm font-normal",children:"Educación Ambiental"})]})}),e.jsx(r,{control:a.control,name:"interestMaintenance",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-start space-x-3 space-y-0",children:[e.jsx(t,{children:e.jsx(d,{checked:s.value,onCheckedChange:s.onChange})}),e.jsx(o,{className:"text-sm font-normal",children:"Mantenimiento de Parques"})]})}),e.jsx(r,{control:a.control,name:"interestSports",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-start space-x-3 space-y-0",children:[e.jsx(t,{children:e.jsx(d,{checked:s.value,onCheckedChange:s.onChange})}),e.jsx(o,{className:"text-sm font-normal",children:"Deportes y Recreación"})]})}),e.jsx(r,{control:a.control,name:"interestCultural",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-start space-x-3 space-y-0",children:[e.jsx(t,{children:e.jsx(d,{checked:s.value,onCheckedChange:s.onChange})}),e.jsx(o,{className:"text-sm font-normal",children:"Actividades Culturales"})]})})]})})]}),e.jsxs(u,{children:[e.jsxs(p,{children:[e.jsx(g,{children:"Consentimientos Legales"}),e.jsx(f,{children:"Aceptación de términos y condiciones"})]}),e.jsxs(v,{className:"space-y-4",children:[e.jsx(r,{control:a.control,name:"legalConsent",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-start space-x-3 space-y-0",children:[e.jsx(t,{children:e.jsx(d,{checked:s.value,onCheckedChange:s.onChange})}),e.jsx(o,{className:"text-sm",children:"Acepto los términos y condiciones del programa de voluntariado y autorizo el tratamiento de mis datos personales conforme a la Ley de Protección de Datos Personales."}),e.jsx(i,{})]})}),e.jsx(r,{control:a.control,name:"ageConsent",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-start space-x-3 space-y-0",children:[e.jsx(t,{children:e.jsx(d,{checked:s.value,onCheckedChange:s.onChange})}),e.jsx(o,{className:"text-sm",children:"Confirmo que soy mayor de 18 años o cuento con autorización de mis padres o tutores legales."}),e.jsx(i,{})]})}),e.jsx(r,{control:a.control,name:"conductConsent",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-start space-x-3 space-y-0",children:[e.jsx(t,{children:e.jsx(d,{checked:s.value,onCheckedChange:s.onChange})}),e.jsx(o,{className:"text-sm",children:"Me comprometo a cumplir con el código de conducta del programa de voluntariado y las normativas de seguridad establecidas."}),e.jsx(i,{})]})})]})]}),e.jsxs("div",{className:"flex justify-end gap-4",children:[e.jsx(C,{type:"button",variant:"outline",onClick:()=>x("/admin/volunteers"),children:"Cancelar"}),e.jsxs(C,{type:"submit",disabled:y.isPending,className:"bg-green-600 hover:bg-green-700",children:[e.jsx(J,{className:"h-4 w-4 mr-2"}),y.isPending?"Registrando...":"Registrar Voluntario"]})]})]})})]})})}export{re as default};
