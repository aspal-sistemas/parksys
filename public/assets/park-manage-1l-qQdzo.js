import{l as je,ae as Ne,a2 as x,u as X,ag as F,j as e,b1 as Ge,b2 as Ze,b3 as Z,bZ as as,F as Ae,b4 as H,w as ie,x as ke,B as d,bh as le,y as ce,z as oe,I as de,O as b,$ as he,bC as pe,f as w,o as v,b as Se,i as E,au as He,bn as me,D as rs,aq as ee,g as T,h as P,a$ as De,c8 as ye,M as te,bq as Je,af as Te,aW as be,aS as ts,ab as J,a4 as We,c9 as Pe,aT as ne,J as Fe,ai as ze,aj as M,ak as Q,al as R,am as O,an as K,Q as $e,V as Ie,W as Ue,Y as Le,_ as ae,ad as Y,ap as Me,az as ns,E as Qe,m as ge,r as is,n as ls,U as W,a1 as cs,a7 as os,p as Re,P as Oe,t as ds,k as ms,aX as fe,L as Ke,A as xs,aZ as us}from"./index-D5qLf1ib.js";import{T as Xe}from"./tree-species-icon-8ii1W9e9.js";import{I as Ve}from"./images-BMibsPhC.js";import"./flower-BcB1HXxJ.js";function hs({parkId:t}){const{toast:i}=je(),c=Ne(),[j,g]=x.useState(!1),[y,C]=x.useState(!1),[u,l]=x.useState(null),[D,q]=x.useState(""),[A,f]=x.useState(""),[p,$]=x.useState(!1),[k,I]=x.useState(null),[z,L]=x.useState(""),[r,o]=x.useState(""),[N,U]=x.useState(""),[B,se]=x.useState("general"),re=()=>{l(null),q(""),f(""),$(!1)},n=()=>{I(null),L(""),o(""),U(""),se("general")},{data:h=[],isLoading:_,error:xe}=X({queryKey:[`/api/parks/${t}/images`],queryFn:async()=>{console.log(`🔍 FRONTEND: Cargando imágenes para parque ${t}`);const a=await fetch(`/api/parks/${t}/images`,{headers:{Authorization:"Bearer direct-token-1750522117022","X-User-Id":"1","X-User-Role":"super_admin"}});if(!a.ok)throw new Error("Error cargando imágenes");const m=await a.json();return console.log("✅ FRONTEND: Imágenes cargadas:",m),m},staleTime:0,gcTime:0}),{data:G=[],isLoading:s,error:S}=X({queryKey:[`/api/parks/${t}/documents`],queryFn:async()=>{console.log(`🔍 FRONTEND: Cargando documentos para parque ${t}`);const a=await fetch(`/api/parks/${t}/documents`,{headers:{Authorization:"Bearer direct-token-1750522117022","X-User-Id":"1","X-User-Role":"super_admin"}});if(!a.ok)throw new Error("Error cargando documentos");const m=await a.json();return console.log("✅ FRONTEND: Documentos cargados:",m),m},staleTime:0,gcTime:0}),ue=F({mutationFn:async a=>{if(a instanceof FormData){const m=await fetch(`/api/parks/${t}/images`,{method:"POST",headers:{Authorization:"Bearer direct-token-1750522117022","X-User-Id":"1","X-User-Role":"super_admin"},body:a});if(!m.ok)throw new Error("Error subiendo imagen");return m.json()}else return(await ee(`/api/parks/${t}/images`,{method:"POST",data:a})).json()},onSuccess:()=>{i({title:"Imagen subida",description:"La imagen se ha agregado exitosamente al parque."}),c.invalidateQueries({queryKey:[`/api/parks/${t}/images`]}),c.invalidateQueries({queryKey:[`/api/parks/${t}`]}),re(),g(!1)},onError:a=>{i({title:"Error",description:"No se pudo subir la imagen. Intente nuevamente.",variant:"destructive"})}}),we=F({mutationFn:async a=>(await ee(`/api/park-images/${a}/set-primary`,{method:"POST",data:{}})).json(),onSuccess:()=>{i({title:"Imagen principal actualizada",description:"Se ha establecido la nueva imagen principal del parque."}),c.invalidateQueries({queryKey:[`/api/parks/${t}/images`]}),c.invalidateQueries({queryKey:[`/api/parks/${t}`]})},onError:()=>{i({title:"Error",description:"No se pudo establecer la imagen principal.",variant:"destructive"})}}),Ee=F({mutationFn:async a=>await ee(`/api/park-images/${a}`,{method:"DELETE"}),onSuccess:()=>{i({title:"Imagen eliminada",description:"La imagen se ha eliminado correctamente."}),c.invalidateQueries({queryKey:[`/api/parks/${t}/images`]}),c.invalidateQueries({queryKey:[`/api/parks/${t}`]}),c.removeQueries({queryKey:[`/api/parks/${t}/images`]}),c.refetchQueries({queryKey:[`/api/parks/${t}/images`]}),setTimeout(()=>{c.invalidateQueries({queryKey:[`/api/parks/${t}/images`]})},100)},onError:()=>{i({title:"Error",description:"No se pudo eliminar la imagen.",variant:"destructive"})}}),ve=F({mutationFn:async a=>{const m=await fetch(`/api/parks/${t}/documents`,{method:"POST",headers:{Authorization:"Bearer direct-token-1750522117022","X-User-Id":"1","X-User-Role":"super_admin"},body:a});if(!m.ok){const V=await m.text();throw console.error("❌ Error uploading document:",V),new Error("Error subiendo documento")}return m.json()},onSuccess:()=>{i({title:"Documento subido",description:"El documento se ha agregado exitosamente al parque."}),c.invalidateQueries({queryKey:[`/api/parks/${t}/documents`]}),c.invalidateQueries({queryKey:[`/api/parks/${t}`]}),n(),C(!1)},onError:a=>{i({title:"Error",description:"No se pudo subir el documento. Intente nuevamente.",variant:"destructive"})}}),Ce=F({mutationFn:async a=>(console.log(`🌐 [API REQUEST] DELETE /api/park-documents/${a}`),await ee(`/api/park-documents/${a}`,{method:"DELETE"})),onSuccess:a=>{i({title:"Documento eliminado",description:(a==null?void 0:a.message)||"El documento se ha eliminado correctamente."}),c.invalidateQueries({queryKey:[`/api/parks/${t}/documents`]}),c.invalidateQueries({queryKey:[`/api/parks/${t}`]}),c.invalidateQueries({queryKey:["/api/parks"]}),c.refetchQueries({queryKey:[`/api/parks/${t}/documents`]})},onError:a=>{console.error("❌ Error en eliminación:",a),c.invalidateQueries({queryKey:[`/api/parks/${t}/documents`]}),c.refetchQueries({queryKey:[`/api/parks/${t}/documents`]}),i({title:"Error",description:"No se pudo eliminar el documento.",variant:"destructive"})}}),Ye=()=>{if(u){const a=new FormData;a.append("image",u),a.append("caption",A),a.append("isPrimary",p.toString()),ue.mutate(a)}else D&&ue.mutate({imageUrl:D,caption:A,isPrimary:p})},es=()=>{if(!r.trim()){i({title:"Error",description:"El título del documento es requerido.",variant:"destructive"});return}if(!k){i({title:"Error",description:"Debe seleccionar un archivo para subir.",variant:"destructive"});return}const a=new FormData;a.append("document",k),a.append("title",r),a.append("description",N),a.append("category",B),ve.mutate(a)},ss=a=>{if(a===0)return"0 Bytes";const m=1024,V=["Bytes","KB","MB","GB"],qe=Math.floor(Math.log(a)/Math.log(m));return parseFloat((a/Math.pow(m,qe)).toFixed(2))+" "+V[qe]};return console.log("🔍 MULTIMEDIA MANAGER - Renderizando con:",{parkId:t,images:h.length,documents:G.length,imagesLoading:_,documentsLoading:s,imagesError:xe,documentsError:S}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border",children:[e.jsx("h4",{className:"font-semibold text-blue-800",children:"Estado del Componente Multimedia"}),e.jsxs("p",{className:"text-sm text-blue-600",children:["Parque ID: ",t," | Imágenes: ",h.length," | Documentos: ",G.length]}),e.jsxs("p",{className:"text-sm text-blue-600",children:["Cargando imágenes: ",_?"Sí":"No"," | Error: ",xe?"Sí":"No"]})]}),e.jsxs(Ge,{defaultValue:"images",className:"w-full",children:[e.jsxs(Ze,{className:"grid w-full grid-cols-2",children:[e.jsxs(Z,{value:"images",className:"flex items-center gap-2",children:[e.jsx(as,{className:"h-4 w-4"}),"Imágenes (",h.length,")"]}),e.jsxs(Z,{value:"documents",className:"flex items-center gap-2",children:[e.jsx(Ae,{className:"h-4 w-4"}),"Documentos (",G.length,")"]})]}),e.jsxs(H,{value:"images",className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Galería de Imágenes"}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(ie,{open:j,onOpenChange:g,children:[e.jsx(ke,{asChild:!0,children:e.jsxs(d,{className:"bg-green-600 hover:bg-green-700 text-white flex items-center gap-2",children:[e.jsx(le,{className:"h-4 w-4"}),"Agregar Imagen"]})}),e.jsxs(ce,{className:"max-w-md",children:[e.jsx(oe,{children:e.jsx(de,{children:"Agregar Nueva Imagen"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Subir archivo"}),e.jsx(b,{type:"file",accept:"image/*",onChange:a=>{var V;const m=(V=a.target.files)==null?void 0:V[0];m&&(l(m),q(""))}})]}),e.jsx("div",{className:"text-center text-sm text-gray-500",children:"- O -"}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"URL de imagen"}),e.jsx(b,{value:D,onChange:a=>{q(a.target.value),a.target.value&&l(null)},placeholder:"https://ejemplo.com/imagen.jpg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Descripción"}),e.jsx(he,{value:A,onChange:a=>f(a.target.value),placeholder:"Descripción de la imagen...",rows:3})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"isPrimary",checked:p,onChange:a=>$(a.target.checked)}),e.jsx("label",{htmlFor:"isPrimary",className:"text-sm",children:"Establecer como imagen principal"})]})]}),e.jsx(pe,{children:e.jsx(d,{onClick:Ye,disabled:!u&&!D||ue.isPending,children:ue.isPending?"Subiendo...":"Agregar Imagen"})})]})]})})]}),_?e.jsx("div",{className:"text-center py-8",children:"Cargando imágenes..."}):h.length===0?e.jsx("div",{className:"text-center py-8 text-gray-500",children:"No hay imágenes para este parque"}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:h.map(a=>e.jsxs(w,{className:"overflow-hidden",children:[e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:a.imageUrl,alt:a.caption,className:"w-full h-48 object-cover"}),a.isPrimary&&e.jsxs(v,{className:"absolute top-2 left-2 bg-yellow-500",children:[e.jsx(Se,{className:"h-3 w-3 mr-1"}),"Principal"]})]}),e.jsxs(E,{className:"p-4",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:a.caption}),e.jsxs("div",{className:"flex gap-2",children:[!a.isPrimary&&e.jsx(d,{size:"sm",variant:"outline",onClick:()=>we.mutate(a.id),disabled:we.isPending,children:e.jsx(Se,{className:"h-3 w-3"})}),e.jsx(d,{size:"sm",variant:"outline",onClick:()=>window.open(a.imageUrl,"_blank"),children:e.jsx(He,{className:"h-3 w-3"})}),e.jsx(d,{size:"sm",variant:"destructive",onClick:()=>Ee.mutate(a.id),disabled:Ee.isPending,children:e.jsx(me,{className:"h-3 w-3"})})]})]})]},a.id))})]}),e.jsxs(H,{value:"documents",className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Documentos del Parque"}),e.jsxs(ie,{open:y,onOpenChange:C,children:[e.jsx(ke,{asChild:!0,children:e.jsxs(d,{className:"flex items-center gap-2",children:[e.jsx(le,{className:"h-4 w-4"}),"Agregar Documento"]})}),e.jsxs(ce,{className:"max-w-md",children:[e.jsx(oe,{children:e.jsx(de,{children:"Agregar Nuevo Documento"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Título"}),e.jsx(b,{value:r,onChange:a=>o(a.target.value),placeholder:"Título del documento"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Archivo del Documento *"}),e.jsx(b,{type:"file",accept:".pdf,.doc,.docx,.txt,.xls,.xlsx,.ppt,.pptx",onChange:a=>{var V;const m=(V=a.target.files)==null?void 0:V[0];I(m||null)},required:!0}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Formatos permitidos: PDF, DOC, DOCX, TXT, XLS, XLSX, PPT, PPTX (máx. 10MB)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"URL de Referencia (opcional)"}),e.jsx(b,{value:z,onChange:a=>L(a.target.value),placeholder:"https://ejemplo.com/documento-original.pdf"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"URL opcional para referenciar el documento original o fuente"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Categoría"}),e.jsxs("select",{value:B,onChange:a=>se(a.target.value),className:"w-full p-2 border border-gray-300 rounded-md",children:[e.jsx("option",{value:"general",children:"General"}),e.jsx("option",{value:"reglamento",children:"Reglamento"}),e.jsx("option",{value:"mantenimiento",children:"Mantenimiento"}),e.jsx("option",{value:"eventos",children:"Eventos"}),e.jsx("option",{value:"legal",children:"Legal"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Descripción"}),e.jsx(he,{value:N,onChange:a=>U(a.target.value),placeholder:"Descripción del documento...",rows:3})]})]}),e.jsx(pe,{children:e.jsx(d,{onClick:es,disabled:!k||!r.trim()||ve.isPending,children:ve.isPending?"Subiendo...":"Agregar Documento"})})]})]})]}),s?e.jsx("div",{className:"text-center py-8",children:"Cargando documentos..."}):G.length===0?e.jsx("div",{className:"text-center py-8 text-gray-500",children:"No hay documentos para este parque"}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:G.map(a=>e.jsx(w,{children:e.jsxs(E,{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ae,{className:"h-5 w-5 text-blue-500"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:a.title}),e.jsx("p",{className:"text-xs text-gray-500 capitalize",children:a.category})]})]}),e.jsx(v,{variant:"outline",children:ss(a.fileSize)})]}),a.description&&e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:a.description}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(d,{size:"sm",variant:"outline",onClick:()=>window.open(a.fileUrl,"_blank"),children:[e.jsx(rs,{className:"h-3 w-3 mr-1"}),"Ver"]}),e.jsx(d,{size:"sm",variant:"destructive",onClick:()=>Ce.mutate(a.id),disabled:Ce.isPending,children:e.jsx(me,{className:"h-3 w-3"})})]})]})},a.id))})]})]})]})}const ps={activo:"Activo",inactivo:"Inactivo",mantenimiento:"En Mantenimiento"};function gs({parkId:t}){const{toast:i}=je(),c=Ne(),[j,g]=x.useState(!1),[y,C]=x.useState(null),[u,l]=x.useState(null),[D,q]=x.useState(""),[A,f]=x.useState(""),[p,$]=x.useState(""),{data:k=[],isLoading:I,error:z}=X({queryKey:[`/api/parks/${t}/amenities`],queryFn:async()=>{console.log("🔍 FRONTEND: Cargando amenidades para parque",t);const n=await fetch(`/api/parks/${t}/amenities`,{headers:{Authorization:"Bearer direct-token-1750522117022","X-User-Id":"1","X-User-Role":"super_admin"}});if(!n.ok)throw new Error("Error cargando amenidades");const h=await n.json();return console.log("✅ FRONTEND: Amenidades cargadas:",h),h},enabled:!!t}),{data:L=[]}=X({queryKey:["/api/amenities"],queryFn:async()=>{const n=await fetch("/api/amenities",{headers:{Authorization:"Bearer direct-token-1750522117022","X-User-Id":"1","X-User-Role":"super_admin"}});if(!n.ok)throw new Error("Error cargando amenidades disponibles");return n.json()}}),r=F({mutationFn:async n=>{const h=await fetch(`/api/parks/${t}/amenities`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer direct-token-1750522117022","X-User-Id":"1","X-User-Role":"super_admin"},body:JSON.stringify(n)});if(!h.ok)throw new Error("Error agregando amenidad");return h.json()},onSuccess:()=>{c.invalidateQueries({queryKey:[`/api/parks/${t}/amenities`]}),i({title:"Amenidad agregada",description:"La amenidad se agregó correctamente al parque"}),l(null),q(""),f(""),$("")},onError:n=>{i({title:"Error",description:"No se pudo agregar la amenidad",variant:"destructive"})}}),o=F({mutationFn:async({parkAmenityId:n,data:h})=>{const _=await fetch(`/api/park-amenities/${n}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer direct-token-1750522117022","X-User-Id":"1","X-User-Role":"super_admin"},body:JSON.stringify(h)});if(!_.ok)throw new Error("Error actualizando amenidad");return _.json()},onSuccess:()=>{c.invalidateQueries({queryKey:[`/api/parks/${t}/amenities`]}),g(!1),C(null),i({title:"Amenidad actualizada",description:"La amenidad se actualizó correctamente"})}}),N=F({mutationFn:async n=>{if(!(await fetch(`/api/parks/${t}/amenities/${n}`,{method:"DELETE",headers:{Authorization:"Bearer direct-token-1750522117022","X-User-Id":"1","X-User-Role":"super_admin"}})).ok)throw new Error("Error eliminando amenidad")},onSuccess:()=>{c.invalidateQueries({queryKey:[`/api/parks/${t}/amenities`]}),i({title:"Amenidad eliminada",description:"La amenidad se eliminó correctamente del parque"})}}),U=n=>{C(n),q(n.moduleName||""),f(n.surfaceArea||""),$(n.description||""),g(!0)},B=()=>{if(!y)return;const n={moduleName:D||null,surfaceArea:A||null,description:p||null};o.mutate({parkAmenityId:y.id,data:n})},se=n=>{confirm("¿Estás seguro de que deseas eliminar esta amenidad del parque?")&&N.mutate(n)},re=n=>{const h={amenityId:n,moduleName:"",surfaceArea:null,description:null};r.mutate(h)};return console.log("🔍 AMENITIES MANAGER - Renderizando con:",{parkId:t,amenitiesCount:k.length,amenitiesLoading:I,amenitiesError:(z==null?void 0:z.message)||null,availableCount:L.length}),I?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900 mx-auto"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Cargando amenidades..."})]}):z?e.jsx("div",{className:"text-center py-8",children:e.jsxs("p",{className:"text-red-600",children:["Error cargando amenidades: ",z.message]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Gestión de Amenidades del Parque"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Selecciona amenidades de la lista disponible para agregarlas al parque"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(w,{children:[e.jsxs(T,{children:[e.jsxs(P,{className:"flex items-center gap-2",children:[e.jsx(De,{className:"h-5 w-5"}),"Amenidades Disponibles"]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Haz clic en una amenidad para agregarla al parque"})]}),e.jsx(E,{children:e.jsxs("div",{className:"space-y-2 max-h-[600px] overflow-y-auto",children:[L.filter(n=>!k.some(h=>h.amenityId===n.id)).map(n=>e.jsxs("div",{onClick:()=>re(n.id),className:"flex items-center gap-3 p-3 border rounded-lg hover:bg-blue-50 hover:border-blue-200 cursor-pointer transition-colors",children:[e.jsx(ye,{name:n.name,iconType:n.icon==="custom"?"custom":"system",customIconUrl:n.icon==="custom"?`/uploads/amenity-icon-${n.id}.png`:void 0,size:32}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h5",{className:"font-medium text-gray-900",children:n.name}),e.jsx("p",{className:"text-xs text-gray-500",children:"Click para agregar"})]}),e.jsx(le,{className:"h-4 w-4 text-gray-400"})]},n.id)),L.filter(n=>!k.some(h=>h.amenityId===n.id)).length===0&&e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(De,{className:"h-8 w-8 mx-auto mb-2 text-gray-400"}),e.jsx("p",{className:"text-sm",children:"Todas las amenidades disponibles ya están asignadas"})]})]})})]}),e.jsxs(w,{children:[e.jsxs(T,{children:[e.jsxs(P,{className:"flex items-center gap-2",children:[e.jsx(te,{className:"h-5 w-5"}),"Amenidades del Parque (",k.length,")"]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Amenidades actualmente asignadas a este parque"})]}),e.jsx(E,{children:e.jsx("div",{className:"space-y-2 max-h-[600px] overflow-y-auto",children:k.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(te,{className:"h-8 w-8 mx-auto mb-2 text-gray-400"}),e.jsx("p",{className:"text-sm",children:"No hay amenidades asignadas"}),e.jsx("p",{className:"text-xs mt-1",children:"Agrega amenidades desde la lista de la izquierda"})]}):k.map(n=>e.jsxs("div",{className:"flex items-center gap-3 p-3 border rounded-lg bg-green-50 border-green-200",children:[e.jsx(ye,{name:n.amenityName,iconType:n.amenityIcon==="custom"?"custom":"system",customIconUrl:n.customIconUrl,size:32}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h5",{className:"font-medium text-gray-900",children:n.amenityName}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(v,{variant:"outline",className:"text-xs",children:ps[n.status]||n.status}),n.moduleName&&e.jsxs("span",{className:"text-xs text-gray-500",children:["📍 ",n.moduleName]})]})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(d,{size:"sm",variant:"outline",onClick:()=>U(n),children:e.jsx(Je,{className:"h-3 w-3"})}),e.jsx(d,{size:"sm",variant:"destructive",onClick:()=>se(n.id),disabled:N.isPending,children:e.jsx(me,{className:"h-3 w-3"})})]})]},n.id))})})]})]}),e.jsx(ie,{open:j,onOpenChange:g,children:e.jsxs(ce,{className:"max-w-md",children:[e.jsx(oe,{children:e.jsx(de,{children:"Editar Amenidad"})}),y&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[e.jsx(ye,{name:y.amenityName,iconType:y.amenityIcon==="custom"?"custom":"system",customIconUrl:y.customIconUrl,size:32}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium",children:y.amenityName}),e.jsx("p",{className:"text-sm text-gray-600 capitalize",children:"General"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Módulo/Ubicación"}),e.jsx(b,{value:D,onChange:n=>q(n.target.value),placeholder:"Ej: Zona Norte, Entrada Principal..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Superficie (m²)"}),e.jsx(b,{value:A,onChange:n=>f(n.target.value),placeholder:"Ej: 150.5",type:"number",step:"0.1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Descripción"}),e.jsx(b,{value:p,onChange:n=>$(n.target.value),placeholder:"Descripción adicional..."})]}),e.jsxs("div",{className:"flex gap-2 pt-4",children:[e.jsx(d,{onClick:B,disabled:o.isPending,className:"flex-1",children:o.isPending?"Actualizando...":"Actualizar"}),e.jsx(d,{variant:"outline",onClick:()=>g(!1),className:"flex-1",children:"Cancelar"})]})]})]})})]})}const Be=Y.object({speciesId:Y.number().min(1,"Debe seleccionar una especie"),recommendedQuantity:Y.number().min(1,"Cantidad debe ser mayor a 0").optional(),currentQuantity:Y.number().min(0,"Cantidad actual no puede ser negativa").default(0),plantingZone:Y.string().optional(),notes:Y.string().optional(),status:Y.string().default("planificado")});function js({parkId:t}){var G;const[i,c]=x.useState(""),[j,g]=x.useState(null),[y,C]=x.useState(!1),[u,l]=x.useState(null),[D,q]=x.useState(!1),{toast:A}=je(),f=Ne(),{data:p,isLoading:$,error:k}=X({queryKey:[`/api/parks/${t}/tree-species`],queryFn:async()=>{const s=await fetch(`/api/parks/${t}/tree-species`);if(!s.ok)throw new Error("Error al cargar especies asignadas");return s.json()}}),{data:I,isLoading:z}=X({queryKey:["/api/tree-species",i],queryFn:async()=>{const s=new URLSearchParams({page:"1",limit:"50",...i&&{search:i}}),S=await fetch(`/api/tree-species?${s}`);if(!S.ok)throw new Error("Error al cargar especies disponibles");return S.json()}}),L=(p==null?void 0:p.map(s=>s.speciesId))||[],r=((G=I==null?void 0:I.data)==null?void 0:G.filter(s=>!L.includes(s.id)))||[],o=Te({resolver:Me(Be),defaultValues:{currentQuantity:0,status:"planificado"}}),N=Te({resolver:Me(Be)}),U=F({mutationFn:async s=>ee(`/api/parks/${t}/tree-species`,{method:"POST",data:s}),onSuccess:()=>{f.invalidateQueries({queryKey:[`/api/parks/${t}/tree-species`]}),f.invalidateQueries({queryKey:["/api/tree-species"]}),C(!1),g(null),o.reset(),A({title:"Éxito",description:"Especie asignada al parque correctamente"})},onError:s=>{A({title:"Error",description:s.message||"Error al asignar la especie",variant:"destructive"})}}),B=F({mutationFn:async s=>ee(`/api/park-tree-species/${u==null?void 0:u.id}`,{method:"PUT",data:s}),onSuccess:()=>{f.invalidateQueries({queryKey:[`/api/parks/${t}/tree-species`]}),q(!1),l(null),N.reset(),A({title:"Éxito",description:"Asignación actualizada correctamente"})},onError:s=>{A({title:"Error",description:s.message||"Error al actualizar la asignación",variant:"destructive"})}}),se=F({mutationFn:async s=>ee(`/api/park-tree-species/${s}`,{method:"DELETE"}),onSuccess:()=>{f.invalidateQueries({queryKey:[`/api/parks/${t}/tree-species`]}),f.invalidateQueries({queryKey:["/api/tree-species"]}),A({title:"Éxito",description:"Especie removida del parque correctamente"})},onError:s=>{A({title:"Error",description:s.message||"Error al remover la especie",variant:"destructive"})}}),re=s=>{g(s),o.setValue("speciesId",s.id),C(!0)},n=s=>{l(s),N.reset({speciesId:s.speciesId,recommendedQuantity:s.recommendedQuantity||void 0,currentQuantity:s.currentQuantity,plantingZone:s.plantingZone||"",notes:s.notes||"",status:s.status}),q(!0)},h=s=>{confirm("¿Está seguro de que desea remover esta especie del parque?")&&se.mutate(s)},_=s=>{switch(s){case"planificado":return"bg-yellow-100 text-yellow-800";case"en_desarrollo":return"bg-blue-100 text-blue-800";case"establecido":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},xe=s=>{switch(s){case"planificado":return"Planificado";case"en_desarrollo":return"En Desarrollo";case"establecido":return"Establecido";default:return s}};return $||z?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-600"})}):k?e.jsxs("div",{className:"text-center py-8 text-red-600",children:[e.jsx(be,{className:"h-12 w-12 mx-auto mb-4"}),e.jsx("p",{children:"Error al cargar las especies del parque"})]}):e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 h-[600px]",children:[e.jsxs(w,{className:"flex flex-col",children:[e.jsxs(T,{children:[e.jsxs(P,{className:"flex items-center gap-2 text-green-700",children:[e.jsx(ts,{className:"h-5 w-5"}),"Especies Disponibles (",r.length,")"]}),e.jsx(J,{children:"Especies arbóreas que pueden ser asignadas a este parque"}),e.jsxs("div",{className:"relative",children:[e.jsx(We,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(b,{placeholder:"Buscar especies...",value:i,onChange:s=>c(s.target.value),className:"pl-10"})]})]}),e.jsx(E,{className:"flex-1 p-0",children:e.jsx(Pe,{className:"h-full px-6 pb-6",children:e.jsxs("div",{className:"space-y-2",children:[r.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg border hover:bg-gray-50 cursor-pointer transition-colors",onClick:()=>re(s),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Xe,{iconType:s.iconType,customIconUrl:s.customIconUrl,size:32}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-medium truncate",children:s.commonName}),e.jsx("p",{className:"text-sm text-gray-600 italic truncate",children:s.scientificName}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(v,{variant:"outline",className:"text-xs",children:s.family}),e.jsx(v,{variant:s.origin==="Nativo"?"default":"secondary",className:"text-xs",children:s.origin}),s.isEndangered&&e.jsx(v,{variant:"destructive",className:"text-xs",children:"Amenazada"})]})]})]}),e.jsxs(d,{variant:"outline",size:"sm",className:"shrink-0",children:[e.jsx(le,{className:"h-4 w-4 mr-1"}),"Asignar"]})]},s.id)),r.length===0&&e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(ne,{className:"h-12 w-12 mx-auto mb-4 text-gray-400"}),e.jsx("p",{children:"No hay especies disponibles"}),i&&e.jsx("p",{className:"text-sm",children:"Intenta con otros términos de búsqueda"})]})]})})})]}),e.jsxs(w,{className:"flex flex-col",children:[e.jsxs(T,{children:[e.jsxs(P,{className:"flex items-center gap-2 text-green-700",children:[e.jsx(ne,{className:"h-5 w-5"}),"Especies del Parque (",(p==null?void 0:p.length)||0,")"]}),e.jsx(J,{children:"Especies arbóreas asignadas a este parque"})]}),e.jsx(E,{className:"flex-1 p-0",children:e.jsx(Pe,{className:"h-full px-6 pb-6",children:e.jsxs("div",{className:"space-y-2",children:[p==null?void 0:p.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg border bg-green-50",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Xe,{iconType:s.iconType,customIconUrl:s.customIconUrl,size:32}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-medium truncate",children:s.commonName}),e.jsx("p",{className:"text-sm text-gray-600 italic truncate",children:s.scientificName}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(v,{className:_(s.status),children:xe(s.status)}),s.currentQuantity>0&&e.jsxs(v,{variant:"outline",className:"text-xs",children:[s.currentQuantity," plantados"]}),s.recommendedQuantity&&e.jsxs(v,{variant:"secondary",className:"text-xs",children:["Meta: ",s.recommendedQuantity]}),s.isEndangered&&e.jsx(v,{variant:"destructive",className:"text-xs",children:"Amenazada"})]}),s.plantingZone&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Zona: ",s.plantingZone]})]})]}),e.jsxs("div",{className:"flex gap-1 shrink-0",children:[e.jsx(d,{variant:"outline",size:"sm",onClick:()=>n(s),children:e.jsx(Je,{className:"h-4 w-4"})}),e.jsx(d,{variant:"outline",size:"sm",onClick:()=>h(s.id),className:"text-red-600 hover:text-red-700",children:e.jsx(me,{className:"h-4 w-4"})})]})]},s.id)),(!p||p.length===0)&&e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(ne,{className:"h-12 w-12 mx-auto mb-4 text-gray-400"}),e.jsx("p",{children:"No hay especies asignadas a este parque"}),e.jsx("p",{className:"text-sm",children:"Selecciona especies de la columna izquierda"})]})]})})})]}),e.jsx(ie,{open:y,onOpenChange:C,children:e.jsxs(ce,{className:"sm:max-w-[500px]",children:[e.jsxs(oe,{children:[e.jsx(de,{children:"Asignar Especie al Parque"}),e.jsxs(Fe,{children:["Configura los detalles de la asignación de ",j==null?void 0:j.commonName]})]}),e.jsx(ze,{...o,children:e.jsxs("form",{onSubmit:o.handleSubmit(s=>U.mutate(s)),className:"space-y-4",children:[e.jsx(M,{control:o.control,name:"recommendedQuantity",render:({field:s})=>e.jsxs(Q,{children:[e.jsx(R,{children:"Cantidad Recomendada"}),e.jsx(O,{children:e.jsx(b,{type:"number",placeholder:"Cantidad objetivo a plantar",...s,value:s.value||"",onChange:S=>s.onChange(S.target.value?parseInt(S.target.value):void 0)})}),e.jsx(K,{})]})}),e.jsx(M,{control:o.control,name:"currentQuantity",render:({field:s})=>e.jsxs(Q,{children:[e.jsx(R,{children:"Cantidad Actual Plantada"}),e.jsx(O,{children:e.jsx(b,{type:"number",...s,onChange:S=>s.onChange(parseInt(S.target.value)||0)})}),e.jsx(K,{})]})}),e.jsx(M,{control:o.control,name:"plantingZone",render:({field:s})=>e.jsxs(Q,{children:[e.jsx(R,{children:"Zona de Plantación (Opcional)"}),e.jsx(O,{children:e.jsx(b,{placeholder:"Ej. Área norte, Sendero principal...",...s})}),e.jsx(K,{})]})}),e.jsx(M,{control:o.control,name:"status",render:({field:s})=>e.jsxs(Q,{children:[e.jsx(R,{children:"Estado"}),e.jsxs($e,{onValueChange:s.onChange,defaultValue:s.value,children:[e.jsx(O,{children:e.jsx(Ie,{children:e.jsx(Ue,{placeholder:"Selecciona el estado"})})}),e.jsxs(Le,{children:[e.jsx(ae,{value:"planificado",children:"Planificado"}),e.jsx(ae,{value:"en_desarrollo",children:"En Desarrollo"}),e.jsx(ae,{value:"establecido",children:"Establecido"})]})]}),e.jsx(K,{})]})}),e.jsx(M,{control:o.control,name:"notes",render:({field:s})=>e.jsxs(Q,{children:[e.jsx(R,{children:"Notas (Opcional)"}),e.jsx(O,{children:e.jsx(he,{placeholder:"Observaciones sobre la plantación...",...s})}),e.jsx(K,{})]})}),e.jsxs(pe,{children:[e.jsx(d,{type:"button",variant:"outline",onClick:()=>C(!1),children:"Cancelar"}),e.jsx(d,{type:"submit",disabled:U.isPending,className:"bg-green-600 hover:bg-green-700",children:U.isPending?"Asignando...":"Asignar Especie"})]})]})})]})}),e.jsx(ie,{open:D,onOpenChange:q,children:e.jsxs(ce,{className:"sm:max-w-[500px]",children:[e.jsxs(oe,{children:[e.jsx(de,{children:"Editar Asignación de Especie"}),e.jsxs(Fe,{children:["Modifica los detalles de la asignación de ",u==null?void 0:u.commonName]})]}),e.jsx(ze,{...N,children:e.jsxs("form",{onSubmit:N.handleSubmit(s=>B.mutate(s)),className:"space-y-4",children:[e.jsx(M,{control:N.control,name:"recommendedQuantity",render:({field:s})=>e.jsxs(Q,{children:[e.jsx(R,{children:"Cantidad Recomendada"}),e.jsx(O,{children:e.jsx(b,{type:"number",placeholder:"Cantidad objetivo a plantar",...s,value:s.value||"",onChange:S=>s.onChange(S.target.value?parseInt(S.target.value):void 0)})}),e.jsx(K,{})]})}),e.jsx(M,{control:N.control,name:"currentQuantity",render:({field:s})=>e.jsxs(Q,{children:[e.jsx(R,{children:"Cantidad Actual Plantada"}),e.jsx(O,{children:e.jsx(b,{type:"number",...s,onChange:S=>s.onChange(parseInt(S.target.value)||0)})}),e.jsx(K,{})]})}),e.jsx(M,{control:N.control,name:"plantingZone",render:({field:s})=>e.jsxs(Q,{children:[e.jsx(R,{children:"Zona de Plantación"}),e.jsx(O,{children:e.jsx(b,{placeholder:"Ej. Área norte, Sendero principal...",...s})}),e.jsx(K,{})]})}),e.jsx(M,{control:N.control,name:"status",render:({field:s})=>e.jsxs(Q,{children:[e.jsx(R,{children:"Estado"}),e.jsxs($e,{onValueChange:s.onChange,value:s.value,children:[e.jsx(O,{children:e.jsx(Ie,{children:e.jsx(Ue,{placeholder:"Selecciona el estado"})})}),e.jsxs(Le,{children:[e.jsx(ae,{value:"planificado",children:"Planificado"}),e.jsx(ae,{value:"en_desarrollo",children:"En Desarrollo"}),e.jsx(ae,{value:"establecido",children:"Establecido"})]})]}),e.jsx(K,{})]})}),e.jsx(M,{control:N.control,name:"notes",render:({field:s})=>e.jsxs(Q,{children:[e.jsx(R,{children:"Notas"}),e.jsx(O,{children:e.jsx(he,{placeholder:"Observaciones sobre la plantación...",...s})}),e.jsx(K,{})]})}),e.jsxs(pe,{children:[e.jsx(d,{type:"button",variant:"outline",onClick:()=>q(!1),children:"Cancelar"}),e.jsx(d,{type:"submit",disabled:B.isPending,className:"bg-green-600 hover:bg-green-700",children:B.isPending?"Guardando...":"Guardar Cambios"})]})]})})]})})]})}const Ns={"Arte y Cultura":"bg-pink-100 text-pink-800","Recreación y Bienestar":"bg-green-100 text-green-800","Eventos de Temporada":"bg-amber-100 text-amber-800",Deportivo:"bg-red-100 text-red-800",Comunidad:"bg-purple-100 text-purple-800","Naturaleza y Ciencia":"bg-blue-100 text-blue-800","Fitness y Ejercicio":"bg-indigo-100 text-indigo-800","Actividades Familiares":"bg-teal-100 text-teal-800"};function vs({parkId:t}){const[,i]=ns(),{data:c,isLoading:j,error:g}=X({queryKey:[`/api/parks/${t}/activities`],queryFn:async()=>{const l=await fetch(`/api/parks/${t}/activities`);if(!l.ok)throw new Error("Error cargando actividades");return l.json()}}),y=l=>{i(`/admin/organizador/catalogo/${l}`)},C=()=>{i("/admin/activities")};if(j)return e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900 mx-auto"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Cargando actividades..."})]});if(g)return e.jsx("div",{className:"text-center py-8 text-red-500",children:e.jsx("p",{children:"Error cargando actividades del parque"})});const u=Array.isArray(c)?c:[];return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Actividades del Parque"}),e.jsxs("p",{className:"text-sm text-gray-600",children:[u.length," actividad",u.length!==1?"es":""," programada",u.length!==1?"s":""]})]}),e.jsxs(d,{onClick:C,variant:"outline",className:"border-green-600 text-green-600 hover:bg-green-50",children:[e.jsx(Qe,{className:"h-4 w-4 mr-2"}),"Gestionar en Actividades"]})]}),u.length===0?e.jsx(w,{children:e.jsx(E,{className:"py-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx(ge,{className:"h-12 w-12 mx-auto mb-4 text-gray-400"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No hay actividades programadas"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Comienza agregando la primera actividad para este parque."}),e.jsxs(d,{onClick:C,className:"bg-green-600 hover:bg-green-700",children:[e.jsx(Qe,{className:"h-4 w-4 mr-2"}),"Ir al Módulo de Actividades"]})]})})}):e.jsx("div",{className:"grid gap-4",children:u.map(l=>{const D=Ns[l.category]||"bg-gray-100 text-gray-800";return e.jsxs(w,{className:"hover:shadow-md transition-shadow",children:[e.jsx(T,{className:"pb-3",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(P,{className:"text-lg",children:l.title}),e.jsx(v,{className:D,children:l.category})]}),e.jsx("p",{className:"text-sm text-gray-600 line-clamp-2",children:l.description})]}),e.jsx("div",{className:"flex gap-1 ml-4",children:e.jsxs(d,{variant:"outline",size:"sm",onClick:()=>y(l.id),className:"text-green-600 border-green-600 hover:bg-green-50",children:[e.jsx(He,{className:"h-4 w-4 mr-1"}),"Ver detalle"]})})]})}),e.jsxs(E,{className:"pt-0",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ge,{className:"h-4 w-4 text-gray-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Inicio"}),e.jsx("p",{className:"text-gray-600",children:l.startDate?is(new Date(l.startDate),"dd/MM/yyyy",{locale:cs}):"Sin fecha"})]})]}),l.startTime&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ls,{className:"h-4 w-4 text-gray-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Horario"}),e.jsx("p",{className:"text-gray-600",children:l.startTime})]})]}),l.capacity&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(W,{className:"h-4 w-4 text-gray-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Capacidad"}),e.jsxs("p",{className:"text-gray-600",children:[l.capacity," personas"]})]})]}),l.instructorName&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(W,{className:"h-4 w-4 text-gray-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Instructor"}),e.jsx("p",{className:"text-gray-600",children:l.instructorName})]})]})]}),e.jsxs("div",{className:"mt-3 flex flex-wrap gap-2",children:[l.isFree&&e.jsx(v,{variant:"outline",className:"bg-green-50 text-green-700 border-green-200",children:"Gratuita"}),l.price&&e.jsxs(v,{variant:"outline",className:"bg-yellow-50 text-yellow-700 border-yellow-200",children:["$",l.price," MXN"]}),l.isRecurring&&e.jsx(v,{variant:"outline",className:"bg-blue-50 text-blue-700 border-blue-200",children:"Recurrente"}),l.duration&&e.jsxs(v,{variant:"outline",className:"bg-gray-50 text-gray-700 border-gray-200",children:[l.duration," min"]})]})]})]},l.id)})})]})}const _e={active:"Activo",inactive:"Inactivo",pending:"Pendiente",suspended:"Suspendido"};function ys({parkId:t}){const{toast:i}=je(),c=Ne(),[j,g]=x.useState(""),[y,C]=x.useState("all"),{data:u=[],isLoading:l}=X({queryKey:[`/api/parks/${t}/volunteers`],queryFn:async()=>{console.log("🔍 FRONTEND: Cargando voluntarios asignados para parque",t);const r=await fetch(`/api/parks/${t}/volunteers`,{headers:{Authorization:"Bearer direct-token-1750522117022","X-User-Id":"1","X-User-Role":"super_admin"}});if(!r.ok)throw new Error("Error cargando voluntarios asignados");const o=await r.json();return console.log("✅ FRONTEND: Voluntarios asignados cargados:",o),o},enabled:!!t}),{data:D=[]}=X({queryKey:["/api/volunteers"],queryFn:async()=>{const r=await fetch("/api/volunteers",{headers:{Authorization:"Bearer direct-token-1750522117022","X-User-Id":"1","X-User-Role":"super_admin"}});if(!r.ok)throw new Error("Error cargando voluntarios disponibles");return r.json()}}),q=u.map(r=>r.id),f=D.filter(r=>!q.includes(r.id)&&r.status==="active").filter(r=>{var U;const o=j===""||r.fullName.toLowerCase().includes(j.toLowerCase())||r.email.toLowerCase().includes(j.toLowerCase())||((U=r.skills)==null?void 0:U.toLowerCase().includes(j.toLowerCase())),N=y==="all"||r.status===y;return o&&N}),p=F({mutationFn:async r=>{const o=await fetch(`/api/parks/${t}/volunteers`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer direct-token-1750522117022","X-User-Id":"1","X-User-Role":"super_admin"},body:JSON.stringify({volunteerId:r})});if(!o.ok)throw new Error("Error asignando voluntario");return o.json()},onSuccess:()=>{c.invalidateQueries({queryKey:[`/api/parks/${t}/volunteers`]}),c.invalidateQueries({queryKey:["/api/volunteers"]}),i({title:"Voluntario asignado",description:"El voluntario ha sido asignado correctamente al parque"})},onError:r=>{i({title:"Error",description:"Error al asignar voluntario al parque",variant:"destructive"})}}),$=F({mutationFn:async r=>{const o=await fetch(`/api/parks/${t}/volunteers/${r}`,{method:"DELETE",headers:{Authorization:"Bearer direct-token-1750522117022","X-User-Id":"1","X-User-Role":"super_admin"}});if(!o.ok)throw new Error("Error removiendo voluntario");return o.json()},onSuccess:()=>{c.invalidateQueries({queryKey:[`/api/parks/${t}/volunteers`]}),c.invalidateQueries({queryKey:["/api/volunteers"]}),i({title:"Voluntario removido",description:"El voluntario ha sido removido correctamente del parque"})},onError:r=>{i({title:"Error",description:"Error al remover voluntario del parque",variant:"destructive"})}}),k=r=>{p.mutate(r)},I=r=>{$.mutate(r)},z=r=>({active:"default",inactive:"secondary",pending:"outline",suspended:"destructive"})[r]||"secondary",L=r=>new Date(r).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric"});return e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(w,{children:[e.jsxs(T,{children:[e.jsxs(P,{className:"flex items-center gap-2",children:[e.jsx(W,{className:"h-5 w-5"}),"Voluntarios Disponibles (",f.length,")"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(We,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(b,{placeholder:"Buscar voluntarios...",value:j,onChange:r=>g(r.target.value),className:"pl-10"})]}),e.jsxs(d,{variant:"outline",size:"sm",onClick:()=>{g(""),C("all")},children:[e.jsx(os,{className:"h-4 w-4 mr-1"}),"Limpiar"]})]})]}),e.jsx(E,{children:e.jsxs("div",{className:"space-y-3 max-h-[600px] overflow-y-auto",children:[f.map(r=>e.jsx("div",{className:"border rounded-lg p-4 hover:bg-gray-50 transition-colors",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("h4",{className:"font-semibold",children:r.fullName}),e.jsx(v,{variant:z(r.status),children:_e[r.status]||r.status})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-2 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Re,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{className:"text-gray-600",children:r.email})]}),r.phone&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Oe,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{className:"text-gray-600",children:r.phone})]}),r.skills&&e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Habilidades:"}),e.jsx("span",{className:"text-gray-600",children:r.skills})]}),r.age&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ds,{className:"h-4 w-4 text-gray-500"}),e.jsxs("span",{className:"text-gray-600",children:[r.age," años"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Registrado:"}),e.jsx("span",{className:"text-gray-600",children:L(r.createdAt)})]})]})]}),e.jsxs(d,{size:"sm",onClick:()=>k(r.id),disabled:p.isPending,children:[e.jsx(le,{className:"h-4 w-4 mr-1"}),"Asignar"]})]})},r.id)),f.length===0&&e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(W,{className:"h-12 w-12 mx-auto mb-3 text-gray-300"}),e.jsx("p",{className:"text-lg font-medium mb-2",children:"No hay voluntarios disponibles"}),e.jsx("p",{className:"text-sm",children:"Todos los voluntarios activos ya están asignados a parques."})]})]})})]}),e.jsxs(w,{children:[e.jsx(T,{children:e.jsxs(P,{className:"flex items-center gap-2",children:[e.jsx(W,{className:"h-5 w-5"}),"Voluntarios Asignados (",u.length,")"]})}),e.jsx(E,{children:e.jsxs("div",{className:"space-y-3 max-h-[600px] overflow-y-auto",children:[u.map(r=>e.jsx("div",{className:"border rounded-lg p-4 bg-green-50 hover:bg-green-100 transition-colors",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("h4",{className:"font-semibold",children:r.fullName}),e.jsx(v,{variant:z(r.status),children:_e[r.status]||r.status})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-2 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Re,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{className:"text-gray-600",children:r.email})]}),r.phone&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Oe,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{className:"text-gray-600",children:r.phone})]}),r.skills&&e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Habilidades:"}),e.jsx("span",{className:"text-gray-600",children:r.skills})]}),r.interestAreas&&e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Intereses:"}),e.jsx("span",{className:"text-gray-600",children:r.interestAreas})]})]})]}),e.jsxs(d,{size:"sm",variant:"destructive",onClick:()=>I(r.id),disabled:$.isPending,children:[e.jsx(me,{className:"h-4 w-4 mr-1"}),"Remover"]})]})},r.id)),u.length===0&&e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(W,{className:"h-12 w-12 mx-auto mb-3 text-gray-300"}),e.jsx("p",{className:"text-lg font-medium mb-2",children:"No hay voluntarios asignados"}),e.jsx("p",{className:"text-sm",children:"Selecciona voluntarios de la columna izquierda para asignarlos a este parque."})]})]})})]})]})}function Cs(){const{id:t}=ms(),{data:i,isLoading:c,error:j}=X({queryKey:[`/api/parks/${t}`],queryFn:async()=>{const g=await fetch(`/api/parks/${t}`,{headers:{Authorization:"Bearer direct-token-1750522117022","X-User-Id":"1","X-User-Role":"super_admin"}});if(!g.ok)throw new Error("Error cargando parque");return g.json()},enabled:!!t});return c?e.jsx(fe,{children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900 mx-auto"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Cargando parque..."})]})})}):j||!i?e.jsx(fe,{children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-red-600",children:"Error cargando el parque"}),e.jsx(Ke,{href:"/admin/parks",children:e.jsx(d,{className:"mt-4",children:"Volver a parques"})})]})})}):e.jsx(fe,{children:e.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(Ke,{href:"/admin/parks",children:e.jsxs(d,{variant:"outline",size:"sm",children:[e.jsx(xs,{className:"h-4 w-4 mr-2"}),"Volver"]})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:i.name}),e.jsxs("div",{className:"flex items-center text-gray-600 mt-1",children:[e.jsx(te,{className:"h-4 w-4 mr-1"}),e.jsx("span",{className:"text-sm",children:i.address})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(us,{className:"h-5 w-5 text-blue-600"}),e.jsx("span",{className:"text-sm font-medium text-blue-600",children:"Modo Gestión"})]})]}),e.jsxs(Ge,{defaultValue:"multimedia",className:"space-y-4",children:[e.jsxs(Ze,{className:"grid w-full grid-cols-6",children:[e.jsxs(Z,{value:"multimedia",className:"flex items-center gap-2",children:[e.jsx(Ve,{className:"h-4 w-4"}),"Multimedia"]}),e.jsxs(Z,{value:"amenidades",className:"flex items-center gap-2",children:[e.jsx(te,{className:"h-4 w-4"}),"Amenidades"]}),e.jsxs(Z,{value:"actividades",className:"flex items-center gap-2",children:[e.jsx(ge,{className:"h-4 w-4"}),"Actividades"]}),e.jsxs(Z,{value:"arboles",className:"flex items-center gap-2",children:[e.jsx(ne,{className:"h-4 w-4"}),"Árboles"]}),e.jsxs(Z,{value:"voluntarios",className:"flex items-center gap-2",children:[e.jsx(W,{className:"h-4 w-4"}),"Voluntarios"]}),e.jsxs(Z,{value:"incidencias",className:"flex items-center gap-2",children:[e.jsx(be,{className:"h-4 w-4"}),"Incidencias"]})]}),e.jsx(H,{value:"multimedia",className:"space-y-4",children:e.jsxs(w,{children:[e.jsxs(T,{children:[e.jsxs(P,{className:"text-2xl text-blue-600 flex items-center gap-2",children:[e.jsx(Ve,{className:"h-6 w-6"}),"Gestión de Multimedia del Parque"]}),e.jsx(J,{children:"Administra imágenes y documentos del parque. Puedes subir archivos o usar URLs externas."})]}),e.jsx(E,{children:e.jsx(hs,{parkId:parseInt(t||"0")})})]})}),e.jsx(H,{value:"amenidades",className:"space-y-4",children:e.jsxs(w,{children:[e.jsxs(T,{children:[e.jsxs(P,{className:"text-2xl text-green-600 flex items-center gap-2",children:[e.jsx(te,{className:"h-6 w-6"}),"Gestión de Amenidades del Parque"]}),e.jsx(J,{children:"Administra las amenidades y servicios disponibles en el parque. Puedes agregar nuevas amenidades o editar las existentes."})]}),e.jsx(E,{children:e.jsx(gs,{parkId:parseInt(t)})})]})}),e.jsx(H,{value:"actividades",className:"space-y-4",children:e.jsxs(w,{children:[e.jsxs(T,{children:[e.jsxs(P,{className:"text-2xl text-blue-600 flex items-center gap-2",children:[e.jsx(ge,{className:"h-6 w-6"}),"Actividades del Parque"]}),e.jsx(J,{children:"Visualiza las actividades programadas en este parque. Para gestionar actividades, utiliza el módulo de Actividades."})]}),e.jsx(E,{children:e.jsx(vs,{parkId:parseInt(t)})})]})}),e.jsx(H,{value:"arboles",className:"space-y-4",children:e.jsxs(w,{children:[e.jsxs(T,{children:[e.jsxs(P,{className:"text-2xl text-green-600 flex items-center gap-2",children:[e.jsx(ne,{className:"h-6 w-6"}),"Gestión de Especies Arbóreas del Parque"]}),e.jsx(J,{children:"Administra las especies arbóreas asignadas al parque. Puedes seleccionar especies del catálogo y configurar detalles de plantación."})]}),e.jsx(E,{children:e.jsx(js,{parkId:parseInt(t)})})]})}),e.jsx(H,{value:"voluntarios",className:"space-y-4",children:e.jsxs(w,{children:[e.jsxs(T,{children:[e.jsxs(P,{className:"text-2xl text-green-600 flex items-center gap-2",children:[e.jsx(W,{className:"h-6 w-6"}),"Gestión de Voluntarios del Parque"]}),e.jsx(J,{children:"Administra los voluntarios asignados al parque. Selecciona voluntarios disponibles de la columna izquierda para asignarlos a este parque."})]}),e.jsx(E,{children:e.jsx(ys,{parkId:parseInt(t)})})]})}),e.jsx(H,{value:"incidencias",className:"space-y-4",children:e.jsxs(w,{children:[e.jsxs(T,{children:[e.jsx(P,{children:"Gestión de Incidencias"}),e.jsx(J,{children:"Administra las incidencias reportadas en el parque."})]}),e.jsx(E,{children:e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(be,{className:"h-12 w-12 mx-auto mb-4 text-gray-400"}),e.jsx("p",{children:"Funcionalidad de gestión de incidencias próximamente"})]})})]})})]})]})})}export{Cs as default};
