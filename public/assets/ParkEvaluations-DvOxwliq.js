import{d as S,Y as E,u as j,j as e,B as n,A,S as d,C as o,a as M,b as $,c as p,U as z,at as L,au as B,M as R,h as K,f as T,s as h}from"./index-Dzu3mJf5.js";const g=({rating:s})=>e.jsx("div",{className:"flex items-center gap-1",children:[1,2,3,4,5].map(t=>e.jsx(d,{className:`h-4 w-4 ${t<=s?"fill-yellow-400 text-yellow-400":"text-gray-300"}`},t))}),U=({evaluation:s})=>{const t={cleanliness:"Limpieza",safety:"Seguridad",maintenance:"Mantenimiento",accessibility:"Accesibilidad",amenities:"Amenidades",activities:"Actividades",staff:"Personal",natural_beauty:"Belleza Natural"};return e.jsx(o,{className:"mb-4",children:e.jsxs(p,{className:"pt-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-lg",children:s.evaluator_name}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(R,{className:"h-3 w-3"}),e.jsx("span",{children:s.evaluator_city})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(g,{rating:s.overall_rating}),e.jsxs("span",{className:"text-sm font-medium",children:[s.overall_rating,"/5"]})]}),e.jsx("div",{className:"text-xs text-gray-500",children:new Date(s.created_at).toLocaleDateString()})]})]}),e.jsx("div",{className:"grid grid-cols-4 gap-2 mb-4",children:Object.entries(t).map(([r,c])=>e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xs text-gray-600 mb-1",children:c}),e.jsx("div",{className:"flex justify-center",children:e.jsx(g,{rating:s[r]})})]},r))}),s.comments&&e.jsx("div",{className:"mb-3",children:e.jsxs("p",{className:"text-sm text-gray-700 italic",children:['"',s.comments,'"']})}),s.suggestions&&e.jsx("div",{className:"mb-3",children:e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("strong",{children:"Sugerencias:"})," ",s.suggestions]})}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-600",children:[s.visit_date&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(K,{className:"h-3 w-3"}),new Date(s.visit_date).toLocaleDateString()]}),s.visit_purpose&&e.jsxs("span",{children:["Propósito: ",s.visit_purpose]}),s.would_recommend&&e.jsx(T,{variant:"secondary",className:"text-xs",children:"Recomendado"})]})]})})};function G(){var N,u,f,y,b,w,_,C,k,q,P;const{parkSlug:s}=S(),[t,r]=E.useState(1),c=10,i=s==null?void 0:s.split("-").pop(),{data:a}=j({queryKey:["/api/parks",i,"evaluation-stats"],queryFn:()=>h(`/api/parks/${i}/evaluation-stats`),enabled:!!i}),{data:l}=j({queryKey:["/api/parks",i,"evaluations",t],queryFn:()=>h(`/api/parks/${i}/evaluations?page=${t}&limit=${c}`),enabled:!!i}),{data:m}=j({queryKey:["/api/parks",i],queryFn:()=>h(`/api/parks/${i}`),enabled:!!i}),v=(l==null?void 0:l.evaluations)||[],x=Math.ceil((((N=l==null?void 0:l.pagination)==null?void 0:N.total)||0)/c);return i?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white shadow",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(n,{variant:"ghost",size:"sm",onClick:()=>window.history.back(),children:[e.jsx(A,{className:"h-4 w-4 mr-2"}),"Volver"]}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900",children:["Evaluaciones de ",(m==null?void 0:m.name)||"Parque"]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Todas las evaluaciones ciudadanas del parque"})]})]}),e.jsxs(n,{className:"bg-green-600 hover:bg-green-700",onClick:()=>window.open(`/parque/${s}/evaluar`,"_blank"),children:[e.jsx(d,{className:"h-4 w-4 mr-2"}),"Evaluar este parque"]})]})})}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsxs(o,{className:"sticky top-4",children:[e.jsx(M,{children:e.jsxs($,{className:"flex items-center gap-2",children:[e.jsx(d,{className:"h-5 w-5 text-yellow-400"}),"Estadísticas Generales"]})}),e.jsx(p,{children:a&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-gray-900",children:((u=a.average_rating)==null?void 0:u.toFixed(1))||"0.0"}),e.jsx("div",{className:"flex justify-center mb-2",children:e.jsx(g,{rating:Math.round(a.average_rating||0)})}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Basado en ",Number(a.total_evaluations)||0," evaluaciones"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"5 estrellas"}),e.jsx("span",{children:a.five_star_count||0})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"4 estrellas"}),e.jsx("span",{children:a.four_star_count||0})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"3 estrellas"}),e.jsx("span",{children:a.three_star_count||0})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"2 estrellas"}),e.jsx("span",{children:a.two_star_count||0})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"1 estrella"}),e.jsx("span",{children:a.one_star_count||0})]})]}),e.jsxs("div",{className:"pt-4 border-t",children:[e.jsx("div",{className:"text-sm text-gray-600 mb-2",children:"Promedio por criterio:"}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{children:"Limpieza"}),e.jsx("span",{children:((f=a.avg_cleanliness)==null?void 0:f.toFixed(1))||"0.0"})]}),e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{children:"Seguridad"}),e.jsx("span",{children:((y=a.avg_safety)==null?void 0:y.toFixed(1))||"0.0"})]}),e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{children:"Mantenimiento"}),e.jsx("span",{children:((b=a.avg_maintenance)==null?void 0:b.toFixed(1))||"0.0"})]}),e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{children:"Accesibilidad"}),e.jsx("span",{children:((w=a.avg_accessibility)==null?void 0:w.toFixed(1))||"0.0"})]}),e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{children:"Amenidades"}),e.jsx("span",{children:((_=a.avg_amenities)==null?void 0:_.toFixed(1))||"0.0"})]}),e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{children:"Actividades"}),e.jsx("span",{children:((C=a.avg_activities)==null?void 0:C.toFixed(1))||"0.0"})]}),e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{children:"Personal"}),e.jsx("span",{children:((k=a.avg_staff)==null?void 0:k.toFixed(1))||"0.0"})]}),e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{children:"Belleza Natural"}),e.jsx("span",{children:((q=a.avg_natural_beauty)==null?void 0:q.toFixed(1))||"0.0"})]})]})]})]})})]})}),e.jsxs("div",{className:"lg:col-span-2",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("h2",{className:"text-xl font-semibold text-gray-900",children:["Evaluaciones (",((P=l==null?void 0:l.pagination)==null?void 0:P.total)||0,")"]})}),v.length===0?e.jsx(o,{children:e.jsxs(p,{className:"py-12 text-center",children:[e.jsx(z,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No hay evaluaciones aún"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Sé el primero en evaluar este parque"}),e.jsxs(n,{className:"bg-green-600 hover:bg-green-700",onClick:()=>window.open(`/parque/${s}/evaluar`,"_blank"),children:[e.jsx(d,{className:"h-4 w-4 mr-2"}),"Evaluar parque"]})]})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-4",children:v.map(F=>e.jsx(U,{evaluation:F},F.id))}),x>1&&e.jsxs("div",{className:"flex items-center justify-center gap-2 mt-8",children:[e.jsxs(n,{variant:"outline",size:"sm",onClick:()=>r(Math.max(1,t-1)),disabled:t===1,children:[e.jsx(L,{className:"h-4 w-4"}),"Anterior"]}),e.jsxs("span",{className:"text-sm text-gray-600",children:["Página ",t," de ",x]}),e.jsxs(n,{variant:"outline",size:"sm",onClick:()=>r(Math.min(x,t+1)),disabled:t===x,children:["Siguiente",e.jsx(B,{className:"h-4 w-4"})]})]})]})]})]})})]}):e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Parque no encontrado"}),e.jsxs(n,{onClick:()=>window.history.back(),children:[e.jsx(A,{className:"h-4 w-4 mr-2"}),"Volver"]})]})})}export{G as default};
