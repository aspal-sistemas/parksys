import{cl as F,al as I,Y as a,j as e,B as h,A as k,C as L,a as T,b as $,c as z,y as o,I as x,O as A}from"./index-BBGHPKhn.js";import{S as B}from"./save-BO66L-dX.js";function O(){const[,n]=F("/admin/assets/:id/edit-basic"),[,c]=I(),[l,p]=a.useState(!1),[v,t]=a.useState(""),[j,N]=a.useState(""),r=n==null?void 0:n.id,[d,g]=a.useState(""),[b,f]=a.useState(""),[C,y]=a.useState(""),[S,E]=a.useState(""),[m,w]=a.useState("");a.useEffect(()=>{r&&fetch(`/api/assets/${r}`).then(s=>s.json()).then(s=>{g(s.name||""),f(s.description||""),y(s.serialNumber||""),E(s.notes||""),w(s.acquisitionCost||"")}).catch(s=>{console.error("Error al cargar activo:",s),t("Error al cargar el activo")})},[r]);const D=async()=>{if(!r){t("ID de activo no válido");return}if(!d.trim()){t("El nombre es obligatorio");return}p(!0),t(""),N("");try{const s={name:d.trim(),description:b.trim(),serialNumber:C.trim(),notes:S.trim(),parkId:5,categoryId:2,status:"activo",condition:"bueno",acquisitionCost:m?parseFloat(m):void 0};console.log("Enviando datos:",s);const u=await fetch(`/api/assets/${r}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(u.ok){const i=await u.json();console.log("Actualización exitosa:",i),N("¡Activo actualizado correctamente!"),setTimeout(()=>{c(`/admin/assets/${r}`)},2e3)}else{const i=await u.json();console.error("Error de respuesta:",i),t(i.message||"Error al actualizar el activo")}}catch(s){console.error("Error en la solicitud:",s),t("Error de conexión al servidor")}finally{p(!1)}};return e.jsxs("div",{className:"container mx-auto p-6",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsxs(h,{variant:"outline",size:"sm",onClick:()=>c(`/admin/assets/${r}`),children:[e.jsx(k,{className:"h-4 w-4 mr-2"}),"Volver al Activo"]}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Editar Activo (Básico)"})]}),e.jsxs(L,{className:"max-w-2xl",children:[e.jsx(T,{children:e.jsx($,{children:"Información del Activo"})}),e.jsxs(z,{className:"space-y-4",children:[v&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded",children:v}),j&&e.jsx("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded",children:j}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"name",children:"Nombre *"}),e.jsx(x,{id:"name",value:d,onChange:s=>g(s.target.value),placeholder:"Nombre del activo"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"description",children:"Descripción"}),e.jsx(A,{id:"description",value:b,onChange:s=>f(s.target.value),placeholder:"Descripción del activo",rows:3})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"serialNumber",children:"Número de Serie"}),e.jsx(x,{id:"serialNumber",value:C,onChange:s=>y(s.target.value),placeholder:"Número de serie"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"cost",children:"Costo de Adquisición"}),e.jsx(x,{id:"cost",type:"number",step:"0.01",value:m,onChange:s=>w(s.target.value),placeholder:"0.00"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"notes",children:"Notas"}),e.jsx(A,{id:"notes",value:S,onChange:s=>E(s.target.value),placeholder:"Notas adicionales",rows:3})]}),e.jsxs("div",{className:"flex gap-4 pt-4",children:[e.jsx(h,{variant:"outline",onClick:()=>c(`/admin/assets/${r}`),disabled:l,children:"Cancelar"}),e.jsxs(h,{onClick:D,disabled:l,children:[l?"Guardando...":"Guardar Cambios",e.jsx(B,{className:"ml-2 h-4 w-4"})]})]})]})]})]})}export{O as default};
