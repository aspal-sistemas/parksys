import{a2 as g,l as me,ae as ue,u as pe,af as O,ag as V,j as e,aX as ge,f as y,U as I,w as B,x as fe,B as u,bh as be,y as H,z as X,I as k,J as G,ai as M,aj as a,ak as r,al as n,am as o,O as t,an as i,Q as U,V as Q,W as J,Y as K,_ as N,$ as w,bC as $,b1 as ve,b2 as Ce,b3 as F,F as W,b as Y,b4 as _,g as D,h as z,a4 as ye,ab as L,i as R,aB as Ne,bH as we,bI as Se,bJ as Z,bK as j,bL as Te,bM as h,o as f,bq as Ee,ce as Fe,cf as m,cg as _e,ap as ee}from"./index-D5qLf1ib.js";import{H as De}from"./Helmet-BNepwt1P.js";import{U as ze}from"./user-round-7dlnkIYD.js";const se=Fe({name:m().min(3,{message:"El nombre debe tener al menos 3 caracteres"}),type:_e(["persona_fisica","persona_moral"],{required_error:"Debes seleccionar un tipo de concesionario"}),rfc:m().min(10,{message:"El RFC debe tener al menos 10 caracteres"}).max(13,{message:"El RFC no debe exceder 13 caracteres"}),tax_address:m().min(5,{message:"La dirección fiscal es obligatoria"}),legal_representative:m().optional(),phone:m().optional(),email:m().email({message:"Debe ser un correo electrónico válido"}).optional(),notes:m().optional()});function Ae(){const[ae,S]=g.useState(!1),[re,b]=g.useState(!1),[P,ne]=g.useState(null),[oe,ie]=g.useState("listado"),[p,le]=g.useState(""),{toast:v}=me(),A=ue(),{data:C=[],isLoading:ce}=pe({queryKey:["/api/concessionaires"]}),c=O({resolver:ee(se),defaultValues:{name:"",type:"persona_fisica",rfc:"",tax_address:"",legal_representative:"",phone:"",email:"",notes:""}}),l=O({resolver:ee(se),defaultValues:{name:"",type:"persona_fisica",rfc:"",tax_address:"",legal_representative:"",phone:"",email:"",notes:""}}),T=V({mutationFn:async s=>{const d=await fetch("/api/concessionaires",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!d.ok){const x=await d.json();throw new Error(x.message||"Error al crear el concesionario")}return d.json()},onSuccess:()=>{S(!1),c.reset(),A.invalidateQueries({queryKey:["/api/concessionaires"]}),v({title:"Concesionario creado",description:"El concesionario ha sido registrado correctamente."})},onError:s=>{v({title:"Error",description:s.message,variant:"destructive"})}}),E=V({mutationFn:async({id:s,...d})=>{const x=await fetch(`/api/concessionaires/${s}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)});if(!x.ok){const he=await x.json();throw new Error(he.message||"Error al actualizar el concesionario")}return x.json()},onSuccess:()=>{b(!1),l.reset(),A.invalidateQueries({queryKey:["/api/concessionaires"]}),v({title:"Concesionario actualizado",description:"Los datos del concesionario han sido actualizados correctamente."})},onError:s=>{v({title:"Error",description:s.message,variant:"destructive"})}}),te=s=>{T.mutate(s)},de=s=>{P&&E.mutate({...s,id:P.id})},xe=s=>{ne(s),l.reset({name:s.name,type:s.type,rfc:s.rfc,tax_address:s.tax_address,legal_representative:s.legal_representative,phone:s.phone,email:s.email,notes:s.notes}),b(!0)},je=s=>{switch(s){case"activo":return e.jsx(f,{className:"bg-green-500",children:"Activo"});case"inactivo":return e.jsx(f,{variant:"secondary",children:"Inactivo"});case"suspendido":return e.jsx(f,{variant:"destructive",children:"Suspendido"});default:return e.jsx(f,{variant:"outline",children:s})}},q=p?Array.isArray(C)?C.filter(s=>{var d,x;return((d=s.name)==null?void 0:d.toLowerCase().includes(p.toLowerCase()))||((x=s.rfc)==null?void 0:x.toLowerCase().includes(p.toLowerCase()))}):[]:Array.isArray(C)?C:[];return e.jsxs(ge,{children:[e.jsxs(De,{children:[e.jsx("title",{children:"Registro de Concesionarios | Bosques Urbanos"}),e.jsx("meta",{name:"description",content:"Gestión de concesionarios autorizados para operar en los parques"})]}),e.jsxs("div",{className:"container mx-auto py-6",children:[e.jsx(y,{className:"p-4 bg-gray-50 mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{className:"w-8 h-8 text-gray-900"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Gestión de Concesionarios"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Administra los concesionarios autorizados para operar en los parques"})]})]}),e.jsxs(B,{open:ae,onOpenChange:S,children:[e.jsx(fe,{asChild:!0,children:e.jsxs(u,{className:"gap-2",children:[e.jsx(be,{size:16}),"Nuevo Concesionario"]})}),e.jsxs(H,{className:"sm:max-w-[800px]",children:[e.jsxs(X,{children:[e.jsx(k,{children:"Crear nuevo concesionario"}),e.jsx(G,{children:"Registra un nuevo concesionario autorizado para operar en los parques."})]}),e.jsx(M,{...c,children:e.jsxs("form",{onSubmit:c.handleSubmit(te),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(a,{control:c.control,name:"name",render:({field:s})=>e.jsxs(r,{children:[e.jsx(n,{children:"Nombre o Razón Social *"}),e.jsx(o,{children:e.jsx(t,{...s})}),e.jsx(i,{})]})}),e.jsx(a,{control:c.control,name:"type",render:({field:s})=>e.jsxs(r,{children:[e.jsx(n,{children:"Tipo de Concesionario *"}),e.jsxs(U,{onValueChange:s.onChange,defaultValue:s.value,children:[e.jsx(o,{children:e.jsx(Q,{children:e.jsx(J,{placeholder:"Selecciona un tipo"})})}),e.jsxs(K,{children:[e.jsx(N,{value:"persona_fisica",children:"Persona Física"}),e.jsx(N,{value:"persona_moral",children:"Persona Moral"})]})]}),e.jsx(i,{})]})}),e.jsx(a,{control:c.control,name:"rfc",render:({field:s})=>e.jsxs(r,{children:[e.jsx(n,{children:"RFC *"}),e.jsx(o,{children:e.jsx(t,{...s,placeholder:"Ej: XAXX010101000"})}),e.jsx(i,{})]})}),e.jsx(a,{control:c.control,name:"legal_representative",render:({field:s})=>e.jsxs(r,{children:[e.jsx(n,{children:"Representante Legal"}),e.jsx(o,{children:e.jsx(t,{...s})}),e.jsx(i,{})]})}),e.jsx(a,{control:c.control,name:"phone",render:({field:s})=>e.jsxs(r,{children:[e.jsx(n,{children:"Teléfono"}),e.jsx(o,{children:e.jsx(t,{...s})}),e.jsx(i,{})]})}),e.jsx(a,{control:c.control,name:"email",render:({field:s})=>e.jsxs(r,{children:[e.jsx(n,{children:"Correo Electrónico"}),e.jsx(o,{children:e.jsx(t,{...s,type:"email"})}),e.jsx(i,{})]})})]}),e.jsx(a,{control:c.control,name:"tax_address",render:({field:s})=>e.jsxs(r,{children:[e.jsx(n,{children:"Dirección Fiscal *"}),e.jsx(o,{children:e.jsx(w,{...s,rows:2})}),e.jsx(i,{})]})}),e.jsx(a,{control:c.control,name:"notes",render:({field:s})=>e.jsxs(r,{children:[e.jsx(n,{children:"Notas adicionales"}),e.jsx(o,{children:e.jsx(w,{...s,rows:3})}),e.jsx(i,{})]})}),e.jsxs($,{children:[e.jsx(u,{type:"button",variant:"outline",onClick:()=>S(!1),children:"Cancelar"}),e.jsx(u,{type:"submit",disabled:T.isPending,children:T.isPending?"Guardando...":"Guardar concesionario"})]})]})})]})]})]})}),e.jsxs(ve,{value:oe,onValueChange:ie,className:"w-full",children:[e.jsxs(Ce,{className:"grid grid-cols-3 w-[400px]",children:[e.jsxs(F,{value:"listado",children:[e.jsx(I,{className:"h-4 w-4 mr-2"}),"Listado"]}),e.jsxs(F,{value:"documentos",children:[e.jsx(W,{className:"h-4 w-4 mr-2"}),"Documentación"]}),e.jsxs(F,{value:"evaluaciones",children:[e.jsx(Y,{className:"h-4 w-4 mr-2"}),"Evaluaciones"]})]}),e.jsx(_,{value:"listado",children:e.jsxs(y,{children:[e.jsxs(D,{className:"pb-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(z,{children:"Concesionarios Registrados"}),e.jsxs("div",{className:"relative w-64",children:[e.jsx(ye,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(t,{placeholder:"Buscar por nombre o RFC",className:"pl-8",value:p,onChange:s=>le(s.target.value)})]})]}),e.jsx(L,{children:"Listado de personas físicas y morales autorizadas para operar concesiones"})]}),e.jsx(R,{children:ce?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Ne,{className:"h-6 w-6 animate-spin mx-auto mb-2"}),e.jsx("p",{children:"Cargando concesionarios..."})]}):q.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ze,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-lg font-medium",children:"No hay concesionarios registrados"}),e.jsx("p",{className:"text-muted-foreground",children:p?"No se encontraron resultados":"Comienza registrando tu primer concesionario"})]}):e.jsxs(we,{children:[e.jsx(Se,{children:e.jsxs(Z,{children:[e.jsx(j,{children:"Nombre/Razón Social"}),e.jsx(j,{children:"Tipo"}),e.jsx(j,{children:"RFC"}),e.jsx(j,{children:"Teléfono"}),e.jsx(j,{children:"Email"}),e.jsx(j,{children:"Estado"}),e.jsx(j,{children:"Acciones"})]})}),e.jsx(Te,{children:q.map(s=>e.jsxs(Z,{children:[e.jsx(h,{className:"font-medium",children:s.name}),e.jsx(h,{children:e.jsx(f,{variant:"outline",children:s.type==="persona_fisica"?"P. Física":"P. Moral"})}),e.jsx(h,{className:"font-mono text-sm",children:s.rfc}),e.jsx(h,{children:s.phone||"-"}),e.jsx(h,{children:s.email||"-"}),e.jsx(h,{children:je(s.status||"activo")}),e.jsx(h,{children:e.jsx(u,{variant:"outline",size:"sm",onClick:()=>xe(s),children:e.jsx(Ee,{className:"h-4 w-4"})})})]},s.id))})]})})]})}),e.jsx(_,{value:"documentos",children:e.jsxs(y,{children:[e.jsxs(D,{children:[e.jsx(z,{children:"Documentos de Concesionarios"}),e.jsx(L,{children:"Gestiona los documentos requeridos para cada concesionario"})]}),e.jsx(R,{children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(W,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-lg font-medium",children:"Gestión de Documentos"}),e.jsx("p",{className:"text-muted-foreground",children:"Funcionalidad próximamente disponible"})]})})]})}),e.jsx(_,{value:"evaluaciones",children:e.jsxs(y,{children:[e.jsxs(D,{children:[e.jsx(z,{children:"Evaluaciones de Desempeño"}),e.jsx(L,{children:"Califica el desempeño de los concesionarios"})]}),e.jsx(R,{children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Y,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-lg font-medium",children:"Sistema de Evaluaciones"}),e.jsx("p",{className:"text-muted-foreground",children:"Funcionalidad próximamente disponible"})]})})]})})]}),e.jsx(B,{open:re,onOpenChange:b,children:e.jsxs(H,{className:"sm:max-w-[600px]",children:[e.jsxs(X,{children:[e.jsx(k,{children:"Editar Concesionario"}),e.jsx(G,{children:"Actualiza los datos fiscales y de contacto del concesionario."})]}),e.jsx(M,{...l,children:e.jsxs("form",{onSubmit:l.handleSubmit(de),className:"space-y-4",children:[e.jsx(a,{control:l.control,name:"name",render:({field:s})=>e.jsxs(r,{children:[e.jsx(n,{children:"Nombre o Razón Social *"}),e.jsx(o,{children:e.jsx(t,{...s})}),e.jsx(i,{})]})}),e.jsx(a,{control:l.control,name:"type",render:({field:s})=>e.jsxs(r,{children:[e.jsx(n,{children:"Tipo de Concesionario *"}),e.jsxs(U,{onValueChange:s.onChange,defaultValue:s.value,children:[e.jsx(o,{children:e.jsx(Q,{children:e.jsx(J,{placeholder:"Selecciona un tipo"})})}),e.jsxs(K,{children:[e.jsx(N,{value:"persona_fisica",children:"Persona Física"}),e.jsx(N,{value:"persona_moral",children:"Persona Moral"})]})]}),e.jsx(i,{})]})}),e.jsx(a,{control:l.control,name:"rfc",render:({field:s})=>e.jsxs(r,{children:[e.jsx(n,{children:"RFC *"}),e.jsx(o,{children:e.jsx(t,{...s,placeholder:"Ej: XAXX010101000"})}),e.jsx(i,{})]})}),e.jsx(a,{control:l.control,name:"tax_address",render:({field:s})=>e.jsxs(r,{children:[e.jsx(n,{children:"Dirección Fiscal *"}),e.jsx(o,{children:e.jsx(w,{...s,rows:2})}),e.jsx(i,{})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(a,{control:l.control,name:"phone",render:({field:s})=>e.jsxs(r,{children:[e.jsx(n,{children:"Teléfono"}),e.jsx(o,{children:e.jsx(t,{...s})}),e.jsx(i,{})]})}),e.jsx(a,{control:l.control,name:"email",render:({field:s})=>e.jsxs(r,{children:[e.jsx(n,{children:"Correo Electrónico"}),e.jsx(o,{children:e.jsx(t,{...s,type:"email"})}),e.jsx(i,{})]})})]}),e.jsx(a,{control:l.control,name:"legal_representative",render:({field:s})=>e.jsxs(r,{children:[e.jsx(n,{children:"Representante Legal"}),e.jsx(o,{children:e.jsx(t,{...s})}),e.jsx(i,{})]})}),e.jsx(a,{control:l.control,name:"notes",render:({field:s})=>e.jsxs(r,{children:[e.jsx(n,{children:"Notas adicionales"}),e.jsx(o,{children:e.jsx(w,{...s,rows:3})}),e.jsx(i,{})]})}),e.jsxs($,{children:[e.jsx(u,{type:"button",variant:"outline",onClick:()=>b(!1),children:"Cancelar"}),e.jsx(u,{type:"submit",disabled:E.isPending,children:E.isPending?"Actualizando...":"Actualizar concesionario"})]})]})})]})})]})]})}export{Ae as default};
