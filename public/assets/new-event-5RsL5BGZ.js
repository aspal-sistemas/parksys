import{az as E,l as T,ae as w,af as I,u as g,ag as D,j as e,aX as P,bh as k,f as c,g as l,h as o,F as L,i as d,N as r,O as a,Q as u,V as _,W as v,Y as y,_ as N,$ as f,m as V,M as $,U as M,B as S,n as H,bG as K,ad as i,ap as Q,aq as U}from"./index-D5qLf1ib.js";const B=i.object({title:i.string().min(1,"El título es requerido").max(255,"El título es muy largo"),description:i.string().min(1,"La descripción es requerida"),start_date:i.string().min(1,"La fecha de inicio es requerida"),end_date:i.string().optional(),start_time:i.string().min(1,"La hora de inicio es requerida"),end_time:i.string().optional(),park_id:i.string().min(1,"Debe seleccionar un parque"),category:i.string().min(1,"Debe seleccionar una categoría"),capacity:i.string().optional(),location:i.string().optional(),contact_email:i.string().email("Email inválido").optional().or(i.literal("")),contact_phone:i.string().optional(),registration_required:i.boolean().default(!1),price:i.string().optional(),notes:i.string().optional()});function z(){const[,p]=E(),{toast:j}=T(),F=w(),t=I({resolver:Q(B),defaultValues:{title:"",description:"",start_date:"",end_date:"",start_time:"",end_time:"",park_id:"",category:"",capacity:"",location:"",contact_email:"",contact_phone:"",registration_required:!1,price:"",notes:""}}),{data:m}=g({queryKey:["/api/parks"],select:s=>s.map(n=>({id:n.id,name:n.name}))}),{data:x}=g({queryKey:["/api/event-categories"]}),h=D({mutationFn:async s=>{const n=`${s.start_date}T${s.start_time}:00`,C=s.end_date&&s.end_time?`${s.end_date}T${s.end_time}:00`:s.end_date?`${s.end_date}T23:59:59`:n,q={title:s.title,description:s.description,start_date:n,end_date:C,park_id:parseInt(s.park_id),category:s.category,capacity:s.capacity?parseInt(s.capacity):null,location:s.location||null,contact_email:s.contact_email||null,contact_phone:s.contact_phone||null,registration_required:s.registration_required,price:s.price?parseFloat(s.price):null,notes:s.notes||null,status:"programado"};return U("/api/activities",{method:"POST",body:JSON.stringify(q)})},onSuccess:()=>{j({title:"Evento creado",description:"El evento ha sido creado exitosamente."}),F.invalidateQueries({queryKey:["/api/activities"]}),p("/admin/activities")},onError:s=>{j({title:"Error",description:s.message||"Error al crear el evento",variant:"destructive"})}}),b=s=>{h.mutate(s)};return e.jsx(P,{children:e.jsxs("div",{className:"container mx-auto py-6 max-w-4xl",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[e.jsx(k,{className:"w-8 h-8"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Nuevo Evento"}),e.jsx("p",{className:"text-gray-600",children:"Crear un nuevo evento o actividad para los parques"})]})]}),e.jsxs("form",{onSubmit:t.handleSubmit(b),className:"space-y-6",children:[e.jsxs(c,{children:[e.jsx(l,{children:e.jsxs(o,{className:"flex items-center gap-2",children:[e.jsx(L,{className:"h-5 w-5"}),"Información Básica"]})}),e.jsxs(d,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(r,{htmlFor:"title",children:"Título del Evento *"}),e.jsx(a,{id:"title",...t.register("title"),placeholder:"Ej: Yoga matutino en el parque"}),t.formState.errors.title&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:t.formState.errors.title.message})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"category",children:"Categoría *"}),e.jsxs(u,{onValueChange:s=>t.setValue("category",s),children:[e.jsx(_,{children:e.jsx(v,{placeholder:"Seleccionar categoría"})}),e.jsx(y,{children:x==null?void 0:x.map(s=>e.jsx(N,{value:s.name,children:s.name},s.id))})]}),t.formState.errors.category&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:t.formState.errors.category.message})]})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"description",children:"Descripción *"}),e.jsx(f,{id:"description",...t.register("description"),placeholder:"Describe el evento, actividades incluidas, requisitos, etc.",rows:4}),t.formState.errors.description&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:t.formState.errors.description.message})]})]})]}),e.jsxs(c,{children:[e.jsx(l,{children:e.jsxs(o,{className:"flex items-center gap-2",children:[e.jsx(V,{className:"h-5 w-5"}),"Fecha y Hora"]})}),e.jsxs(d,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(r,{htmlFor:"start_date",children:"Fecha de Inicio *"}),e.jsx(a,{id:"start_date",type:"date",...t.register("start_date")}),t.formState.errors.start_date&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:t.formState.errors.start_date.message})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"end_date",children:"Fecha de Fin"}),e.jsx(a,{id:"end_date",type:"date",...t.register("end_date")})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(r,{htmlFor:"start_time",children:"Hora de Inicio *"}),e.jsx(a,{id:"start_time",type:"time",...t.register("start_time")}),t.formState.errors.start_time&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:t.formState.errors.start_time.message})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"end_time",children:"Hora de Fin"}),e.jsx(a,{id:"end_time",type:"time",...t.register("end_time")})]})]})]})]}),e.jsxs(c,{children:[e.jsx(l,{children:e.jsxs(o,{className:"flex items-center gap-2",children:[e.jsx($,{className:"h-5 w-5"}),"Ubicación y Detalles"]})}),e.jsxs(d,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(r,{htmlFor:"park_id",children:"Parque *"}),e.jsxs(u,{onValueChange:s=>t.setValue("park_id",s),children:[e.jsx(_,{children:e.jsx(v,{placeholder:"Seleccionar parque"})}),e.jsx(y,{children:m==null?void 0:m.map(s=>e.jsx(N,{value:s.id.toString(),children:s.name},s.id))})]}),t.formState.errors.park_id&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:t.formState.errors.park_id.message})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"location",children:"Ubicación Específica"}),e.jsx(a,{id:"location",...t.register("location"),placeholder:"Ej: Área de juegos, Kiosco central"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(r,{htmlFor:"capacity",children:"Capacidad (personas)"}),e.jsx(a,{id:"capacity",type:"number",...t.register("capacity"),placeholder:"Ej: 50"})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"price",children:"Precio (MXN)"}),e.jsx(a,{id:"price",type:"number",step:"0.01",...t.register("price"),placeholder:"0.00 (gratis)"})]})]})]})]}),e.jsxs(c,{children:[e.jsx(l,{children:e.jsxs(o,{className:"flex items-center gap-2",children:[e.jsx(M,{className:"h-5 w-5"}),"Información de Contacto"]})}),e.jsxs(d,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(r,{htmlFor:"contact_email",children:"Email de Contacto"}),e.jsx(a,{id:"contact_email",type:"email",...t.register("contact_email"),placeholder:"evento@ejemplo.com"}),t.formState.errors.contact_email&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:t.formState.errors.contact_email.message})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"contact_phone",children:"Teléfono de Contacto"}),e.jsx(a,{id:"contact_phone",...t.register("contact_phone"),placeholder:"(33) 1234-5678"})]})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"notes",children:"Notas Adicionales"}),e.jsx(f,{id:"notes",...t.register("notes"),placeholder:"Información adicional, requisitos especiales, materiales necesarios, etc.",rows:3})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-4",children:[e.jsx(S,{type:"button",variant:"outline",onClick:()=>p("/admin/activities"),children:"Cancelar"}),e.jsx(S,{type:"submit",disabled:h.isPending,className:"bg-green-600 hover:bg-green-700",children:h.isPending?e.jsxs(e.Fragment,{children:[e.jsx(H,{className:"h-4 w-4 mr-2 animate-spin"}),"Creando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(K,{className:"h-4 w-4 mr-2"}),"Crear Evento"]})})]})]})]})})}export{z as default};
