import{az as H,a2 as f,u as D,j as e,aX as _,f as l,m,B as p,bh as J,g as c,aM as O,aN as B,Q as K,V as W,W as Y,Y as Q,_ as S,h as x,i as d,as as k,w as X,y as G,z as U,I as Z,M as ee,n as se,o as M}from"./index-D5qLf1ib.js";const v={pending:"bg-yellow-100 text-yellow-800 border-yellow-300",confirmed:"bg-green-100 text-green-800 border-green-300",cancelled:"bg-red-100 text-red-800 border-red-300",completed:"bg-blue-100 text-blue-800 border-blue-300"},L={pending:"Pendiente",confirmed:"Confirmada",cancelled:"Cancelada",completed:"Completada"},ae={playground:"Área de Juegos",kiosk:"Kiosco",picnic_area:"Área de Picnic",open_area:"Área Abierta",pavilion:"Pabellón"},te=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],re=["Dom","Lun","Mar","Mié","Jue","Vie","Sáb"];function ce(){const[le,$]=H(),[u,b]=f.useState(new Date),[a,y]=f.useState(null),[h,E]=f.useState("all"),n=u.getFullYear(),i=u.getMonth(),{data:F=[],isLoading:R}=D({queryKey:["/api/space-reservations",n,i+1],queryFn:async()=>{const s=await fetch(`/api/space-reservations?month=${i+1}&year=${n}`);if(!s.ok)throw new Error("Error al cargar las reservas");return s.json()}}),{data:j}=D({queryKey:["/api/parks"],queryFn:async()=>{const s=await fetch("/api/parks");if(!s.ok)throw new Error("Error al cargar los parques");return s.json()}}),P=(j==null?void 0:j.data)||j||[],o=F.filter(s=>h==="all"?!0:s.space_name.toLowerCase().includes(h.toLowerCase())||s.park_name.toLowerCase().includes(h.toLowerCase())),w=s=>{const t=new Date(u);t.setMonth(t.getMonth()+s),b(t)},T=()=>{b(new Date)},q=()=>{$("/admin/space-reservations/new")},z=new Date(n,i,1),I=new Date(n,i+1,0).getDate(),V=z.getDay(),g=[];for(let s=0;s<V;s++)g.push(null);for(let s=1;s<=I;s++)g.push(s);const N=s=>{const t=`${n}-${(i+1).toString().padStart(2,"0")}-${s.toString().padStart(2,"0")}`;return o.filter(r=>r.reservation_date.startsWith(t))},C=s=>{const t=new Date;return t.getFullYear()===n&&t.getMonth()===i&&t.getDate()===s},A=s=>{y(s)};return R?e.jsx(_,{children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})}):e.jsx(_,{children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx(l,{className:"p-4 bg-gray-50",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(m,{className:"w-8 h-8 text-gray-900"}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Calendario de Reservas"})]}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Visualiza las reservas de espacios en formato calendario"})]}),e.jsxs(p,{onClick:q,className:"bg-[#00a587] hover:bg-[#067f5f] text-white",children:[e.jsx(J,{className:"h-4 w-4 mr-2"}),"Nueva Reserva"]})]})}),e.jsx(l,{children:e.jsx(c,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(p,{variant:"outline",size:"sm",onClick:()=>w(-1),children:e.jsx(O,{className:"h-4 w-4"})}),e.jsxs("h2",{className:"text-xl font-semibold",children:[te[i]," ",n]}),e.jsx(p,{variant:"outline",size:"sm",onClick:()=>w(1),children:e.jsx(B,{className:"h-4 w-4"})}),e.jsx(p,{variant:"outline",size:"sm",onClick:T,children:"Hoy"})]}),e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs(K,{value:h,onValueChange:E,children:[e.jsx(W,{className:"w-[200px]",children:e.jsx(Y,{placeholder:"Filtrar por parque"})}),e.jsxs(Q,{children:[e.jsx(S,{value:"all",children:"Todos los parques"}),P.map(s=>e.jsx(S,{value:s.name,children:s.name},s.id))]})]})})]})})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs(l,{children:[e.jsxs(c,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(x,{className:"text-sm font-medium",children:"Reservas Este Mes"}),e.jsx(m,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(d,{children:e.jsx("div",{className:"text-2xl font-bold",children:o.length})})]}),e.jsxs(l,{children:[e.jsxs(c,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(x,{className:"text-sm font-medium",children:"Confirmadas"}),e.jsx(m,{className:"h-4 w-4 text-green-600"})]}),e.jsx(d,{children:e.jsx("div",{className:"text-2xl font-bold text-green-600",children:o.filter(s=>s.status==="confirmed").length})})]}),e.jsxs(l,{children:[e.jsxs(c,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(x,{className:"text-sm font-medium",children:"Pendientes"}),e.jsx(m,{className:"h-4 w-4 text-yellow-600"})]}),e.jsx(d,{children:e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:o.filter(s=>s.status==="pending").length})})]}),e.jsxs(l,{children:[e.jsxs(c,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(x,{className:"text-sm font-medium",children:"Ingresos del Mes"}),e.jsx(k,{className:"h-4 w-4 text-[#00a587]"})]}),e.jsx(d,{children:e.jsxs("div",{className:"text-2xl font-bold text-[#00a587]",children:["$",o.reduce((s,t)=>s+parseFloat(t.total_cost||"0"),0).toFixed(2)]})})]})]}),e.jsx(l,{children:e.jsxs(d,{className:"p-0",children:[e.jsx("div",{className:"grid grid-cols-7 border-b",children:re.map(s=>e.jsx("div",{className:"p-4 text-center font-medium text-gray-700 border-r last:border-r-0",children:s},s))}),e.jsx("div",{className:"grid grid-cols-7",children:g.map((s,t)=>e.jsx("div",{className:`min-h-[120px] border-r border-b last:border-r-0 p-2 ${s?"bg-white hover:bg-gray-50":"bg-gray-50"} ${C(s||0)?"bg-blue-50":""}`,children:s&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`text-sm font-medium mb-1 ${C(s)?"text-blue-600":"text-gray-900"}`,children:s}),e.jsxs("div",{className:"space-y-1",children:[N(s).slice(0,3).map(r=>e.jsxs("div",{onClick:()=>A(r),className:`text-xs p-1 rounded cursor-pointer border ${v[r.status]} hover:opacity-80`,children:[e.jsxs("div",{className:"font-medium truncate",children:[r.start_time," - ",r.space_name]}),e.jsx("div",{className:"truncate text-gray-600",children:r.customer_name})]},r.id)),N(s).length>3&&e.jsxs("div",{className:"text-xs text-gray-500 font-medium",children:["+",N(s).length-3," más..."]})]})]})},t))})]})}),e.jsxs(l,{children:[e.jsx(c,{children:e.jsx(x,{className:"text-base",children:"Leyenda de Estados"})}),e.jsx(d,{children:e.jsx("div",{className:"flex flex-wrap gap-4",children:Object.entries(v).map(([s,t])=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-4 h-4 rounded border ${t}`}),e.jsx("span",{className:"text-sm",children:L[s]})]},s))})})]}),e.jsx(X,{open:!!a,onOpenChange:s=>!s&&y(null),children:e.jsxs(G,{className:"max-w-2xl",children:[e.jsx(U,{children:e.jsx(Z,{children:"Detalles de la Reserva"})}),a&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Información del Cliente"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Nombre:"})," ",a.customer_name]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Email:"})," ",a.customer_email]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Teléfono:"})," ",a.customer_phone]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Información del Espacio"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"h-3 w-3"}),e.jsx("span",{children:a.space_name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Parque:"})," ",a.park_name]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Tipo:"})," ",ae[a.space_type]]})]})]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Detalles de la Reserva"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(m,{className:"h-3 w-3"}),e.jsx("span",{className:"font-medium",children:"Fecha:"}),e.jsx("span",{children:new Date(a.reservation_date).toLocaleDateString()})]}),e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(se,{className:"h-3 w-3"}),e.jsx("span",{className:"font-medium",children:"Horario:"}),e.jsxs("span",{children:[a.start_time," - ",a.end_time]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"font-medium",children:"Duración:"}),e.jsxs("span",{children:[a.total_hours," horas"]})]}),e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(k,{className:"h-3 w-3"}),e.jsx("span",{className:"font-medium",children:"Total:"}),e.jsxs("span",{className:"text-lg font-bold text-[#00a587]",children:["$",a.total_cost]})]})]})]})]}),a.special_requests&&e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Solicitudes Especiales"}),e.jsx("p",{className:"text-sm text-gray-600",children:a.special_requests})]}),e.jsx("div",{className:"border-t pt-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Estado:"}),e.jsx(M,{className:`ml-2 ${v[a.status]}`,children:L[a.status]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Depósito:"}),e.jsx(M,{className:`ml-2 ${a.deposit_paid?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:a.deposit_paid?"Pagado":"Pendiente"})]})]})})]})]})})]})})}export{ce as default};
