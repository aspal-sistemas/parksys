import{a5 as n,al as T,e as E,a6 as F,Y as D,u as q,a8 as f,j as e,aB as L,B as o,A as P,aW as k,C as y,a as I,b as M,b3 as Q,bh as B,bi as K,b4 as H,bj as R,bk as $,bl as G,bm as V,bn as U,bo as W,bp as Y,c as J,f as X,a7 as Z,ag as _,ah as b,D as ee,r as se,t as ae,v as ie,aa as re,ab as m,ac as x,ad as h,ae as u,I as j,af as p,O as te}from"./index-BBGHPKhn.js";const ne=n.object({name:n.string().min(1,"El nombre es obligatorio").max(100,"Máximo 100 caracteres"),description:n.string().optional(),color:n.string().regex(/^#[0-9A-F]{6}$/i,"Color debe ser un código hexadecimal válido").default("#00a587"),icon:n.string().min(1,"El icono es obligatorio").default("calendar"),sortOrder:n.number().default(0),isActive:n.boolean().default(!0)}),le=({category:s,onSuccess:c,isOpen:C,onOpenChange:v})=>{const{toast:t}=E(),g=F(),r=Z({resolver:_(ne),defaultValues:{name:(s==null?void 0:s.name)||"",description:(s==null?void 0:s.description)||"",color:(s==null?void 0:s.color)||"#00a587",icon:(s==null?void 0:s.icon)||"calendar",sortOrder:(s==null?void 0:s.sortOrder)||0,isActive:(s==null?void 0:s.isActive)??!0}}),l=f({mutationFn:a=>b("/api/activity-categories",{method:"POST",data:a}),onSuccess:()=>{g.invalidateQueries({queryKey:["/api/activity-categories"]}),t({title:"Categoría creada exitosamente"}),c()},onError:a=>{t({title:"Error al crear categoría",description:a.message,variant:"destructive"})}}),d=f({mutationFn:a=>b(`/api/activity-categories/${s==null?void 0:s.id}`,{method:"PUT",data:a}),onSuccess:()=>{g.invalidateQueries({queryKey:["/api/activity-categories"]}),t({title:"Categoría actualizada exitosamente"}),c()},onError:a=>{t({title:"Error al actualizar categoría",description:a.message,variant:"destructive"})}}),A=a=>{s?d.mutate(a):l.mutate(a)};return e.jsx(ee,{open:C,onOpenChange:v,children:e.jsxs(se,{className:"sm:max-w-[525px]","aria-describedby":"category-management-description",children:[e.jsx(ae,{children:e.jsx(ie,{children:s?"Editar Categoría":"Nueva Categoría"})}),e.jsx("div",{id:"category-management-description",className:"sr-only",children:"Formulario para crear o editar categorías de actividades"}),e.jsx(re,{...r,children:e.jsxs("form",{onSubmit:r.handleSubmit(A),className:"space-y-4",children:[e.jsx(m,{control:r.control,name:"name",render:({field:a})=>e.jsxs(x,{children:[e.jsx(h,{children:"Nombre"}),e.jsx(u,{children:e.jsx(j,{placeholder:"Ej. Arte y Cultura",...a})}),e.jsx(p,{})]})}),e.jsx(m,{control:r.control,name:"description",render:({field:a})=>e.jsxs(x,{children:[e.jsx(h,{children:"Descripción"}),e.jsx(u,{children:e.jsx(te,{placeholder:"Descripción de la categoría...",className:"resize-none",...a})}),e.jsx(p,{})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(m,{control:r.control,name:"color",render:({field:a})=>e.jsxs(x,{children:[e.jsx(h,{children:"Color"}),e.jsx(u,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(j,{type:"color",className:"w-12 h-9 p-1 border rounded-md",...a}),e.jsx(j,{placeholder:"#00a587",className:"flex-1",...a})]})}),e.jsx(p,{})]})}),e.jsx(m,{control:r.control,name:"sortOrder",render:({field:a})=>e.jsxs(x,{children:[e.jsx(h,{children:"Orden"}),e.jsx(u,{children:e.jsx(j,{type:"number",placeholder:"0",...a,onChange:N=>a.onChange(Number(N.target.value))})}),e.jsx(p,{})]})})]}),e.jsx(m,{control:r.control,name:"icon",render:({field:a})=>e.jsxs(x,{children:[e.jsx(h,{children:"Icono (Lucide)"}),e.jsx(u,{children:e.jsx(j,{placeholder:"calendar",...a})}),e.jsx(p,{})]})}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(o,{type:"button",variant:"outline",onClick:()=>v(!1),children:"Cancelar"}),e.jsx(o,{type:"submit",disabled:l.isPending||d.isPending,children:l.isPending||d.isPending?"Guardando...":s?"Actualizar":"Crear"})]})]})})]})})},ce=()=>{const[,s]=T(),{toast:c}=E(),C=F(),[v,t]=D.useState(),[g,r]=D.useState(!1),{data:l,isLoading:d,error:A}=q({queryKey:["/api/activity-categories"],queryFn:async()=>{const i=await b("/api/activity-categories");return i&&typeof i.json=="function"?await i.json():i}}),a=Array.isArray(l)?l:[],N=f({mutationFn:i=>b(`/api/activity-categories/${i}`,{method:"DELETE"}),onSuccess:()=>{C.invalidateQueries({queryKey:["/api/activity-categories"]}),c({title:"Categoría eliminada exitosamente"})},onError:i=>{c({title:"Error al eliminar categoría",description:i.message,variant:"destructive"})}}),w=i=>{t(i),r(!0)},O=()=>{t(void 0),r(!0)},S=()=>{r(!1),t(void 0)},z=i=>{N.mutate(i)};return e.jsx(L,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(o,{variant:"outline",onClick:()=>s("/admin/organizador"),className:"flex items-center gap-2",children:[e.jsx(P,{className:"h-4 w-4"}),"Volver al Organizador"]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Categorías de Actividades"}),e.jsx("p",{className:"text-gray-500",children:"Gestiona las categorías para organizar las actividades"})]})]}),e.jsxs(o,{onClick:O,className:"flex items-center gap-2",children:[e.jsx(k,{className:"h-4 w-4"}),"Nueva Categoría"]})]}),d?e.jsx("div",{className:"text-center py-8",children:e.jsx("div",{className:"text-gray-500",children:"Cargando categorías..."})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:a.map(i=>e.jsxs(y,{className:"hover:shadow-md transition-shadow",children:[e.jsx(I,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(M,{className:"text-lg flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:i.color}}),i.name]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(o,{variant:"ghost",size:"sm",onClick:()=>w(i),children:e.jsx(Q,{className:"h-4 w-4"})}),e.jsxs(B,{children:[e.jsx(K,{asChild:!0,children:e.jsx(o,{variant:"ghost",size:"sm",className:"text-red-600 hover:text-red-700",children:e.jsx(H,{className:"h-4 w-4"})})}),e.jsxs(R,{children:[e.jsxs($,{children:[e.jsx(G,{children:"¿Eliminar categoría?"}),e.jsxs(V,{children:['Esta acción no se puede deshacer. La categoría "',i.name,'" será eliminada permanentemente.']})]}),e.jsxs(U,{children:[e.jsx(W,{children:"Cancelar"}),e.jsx(Y,{onClick:()=>z(i.id),className:"bg-red-600 hover:bg-red-700",children:"Eliminar"})]})]})]})]})]})}),e.jsxs(J,{children:[i.description&&e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:i.description}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(X,{variant:i.isActive?"default":"secondary",children:i.isActive?"Activa":"Inactiva"})}),e.jsxs("div",{children:["Orden: ",i.sortOrder]})]})]})]},i.id))}),e.jsx(le,{category:v,onSuccess:S,isOpen:g,onOpenChange:r})]})})};export{ce as default};
