import{l as pe,ae as ue,az as Ne,a2 as x,u as G,ag as fe,j as e,aX as ve,f as t,U as f,B as c,bh as ye,i as n,n as q,a3 as be,g as p,h as u,a7 as we,a4 as _e,O as Ce,Q as F,V as z,W as H,Y as M,_ as d,D as De,aR as Se,ab as ke,aM as Ee,aN as Ve,m as J,M as W,o as S,au as Ie,bq as X,bn as Pe,w as Te,y as $e,z as Le,I as Ae,J as qe,aq as Fe}from"./index-D5qLf1ib.js";function He(){const{toast:w}=pe(),Z=ue(),[,U]=Ne(),O=x.useRef(null),[_,ee]=x.useState(""),[k,se]=x.useState("all"),[E,ae]=x.useState("all"),[V,le]=x.useState("all"),[o,I]=x.useState(1),[a,ie]=x.useState(null),[te,C]=x.useState(!1),P=10,{data:v,isLoading:re}=G({queryKey:["/api/volunteers"],suspense:!1,retry:1}),y=Array.isArray(v)?v:(v==null?void 0:v.data)||[],{data:T}=G({queryKey:["/api/parks"],suspense:!1,retry:1}),R=(T==null?void 0:T.data)||[],$=fe({mutationFn:async s=>{await Fe(`/api/volunteers/${s}`,{method:"DELETE"})},onSuccess:()=>{Z.invalidateQueries({queryKey:["/api/volunteers"]}),w({title:"Voluntario eliminado",description:"El voluntario ha sido desactivado correctamente"})},onError:s=>{console.error("Error al eliminar voluntario:",s),w({title:"Error",description:"No se pudo eliminar el voluntario",variant:"destructive"})}}),m=y.filter(s=>{var i,j,b,D,Y;const l=(((i=s.firstName)==null?void 0:i.toLowerCase())||((j=s.full_name)==null?void 0:j.toLowerCase())||"").includes(_.toLowerCase())||(((b=s.lastName)==null?void 0:b.toLowerCase())||"").includes(_.toLowerCase())||(((D=s.email)==null?void 0:D.toLowerCase())||"").includes(_.toLowerCase()),r=k==="all"||s.status===k,N=E==="all"||((Y=s.preferred_park_id)==null?void 0:Y.toString())===E,h=V==="all"||(()=>{const g=s.age||0;switch(V){case"18-25":return g>=18&&g<=25;case"26-35":return g>=26&&g<=35;case"36-45":return g>=36&&g<=45;case"46+":return g>=46;default:return!0}})();return l&&r&&N&&h}),L=Math.ceil(m.length/P),A=(o-1)*P,B=A+P,ce=m.slice(A,B),ne=()=>{const s=["ID","Nombre Completo","Email","Teléfono","Edad","Estado","Habilidades","Experiencia","Parque Preferido","Fecha Ingreso"],l=m.map(i=>[i.id,i.full_name||`${i.firstName||""} ${i.lastName||""}`.trim(),i.email,i.phone||"",i.age||"",i.status||"active",i.skills||"",i.previous_experience||"",i.preferred_park_id||"",new Date(i.created_at||i.createdAt).toLocaleDateString()]),r=[s,...l].map(i=>i.map(j=>`"${j}"`).join(",")).join(`
`),N=new Blob([r],{type:"text/csv;charset=utf-8;"}),h=document.createElement("a");h.href=URL.createObjectURL(N),h.download=`voluntarios_${new Date().toISOString().split("T")[0]}.csv`,h.click(),w({title:"Exportación exitosa",description:`Se exportaron ${m.length} voluntarios a CSV`})},de=s=>{var N;const l=(N=s.target.files)==null?void 0:N[0];if(!l)return;const r=new FileReader;r.onload=h=>{var b;const j=((b=h.target)==null?void 0:b.result).split(`
`);j[0].split(",").map(D=>D.replace(/"/g,"")),w({title:"Importación en desarrollo",description:`Se detectaron ${j.length-1} registros en el archivo CSV`})},r.readAsText(l)},oe=s=>{ie(s),C(!0)},xe=()=>{U("/admin/volunteers/register")},Q=s=>{U(`/admin/volunteers/edit/${s}`)},me=async s=>{window.confirm(`¿Estás seguro de que deseas eliminar al voluntario "${s.full_name||`${s.firstName} ${s.lastName}`}"?

Esta acción cambiará su estado a "inactivo".`)&&$.mutate(s.id)},K=s=>{switch(s){case"activo":case"active":return"bg-green-100 text-green-800";case"inactivo":case"inactive":return"bg-red-100 text-red-800";case"suspendido":case"suspended":return"bg-yellow-100 text-yellow-800";default:return"bg-green-100 text-green-800"}},he=s=>{I(s)},je=()=>{o>1&&I(o-1)},ge=()=>{o<L&&I(o+1)};return e.jsx(ve,{children:e.jsxs("div",{className:"container mx-auto p-6",children:[e.jsx(t,{className:"p-4 bg-gray-50 mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(f,{className:"w-8 h-8 text-gray-900"}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Gestión de Voluntarios"})]}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Administra los voluntarios registrados en el sistema"})]}),e.jsx("div",{children:e.jsxs(c,{onClick:xe,children:[e.jsx(ye,{className:"h-4 w-4 mr-2"}),"Nuevo Voluntario"]})})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsx(t,{children:e.jsx(n,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(f,{className:"h-8 w-8 text-blue-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Voluntarios"}),e.jsx("p",{className:"text-2xl font-bold",children:y.length||0})]})]})})}),e.jsx(t,{children:e.jsx(n,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(f,{className:"h-8 w-8 text-green-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Activos"}),e.jsx("p",{className:"text-2xl font-bold",children:y.filter(s=>s.status==="activo").length||0})]})]})})}),e.jsx(t,{children:e.jsx(n,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(q,{className:"h-8 w-8 text-purple-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Horas Totales"}),e.jsx("p",{className:"text-2xl font-bold",children:y.reduce((s,l)=>s+(l.totalHours||l.total_hours||0),0)||0})]})]})})}),e.jsx(t,{children:e.jsx(n,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(be,{className:"h-8 w-8 text-yellow-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Nuevos este mes"}),e.jsx("p",{className:"text-2xl font-bold",children:y.filter(s=>{const l=new Date(s.joinDate||s.join_date||s.createdAt),r=new Date;return l.getMonth()===r.getMonth()&&l.getFullYear()===r.getFullYear()}).length||0})]})]})})})]}),e.jsxs(t,{className:"mb-6",children:[e.jsx(p,{children:e.jsxs(u,{className:"text-lg flex items-center gap-2",children:[e.jsx(we,{className:"h-5 w-5"}),"Filtros de Búsqueda"]})}),e.jsxs(n,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(_e,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(Ce,{placeholder:"Buscar por nombre o email...",value:_,onChange:s=>ee(s.target.value),className:"pl-9"})]}),e.jsxs(F,{value:k,onValueChange:se,children:[e.jsx(z,{children:e.jsx(H,{placeholder:"Estado"})}),e.jsxs(M,{children:[e.jsx(d,{value:"all",children:"Todos los estados"}),e.jsx(d,{value:"active",children:"Activo"}),e.jsx(d,{value:"inactive",children:"Inactivo"}),e.jsx(d,{value:"suspended",children:"Suspendido"})]})]}),e.jsxs(F,{value:E,onValueChange:ae,children:[e.jsx(z,{children:e.jsx(H,{placeholder:"Parque"})}),e.jsxs(M,{children:[e.jsx(d,{value:"all",children:"Todos los parques"}),R&&R.map(s=>e.jsx(d,{value:s.id.toString(),children:s.name},s.id))]})]}),e.jsxs(F,{value:V,onValueChange:le,children:[e.jsx(z,{children:e.jsx(H,{placeholder:"Edad"})}),e.jsxs(M,{children:[e.jsx(d,{value:"all",children:"Todas las edades"}),e.jsx(d,{value:"18-25",children:"18-25 años"}),e.jsx(d,{value:"26-35",children:"26-35 años"}),e.jsx(d,{value:"36-45",children:"36-45 años"}),e.jsx(d,{value:"46+",children:"46+ años"})]})]})]}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsxs(c,{variant:"outline",onClick:ne,className:"flex items-center gap-2",children:[e.jsx(De,{className:"h-4 w-4"}),"Exportar CSV"]}),e.jsxs(c,{variant:"outline",onClick:()=>{var s;return(s=O.current)==null?void 0:s.click()},className:"flex items-center gap-2",children:[e.jsx(Se,{className:"h-4 w-4"}),"Importar CSV"]}),e.jsx("input",{ref:O,type:"file",accept:".csv",style:{display:"none"},onChange:de})]})]})]}),e.jsxs(t,{children:[e.jsxs(p,{children:[e.jsx(u,{children:"Voluntarios Registrados"}),e.jsx(ke,{children:"Lista completa de voluntarios con información básica"})]}),e.jsx(n,{children:re?e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{children:"Cargando voluntarios..."})}):m.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(f,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"No se encontraron voluntarios"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("p",{className:"text-sm text-gray-500",children:["Mostrando ",A+1," a ",Math.min(B,m.length)," de ",m.length," voluntarios"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(c,{variant:"outline",size:"sm",onClick:je,disabled:o===1,children:[e.jsx(Ee,{className:"h-4 w-4"}),"Anterior"]}),e.jsx("div",{className:"flex gap-1",children:Array.from({length:L},(s,l)=>l+1).map(s=>e.jsx(c,{variant:o===s?"default":"outline",size:"sm",onClick:()=>he(s),className:o===s?"bg-green-600 hover:bg-green-700":"",children:s},s))}),e.jsxs(c,{variant:"outline",size:"sm",onClick:ge,disabled:o===L,children:["Siguiente",e.jsx(Ve,{className:"h-4 w-4"})]})]})]}),e.jsx("div",{className:"space-y-4",children:ce.map(s=>e.jsxs("div",{className:"flex items-center gap-4 p-4 border rounded-lg hover:bg-gray-50",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center overflow-hidden",children:s.profileImageUrl||s.profile_image_url?e.jsx("img",{src:s.profileImageUrl||s.profile_image_url,alt:s.full_name||`${s.firstName||""} ${s.lastName||""}`.trim(),className:"w-16 h-16 rounded-full object-cover"}):e.jsx(f,{className:"h-8 w-8 text-green-600"})})}),e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-lg",children:s.full_name||`${s.firstName||""} ${s.lastName||""}`.trim()}),e.jsx("p",{className:"text-gray-600 mb-1",children:s.email}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 mt-2 text-sm text-gray-500",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(J,{className:"h-4 w-4"}),e.jsxs("span",{children:["Desde: ",new Date(s.joinDate||s.join_date||s.created_at||new Date).toLocaleDateString()]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(q,{className:"h-4 w-4"}),e.jsxs("span",{children:[s.totalHours||s.total_hours||0," horas"]})]}),s.phone&&e.jsx("div",{className:"flex items-center gap-1",children:e.jsxs("span",{children:["📞 ",s.phone]})}),s.age&&e.jsx("div",{className:"flex items-center gap-1",children:e.jsxs("span",{children:["👤 ",s.age," años"]})}),s.preferred_park_id&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(W,{className:"h-4 w-4"}),e.jsx("span",{children:"Parque preferido"})]}),s.available_hours&&e.jsx("div",{className:"flex items-center gap-1",children:e.jsxs("span",{children:["⏰ ",s.available_hours]})})]}),(s.skills||s.previous_experience)&&e.jsxs("div",{className:"mt-3 space-y-1",children:[s.skills&&e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("strong",{children:"Habilidades:"})," ",s.skills]}),s.previous_experience&&e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("strong",{children:"Experiencia:"})," ",s.previous_experience]})]}),s.interest_areas&&s.interest_areas.length>0&&e.jsx("div",{className:"mt-2",children:e.jsx("div",{className:"flex flex-wrap gap-1",children:s.interest_areas.map((l,r)=>e.jsx(S,{variant:"secondary",className:"text-xs",children:l},r))})})]}),e.jsxs("div",{className:"flex flex-col items-end gap-2 ml-4",children:[e.jsx(S,{className:K(s.status||"active"),children:s.status==="active"?"activo":s.status||"activo"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(c,{variant:"outline",size:"sm",onClick:()=>oe(s),children:[e.jsx(Ie,{className:"h-4 w-4 mr-1"}),"Ver"]}),e.jsxs(c,{variant:"outline",size:"sm",onClick:()=>Q(s.id),children:[e.jsx(X,{className:"h-4 w-4 mr-1"}),"Editar"]}),e.jsxs(c,{variant:"outline",size:"sm",onClick:()=>me(s),disabled:$.isPending,className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:[e.jsx(Pe,{className:"h-4 w-4 mr-1"}),$.isPending?"Eliminando...":"Eliminar"]})]})]})]})})]},s.id))})]})})]}),e.jsx(Te,{open:te,onOpenChange:C,children:e.jsxs($e,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(Le,{children:[e.jsx(Ae,{className:"text-2xl",children:"Perfil del Voluntario"}),e.jsx(qe,{children:"Información completa y detallada del voluntario seleccionado"})]}),a&&e.jsxs("div",{className:"grid gap-6 py-4",children:[e.jsxs("div",{className:"flex items-start gap-6 p-6 bg-gradient-to-r from-green-50 to-blue-50 rounded-lg",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-24 h-24 bg-green-100 rounded-full flex items-center justify-center overflow-hidden ring-4 ring-white shadow-lg",children:a.profileImageUrl||a.profile_image_url?e.jsx("img",{src:a.profileImageUrl||a.profile_image_url,alt:a.full_name||`${a.firstName||""} ${a.lastName||""}`.trim(),className:"w-24 h-24 rounded-full object-cover"}):e.jsx(f,{className:"h-12 w-12 text-green-600"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-2",children:a.full_name||`${a.firstName||""} ${a.lastName||""}`.trim()}),e.jsxs("div",{className:"flex items-center gap-4 mb-3",children:[e.jsx(S,{className:K(a.status||"active"),size:"lg",children:a.status==="active"?"ACTIVO":(a.status||"ACTIVO").toUpperCase()}),a.age&&e.jsxs("span",{className:"text-lg text-gray-600",children:[a.age," años"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J,{className:"h-4 w-4"}),e.jsxs("span",{children:["Miembro desde: ",new Date(a.joinDate||a.join_date||a.created_at||new Date).toLocaleDateString()]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(q,{className:"h-4 w-4"}),e.jsxs("span",{children:[a.totalHours||a.total_hours||0," horas de servicio"]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(t,{children:[e.jsx(p,{children:e.jsx(u,{className:"text-lg",children:"Información de Contacto"})}),e.jsxs(n,{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-700",children:"Email:"}),e.jsx("p",{className:"text-blue-600",children:a.email})]}),a.phone&&e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-700",children:"Teléfono:"}),e.jsx("p",{children:a.phone})]}),a.address&&e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-700",children:"Dirección:"}),e.jsx("p",{children:a.address})]})]})]}),e.jsxs(t,{children:[e.jsx(p,{children:e.jsx(u,{className:"text-lg",children:"Contacto de Emergencia"})}),e.jsxs(n,{className:"space-y-3",children:[a.emergency_contact&&e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-700",children:"Nombre:"}),e.jsx("p",{children:a.emergency_contact})]}),a.emergency_phone&&e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-700",children:"Teléfono:"}),e.jsx("p",{children:a.emergency_phone})]}),!a.emergency_contact&&!a.emergency_phone&&e.jsx("p",{className:"text-gray-500 italic",children:"No especificado"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(a.skills||a.previous_experience)&&e.jsxs(t,{children:[e.jsx(p,{children:e.jsx(u,{className:"text-lg",children:"Habilidades y Experiencia"})}),e.jsxs(n,{className:"space-y-3",children:[a.skills&&e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-700",children:"Habilidades:"}),e.jsx("p",{className:"bg-gray-50 p-2 rounded",children:a.skills})]}),a.previous_experience&&e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-700",children:"Experiencia previa:"}),e.jsx("p",{className:"bg-gray-50 p-2 rounded",children:a.previous_experience})]})]})]}),e.jsxs(t,{children:[e.jsx(p,{children:e.jsx(u,{className:"text-lg",children:"Disponibilidad y Preferencias"})}),e.jsxs(n,{className:"space-y-3",children:[a.available_hours&&e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-700",children:"Horarios disponibles:"}),e.jsx("p",{className:"capitalize",children:a.available_hours})]}),a.preferred_park_id&&e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-700",children:"Parque preferido:"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(W,{className:"h-4 w-4 text-green-600"}),e.jsxs("span",{children:["ID: ",a.preferred_park_id]})]})]})]})]})]}),a.interest_areas&&a.interest_areas.length>0&&e.jsxs(t,{children:[e.jsx(p,{children:e.jsx(u,{className:"text-lg",children:"Áreas de Interés"})}),e.jsx(n,{children:e.jsx("div",{className:"flex flex-wrap gap-2",children:a.interest_areas.map((s,l)=>e.jsx(S,{variant:"outline",className:"capitalize",children:s},l))})})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[e.jsx(c,{variant:"outline",onClick:()=>C(!1),children:"Cerrar"}),e.jsxs(c,{onClick:()=>{C(!1),Q(a.id)},className:"bg-green-600 hover:bg-green-700",children:[e.jsx(X,{className:"h-4 w-4 mr-2"}),"Editar Voluntario"]})]})]})]})})]})})}export{He as default};
