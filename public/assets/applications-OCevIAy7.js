import{a2 as x,l as R,ae as k,u as H,ag as B,j as e,aX as w,f as h,g as m,h as u,n as I,i as j,a3 as $,U as A,ab as J,bH as K,bI as L,bJ as D,bK as t,bL as Q,bM as r,p as U,P as O,o as p,m as X,r as Y,B as l,au as G,ah as V,b$ as W,c0 as Z,bo as _,c1 as ee,c2 as se,c3 as ae,c4 as ie,c5 as ne,c6 as te,c7 as re,w as le,y as ce,z as de,I as oe,J as xe,$ as he,bC as me,aq as E,a1 as ue}from"./index-D5qLf1ib.js";function pe(){const[c,g]=x.useState(null),[T,d]=x.useState(!1),[f,b]=x.useState(""),[i,z]=x.useState("approved"),{toast:y}=R(),S=k(),{data:n=[],isLoading:q}=H({queryKey:["/api/instructor-applications/pending"],queryFn:()=>E("/api/instructor-applications/pending").then(s=>s.json())}),v=B({mutationFn:async({id:s,decision:a,notes:o})=>(await E(`/api/instructor-applications/${s}/evaluate`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({decision:a,notes:o})})).json(),onSuccess:s=>{y({title:"Evaluación completada",description:`Aplicación ${s.newStatus==="active"?"aprobada":"rechazada"} exitosamente.`}),S.invalidateQueries({queryKey:["/api/instructor-applications/pending"]}),d(!1),g(null),b("")},onError:s=>{y({title:"Error",description:"No se pudo evaluar la aplicación.",variant:"destructive"})}}),C=(s,a)=>{g(s),z(a),d(!0)},P=()=>{c&&v.mutate({id:c.id,decision:i,notes:f})};return q?e.jsx(w,{children:e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full mx-auto"}),e.jsx("p",{className:"mt-2",children:"Cargando aplicaciones..."})]})}):e.jsx(w,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Aplicaciones de Instructores"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Evalúa y gestiona las postulaciones para ser instructor"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs(h,{children:[e.jsxs(m,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(u,{className:"text-sm font-medium",children:"Aplicaciones Pendientes"}),e.jsx(I,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(j,{children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:n.length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Esperando evaluación"})]})]}),e.jsxs(h,{children:[e.jsxs(m,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(u,{className:"text-sm font-medium",children:"Promedio de Experiencia"}),e.jsx($,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(j,{children:[e.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[n.length>0?Math.round(n.reduce((s,a)=>s+a.experienceYears,0)/n.length):0," años"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Entre todos los candidatos"})]})]}),e.jsxs(h,{children:[e.jsxs(m,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(u,{className:"text-sm font-medium",children:"Especialidades Únicas"}),e.jsx(A,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(j,{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:new Set(n.flatMap(s=>s.specialties||[])).size}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Diferentes especialidades"})]})]})]}),e.jsxs(h,{children:[e.jsxs(m,{children:[e.jsx(u,{children:"Aplicaciones Pendientes"}),e.jsx(J,{children:"Revisa y evalúa las postulaciones de nuevos instructores"})]}),e.jsx(j,{children:n.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(A,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No hay aplicaciones pendientes"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Cuando lleguen nuevas postulaciones aparecerán aquí"})]}):e.jsxs(K,{children:[e.jsx(L,{children:e.jsxs(D,{children:[e.jsx(t,{children:"Candidato"}),e.jsx(t,{children:"Contacto"}),e.jsx(t,{children:"Experiencia"}),e.jsx(t,{children:"Especialidades"}),e.jsx(t,{children:"Fecha de Aplicación"}),e.jsx(t,{children:"Campaña"}),e.jsx(t,{children:"Acciones"})]})}),e.jsx(Q,{children:n.map(s=>{var a,o,N;return e.jsxs(D,{children:[e.jsx(r,{children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.fullName}),e.jsxs("div",{className:"text-sm text-gray-500",children:["ID: ",s.id]})]})}),e.jsx(r,{children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(U,{className:"h-3 w-3 mr-1"}),s.email]}),s.phone&&e.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[e.jsx(O,{className:"h-3 w-3 mr-1"}),s.phone]})]})}),e.jsx(r,{children:e.jsxs(p,{variant:"outline",children:[s.experienceYears," años"]})}),e.jsx(r,{children:e.jsxs("div",{className:"space-y-1",children:[(a=s.specialties)==null?void 0:a.slice(0,2).map((F,M)=>e.jsx(p,{variant:"secondary",className:"mr-1 text-xs",children:F},M)),(((o=s.specialties)==null?void 0:o.length)||0)>2&&e.jsxs(p,{variant:"outline",className:"text-xs",children:["+",(((N=s.specialties)==null?void 0:N.length)||0)-2," más"]})]})}),e.jsx(r,{children:e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(X,{className:"h-3 w-3 mr-1"}),Y(new Date(s.applicationDate),"dd/MM/yyyy",{locale:ue})]})}),e.jsx(r,{children:s.campaignTitle&&e.jsx(p,{variant:"outline",className:"text-xs",children:s.campaignTitle})}),e.jsx(r,{children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(l,{variant:"outline",size:"sm",onClick:()=>{g(s)},children:e.jsx(G,{className:"h-3 w-3"})}),e.jsx(l,{variant:"default",size:"sm",onClick:()=>C(s,"approved"),className:"bg-green-600 hover:bg-green-700",children:e.jsx(V,{className:"h-3 w-3"})}),e.jsxs(W,{children:[e.jsx(Z,{asChild:!0,children:e.jsx(l,{variant:"destructive",size:"sm",children:e.jsx(_,{className:"h-3 w-3"})})}),e.jsxs(ee,{children:[e.jsxs(se,{children:[e.jsx(ae,{children:"Rechazar Aplicación"}),e.jsxs(ie,{children:["¿Estás seguro de que quieres rechazar la aplicación de ",s.fullName,"? Esta acción enviará una notificación por email al candidato."]})]}),e.jsxs(ne,{children:[e.jsx(te,{children:"Cancelar"}),e.jsx(re,{onClick:()=>C(s,"rejected"),className:"bg-red-600 hover:bg-red-700",children:"Rechazar"})]})]})]})]})})]},s.id)})})]})})]}),e.jsx(le,{open:T,onOpenChange:d,children:e.jsxs(ce,{children:[e.jsxs(de,{children:[e.jsxs(oe,{children:[i==="approved"?"Aprobar":"Rechazar"," Aplicación"]}),e.jsx(xe,{children:c&&e.jsxs(e.Fragment,{children:["Candidato: ",e.jsx("strong",{children:c.fullName}),e.jsx("br",{}),i==="approved"?"Esta aplicación será aprobada y el candidato será notificado por email.":"Esta aplicación será rechazada y el candidato será notificado por email."]})})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"evaluation-notes",className:"text-sm font-medium",children:["Comentarios ",i==="rejected"?"(requerido)":"(opcional)"]}),e.jsx(he,{id:"evaluation-notes",placeholder:i==="approved"?"Felicitaciones por tu excelente aplicación...":"Gracias por tu interés. En esta ocasión...",value:f,onChange:s=>b(s.target.value),rows:4})]})}),e.jsxs(me,{children:[e.jsx(l,{variant:"outline",onClick:()=>d(!1),children:"Cancelar"}),e.jsx(l,{onClick:P,disabled:v.isPending,className:i==="approved"?"bg-green-600 hover:bg-green-700":"bg-red-600 hover:bg-red-700",children:v.isPending?"Procesando...":i==="approved"?"Aprobar":"Rechazar"})]})]})})]})})}export{pe as default};
