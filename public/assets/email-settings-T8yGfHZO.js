import{c as P,l as w,ae as A,u as N,a2 as S,ag as G,j as e,aX as I,f as c,g as d,h as t,bp as k,ab as o,i as m,B as p,p as f,ah as _,bo as T,o as i,N as h,O as v,$ as M}from"./index-D5qLf1ib.js";import{S as R}from"./separator-Bek7HtsH.js";import{S as D}from"./send-Bxi1PaXf.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=P("TestTube",[["path",{d:"M14.5 2v17.5c0 1.4-1.1 2.5-2.5 2.5c-1.4 0-2.5-1.1-2.5-2.5V2",key:"125lnx"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M14.5 16h-5",key:"1ox875"}]]);function z(){const{toast:x}=w();A();const{data:s}=N({queryKey:["/api/email/status"]}),[r,u]=S.useState({to:"",subject:"Email de Prueba - ParkSys",html:`
      <div style="font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;">
        <h2 style="color: #00a587;">Email de Prueba</h2>
        <p>Este es un email de prueba enviado desde el sistema ParkSys.</p>
        <p>Si recibes este mensaje, la configuración de email está funcionando correctamente.</p>
        <hr style="border: none; border-top: 1px solid #eee; margin: 30px 0;">
        <p style="color: #6c757d; font-size: 12px;">
          Sistema ParkSys - Configuración de Email
        </p>
      </div>
    `}),{data:n,isLoading:b,refetch:y}=N({queryKey:["/api/email/test-connection"],enabled:!1}),g=G({mutationFn:async a=>{const l=await fetch("/api/email/send",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!l.ok){const j=await l.json();throw new Error(j.message||"Error enviando email")}return l.json()},onSuccess:()=>{x({title:"Email enviado",description:"El email de prueba se envió correctamente"})},onError:a=>{x({title:"Error",description:a.message,variant:"destructive"})}}),C=async()=>{var l,j;const a=await y();(l=a.data)!=null&&l.success?x({title:"Conexión exitosa",description:`Conectado usando ${a.data.method}`}):x({title:"Error de conexión",description:((j=a.data)==null?void 0:j.error)||"No se pudo conectar",variant:"destructive"})},E=()=>{if(!r.to){x({title:"Error",description:"Ingresa un email de destino",variant:"destructive"});return}g.mutate(r)};return e.jsx(I,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight text-gray-900",children:"Configuración de Email"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Gestiona la configuración del sistema de correo electrónico"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(c,{children:[e.jsxs(d,{children:[e.jsxs(t,{className:"flex items-center gap-2",children:[e.jsx(k,{className:"h-5 w-5"}),"Estado del Sistema"]}),e.jsx(o,{children:"Verifica la configuración y conexión del servicio de email"})]}),e.jsxs(m,{className:"space-y-4",children:[e.jsxs(p,{onClick:C,disabled:b,className:"w-full",children:[e.jsx(L,{className:"h-4 w-4 mr-2"}),b?"Probando...":"Probar Conexión"]}),e.jsxs("div",{className:"p-3 bg-yellow-50 rounded-lg border border-yellow-200",children:[e.jsxs("div",{className:"flex items-center gap-2 text-yellow-800",children:[e.jsx(f,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:"Estado del Sistema"})]}),e.jsx("p",{className:"text-sm text-yellow-700 mt-1",children:"Sistema de email robusto instalado con soporte para SendGrid y Gmail"})]}),n&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[n.success?e.jsx(_,{className:"h-5 w-5 text-green-500"}):e.jsx(T,{className:"h-5 w-5 text-red-500"}),e.jsx("span",{className:"font-medium",children:n.success?"Conectado":"Desconectado"})]}),n.success&&e.jsxs(i,{variant:"secondary",children:["Método: ",n.method]}),n.error&&e.jsx("p",{className:"text-sm text-red-600",children:n.error})]}),e.jsx(R,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium",children:"Configuración de Email:"}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Puedes usar SendGrid (profesional) o Gmail (alternativo)"}),e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"SENDGRID_API_KEY:"}),e.jsx(i,{variant:s!=null&&s.sendgrid?"default":"destructive",children:s!=null&&s.sendgrid?"Configurado":"Faltante"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"GMAIL_USER:"}),e.jsx(i,{variant:s!=null&&s.gmail?"default":"secondary",children:s!=null&&s.gmail?"Configurado":"Opcional"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"GMAIL_APP_PASSWORD:"}),e.jsx(i,{variant:s!=null&&s.gmail?"default":"secondary",children:s!=null&&s.gmail?"Configurado":"Opcional"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Sistema configurado:"}),e.jsx(i,{variant:s!=null&&s.configured?"default":"destructive",children:s!=null&&s.configured?"Sí":"No"})]})]})]})]})]}),e.jsxs(c,{children:[e.jsxs(d,{children:[e.jsxs(t,{className:"flex items-center gap-2",children:[e.jsx(f,{className:"h-5 w-5"}),"Email de Prueba"]}),e.jsx(o,{children:"Envía un email de prueba para verificar el funcionamiento"})]}),e.jsxs(m,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"test-email-to",children:"Destinatario"}),e.jsx(v,{id:"test-email-to",type:"email",placeholder:"ejemplo@correo.com",value:r.to,onChange:a=>u({...r,to:a.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"test-email-subject",children:"Asunto"}),e.jsx(v,{id:"test-email-subject",value:r.subject,onChange:a=>u({...r,subject:a.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"test-email-content",children:"Contenido HTML"}),e.jsx(M,{id:"test-email-content",rows:8,value:r.html,onChange:a=>u({...r,html:a.target.value})})]}),e.jsxs(p,{onClick:E,disabled:g.isPending,className:"w-full",children:[e.jsx(D,{className:"h-4 w-4 mr-2"}),g.isPending?"Enviando...":"Enviar Email de Prueba"]})]})]})]}),e.jsxs(c,{children:[e.jsxs(d,{children:[e.jsx(t,{className:"text-green-600",children:"Configurar Gmail/Google Workspace"}),e.jsx(o,{children:"Configura tu cuenta de Gmail para enviar emails desde el sistema"})]}),e.jsxs(m,{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-green-50 rounded-lg border border-green-200",children:[e.jsx("h4",{className:"font-medium text-green-900 mb-3",children:"Pasos para obtener las credenciales:"}),e.jsxs("ol",{className:"list-decimal list-inside text-sm text-green-800 space-y-2",children:[e.jsxs("li",{children:["Ve a tu ",e.jsx("a",{href:"https://myaccount.google.com",target:"_blank",className:"underline font-medium",children:"Cuenta de Google"})]}),e.jsxs("li",{children:["En el menú izquierdo, selecciona ",e.jsx("strong",{children:'"Seguridad"'})]}),e.jsxs("li",{children:["Busca ",e.jsx("strong",{children:'"Verificación en 2 pasos"'})," y actívala si no está activa"]}),e.jsxs("li",{children:["Busca ",e.jsx("strong",{children:'"Contraseñas de aplicaciones"'})," (App passwords)"]}),e.jsxs("li",{children:["Selecciona ",e.jsx("strong",{children:'"Correo"'})," como aplicación"]}),e.jsx("li",{children:"Google generará una contraseña de 16 caracteres"}),e.jsx("li",{children:"Copia esa contraseña y úsala como GMAIL_APP_PASSWORD"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{className:"text-green-700 font-medium",children:"GMAIL_USER"}),e.jsxs("div",{className:"p-3 bg-white border border-green-300 rounded",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Tu dirección de Gmail:"}),e.jsx("code",{className:"text-green-700 bg-green-100 px-2 py-1 rounded text-sm",children:"tuempresa@gmail.com"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{className:"text-green-700 font-medium",children:"GMAIL_APP_PASSWORD"}),e.jsxs("div",{className:"p-3 bg-white border border-green-300 rounded",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Contraseña de aplicación (16 caracteres):"}),e.jsx("code",{className:"text-green-700 bg-green-100 px-2 py-1 rounded text-sm",children:"abcd efgh ijkl mnop"})]})]})]}),e.jsxs("div",{className:"p-3 bg-yellow-50 border border-yellow-200 rounded",children:[e.jsx("h5",{className:"font-medium text-yellow-800 mb-1",children:"⚠️ Importante:"}),e.jsx("p",{className:"text-sm text-yellow-700",children:'NO uses tu contraseña normal de Gmail. Debes generar una "Contraseña de aplicación" específica desde la configuración de seguridad de Google.'})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"flex items-center justify-center",children:e.jsx(p,{onClick:()=>window.open("https://myaccount.google.com/security","_blank"),className:"bg-green-600 hover:bg-green-700",children:"Ir a Configuración de Google"})}),e.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded",children:[e.jsx("h5",{className:"font-medium text-blue-900 mb-2",children:"📍 Configurar credenciales en Replit"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"text-sm text-blue-800",children:[e.jsx("p",{className:"font-medium mb-2",children:"Pasos para agregar los secretos:"}),e.jsxs("ol",{className:"space-y-1 ml-4",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"1."})," En el panel izquierdo de Replit, busca ",e.jsx("strong",{children:'"Secrets"'})," (icono de candado 🔒)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"2."}),' Haz clic en "Add new secret"']}),e.jsxs("li",{children:[e.jsx("strong",{children:"3."})," Primer secreto:",e.jsxs("div",{className:"ml-4 mt-1 p-2 bg-white rounded border",children:[e.jsx("code",{children:"Key: GMAIL_USER"}),e.jsx("br",{}),e.jsx("code",{children:"Value: tu-email@gmail.com"})]})]}),e.jsxs("li",{children:[e.jsx("strong",{children:"4."})," Segundo secreto:",e.jsxs("div",{className:"ml-4 mt-1 p-2 bg-white rounded border",children:[e.jsx("code",{children:"Key: GMAIL_APP_PASSWORD"}),e.jsx("br",{}),e.jsx("code",{children:"Value: abcd efgh ijkl mnop"})]})]}),e.jsxs("li",{children:[e.jsx("strong",{children:"5."})," El servidor se reiniciará automáticamente"]})]})]}),e.jsxs("div",{className:"text-xs text-blue-700 bg-blue-100 p-2 rounded",children:[e.jsx("strong",{children:"💡 Tip:"}),' Si no ves la sección "Secrets", está en la barra lateral izquierda bajo "Tools" o como un icono de candado.']})]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(c,{children:[e.jsxs(d,{children:[e.jsx(t,{className:"text-blue-600",children:"Opción 1: SendGrid (Profesional)"}),e.jsx(o,{children:"Servicio recomendado para uso empresarial"})]}),e.jsxs(m,{className:"space-y-3",children:[e.jsxs("div",{className:"p-3 bg-blue-50 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-blue-900",children:"Pasos para configurar:"}),e.jsxs("ol",{className:"list-decimal list-inside text-sm text-blue-800 mt-2 space-y-1",children:[e.jsxs("li",{children:["Crea cuenta en ",e.jsx("a",{href:"https://sendgrid.com",target:"_blank",className:"underline",children:"sendgrid.com"})]}),e.jsx("li",{children:"Ve a Settings → API Keys"}),e.jsx("li",{children:"Crea nueva API Key con permisos de envío"}),e.jsx("li",{children:"Copia la clave y agrégala como SENDGRID_API_KEY en secretos"})]})]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("strong",{children:"Ventajas:"})," Alta entregabilidad, análiticas, plantillas dinámicas, soporte empresarial"]})]})]}),e.jsxs(c,{children:[e.jsxs(d,{children:[e.jsx(t,{className:"text-green-600",children:"Opción 2: Gmail (Configurado arriba)"}),e.jsx(o,{children:"Usando tu cuenta de Gmail actual"})]}),e.jsx(m,{className:"space-y-3",children:e.jsxs("div",{className:"text-sm space-y-2",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Estado:"})," ",e.jsx("span",{className:s!=null&&s.gmail?"text-green-600":"text-orange-600",children:s!=null&&s.gmail?"Configurado":"Pendiente"})]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Configuración:"})," Ver instrucciones arriba"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Ventajas:"})," Gratis, fácil configuración, familiar"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Limitaciones:"})," 500 emails/día, menos funciones empresariales"]})]})})]})]}),e.jsxs(c,{children:[e.jsxs(d,{children:[e.jsx(t,{children:"Plantillas de Email Disponibles"}),e.jsx(o,{children:"El sistema incluye plantillas predefinidas para diferentes procesos"})]}),e.jsx(m,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("h4",{className:"font-medium mb-2",children:"Email de Bienvenida"}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Se envía automáticamente cuando se crea un nuevo usuario o empleado"}),e.jsx(i,{variant:"secondary",children:"Automático"})]}),e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("h4",{className:"font-medium mb-2",children:"Evento Aprobado"}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Notifica cuando una solicitud de evento es aprobada"}),e.jsx(i,{variant:"secondary",children:"Automático"})]}),e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("h4",{className:"font-medium mb-2",children:"Nómina Procesada"}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Informa a empleados cuando su nómina ha sido procesada"}),e.jsx(i,{variant:"secondary",children:"Automático"})]}),e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("h4",{className:"font-medium mb-2",children:"Recordatorio de Mantenimiento"}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Alerta sobre fechas de mantenimiento programado"}),e.jsx(i,{variant:"secondary",children:"Automático"})]}),e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("h4",{className:"font-medium mb-2",children:"Registro de Voluntario"}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Confirma el registro exitoso de nuevos voluntarios"}),e.jsx(i,{variant:"secondary",children:"Automático"})]}),e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("h4",{className:"font-medium mb-2",children:"Email Personalizado"}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Permite enviar emails personalizados usando la API"}),e.jsx(i,{variant:"outline",children:"API"})]})]})})]})]})})}export{z as default};
