import{u as A,j as e,w as O,y as Q,z as me,a8 as he,a9 as je,aa as pe,I as ue,J as we,o as D,b1 as ge,b2 as Ne,b3 as k,b4 as $,f,i as y,p as fe,P as ve,m as T,M as Ce,cT as ee,cq as G,F as _e,n as le,t as Ee,b as H,a3 as Y,U as J,bC as ye,B as u,l as Se,ae as Fe,af as De,R as X,ag as Te,ai as Pe,aj as w,ak as C,al as _,am as E,O as P,an as S,Q as R,V as K,W as U,Y as B,_ as p,$ as te,aF as Ae,ce as ke,cf as F,cU as $e,ap as Le,az as be,a2 as L,g as M,cc as Ie,cN as Me,cO as ze,cV as qe,cP as Ve,cQ as Re,cR as ie,cW as ce,cS as I,au as ne,bq as de,a0 as Ke,aX as Ue,bh as Be,h as V,a_ as oe,a7 as Oe,X as Qe,a4 as We,bQ as xe,bE as Ge,K as He}from"./index-D5qLf1ib.js";import{S as Z}from"./Spinner-DBMNTNX4.js";function Ye({instructorId:l,open:x,onOpenChange:h}){const{data:s,isLoading:v}=A({queryKey:[`/api/instructors/${l}`],enabled:x&&!!l}),{data:d}=A({queryKey:[`/api/instructors/${l}/assignments`],enabled:x&&!!l}),{data:N}=A({queryKey:[`/api/instructors/${l}/evaluations`],enabled:x&&!!l}),{data:c}=A({queryKey:[`/api/instructors/${l}/recognitions`],enabled:x&&!!l}),g=a=>a?a.split(" ").map(i=>i[0]).slice(0,2).join("").toUpperCase():"",o=a=>{if(!a)return null;const i=[];for(let n=1;n<=5;n++)i.push(e.jsx(H,{className:`h-4 w-4 ${n<=a?"text-yellow-400 fill-yellow-400":"text-gray-300"}`},n));return e.jsx("div",{className:"flex items-center",children:i})},t=a=>a?new Date(a).toLocaleDateString("es-MX",{year:"numeric",month:"long",day:"numeric"}):"";return v?e.jsx(O,{open:x,onOpenChange:h,children:e.jsx(Q,{className:"sm:max-w-[600px]",children:e.jsx("div",{className:"flex items-center justify-center h-40",children:e.jsx(Z,{size:"lg"})})})}):s?e.jsx(O,{open:x,onOpenChange:h,children:e.jsxs(Q,{className:"sm:max-w-[800px] max-h-[90vh] overflow-y-auto",children:[e.jsx(me,{children:e.jsxs("div",{className:"flex items-start mb-4",children:[e.jsxs(he,{className:"h-16 w-16 mr-4",children:[e.jsx(je,{src:s.profile_image_url||s.profileImageUrl,alt:s.full_name||s.fullName}),e.jsx(pe,{children:g(s.full_name||s.fullName||"")})]}),e.jsxs("div",{children:[e.jsx(ue,{className:"text-xl",children:s.full_name||s.fullName}),e.jsx(we,{children:e.jsxs("div",{className:"mt-1 flex items-center space-x-2",children:[e.jsx(D,{className:`${(s.status||s.estado)==="active"?"bg-green-100 text-green-800 hover:bg-green-100":(s.status||s.estado)==="inactive"?"bg-gray-100 text-gray-800 hover:bg-gray-100":"bg-yellow-100 text-yellow-800 hover:bg-yellow-100"}`,children:(s.status||s.estado)==="active"?"Activo":(s.status||s.estado)==="inactive"?"Inactivo":"Pendiente"}),(s.rating||s.calificacion)&&e.jsx("div",{className:"flex items-center",children:o(s.rating||s.calificacion)})]})})]})]})}),e.jsxs(ge,{defaultValue:"profile",children:[e.jsxs(Ne,{className:"grid w-full grid-cols-4",children:[e.jsx(k,{value:"profile",children:"Perfil"}),e.jsx(k,{value:"assignments",children:"Asignaciones"}),e.jsx(k,{value:"evaluations",children:"Evaluaciones"}),e.jsx(k,{value:"recognitions",children:"Reconocimientos"})]}),e.jsx($,{value:"profile",children:e.jsx(f,{children:e.jsx(y,{className:"pt-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-3",children:"Información Personal"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start",children:[e.jsx(fe,{className:"h-5 w-5 text-gray-400 mr-2 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:"Correo electrónico"}),e.jsx("p",{children:s.email||s.correo})]})]}),(s.phone||s.telefono)&&e.jsxs("div",{className:"flex items-start",children:[e.jsx(ve,{className:"h-5 w-5 text-gray-400 mr-2 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:"Teléfono"}),e.jsx("p",{children:s.phone||s.telefono})]})]}),(s.date_of_birth||s.fechaNacimiento)&&e.jsxs("div",{className:"flex items-start",children:[e.jsx(T,{className:"h-5 w-5 text-gray-400 mr-2 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:"Fecha de nacimiento"}),e.jsx("p",{children:t(s.date_of_birth||s.fechaNacimiento)})]})]}),(s.address||s.direccion)&&e.jsxs("div",{className:"flex items-start",children:[e.jsx(Ce,{className:"h-5 w-5 text-gray-400 mr-2 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:"Dirección"}),e.jsx("p",{children:s.address||s.direccion})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-3",children:"Experiencia Profesional"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start",children:[e.jsx(ee,{className:"h-5 w-5 text-gray-400 mr-2 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:"Experiencia"}),e.jsxs("p",{children:[s.experience_years||s.experienceYears||0," ",(s.experience_years||s.experienceYears)===1?"año":"años"]})]})]}),(s.specialties||s.especialidades)&&e.jsxs("div",{className:"flex items-start",children:[e.jsx(G,{className:"h-5 w-5 text-gray-400 mr-2 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:"Especialidades"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:(s.specialties||s.especialidades||"").split(",").map((a,i)=>e.jsx(D,{variant:"outline",className:"mr-1 mb-1",children:a.trim()},i))})]})]}),(s.biography||s.biografia)&&e.jsxs("div",{className:"flex items-start",children:[e.jsx(_e,{className:"h-5 w-5 text-gray-400 mr-2 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:"Biografía"}),e.jsx("p",{className:"text-sm whitespace-pre-line",children:s.biography||s.biografia})]})]}),(s.created_at||s.createdAt)&&e.jsxs("div",{className:"flex items-start",children:[e.jsx(le,{className:"h-5 w-5 text-gray-400 mr-2 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:"Fecha de registro"}),e.jsx("p",{children:t(s.created_at||s.createdAt)})]})]})]})]})]})})})}),e.jsx($,{value:"assignments",children:e.jsx(f,{children:e.jsx(y,{className:"pt-6",children:d&&d.length>0?e.jsx("div",{className:"space-y-4",children:Array.from(new Map(d.map(a=>[`${a.activityId||a.activity_id||0}-${a.parkId||a.park_id||0}-${a.startDate||a.start_date||""}`,a])).values()).map(a=>e.jsx("div",{className:"border p-3 rounded-md hover:bg-gray-50",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:a.activity_title||a.activityTitle||"Actividad sin título"}),e.jsx("p",{className:"text-sm text-gray-500",children:a.park_name||a.parkName||"Parque no especificado"}),e.jsxs("div",{className:"mt-1 text-sm",children:[e.jsxs("span",{className:"inline-flex items-center mr-3",children:[e.jsx(T,{className:"h-4 w-4 mr-1 text-gray-400"}),t(a.start_date||a.startDate)]}),e.jsxs("span",{className:"inline-flex items-center",children:[e.jsx(le,{className:"h-4 w-4 mr-1 text-gray-400"}),a.status||a.estado||"Pendiente"]})]})]}),e.jsx(D,{className:`${(a.status||a.estado)==="active"?"bg-green-100 text-green-800 hover:bg-green-100":(a.status||a.estado)==="completed"?"bg-blue-100 text-blue-800 hover:bg-blue-100":"bg-yellow-100 text-yellow-800 hover:bg-yellow-100"}`,children:(a.status||a.estado)==="active"?"Activa":(a.status||a.estado)==="completed"?"Completada":"Programada"})]})},a.id))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(T,{className:"h-8 w-8 mx-auto text-gray-400"}),e.jsx("p",{className:"mt-2 text-gray-500",children:"No hay asignaciones registradas"})]})})})}),e.jsx($,{value:"evaluations",children:e.jsx(f,{children:e.jsx(y,{className:"pt-6",children:N&&N.length>0?e.jsx("div",{className:"space-y-4",children:N.map(a=>e.jsx("div",{className:"border p-3 rounded-md hover:bg-gray-50",children:e.jsx("div",{className:"flex justify-between items-start",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("h4",{className:"font-medium",children:a.title||"Evaluación"}),e.jsx("div",{className:"ml-2",children:o(a.rating)})]}),a.activity_title&&e.jsxs("p",{className:"text-sm text-gray-500",children:["Actividad: ",a.activity_title]}),a.comments&&e.jsx("p",{className:"mt-2 text-sm whitespace-pre-line",children:a.comments}),e.jsxs("div",{className:"mt-1 text-sm",children:[e.jsxs("span",{className:"inline-flex items-center mr-3",children:[e.jsx(T,{className:"h-4 w-4 mr-1 text-gray-400"}),t(a.evaluation_date)]}),e.jsxs("span",{className:"inline-flex items-center",children:[e.jsx(Ee,{className:"h-4 w-4 mr-1 text-gray-400"}),a.evaluator_name]})]})]})})},a.id))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(H,{className:"h-8 w-8 mx-auto text-gray-400"}),e.jsx("p",{className:"mt-2 text-gray-500",children:"No hay evaluaciones registradas"})]})})})}),e.jsx($,{value:"recognitions",children:e.jsx(f,{children:e.jsx(y,{className:"pt-6",children:c&&c.length>0?e.jsx("div",{className:"space-y-4",children:c.map(a=>e.jsx("div",{className:"border p-3 rounded-md hover:bg-gray-50",children:e.jsx("div",{className:"flex justify-between items-start",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Y,{className:"h-5 w-5 text-yellow-500 mr-2"}),e.jsx("h4",{className:"font-medium",children:a.title})]}),e.jsx("p",{className:"mt-2 text-sm whitespace-pre-line",children:a.description}),e.jsxs("div",{className:"mt-2 text-sm",children:[e.jsxs("span",{className:"inline-flex items-center mr-3",children:[e.jsx(T,{className:"h-4 w-4 mr-1 text-gray-400"}),t(a.award_date)]}),a.issuing_organization&&e.jsxs("span",{className:"inline-flex items-center",children:[e.jsx(J,{className:"h-4 w-4 mr-1 text-gray-400"}),a.issuing_organization]})]})]})})},a.id))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Y,{className:"h-8 w-8 mx-auto text-gray-400"}),e.jsx("p",{className:"mt-2 text-gray-500",children:"No hay reconocimientos registrados"})]})})})})]}),e.jsx(ye,{children:e.jsx(u,{onClick:()=>h(!1),children:"Cerrar"})})]})}):null}const Je=ke({full_name:F().min(3,{message:"El nombre debe tener al menos 3 caracteres"}),email:F().email({message:"Por favor ingrese un correo electrónico válido"}),phone:F().optional(),specialties:F().optional(),experience_years:$e.number().min(0).max(50),biography:F().optional(),address:F().optional(),status:F()});function Xe({instructorId:l,open:x,onOpenChange:h}){const{toast:s}=Se(),v=Fe(),{data:d,isLoading:N}=A({queryKey:[`/api/instructors/${l}`],enabled:x&&!!l}),c=De({resolver:Le(Je),defaultValues:{full_name:"",email:"",phone:"",specialties:"",experience_years:0,biography:"",address:"",status:"active"}});X.useEffect(()=>{d&&c.reset({full_name:d.full_name||"",email:d.email||"",phone:d.phone||"",specialties:d.specialties||"",experience_years:d.experience_years||0,biography:d.biography||"",address:d.address||"",status:d.status||"active"})},[d,c]);const g=Te({mutationFn:async t=>{const a=await fetch(`/api/instructors/${l}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!a.ok){const i=await a.json();throw new Error(i.message||"Error al actualizar instructor")}return await a.json()},onSuccess:()=>{v.invalidateQueries({queryKey:["/api/instructors"]}),v.invalidateQueries({queryKey:[`/api/instructors/${l}`]}),s({title:"Instructor actualizado",description:"Los datos del instructor se han actualizado correctamente."}),h(!1)},onError:t=>{s({title:"Error",description:t.message||"Hubo un problema al actualizar el instructor",variant:"destructive"})}}),o=t=>{g.mutate(t)};return N?e.jsx(O,{open:x,onOpenChange:h,children:e.jsx(Q,{className:"sm:max-w-[600px]",children:e.jsx("div",{className:"flex items-center justify-center h-40",children:e.jsx(Z,{size:"lg"})})})}):e.jsx(O,{open:x,onOpenChange:h,children:e.jsxs(Q,{className:"sm:max-w-[600px] max-h-[90vh] overflow-y-auto",children:[e.jsx(me,{children:e.jsx(ue,{children:"Editar Instructor"})}),e.jsx(Pe,{...c,children:e.jsxs("form",{onSubmit:c.handleSubmit(o),className:"space-y-6",children:[e.jsxs(ge,{defaultValue:"general",children:[e.jsxs(Ne,{className:"grid w-full grid-cols-2",children:[e.jsx(k,{value:"general",children:"Información General"}),e.jsx(k,{value:"additional",children:"Información Adicional"})]}),e.jsxs($,{value:"general",className:"space-y-4 mt-4",children:[e.jsx(w,{control:c.control,name:"full_name",render:({field:t})=>e.jsxs(C,{children:[e.jsx(_,{children:"Nombre completo"}),e.jsx(E,{children:e.jsx(P,{placeholder:"Nombre completo",...t})}),e.jsx(S,{})]})}),e.jsx(w,{control:c.control,name:"email",render:({field:t})=>e.jsxs(C,{children:[e.jsx(_,{children:"Correo electrónico"}),e.jsx(E,{children:e.jsx(P,{type:"email",placeholder:"correo@ejemplo.com",...t})}),e.jsx(S,{})]})}),e.jsx(w,{control:c.control,name:"phone",render:({field:t})=>e.jsxs(C,{children:[e.jsx(_,{children:"Teléfono"}),e.jsx(E,{children:e.jsx(P,{placeholder:"Teléfono de contacto",...t})}),e.jsx(S,{})]})}),e.jsx(w,{control:c.control,name:"status",render:({field:t})=>e.jsxs(C,{children:[e.jsx(_,{children:"Estado"}),e.jsxs(R,{onValueChange:t.onChange,defaultValue:t.value,value:t.value,children:[e.jsx(E,{children:e.jsx(K,{children:e.jsx(U,{placeholder:"Seleccione un estado"})})}),e.jsxs(B,{children:[e.jsx(p,{value:"active",children:"Activo"}),e.jsx(p,{value:"inactive",children:"Inactivo"}),e.jsx(p,{value:"pending",children:"Pendiente"})]})]}),e.jsx(S,{})]})})]}),e.jsxs($,{value:"additional",className:"space-y-4 mt-4",children:[e.jsx(w,{control:c.control,name:"specialties",render:({field:t})=>e.jsxs(C,{children:[e.jsx(_,{children:"Especialidades"}),e.jsx(E,{children:e.jsx(te,{placeholder:"Yoga, Pilates, Meditación, etc. Separadas por comas",...t})}),e.jsx(Ae,{children:"Ingrese las especialidades separadas por comas."}),e.jsx(S,{})]})}),e.jsx(w,{control:c.control,name:"experience_years",render:({field:t})=>e.jsxs(C,{children:[e.jsx(_,{children:"Años de experiencia"}),e.jsx(E,{children:e.jsx(P,{type:"number",min:"0",max:"50",...t,onChange:a=>t.onChange(parseInt(a.target.value,10)||0)})}),e.jsx(S,{})]})}),e.jsx(w,{control:c.control,name:"biography",render:({field:t})=>e.jsxs(C,{children:[e.jsx(_,{children:"Biografía"}),e.jsx(E,{children:e.jsx(te,{placeholder:"Breve biografía del instructor",className:"min-h-[120px]",...t})}),e.jsx(S,{})]})}),e.jsx(w,{control:c.control,name:"address",render:({field:t})=>e.jsxs(C,{children:[e.jsx(_,{children:"Dirección"}),e.jsx(E,{children:e.jsx(P,{placeholder:"Dirección completa",...t})}),e.jsx(S,{})]})})]})]}),e.jsxs(ye,{children:[e.jsx(u,{type:"button",variant:"outline",onClick:()=>h(!1),disabled:g.isPending,children:"Cancelar"}),e.jsx(u,{type:"submit",disabled:g.isPending,children:g.isPending?e.jsxs(e.Fragment,{children:[e.jsx(Z,{size:"sm",className:"mr-2"}),"Guardando..."]}):"Guardar cambios"})]})]})})]})})}function Ze({instructor:l,showActions:x=!0,compact:h=!1}){const[,s]=be(),[v,d]=L.useState(!1),[N,c]=L.useState(!1),g=i=>i.split(" ").map(n=>n[0]).slice(0,2).join("").toUpperCase(),o=i=>{if(!i)return null;let n=[];try{i.startsWith("{")&&i.endsWith("}")?n=i.slice(1,-1).split(",").map(j=>{let r=j.trim();return r=r.replace(/^"+/,"").replace(/"+$/,""),r=r.replace(/^'+/,"").replace(/'+$/,""),r=r.replace(/^\[+/,"").replace(/\]+$/,""),r=r.trim(),r}).filter(j=>j.length>0):i.startsWith("[")&&i.endsWith("]")?n=JSON.parse(i):n=i.split(",").map(m=>m.trim())}catch{n=i.split(",").map(j=>{let r=j.trim();return r=r.replace(/^["'\[\]]+/,"").replace(/["'\[\]]+$/,""),r.trim()}).filter(j=>j.length>0)}return n=n.map(m=>{let j=m.trim();return j=j.replace(/^["'\[\]{}]+/,"").replace(/["'\[\]{}]+$/,""),j.trim()}).filter(m=>m&&m.length>0),n.length<=2||h?n.map((m,j)=>e.jsx(D,{variant:"outline",className:"mr-1 mb-1",children:m},j)):e.jsxs(e.Fragment,{children:[e.jsx(D,{variant:"outline",className:"mr-1 mb-1",children:n[0]}),e.jsx(D,{variant:"outline",className:"mr-1 mb-1",children:n[1]}),e.jsxs(D,{variant:"outline",className:"mb-1",children:["+",n.length-2," más"]})]})},t=i=>{switch(i){case"active":return"bg-green-50 border-green-200";case"inactive":return"bg-gray-50 border-gray-200";case"pending":return"bg-yellow-50 border-yellow-200";default:return""}},a=i=>{if(!i)return null;const n=[];for(let m=1;m<=5;m++)n.push(e.jsx(H,{className:`h-4 w-4 ${m<=i?"text-yellow-400 fill-yellow-400":"text-gray-300"}`},m));return e.jsx("div",{className:"flex items-center",children:n})};return e.jsxs(e.Fragment,{children:[e.jsxs(f,{className:`h-full overflow-hidden transition-all ${t(l.status)}`,children:[e.jsx(M,{className:"pb-0 pt-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsxs(he,{className:"h-14 w-14 mr-3",children:[e.jsx(je,{src:l.profile_image_url,alt:l.full_name}),e.jsx(pe,{children:g(l.full_name)})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-lg font-semibold truncate",children:l.full_name}),e.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[e.jsx(ee,{className:"h-4 w-4 mr-1"}),e.jsxs("span",{children:[l.experience_years," ",l.experience_years===1?"año":"años"," de experiencia"]})]}),!h&&l.rating&&e.jsx("div",{className:"mt-1",children:a(l.rating)})]})]})}),e.jsxs(y,{className:"pt-4",children:[!h&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-sm mb-3 flex items-center text-gray-500",children:[e.jsx(fe,{className:"h-4 w-4 mr-2"}),e.jsx("span",{className:"truncate",children:l.email})]}),l.phone&&e.jsxs("div",{className:"text-sm mb-3 flex items-center text-gray-500",children:[e.jsx(ve,{className:"h-4 w-4 mr-2"}),e.jsx("span",{children:l.phone})]})]}),e.jsx("div",{className:"mt-2 flex flex-wrap",children:o(l.specialties)})]}),x&&e.jsxs(Ie,{className:"flex justify-between border-t p-3 bg-gray-50",children:[e.jsxs(Me,{children:[e.jsx(ze,{asChild:!0,children:e.jsxs(u,{variant:"ghost",size:"sm",children:[e.jsx(qe,{className:"h-4 w-4 mr-1"}),"Acciones"]})}),e.jsxs(Ve,{align:"start",className:"w-48",children:[e.jsx(Re,{children:"Opciones"}),e.jsx(ie,{}),e.jsxs(ce,{children:[e.jsxs(I,{onClick:()=>d(!0),children:[e.jsx(ne,{className:"h-4 w-4 mr-2"}),"Ver perfil"]}),e.jsxs(I,{onClick:()=>c(!0),children:[e.jsx(de,{className:"h-4 w-4 mr-2"}),"Editar perfil"]})]}),e.jsx(ie,{}),e.jsxs(ce,{children:[e.jsxs(I,{onClick:()=>s(`/admin/instructors/${l.id}/assignments`),children:[e.jsx(T,{className:"h-4 w-4 mr-2"}),"Asignaciones"]}),e.jsxs(I,{onClick:()=>s(`/admin/instructors/${l.id}/evaluations`),children:[e.jsx(Ke,{className:"h-4 w-4 mr-2"}),"Evaluaciones"]}),e.jsxs(I,{onClick:()=>s(`/admin/instructors/${l.id}/recognitions`),children:[e.jsx(Y,{className:"h-4 w-4 mr-2"}),"Reconocimientos"]})]})]})]}),e.jsxs("div",{children:[e.jsxs(u,{variant:"ghost",size:"sm",onClick:()=>d(!0),children:[e.jsx(ne,{className:"h-4 w-4 mr-1"}),"Ver"]}),e.jsxs(u,{variant:"ghost",size:"sm",onClick:()=>c(!0),children:[e.jsx(de,{className:"h-4 w-4 mr-1"}),"Editar"]})]})]})]}),e.jsx(Ye,{instructorId:l.id,open:v,onOpenChange:d}),e.jsx(Xe,{instructorId:l.id,open:N,onOpenChange:c})]})}function as(){const[,l]=be(),[x,h]=L.useState(""),[s,v]=L.useState("all"),[d,N]=L.useState("all"),[c,g]=L.useState("all"),{data:o,isLoading:t,isError:a,refetch:i}=A({queryKey:["/api/instructors"],retry:1,enabled:!0}),n=X.useMemo(()=>o?o.filter(r=>{var ae,re;const b=x===""||((ae=r.full_name)==null?void 0:ae.toLowerCase().includes(x.toLowerCase()))||((re=r.email)==null?void 0:re.toLowerCase().includes(x.toLowerCase())),se=s==="all"||r.status===s,W=d==="all"||r.specialties&&r.specialties.toLowerCase().includes(d.toLowerCase());let z=!0;if(c!=="all"){const q=r.experience_years||0;c==="novice"&&q>2&&(z=!1),c==="intermediate"&&(q<3||q>5)&&(z=!1),c==="expert"&&q<6&&(z=!1)}return b&&se&&W&&z}):[],[o,x,s,d,c]),m=X.useMemo(()=>{if(!o)return[];const r=new Set;return o.forEach(b=>{b.specialties&&b.specialties.split(",").forEach(W=>{r.add(W.trim())})}),Array.from(r)},[o]),j=()=>{h(""),v("all"),N("all"),g("all")};return e.jsx(Ue,{children:e.jsxs("div",{className:"container mx-auto p-6",children:[e.jsx(f,{className:"p-4 bg-gray-50 mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(G,{className:"w-8 h-8 text-gray-900"}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Instructores"})]}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Explora todos los instructores disponibles para las actividades"})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(u,{variant:"outline",onClick:()=>l("/admin/instructors"),children:[e.jsx(J,{className:"mr-2 h-4 w-4"}),"Ver como lista"]}),e.jsxs(u,{onClick:()=>l("/admin/users"),children:[e.jsx(Be,{className:"mr-2 h-4 w-4"}),"Nuevo Instructor"]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-6",children:[e.jsxs(f,{children:[e.jsx(M,{className:"pb-2",children:e.jsx(V,{className:"text-lg",children:"Total"})}),e.jsx(y,{children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(J,{className:"h-5 w-5 text-blue-600 mr-2"}),e.jsx("span",{className:"text-2xl font-bold",children:o?o.length:0})]})})]}),e.jsxs(f,{children:[e.jsx(M,{className:"pb-2",children:e.jsx(V,{className:"text-lg",children:"Activos"})}),e.jsx(y,{children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(oe,{className:"h-5 w-5 text-green-600 mr-2"}),e.jsx("span",{className:"text-2xl font-bold",children:o?o.filter(r=>r.status==="active").length:0})]})})]}),e.jsxs(f,{children:[e.jsx(M,{className:"pb-2",children:e.jsx(V,{className:"text-lg",children:"Experiencia promedio"})}),e.jsx(y,{children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(ee,{className:"h-5 w-5 text-amber-600 mr-2"}),e.jsxs("span",{className:"text-2xl font-bold",children:[o&&o.length>0?Math.round(o.reduce((r,b)=>r+(b.experience_years||0),0)/o.length):0," años"]})]})})]}),e.jsxs(f,{children:[e.jsx(M,{className:"pb-2",children:e.jsx(V,{className:"text-lg",children:"Especialidades"})}),e.jsx(y,{children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(G,{className:"h-5 w-5 text-purple-600 mr-2"}),e.jsx("span",{className:"text-2xl font-bold",children:m.length})]})})]})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm border mb-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(Oe,{className:"h-5 w-5 mr-2 text-gray-500"}),e.jsx("h2",{className:"font-medium",children:"Filtros"}),e.jsxs(u,{variant:"ghost",size:"sm",className:"ml-auto",onClick:j,children:[e.jsx(Qe,{className:"h-4 w-4 mr-1"}),"Limpiar"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx("div",{children:e.jsxs("div",{className:"relative",children:[e.jsx(We,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(P,{placeholder:"Buscar por nombre o email...",className:"pl-8",value:x,onChange:r=>h(r.target.value)})]})}),e.jsx("div",{children:e.jsxs(R,{value:s,onValueChange:v,children:[e.jsx(K,{children:e.jsx(U,{placeholder:"Estado"})}),e.jsxs(B,{children:[e.jsx(p,{value:"all",children:"Todos los estados"}),e.jsx(p,{value:"active",children:"Activos"}),e.jsx(p,{value:"inactive",children:"Inactivos"}),e.jsx(p,{value:"pending",children:"Pendientes"})]})]})}),e.jsx("div",{children:e.jsxs(R,{value:d,onValueChange:N,children:[e.jsx(K,{children:e.jsx(U,{placeholder:"Especialidad"})}),e.jsxs(B,{children:[e.jsx(p,{value:"all",children:"Todas las especialidades"}),m.map((r,b)=>e.jsx(p,{value:r,children:r},b))]})]})}),e.jsx("div",{children:e.jsxs(R,{value:c,onValueChange:g,children:[e.jsx(K,{children:e.jsx(U,{placeholder:"Experiencia"})}),e.jsxs(B,{children:[e.jsx(p,{value:"all",children:"Cualquier nivel"}),e.jsx(p,{value:"novice",children:"Principiante (0-2 años)"}),e.jsx(p,{value:"intermediate",children:"Intermedio (3-5 años)"}),e.jsx(p,{value:"expert",children:"Experto (6+ años)"})]})]})})]})]}),e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsxs(u,{onClick:()=>i(),variant:"outline",children:[e.jsx(xe,{className:"mr-2 h-4 w-4"}),"Actualizar datos"]}),e.jsxs(u,{onClick:()=>{fetch("/api/admin/seed/instructors",{method:"POST",headers:{"Content-Type":"application/json"}}).then(r=>r.json()).then(()=>{i(),alert("Datos de muestra de instructores cargados correctamente")}).catch(r=>{console.error("Error al cargar datos de muestra:",r),alert("Error al cargar datos de muestra: "+r.message)})},variant:"secondary",children:[e.jsx(Ge,{className:"mr-2 h-4 w-4"}),"Cargar datos de muestra"]})]}),t?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(xe,{className:"h-8 w-8 animate-spin mx-auto text-gray-400"}),e.jsx("p",{className:"mt-2 text-gray-500",children:"Cargando instructores..."})]}):a?e.jsxs("div",{className:"text-center py-8 bg-white rounded-lg shadow-sm border p-6",children:[e.jsx(He,{className:"h-8 w-8 mx-auto text-red-500"}),e.jsx("p",{className:"mt-2 text-red-500",children:"Error al cargar los instructores"}),e.jsx(u,{variant:"outline",size:"sm",className:"mt-2",onClick:()=>i(),children:"Reintentar"})]}):(n==null?void 0:n.length)===0?e.jsxs("div",{className:"text-center py-8 bg-white rounded-lg shadow-sm border p-6",children:[e.jsx(oe,{className:"h-8 w-8 mx-auto text-gray-400"}),e.jsx("p",{className:"mt-2 text-gray-500",children:o?"No se encontraron instructores que coincidan con los criterios de búsqueda.":"Haz clic en 'Actualizar datos' para ver los instructores."})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:n.map(r=>e.jsx(Ze,{instructor:r,showActions:!0,compact:!1},r.id))})]})})}export{as as default};
