import{a2 as c,u as E,j as e,aX as h,d4 as F,B as u,D as P,f as i,g as x,h as m,a7 as I,i as d,m as M,O as j,a4 as L,Q as p,V as b,W as v,Y as N,_ as l}from"./index-D5qLf1ib.js";import{P as V}from"./printer-C4fk6c7h.js";function q(){const[o,f]=c.useState(new Date().toISOString().split("T")[0].substring(0,7)),[g,y]=c.useState(""),[B,w]=c.useState("all"),[T,S]=c.useState("all"),{data:X,isLoading:C}=E({queryKey:["/api/accounting/trial-balance",o],enabled:!0}),D=()=>{console.log("Exportando balanza...")},A=()=>{window.print()},n=[{id:1,code:"1.1.001",name:"Caja General",level:3,nature:"Deudor",previousBalance:5e4,debits:125e3,credits:75e3,currentBalance:1e5,balanceType:"debit"},{id:2,code:"1.1.002",name:"Banco Santander",level:3,nature:"Deudor",previousBalance:8e4,debits:2e5,credits:15e4,currentBalance:13e4,balanceType:"debit"},{id:3,code:"1.2.001",name:"Cuentas por Cobrar",level:3,nature:"Deudor",previousBalance:25e3,debits:45e3,credits:3e4,currentBalance:4e4,balanceType:"debit"},{id:4,code:"1.3.001",name:"Inventario",level:3,nature:"Deudor",previousBalance:6e4,debits:85e3,credits:7e4,currentBalance:75e3,balanceType:"debit"},{id:5,code:"2.1.001",name:"Cuentas por Pagar",level:3,nature:"Acreedor",previousBalance:35e3,debits:25e3,credits:5e4,currentBalance:6e4,balanceType:"credit"},{id:6,code:"2.2.001",name:"Impuestos por Pagar",level:3,nature:"Acreedor",previousBalance:15e3,debits:1e4,credits:2e4,currentBalance:25e3,balanceType:"credit"},{id:7,code:"3.1.001",name:"Capital Social",level:3,nature:"Acreedor",previousBalance:2e5,debits:0,credits:0,currentBalance:2e5,balanceType:"credit"},{id:8,code:"4.1.001",name:"Ingresos por Servicios",level:3,nature:"Acreedor",previousBalance:0,debits:2e4,credits:95e3,currentBalance:75e3,balanceType:"credit"},{id:9,code:"5.1.001",name:"Gastos de Administración",level:3,nature:"Deudor",previousBalance:0,debits:45e3,credits:5e3,currentBalance:4e4,balanceType:"debit"},{id:10,code:"5.2.001",name:"Gastos de Venta",level:3,nature:"Deudor",previousBalance:0,debits:3e4,credits:3e3,currentBalance:27e3,balanceType:"debit"}],a={previousBalance:{debit:n.filter(s=>s.balanceType==="debit").reduce((s,r)=>s+r.previousBalance,0),credit:n.filter(s=>s.balanceType==="credit").reduce((s,r)=>s+r.previousBalance,0)},movements:{debit:n.reduce((s,r)=>s+r.debits,0),credit:n.reduce((s,r)=>s+r.credits,0)},currentBalance:{debit:n.filter(s=>s.balanceType==="debit").reduce((s,r)=>s+r.currentBalance,0),credit:n.filter(s=>s.balanceType==="credit").reduce((s,r)=>s+r.currentBalance,0)}},t=s=>new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN",minimumFractionDigits:2}).format(s),z=s=>s==="Deudor"?"bg-blue-50":"bg-green-50";return C?e.jsx(h,{children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-8 w-64 bg-gray-200 rounded animate-pulse"}),e.jsx("div",{className:"h-4 w-96 bg-gray-200 rounded animate-pulse"})]})}),e.jsx("div",{className:"space-y-4",children:[1,2,3,4,5].map(s=>e.jsx("div",{className:"h-16 bg-gray-200 rounded animate-pulse"},s))})]})}):e.jsx(h,{children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(F,{className:"w-8 h-8 text-gray-900"}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Balanza"})]}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Estado de saldos y movimientos contables"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(u,{variant:"outline",onClick:A,className:"flex items-center space-x-2",children:[e.jsx(V,{className:"h-4 w-4"}),e.jsx("span",{children:"Imprimir"})]}),e.jsxs(u,{variant:"outline",onClick:D,className:"flex items-center space-x-2",children:[e.jsx(P,{className:"h-4 w-4"}),e.jsx("span",{children:"Exportar"})]})]})]}),e.jsxs(i,{children:[e.jsx(x,{children:e.jsxs(m,{className:"flex items-center",children:[e.jsx(I,{className:"h-5 w-5 mr-2"}),"Parámetros y Filtros"]})}),e.jsx(d,{children:e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Período"}),e.jsxs("div",{className:"relative",children:[e.jsx(M,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e.jsx(j,{type:"month",value:o,onChange:s=>f(s.target.value),className:"pl-9"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Buscar Cuenta"}),e.jsxs("div",{className:"relative",children:[e.jsx(L,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e.jsx(j,{placeholder:"Buscar por código o nombre...",value:g,onChange:s=>y(s.target.value),className:"pl-9"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Nivel"}),e.jsxs(p,{value:B,onValueChange:w,children:[e.jsx(b,{children:e.jsx(v,{})}),e.jsxs(N,{children:[e.jsx(l,{value:"all",children:"Todos los niveles"}),e.jsx(l,{value:"1",children:"Nivel 1"}),e.jsx(l,{value:"2",children:"Nivel 2"}),e.jsx(l,{value:"3",children:"Nivel 3"}),e.jsx(l,{value:"4",children:"Nivel 4"}),e.jsx(l,{value:"5",children:"Nivel 5"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Naturaleza"}),e.jsxs(p,{value:T,onValueChange:S,children:[e.jsx(b,{children:e.jsx(v,{})}),e.jsxs(N,{children:[e.jsx(l,{value:"all",children:"Todas las naturalezas"}),e.jsx(l,{value:"Deudor",children:"Deudor"}),e.jsx(l,{value:"Acreedor",children:"Acreedor"})]})]})]})]})})]}),e.jsx(i,{children:e.jsx(d,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Período seleccionado:"})," ",new Date(o+"-01").toLocaleDateString("es-MX",{month:"long",year:"numeric"})]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Fecha de generación:"})," ",new Date().toLocaleDateString("es-MX")]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Total de cuentas:"})," ",n.length]})]})})}),e.jsxs(i,{children:[e.jsx(x,{children:e.jsx(m,{children:"Balanza de Comprobación"})}),e.jsx(d,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsxs("thead",{children:[e.jsxs("tr",{className:"border-b-2 border-gray-300",children:[e.jsx("th",{className:"text-left p-3 font-semibold",children:"Código"}),e.jsx("th",{className:"text-left p-3 font-semibold",children:"Nombre de la Cuenta"}),e.jsx("th",{className:"text-center p-3 font-semibold",children:"Naturaleza"}),e.jsx("th",{className:"text-center p-3 font-semibold",children:"Saldo Anterior"}),e.jsx("th",{className:"text-center p-3 font-semibold",children:"Movimientos"}),e.jsx("th",{className:"text-center p-3 font-semibold"}),e.jsx("th",{className:"text-center p-3 font-semibold",children:"Saldo Actual"}),e.jsx("th",{className:"text-center p-3 font-semibold"})]}),e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("th",{className:"p-2"}),e.jsx("th",{className:"p-2"}),e.jsx("th",{className:"p-2"}),e.jsx("th",{className:"p-2"}),e.jsx("th",{className:"text-center p-2 text-xs font-medium",children:"Debe"}),e.jsx("th",{className:"text-center p-2 text-xs font-medium",children:"Haber"}),e.jsx("th",{className:"text-center p-2 text-xs font-medium",children:"Deudor"}),e.jsx("th",{className:"text-center p-2 text-xs font-medium",children:"Acreedor"})]})]}),e.jsx("tbody",{children:n.map(s=>e.jsxs("tr",{className:`border-b hover:bg-gray-50 ${z(s.nature)}`,children:[e.jsx("td",{className:"p-3 font-mono text-sm",children:s.code}),e.jsx("td",{className:"p-3 font-medium",children:s.name}),e.jsx("td",{className:"p-3 text-center",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${s.nature==="Deudor"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:s.nature})}),e.jsx("td",{className:"p-3 text-right font-mono",children:s.previousBalance>0?t(s.previousBalance):"-"}),e.jsx("td",{className:"p-3 text-right font-mono",children:s.debits>0?t(s.debits):"-"}),e.jsx("td",{className:"p-3 text-right font-mono",children:s.credits>0?t(s.credits):"-"}),e.jsx("td",{className:"p-3 text-right font-mono",children:s.balanceType==="debit"?t(s.currentBalance):"-"}),e.jsx("td",{className:"p-3 text-right font-mono",children:s.balanceType==="credit"?t(s.currentBalance):"-"})]},s.id))}),e.jsx("tfoot",{children:e.jsxs("tr",{className:"border-t-2 border-gray-400 bg-gray-100 font-bold",children:[e.jsx("td",{className:"p-3",colSpan:3,children:"TOTALES"}),e.jsx("td",{className:"p-3 text-right font-mono",children:t(a.previousBalance.debit+a.previousBalance.credit)}),e.jsx("td",{className:"p-3 text-right font-mono text-blue-600",children:t(a.movements.debit)}),e.jsx("td",{className:"p-3 text-right font-mono text-green-600",children:t(a.movements.credit)}),e.jsx("td",{className:"p-3 text-right font-mono text-blue-600",children:t(a.currentBalance.debit)}),e.jsx("td",{className:"p-3 text-right font-mono text-green-600",children:t(a.currentBalance.credit)})]})})]})})})]}),e.jsxs(i,{children:[e.jsx(x,{children:e.jsx(m,{children:"Validación de Balanza"})}),e.jsxs(d,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Equilibrio de Movimientos"}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Total Debe:"}),e.jsx("span",{className:"font-mono",children:t(a.movements.debit)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Total Haber:"}),e.jsx("span",{className:"font-mono",children:t(a.movements.credit)})]}),e.jsxs("div",{className:"flex justify-between pt-2 border-t",children:[e.jsx("span",{children:"Diferencia:"}),e.jsx("span",{className:`font-mono ${a.movements.debit===a.movements.credit?"text-green-600":"text-red-600"}`,children:t(Math.abs(a.movements.debit-a.movements.credit))})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Equilibrio de Saldos"}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Saldos Deudores:"}),e.jsx("span",{className:"font-mono",children:t(a.currentBalance.debit)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Saldos Acreedores:"}),e.jsx("span",{className:"font-mono",children:t(a.currentBalance.credit)})]}),e.jsxs("div",{className:"flex justify-between pt-2 border-t",children:[e.jsx("span",{children:"Diferencia:"}),e.jsx("span",{className:`font-mono ${a.currentBalance.debit===a.currentBalance.credit?"text-green-600":"text-red-600"}`,children:t(Math.abs(a.currentBalance.debit-a.currentBalance.credit))})]})]})]})]}),e.jsx("div",{className:"mt-4 p-3 bg-green-50 border border-green-200 rounded",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full mr-3"}),e.jsx("span",{className:"text-green-800 font-medium",children:a.movements.debit===a.movements.credit?"Balanza cuadrada correctamente":"Advertencia: La balanza no cuadra - Revisar asientos contables"})]})})]})]})]})})}export{q as default};
