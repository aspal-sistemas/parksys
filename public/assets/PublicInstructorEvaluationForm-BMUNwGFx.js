import{a5 as s,e as R,a6 as f,Y as C,a7 as w,a8 as S,j as e,C as b,c as y,a9 as F,a as T,b as k,a3 as q,aa as A,ab as r,ac as t,ad as c,ae as d,I as g,af as i,ag as P,O as M,x as I,B as $,S as B,ah as G,ai as H}from"./index-Dzu3mJf5.js";import{S as Q}from"./send-DKRtUueH.js";const z=s.object({evaluatorName:s.string().min(2,"El nombre debe tener al menos 2 caracteres").max(255),evaluatorEmail:s.string().email("Email inválido").optional().or(s.literal("")),evaluatorCity:s.string().max(100).optional().or(s.literal("")),overallRating:s.number().min(1,"Calificación mínima: 1").max(5,"Calificación máxima: 5"),knowledgeRating:s.number().min(1).max(5),patienceRating:s.number().min(1).max(5),clarityRating:s.number().min(1).max(5),punctualityRating:s.number().min(1).max(5),wouldRecommend:s.boolean(),comments:s.string().max(500,"Máximo 500 caracteres").optional().or(s.literal("")),attendedActivity:s.string().max(255).optional().or(s.literal(""))}),u=({value:l,onChange:x,label:j})=>{const[h,m]=C.useState(0);return e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:j}),e.jsx("div",{className:"flex gap-1",children:[1,2,3,4,5].map(o=>e.jsx("button",{type:"button",className:"p-1 rounded transition-colors hover:bg-gray-100",onMouseEnter:()=>m(o),onMouseLeave:()=>m(0),onClick:()=>x(o),children:e.jsx(B,{className:`w-6 h-6 transition-colors ${o<=(h||l)?"text-yellow-400 fill-current":"text-gray-300"}`})},o))}),e.jsx("div",{className:"text-xs text-gray-500",children:l>0?`${l}/5 estrellas`:"Selecciona una calificación"})]})};function L({instructorId:l,instructorName:x,onSuccess:j}){const{toast:h}=R(),m=f(),[o,N]=C.useState(!1),n=w({resolver:G(z),defaultValues:{evaluatorName:"",evaluatorEmail:"",evaluatorCity:"",overallRating:0,knowledgeRating:0,patienceRating:0,clarityRating:0,punctualityRating:0,wouldRecommend:!1,comments:"",attendedActivity:""}}),p=S({mutationFn:async a=>{const v={...a,evaluatorEmail:a.evaluatorEmail||void 0,evaluatorCity:a.evaluatorCity||void 0,comments:a.comments||void 0,attendedActivity:a.attendedActivity||void 0};return H(`/api/public/instructors/${l}/evaluations`,{method:"POST",data:v})},onSuccess:()=>{N(!0),m.invalidateQueries({queryKey:[`/api/public/instructors/${l}/evaluations`]}),m.invalidateQueries({queryKey:[`/api/public/instructors/${l}/evaluation-stats`]}),h({title:"Evaluación enviada",description:"Tu evaluación será revisada antes de publicarse. ¡Gracias por tu participación!"}),j&&j()},onError:a=>{console.error("Error al enviar evaluación:",a),h({title:"Error al enviar evaluación",description:a.message||"Hubo un problema al enviar tu evaluación. Inténtalo nuevamente.",variant:"destructive"})}}),E=a=>{p.mutate(a)};return o?e.jsx(b,{className:"bg-green-50 border-green-200",children:e.jsx(y,{className:"pt-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx(F,{className:"w-12 h-12 text-green-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-green-900 mb-2",children:"¡Evaluación Enviada!"}),e.jsxs("p",{className:"text-green-700 mb-4",children:["Tu evaluación de ",e.jsx("strong",{children:x})," ha sido enviada exitosamente."]}),e.jsx("p",{className:"text-sm text-green-600",children:"Será revisada por nuestro equipo antes de publicarse. ¡Gracias por ayudar a mejorar nuestros servicios!"})]})})}):e.jsxs(b,{className:"bg-white border-gray-200",children:[e.jsxs(T,{children:[e.jsxs(k,{className:"text-xl text-gray-900",children:["Evalúa a ",x]}),e.jsx(q,{children:"Tu opinión nos ayuda a mejorar la calidad de nuestros instructores. Todas las evaluaciones son revisadas antes de publicarse."})]}),e.jsx(y,{children:e.jsx(A,{...n,children:e.jsxs("form",{onSubmit:n.handleSubmit(E),className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:"Información personal"}),e.jsx(r,{control:n.control,name:"evaluatorName",render:({field:a})=>e.jsxs(t,{children:[e.jsx(c,{children:"Nombre completo *"}),e.jsx(d,{children:e.jsx(g,{placeholder:"Tu nombre completo",...a})}),e.jsx(i,{})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(r,{control:n.control,name:"evaluatorEmail",render:({field:a})=>e.jsxs(t,{children:[e.jsx(c,{children:"Email (opcional)"}),e.jsx(d,{children:e.jsx(g,{type:"email",placeholder:"tu@email.com",...a})}),e.jsx(i,{})]})}),e.jsx(r,{control:n.control,name:"evaluatorCity",render:({field:a})=>e.jsxs(t,{children:[e.jsx(c,{children:"Ciudad (opcional)"}),e.jsx(d,{children:e.jsx(g,{placeholder:"Guadalajara",...a})}),e.jsx(i,{})]})})]}),e.jsx(r,{control:n.control,name:"attendedActivity",render:({field:a})=>e.jsxs(t,{children:[e.jsx(c,{children:"Actividad que tomaste (opcional)"}),e.jsx(d,{children:e.jsx(g,{placeholder:"Ej: Clase de yoga, Aqua aeróbicos, etc.",...a})}),e.jsx(i,{})]})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:"Calificaciones *"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(r,{control:n.control,name:"overallRating",render:({field:a})=>e.jsxs(t,{children:[e.jsx(u,{label:"Calificación general",value:a.value,onChange:a.onChange}),e.jsx(i,{})]})}),e.jsx(r,{control:n.control,name:"knowledgeRating",render:({field:a})=>e.jsxs(t,{children:[e.jsx(u,{label:"Conocimiento",value:a.value,onChange:a.onChange}),e.jsx(i,{})]})}),e.jsx(r,{control:n.control,name:"patienceRating",render:({field:a})=>e.jsxs(t,{children:[e.jsx(u,{label:"Paciencia",value:a.value,onChange:a.onChange}),e.jsx(i,{})]})}),e.jsx(r,{control:n.control,name:"clarityRating",render:({field:a})=>e.jsxs(t,{children:[e.jsx(u,{label:"Claridad al explicar",value:a.value,onChange:a.onChange}),e.jsx(i,{})]})}),e.jsx(r,{control:n.control,name:"punctualityRating",render:({field:a})=>e.jsxs(t,{children:[e.jsx(u,{label:"Puntualidad",value:a.value,onChange:a.onChange}),e.jsx(i,{})]})})]})]}),e.jsx(r,{control:n.control,name:"wouldRecommend",render:({field:a})=>e.jsxs(t,{className:"flex flex-row items-start space-x-3 space-y-0",children:[e.jsx(d,{children:e.jsx(P,{checked:a.value,onCheckedChange:a.onChange})}),e.jsx("div",{className:"space-y-1 leading-none",children:e.jsx(c,{className:"text-sm font-medium",children:"¿Recomendarías este instructor a otros?"})})]})}),e.jsx(r,{control:n.control,name:"comments",render:({field:a})=>{var v;return e.jsxs(t,{children:[e.jsx(c,{children:"Comentarios adicionales (opcional)"}),e.jsx(d,{children:e.jsx(M,{placeholder:"Cuéntanos sobre tu experiencia con este instructor...",className:"min-h-[100px]",...a})}),e.jsxs("div",{className:"text-xs text-gray-500",children:[((v=a.value)==null?void 0:v.length)||0,"/500 caracteres"]}),e.jsx(i,{})]})}}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx(I,{className:"w-5 h-5 text-blue-600 mt-0.5"}),e.jsxs("div",{className:"text-sm text-blue-800",children:[e.jsx("p",{className:"font-medium mb-1",children:"Moderación de contenido"}),e.jsx("p",{children:"Todas las evaluaciones son revisadas por nuestro equipo antes de publicarse para garantizar un ambiente respetuoso y constructivo."})]})]})}),e.jsx($,{type:"submit",disabled:p.isPending,className:"w-full bg-green-600 hover:bg-green-700 text-white",children:p.isPending?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Enviando evaluación..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Q,{className:"w-4 h-4 mr-2"}),"Enviar evaluación"]})})]})})})]})}export{L as P};
