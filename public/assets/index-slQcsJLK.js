import{l as F,ae as L,u as R,af as E,ag as P,j as e,aX as A,B as v,bF as T,bG as D,f as h,g as j,h as g,ah as M,ab as p,i as u,e as I,U as G,n as H,ai as U,b1 as z,b2 as B,b3 as b,b4 as y,aj as r,ak as i,al as o,aF as t,am as l,br as d,O as x,an as m,aW as Q,ad as a,ap as K}from"./index-D5qLf1ib.js";const V=a.object({systemEnabled:a.boolean(),inheritanceEnabled:a.boolean(),auditLogsEnabled:a.boolean(),sessionTimeout:a.number().min(5).max(1440),maxConcurrentSessions:a.number().min(1).max(10),requireMfa:a.boolean(),passwordPolicy:a.object({minLength:a.number().min(6).max(128),requireUppercase:a.boolean(),requireLowercase:a.boolean(),requireNumbers:a.boolean(),requireSymbols:a.boolean(),expirationDays:a.number().min(0).max(365)}),maxFailedAttempts:a.number().min(3).max(10),lockoutDuration:a.number().min(5).max(1440),notifyRoleChanges:a.boolean(),notifyPermissionChanges:a.boolean(),notifySecurityEvents:a.boolean(),logRetentionDays:a.number().min(30).max(2555),logLevel:a.enum(["error","warn","info","debug"])}),w={systemEnabled:!0,inheritanceEnabled:!0,auditLogsEnabled:!0,sessionTimeout:480,maxConcurrentSessions:3,requireMfa:!1,passwordPolicy:{minLength:8,requireUppercase:!0,requireLowercase:!0,requireNumbers:!0,requireSymbols:!1,expirationDays:90},maxFailedAttempts:5,lockoutDuration:15,notifyRoleChanges:!0,notifyPermissionChanges:!0,notifySecurityEvents:!0,logRetentionDays:365,logLevel:"info"};function X(){const{toast:f}=F(),S=L(),{data:k=w,isLoading:O}=R({queryKey:["/api/admin-roles/settings"],enabled:!1}),n=E({resolver:K(V),defaultValues:k}),C=P({mutationFn:async s=>(await new Promise(c=>setTimeout(c,1500)),console.log("Guardando configuración:",s),{success:!0}),onSuccess:()=>{S.invalidateQueries({queryKey:["/api/admin-roles/settings"]}),f({title:"Configuración guardada",description:"Los ajustes del sistema de roles se han actualizado correctamente."})},onError:s=>{f({title:"Error al guardar",description:s.message,variant:"destructive"})}}),N=s=>{C.mutate(s)},q=()=>{n.reset(w),f({title:"Configuración restablecida",description:"Se han restaurado los valores por defecto."})};return e.jsx(A,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Configuración del Sistema de Roles"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Configurar políticas y parámetros del sistema de roles y permisos"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(v,{variant:"outline",onClick:q,children:[e.jsx(T,{className:"w-4 h-4 mr-2"}),"Restablecer"]}),e.jsx(v,{onClick:n.handleSubmit(N),disabled:C.isPending,children:C.isPending?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 mr-2 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Guardando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(D,{className:"w-4 h-4 mr-2"}),"Guardar Cambios"]})})]})]}),e.jsxs(h,{children:[e.jsxs(j,{children:[e.jsxs(g,{className:"flex items-center gap-2",children:[e.jsx(M,{className:"h-5 w-5 text-green-500"}),"Estado del Sistema"]}),e.jsx(p,{children:"Información general sobre el estado del sistema de roles"})]}),e.jsx(u,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"flex items-center gap-3 p-4 border rounded-lg",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(I,{className:"h-5 w-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:"Sistema Activo"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Roles funcionando correctamente"})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-4 border rounded-lg",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(G,{className:"h-5 w-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:"10 Roles Activos"}),e.jsx("p",{className:"text-sm text-gray-600",children:"45 usuarios con roles"})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-4 border rounded-lg",children:[e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:e.jsx(H,{className:"h-5 w-5 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:"Última Actualización"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Hace 2 horas"})]})]})]})})]}),e.jsx(U,{...n,children:e.jsx("form",{onSubmit:n.handleSubmit(N),children:e.jsxs(z,{defaultValue:"general",className:"space-y-4",children:[e.jsxs(B,{className:"grid w-full grid-cols-4",children:[e.jsx(b,{value:"general",children:"General"}),e.jsx(b,{value:"security",children:"Seguridad"}),e.jsx(b,{value:"sessions",children:"Sesiones"}),e.jsx(b,{value:"notifications",children:"Notificaciones"})]}),e.jsx(y,{value:"general",className:"space-y-4",children:e.jsxs(h,{children:[e.jsxs(j,{children:[e.jsx(g,{children:"Configuración General"}),e.jsx(p,{children:"Configuraciones básicas del sistema de roles"})]}),e.jsxs(u,{className:"space-y-6",children:[e.jsx(r,{control:n.control,name:"systemEnabled",render:({field:s})=>e.jsxs(i,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(o,{className:"text-base",children:"Sistema de Roles Habilitado"}),e.jsx(t,{children:"Activar o desactivar completamente el sistema de roles"})]}),e.jsx(l,{children:e.jsx(d,{checked:s.value,onCheckedChange:s.onChange})})]})}),e.jsx(r,{control:n.control,name:"inheritanceEnabled",render:({field:s})=>e.jsxs(i,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(o,{className:"text-base",children:"Herencia de Permisos"}),e.jsx(t,{children:"Los roles superiores heredan permisos de roles inferiores"})]}),e.jsx(l,{children:e.jsx(d,{checked:s.value,onCheckedChange:s.onChange})})]})}),e.jsx(r,{control:n.control,name:"auditLogsEnabled",render:({field:s})=>e.jsxs(i,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(o,{className:"text-base",children:"Logs de Auditoría"}),e.jsx(t,{children:"Registrar todas las acciones relacionadas con roles y permisos"})]}),e.jsx(l,{children:e.jsx(d,{checked:s.value,onCheckedChange:s.onChange})})]})}),e.jsx(r,{control:n.control,name:"logRetentionDays",render:({field:s})=>e.jsxs(i,{children:[e.jsx(o,{children:"Retención de Logs (días)"}),e.jsx(l,{children:e.jsx(x,{type:"number",...s,onChange:c=>s.onChange(parseInt(c.target.value))})}),e.jsx(t,{children:"Número de días para mantener los logs del sistema (30-2555)"}),e.jsx(m,{})]})})]})]})}),e.jsx(y,{value:"security",className:"space-y-4",children:e.jsxs(h,{children:[e.jsxs(j,{children:[e.jsx(g,{children:"Configuración de Seguridad"}),e.jsx(p,{children:"Políticas de seguridad y autenticación"})]}),e.jsxs(u,{className:"space-y-6",children:[e.jsx(r,{control:n.control,name:"requireMfa",render:({field:s})=>e.jsxs(i,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(o,{className:"text-base",children:"Autenticación Multifactor (MFA)"}),e.jsx(t,{children:"Requerir MFA para usuarios con roles administrativos"})]}),e.jsx(l,{children:e.jsx(d,{checked:s.value,onCheckedChange:s.onChange})})]})}),e.jsxs("div",{className:"space-y-4 p-4 border rounded-lg",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:"Política de Contraseñas"}),e.jsx(r,{control:n.control,name:"passwordPolicy.minLength",render:({field:s})=>e.jsxs(i,{children:[e.jsx(o,{children:"Longitud Mínima"}),e.jsx(l,{children:e.jsx(x,{type:"number",...s,onChange:c=>s.onChange(parseInt(c.target.value))})}),e.jsx(m,{})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(r,{control:n.control,name:"passwordPolicy.requireUppercase",render:({field:s})=>e.jsxs(i,{className:"flex flex-row items-center justify-between rounded-lg border p-3",children:[e.jsx(o,{className:"text-sm",children:"Mayúsculas"}),e.jsx(l,{children:e.jsx(d,{checked:s.value,onCheckedChange:s.onChange})})]})}),e.jsx(r,{control:n.control,name:"passwordPolicy.requireNumbers",render:({field:s})=>e.jsxs(i,{className:"flex flex-row items-center justify-between rounded-lg border p-3",children:[e.jsx(o,{className:"text-sm",children:"Números"}),e.jsx(l,{children:e.jsx(d,{checked:s.value,onCheckedChange:s.onChange})})]})})]}),e.jsx(r,{control:n.control,name:"passwordPolicy.expirationDays",render:({field:s})=>e.jsxs(i,{children:[e.jsx(o,{children:"Expiración (días)"}),e.jsx(l,{children:e.jsx(x,{type:"number",...s,onChange:c=>s.onChange(parseInt(c.target.value))})}),e.jsx(t,{children:"0 = sin expiración"}),e.jsx(m,{})]})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(r,{control:n.control,name:"maxFailedAttempts",render:({field:s})=>e.jsxs(i,{children:[e.jsx(o,{children:"Intentos Fallidos Máximos"}),e.jsx(l,{children:e.jsx(x,{type:"number",...s,onChange:c=>s.onChange(parseInt(c.target.value))})}),e.jsx(m,{})]})}),e.jsx(r,{control:n.control,name:"lockoutDuration",render:({field:s})=>e.jsxs(i,{children:[e.jsx(o,{children:"Duración de Bloqueo (minutos)"}),e.jsx(l,{children:e.jsx(x,{type:"number",...s,onChange:c=>s.onChange(parseInt(c.target.value))})}),e.jsx(m,{})]})})]})]})]})}),e.jsx(y,{value:"sessions",className:"space-y-4",children:e.jsxs(h,{children:[e.jsxs(j,{children:[e.jsx(g,{children:"Gestión de Sesiones"}),e.jsx(p,{children:"Configuración de sesiones de usuario"})]}),e.jsxs(u,{className:"space-y-6",children:[e.jsx(r,{control:n.control,name:"sessionTimeout",render:({field:s})=>e.jsxs(i,{children:[e.jsx(o,{children:"Tiempo de Sesión (minutos)"}),e.jsx(l,{children:e.jsx(x,{type:"number",...s,onChange:c=>s.onChange(parseInt(c.target.value))})}),e.jsx(t,{children:"Tiempo de inactividad antes de cerrar sesión automáticamente"}),e.jsx(m,{})]})}),e.jsx(r,{control:n.control,name:"maxConcurrentSessions",render:({field:s})=>e.jsxs(i,{children:[e.jsx(o,{children:"Sesiones Concurrentes Máximas"}),e.jsx(l,{children:e.jsx(x,{type:"number",...s,onChange:c=>s.onChange(parseInt(c.target.value))})}),e.jsx(t,{children:"Número máximo de sesiones simultáneas por usuario"}),e.jsx(m,{})]})})]})]})}),e.jsx(y,{value:"notifications",className:"space-y-4",children:e.jsxs(h,{children:[e.jsxs(j,{children:[e.jsx(g,{children:"Configuración de Notificaciones"}),e.jsx(p,{children:"Configurar qué eventos generan notificaciones"})]}),e.jsxs(u,{className:"space-y-6",children:[e.jsx(r,{control:n.control,name:"notifyRoleChanges",render:({field:s})=>e.jsxs(i,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(o,{className:"text-base",children:"Cambios de Roles"}),e.jsx(t,{children:"Notificar cuando se asignan o remueven roles de usuarios"})]}),e.jsx(l,{children:e.jsx(d,{checked:s.value,onCheckedChange:s.onChange})})]})}),e.jsx(r,{control:n.control,name:"notifyPermissionChanges",render:({field:s})=>e.jsxs(i,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(o,{className:"text-base",children:"Cambios de Permisos"}),e.jsx(t,{children:"Notificar cuando se modifican permisos de roles"})]}),e.jsx(l,{children:e.jsx(d,{checked:s.value,onCheckedChange:s.onChange})})]})}),e.jsx(r,{control:n.control,name:"notifySecurityEvents",render:({field:s})=>e.jsxs(i,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(o,{className:"text-base",children:"Eventos de Seguridad"}),e.jsx(t,{children:"Notificar sobre intentos de acceso no autorizado"})]}),e.jsx(l,{children:e.jsx(d,{checked:s.value,onCheckedChange:s.onChange})})]})})]})]})})]})})}),e.jsx(h,{className:"border-orange-200 bg-orange-50",children:e.jsx(u,{className:"p-6",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Q,{className:"h-5 w-5 text-orange-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-orange-900",children:"Advertencias Importantes"}),e.jsxs("ul",{className:"mt-2 text-sm text-orange-800 space-y-1",children:[e.jsx("li",{children:"• Deshabilitar el sistema de roles puede afectar el acceso de todos los usuarios"}),e.jsx("li",{children:"• Los cambios en políticas de seguridad se aplican inmediatamente"}),e.jsx("li",{children:"• Reducir el tiempo de retención de logs puede eliminar información histórica"}),e.jsx("li",{children:"• Habilitar MFA requerirá que todos los usuarios configuren su autenticación"})]})]})]})})})]})})}export{X as default};
