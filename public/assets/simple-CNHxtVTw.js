import{a2 as n,l as C,ae as M,u as T,j as e,aX as D,f as a,aZ as v,B as t,dD as S,g as i,h as c,i as d,ah as z,aW as B,a4 as L,O as P,a5 as E,a6 as k,D as A,au as G,bq as R,bn as q}from"./index-D5qLf1ib.js";function Q(){const[r,y]=n.useState(""),[o,f]=n.useState("all"),[x,u]=n.useState("grid"),[F,b]=n.useState(!1);C(),M();const{data:m,isLoading:w}=T({queryKey:["/api/trees/maintenances"],retry:1}),h=(m==null?void 0:m.data)||[],j=h.length||0,g=h.filter(s=>{const p=new Date(s.maintenanceDate||s.maintenance_date),l=new Date;return l.setDate(l.getDate()-30),p>=l}).length||0,N=h.filter(s=>{const p=r===""||s.notes&&s.notes.toLowerCase().includes(r.toLowerCase())||s.performedBy&&s.performedBy.toLowerCase().includes(r.toLowerCase()),l=o==="all"||s.maintenanceType===o;return p&&l});return e.jsx(D,{children:e.jsxs("div",{className:"container mx-auto py-6",children:[e.jsx(a,{className:"p-4 bg-gray-50 mb-6",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(v,{className:"w-8 h-8 text-gray-900"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Mantenimiento de Árboles"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Gestiona y registra las actividades de mantenimiento realizadas en árboles"})]})]}),e.jsxs(t,{onClick:()=>b(!0),className:"bg-green-600 hover:bg-green-700",children:[e.jsx(S,{className:"mr-2 h-4 w-4"}),"Registrar Mantenimiento"]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs(a,{children:[e.jsx(i,{className:"pb-2",children:e.jsx(c,{className:"text-sm font-medium",children:"Total de Mantenimientos"})}),e.jsx(d,{children:e.jsx("div",{className:"text-2xl font-bold",children:j})})]}),e.jsxs(a,{children:[e.jsxs(i,{className:"pb-2",children:[e.jsx(c,{className:"text-sm font-medium",children:"Mantenimientos Recientes"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Últimos 30 días"})]}),e.jsx(d,{children:e.jsx("div",{className:"text-2xl font-bold",children:g})})]}),e.jsxs(a,{children:[e.jsx(i,{className:"pb-2",children:e.jsx(c,{className:"text-sm font-medium",children:"Cobertura"})}),e.jsx(d,{children:e.jsxs("div",{className:"text-2xl font-bold",children:[j>0?Math.round(g/j*100):0,"%"]})})]}),e.jsxs(a,{children:[e.jsx(i,{className:"pb-2",children:e.jsx(c,{className:"text-sm font-medium",children:"Estado General"})}),e.jsx(d,{children:e.jsx("div",{className:"flex items-center gap-2",children:g>0?e.jsxs(e.Fragment,{children:[e.jsx(z,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{className:"text-sm",children:"Activo"})]}):e.jsxs(e.Fragment,{children:[e.jsx(B,{className:"w-4 h-4 text-yellow-500"}),e.jsx("span",{className:"text-sm",children:"Pendiente"})]})})})]})]}),e.jsx(a,{className:"p-4 mb-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-center justify-between",children:[e.jsxs("div",{className:"flex gap-4 items-center",children:[e.jsxs("div",{className:"relative",children:[e.jsx(L,{className:"absolute left-2 top-2.5 h-4 w-4 text-gray-500"}),e.jsx(P,{placeholder:"Buscar mantenimientos...",value:r,onChange:s=>y(s.target.value),className:"pl-8 w-64"})]}),e.jsxs("select",{value:o,onChange:s=>f(s.target.value),className:"px-3 py-2 border rounded-md",children:[e.jsx("option",{value:"all",children:"Todos los tipos"}),e.jsx("option",{value:"preventivo",children:"Preventivo"}),e.jsx("option",{value:"correctivo",children:"Correctivo"}),e.jsx("option",{value:"poda",children:"Poda"}),e.jsx("option",{value:"riego",children:"Riego"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"flex bg-gray-100 rounded-md p-1",children:[e.jsx(t,{variant:x==="grid"?"default":"ghost",size:"sm",onClick:()=>u("grid"),children:e.jsx(E,{className:"w-4 h-4"})}),e.jsx(t,{variant:x==="list"?"default":"ghost",size:"sm",onClick:()=>u("list"),children:e.jsx(k,{className:"w-4 h-4"})})]}),e.jsxs(t,{variant:"outline",size:"sm",children:[e.jsx(A,{className:"w-4 h-4 mr-2"}),"Exportar"]})]})]})}),e.jsx(a,{className:"p-6",children:w?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-600 mx-auto"}),e.jsx("p",{className:"mt-2 text-gray-500",children:"Cargando mantenimientos..."})]}):N.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(v,{className:"w-12 h-12 mx-auto mb-4 text-gray-400"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No hay mantenimientos registrados"}),e.jsx("p",{children:"Comienza registrando el primer mantenimiento de árboles."})]}):e.jsx("div",{className:x==="grid"?"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4":"space-y-4",children:N.map(s=>e.jsxs(a,{className:"p-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:s.maintenanceType||"Mantenimiento General"}),e.jsx("p",{className:"text-sm text-gray-500",children:s.maintenanceDate||s.maintenance_date||"Sin fecha"})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(t,{variant:"ghost",size:"sm",children:e.jsx(G,{className:"w-4 h-4"})}),e.jsx(t,{variant:"ghost",size:"sm",children:e.jsx(R,{className:"w-4 h-4"})}),e.jsx(t,{variant:"ghost",size:"sm",children:e.jsx(q,{className:"w-4 h-4"})})]})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:s.notes||"Sin observaciones"}),e.jsxs("div",{className:"flex justify-between items-center text-xs text-gray-500",children:[e.jsxs("span",{children:["Por: ",s.performedBy||"No especificado"]}),e.jsx("span",{className:`px-2 py-1 rounded-full ${s.urgency==="alta"?"bg-red-100 text-red-800":s.urgency==="media"?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:s.urgency||"Normal"})]})]},s.id))})})]})})}export{Q as default};
