import{a2 as r,u as K,ag as U,j as e,aX as re,f as c,i as d,a_ as H,b1 as ts,b2 as is,b3 as ce,b0 as de,b4 as me,U as ls,K as oe,ah as D,bo as M,a4 as ns,O as rs,Q as xe,V as he,W as je,Y as pe,_ as y,B as l,a5 as ge,a6 as Ne,D as cs,g as ue,h as fe,ab as ds,ao as ve,bn as be,au as ye,m as we,n as Ce,r as x,aM as Se,aN as Ee,w as ms,y as os,z as xs,I as hs,J as js,o as w,M as ps,R as gs,b$ as De,c1 as Me,c2 as Pe,c3 as ke,c4 as Ae,c5 as Re,c6 as Te,c7 as ze,cb as C,ca as Q,a1 as p}from"./index-D5qLf1ib.js";const us=()=>{var te,ie,le;const[P,Fe]=r.useState(""),[k,Ie]=r.useState("all"),[A,Le]=r.useState("all"),[h,L]=r.useState(1),[R,J]=r.useState("cards"),[t,Oe]=r.useState(null),[$e,T]=r.useState(!1),[X,qe]=r.useState("registrations"),[z,W]=r.useState("cards"),[S,O]=r.useState(1),[m,E]=r.useState([]),[Be,$]=r.useState(!1),[Y,Z]=r.useState(null),[Ve,q]=r.useState(!1),B=10,_e=10,{data:f,isLoading:Ge}=K({queryKey:["/api/activity-registrations",h,P,k,A],queryFn:async()=>{const s=new URLSearchParams({page:h.toString(),limit:_e.toString(),...P&&{search:P},...k!=="all"&&{status:k},...A!=="all"&&{activity:A}}),a=await fetch(`/api/activity-registrations?${s}`);if(!a.ok)throw new Error("Error al cargar inscripciones");return a.json()}}),{data:Ke}=K({queryKey:["/api/activities"],queryFn:async()=>{const s=await fetch("/api/activities");if(!s.ok)throw new Error("Error al cargar actividades");return s.json()}}),{data:j,isLoading:Ue}=K({queryKey:["/api/activities-summary-data"],queryFn:async()=>{const s=await fetch("/api/activities-summary-data");if(!s.ok)throw new Error("Error al cargar resumen de actividades");return s.json()},enabled:X==="summary"}),g=(f==null?void 0:f.registrations)||[],N=((te=f==null?void 0:f.pagination)==null?void 0:te.totalPages)||1,He=Ke||[],F=(j==null?void 0:j.length)||0,v=Math.ceil(F/B),V=(S-1)*B,ee=V+B,se=(j==null?void 0:j.slice(V,ee))||[],u=U({mutationFn:async({id:s,status:a,reason:i})=>{const n=await fetch(`/api/activity-registrations/${s}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:a,rejectionReason:i})});if(!n.ok)throw new Error("Error al actualizar estado");return n.json()},onSuccess:()=>{C({title:"Estado actualizado",description:"El estado de la inscripción ha sido actualizado exitosamente."}),Q.invalidateQueries({queryKey:["/api/activity-registrations"]})},onError:()=>{C({title:"Error",description:"Hubo un problema al actualizar el estado de la inscripción.",variant:"destructive"})}}),_=U({mutationFn:async s=>{const a=await fetch(`/api/activity-registrations/${s}`,{method:"DELETE"});if(!a.ok){const i=await a.json();throw new Error(i.error||"Error al eliminar inscripción")}return a.json()},onSuccess:s=>{C({title:"Inscripción eliminada",description:s.message}),Q.invalidateQueries({queryKey:["/api/activity-registrations"]}),Z(null),$(!1)},onError:s=>{C({title:"Error",description:s.message,variant:"destructive"})}}),I=U({mutationFn:async s=>{const a=await fetch("/api/activity-registrations/bulk-delete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({registrationIds:s})});if(!a.ok){const i=await a.json();throw new Error(i.error||"Error al eliminar inscripciones")}return a.json()},onSuccess:s=>{C({title:"Inscripciones eliminadas",description:s.message}),Q.invalidateQueries({queryKey:["/api/activity-registrations"]}),E([]),q(!1)},onError:s=>{C({title:"Error",description:s.message,variant:"destructive"})}}),G=s=>{switch(s){case"approved":return e.jsxs(w,{variant:"default",className:"bg-green-100 text-green-800",children:[e.jsx(D,{className:"w-3 h-3 mr-1"}),"Aprobada"]});case"rejected":return e.jsxs(w,{variant:"destructive",children:[e.jsx(M,{className:"w-3 h-3 mr-1"}),"Rechazada"]});case"pending":default:return e.jsxs(w,{variant:"secondary",children:[e.jsx(oe,{className:"w-3 h-3 mr-1"}),"Pendiente"]})}},o=g,b=(s,a,i)=>{u.mutate({id:s,status:a,reason:i})},Qe=()=>{const s=[["Actividad","Participante","Email","Teléfono","Estado","Fecha de Inscripción"],...o.map(n=>{var ne;return[((ne=n.activity)==null?void 0:ne.title)||"",n.participantName,n.participantEmail,n.participantPhone||"",n.status,x(new Date(n.registrationDate),"dd/MM/yyyy",{locale:p})]})].map(n=>n.join(",")).join(`
`),a=new Blob([s],{type:"text/csv;charset=utf-8;"}),i=document.createElement("a");i.href=URL.createObjectURL(a),i.download=`inscripciones_actividades_${x(new Date,"dd-MM-yyyy")}.csv`,i.click()},ae=s=>{Oe(s),T(!0)},Je=(s,a)=>{E(a?i=>[...i,s]:i=>i.filter(n=>n!==s))},Xe=s=>{E(s?o.map(a=>a.id):[])},We=o.length>0&&m.length===o.length,Ye=m.length>0&&m.length<o.length,Ze=s=>{Z(s),$(!0)},es=()=>{Y&&_.mutate(Y)},ss=()=>{q(!0)},as=()=>{I.mutate(m)};return Ge?e.jsx(re,{children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-[#00a587] mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Cargando inscripciones..."})]})})}):e.jsx(re,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(c,{className:"p-4 bg-gray-50",children:e.jsxs(d,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(H,{className:"w-8 h-8 text-gray-900"}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Gestión de Inscripciones"})]}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Administra las inscripciones ciudadanas a actividades públicas"})]})}),e.jsxs(ts,{value:X,onValueChange:qe,className:"w-full",children:[e.jsxs(is,{className:"grid w-full grid-cols-2",children:[e.jsxs(ce,{value:"registrations",className:"flex items-center gap-2",children:[e.jsx(H,{className:"h-4 w-4"}),"Inscripciones"]}),e.jsxs(ce,{value:"summary",className:"flex items-center gap-2",children:[e.jsx(de,{className:"h-4 w-4"}),"Resumen de Actividades"]})]}),e.jsxs(me,{value:"registrations",className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(c,{children:e.jsx(d,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Inscripciones"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:g.length})]}),e.jsx(ls,{className:"h-8 w-8 text-blue-600"})]})})}),e.jsx(c,{children:e.jsx(d,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Pendientes"}),e.jsx("p",{className:"text-2xl font-bold text-orange-600",children:g.filter(s=>s.status==="pending").length})]}),e.jsx(oe,{className:"h-8 w-8 text-orange-600"})]})})}),e.jsx(c,{children:e.jsx(d,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Aprobadas"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:g.filter(s=>s.status==="approved").length})]}),e.jsx(D,{className:"h-8 w-8 text-green-600"})]})})}),e.jsx(c,{children:e.jsx(d,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Rechazadas"}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:g.filter(s=>s.status==="rejected").length})]}),e.jsx(M,{className:"h-8 w-8 text-red-600"})]})})})]}),e.jsx(c,{children:e.jsx(d,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-center justify-between",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 flex-1",children:[e.jsxs("div",{className:"relative flex-1 max-w-sm",children:[e.jsx(ns,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(rs,{placeholder:"Buscar por nombre, email o actividad...",value:P,onChange:s=>Fe(s.target.value),className:"pl-10"})]}),e.jsxs(xe,{value:k,onValueChange:Ie,children:[e.jsx(he,{className:"w-40",children:e.jsx(je,{placeholder:"Estado"})}),e.jsxs(pe,{children:[e.jsx(y,{value:"all",children:"Todos los estados"}),e.jsx(y,{value:"pending",children:"Pendientes"}),e.jsx(y,{value:"approved",children:"Aprobadas"}),e.jsx(y,{value:"rejected",children:"Rechazadas"})]})]}),e.jsxs(xe,{value:A,onValueChange:Le,children:[e.jsx(he,{className:"w-48",children:e.jsx(je,{placeholder:"Actividad"})}),e.jsxs(pe,{children:[e.jsx(y,{value:"all",children:"Todas las actividades"}),He.map(s=>e.jsx(y,{value:s.id.toString(),children:s.title},s.id))]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"flex border rounded-lg p-1",children:[e.jsxs(l,{variant:R==="cards"?"default":"ghost",size:"sm",onClick:()=>J("cards"),className:"flex items-center gap-1",children:[e.jsx(ge,{className:"h-4 w-4"}),"Grid"]}),e.jsxs(l,{variant:R==="table"?"default":"ghost",size:"sm",onClick:()=>J("table"),className:"flex items-center gap-1",children:[e.jsx(Ne,{className:"h-4 w-4"}),"Lista"]})]}),e.jsxs(l,{variant:"outline",onClick:Qe,className:"flex items-center gap-2",children:[e.jsx(cs,{className:"h-4 w-4"}),"Exportar CSV"]})]})]})})}),e.jsxs(c,{children:[e.jsx(ue,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("div",{children:[e.jsx(fe,{children:"Inscripciones de Actividades"}),e.jsxs(ds,{children:["Gestiona las solicitudes de inscripción de los ciudadanos (",g.length," total)"]})]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ve,{id:"select-all",checked:We,ref:s=>{s&&(s.indeterminate=Ye)},onCheckedChange:Xe}),e.jsx("label",{htmlFor:"select-all",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Seleccionar todo"})]}),m.length>0&&e.jsxs(l,{variant:"destructive",size:"sm",onClick:ss,disabled:I.isPending,className:"flex items-center gap-2",children:[e.jsx(be,{className:"h-4 w-4"}),"Eliminar (",m.length,")"]})]})]})}),e.jsx(d,{children:o.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(H,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No hay inscripciones"}),e.jsx("p",{className:"text-gray-600",children:"No se encontraron inscripciones con los filtros aplicados."})]}):e.jsxs(e.Fragment,{children:[R==="cards"&&e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:o.map(s=>{var a;return e.jsx(c,{className:"hover:shadow-md transition-shadow",children:e.jsxs(d,{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[e.jsx(ve,{checked:m.includes(s.id),onCheckedChange:i=>Je(s.id,i)}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-lg",children:s.participantName}),e.jsx("p",{className:"text-sm text-gray-600",children:s.participantEmail})]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(l,{variant:"ghost",size:"sm",onClick:()=>ae(s),className:"h-8 w-8 p-0",children:e.jsx(ye,{className:"h-4 w-4"})}),e.jsx(l,{variant:"ghost",size:"sm",onClick:()=>Ze(s.id),className:"h-8 w-8 p-0 text-red-600 hover:text-red-700 hover:bg-red-50",children:e.jsx(be,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(we,{className:"h-3 w-3"}),e.jsx("span",{className:"font-medium truncate",children:(a=s.activity)==null?void 0:a.title})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ce,{className:"h-3 w-3"}),e.jsx("span",{children:x(new Date(s.registrationDate),"dd/MM/yyyy",{locale:p})})]})]}),e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[G(s.status),s.status==="pending"&&e.jsxs("div",{className:"flex gap-1",children:[e.jsx(l,{size:"sm",onClick:()=>b(s.id,"approved"),disabled:u.isPending,className:"bg-green-600 hover:bg-green-700 h-8 px-2",children:e.jsx(D,{className:"h-3 w-3"})}),e.jsx(l,{size:"sm",variant:"destructive",onClick:()=>{const i=prompt("Motivo del rechazo (opcional):");b(s.id,"rejected",i||void 0)},disabled:u.isPending,className:"h-8 px-2",children:e.jsx(M,{className:"h-3 w-3"})})]})]})]})},s.id)})}),R==="table"&&e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b bg-gray-50",children:[e.jsx("th",{className:"text-left p-3 font-medium",children:"Participante"}),e.jsx("th",{className:"text-left p-3 font-medium",children:"Actividad"}),e.jsx("th",{className:"text-left p-3 font-medium",children:"Email"}),e.jsx("th",{className:"text-left p-3 font-medium",children:"Estado"}),e.jsx("th",{className:"text-left p-3 font-medium",children:"Fecha"}),e.jsx("th",{className:"text-center p-3 font-medium",children:"Acciones"})]})}),e.jsx("tbody",{children:o.map(s=>{var a;return e.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[e.jsx("td",{className:"p-3",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:s.participantName}),s.participantPhone&&e.jsx("div",{className:"text-sm text-gray-600",children:s.participantPhone})]})}),e.jsx("td",{className:"p-3",children:e.jsx("div",{className:"font-medium",children:(a=s.activity)==null?void 0:a.title})}),e.jsx("td",{className:"p-3",children:e.jsx("div",{className:"text-sm",children:s.participantEmail})}),e.jsx("td",{className:"p-3",children:G(s.status)}),e.jsx("td",{className:"p-3",children:e.jsx("div",{className:"text-sm",children:x(new Date(s.registrationDate),"dd/MM/yyyy",{locale:p})})}),e.jsx("td",{className:"p-3",children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(l,{variant:"ghost",size:"sm",onClick:()=>ae(s),className:"h-8 w-8 p-0",children:e.jsx(ye,{className:"h-4 w-4"})}),s.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsx(l,{size:"sm",onClick:()=>b(s.id,"approved"),disabled:u.isPending,className:"bg-green-600 hover:bg-green-700 h-8 px-2",children:e.jsx(D,{className:"h-3 w-3"})}),e.jsx(l,{size:"sm",variant:"destructive",onClick:()=>{const i=prompt("Motivo del rechazo (opcional):");b(s.id,"rejected",i||void 0)},disabled:u.isPending,className:"h-8 px-2",children:e.jsx(M,{className:"h-3 w-3"})})]})]})})]},s.id)})})]})})]})})]}),N>1&&e.jsx(c,{children:e.jsx(d,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Página ",h," de ",N," • Mostrando ",o.length," de ",g.length," inscripciones"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(l,{variant:"outline",size:"sm",onClick:()=>L(s=>Math.max(s-1,1)),disabled:h===1,className:"flex items-center gap-1",children:[e.jsx(Se,{className:"h-4 w-4"}),"Anterior"]}),e.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:Math.min(5,N)},(s,a)=>{let i;return N<=5?i=a+1:i=Math.max(1,h-2)+a,i>N?null:e.jsx(l,{variant:h===i?"default":"outline",size:"sm",onClick:()=>L(i),className:h===i?"bg-[#00a587] hover:bg-[#067f5f]":"",children:i},i)})}),e.jsxs(l,{variant:"outline",size:"sm",onClick:()=>L(s=>Math.min(s+1,N)),disabled:h===N,className:"flex items-center gap-1",children:["Siguiente",e.jsx(Ee,{className:"h-4 w-4"})]})]})]})})}),e.jsx(ms,{open:$e,onOpenChange:T,children:e.jsxs(os,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(xs,{children:[e.jsx(hs,{children:"Detalles de la Inscripción"}),e.jsx(js,{children:"Ver información completa del participante y la actividad"})]}),t&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold border-b pb-2",children:"Información del Participante"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Nombre completo"}),e.jsx("p",{className:"text-lg font-semibold",children:t.participantName})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Email"}),e.jsx("p",{className:"text-sm",children:t.participantEmail})]}),t.participantPhone&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Teléfono"}),e.jsx("p",{className:"text-sm",children:t.participantPhone})]}),t.age&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Edad"}),e.jsxs("p",{className:"text-sm",children:[t.age," años"]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold border-b pb-2",children:"Información de la Actividad"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Actividad"}),e.jsx("p",{className:"text-lg font-semibold",children:(ie=t.activity)==null?void 0:ie.title})]}),((le=t.activity)==null?void 0:le.startDate)&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Fecha de inicio"}),e.jsxs("p",{className:"text-sm",children:[x(new Date(t.activity.startDate),"dd/MM/yyyy",{locale:p}),t.activity.startTime&&` a las ${t.activity.startTime}`]})]}),t.activity.endDate&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Fecha de fin"}),e.jsx("p",{className:"text-sm",children:x(new Date(t.activity.endDate),"dd/MM/yyyy",{locale:p})})]})]})]})]}),(t.emergencyContactName||t.emergencyPhone)&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold border-b pb-2",children:"Contacto de Emergencia"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.emergencyContactName&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Nombre"}),e.jsx("p",{className:"text-sm",children:t.emergencyContactName})]}),t.emergencyPhone&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Teléfono"}),e.jsx("p",{className:"text-sm",children:t.emergencyPhone})]})]})]}),(t.medicalConditions||t.dietaryRestrictions)&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold border-b pb-2",children:"Información Médica"}),t.medicalConditions&&e.jsxs("div",{className:"p-3 bg-yellow-50 border border-yellow-200 rounded",children:[e.jsx("label",{className:"text-sm font-medium text-yellow-800",children:"Condiciones médicas"}),e.jsx("p",{className:"text-sm text-yellow-700 mt-1",children:t.medicalConditions})]}),t.dietaryRestrictions&&e.jsxs("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded",children:[e.jsx("label",{className:"text-sm font-medium text-blue-800",children:"Restricciones alimentarias"}),e.jsx("p",{className:"text-sm text-blue-700 mt-1",children:t.dietaryRestrictions})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold border-b pb-2",children:"Estado de la Inscripción"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Estado actual:"}),G(t.status)]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Fecha de inscripción"}),e.jsx("p",{className:"text-sm",children:x(new Date(t.registrationDate),"dd/MM/yyyy HH:mm",{locale:p})})]}),t.rejectionReason&&e.jsxs("div",{className:"p-3 bg-red-50 border border-red-200 rounded",children:[e.jsx("label",{className:"text-sm font-medium text-red-800",children:"Motivo de rechazo"}),e.jsx("p",{className:"text-sm text-red-700 mt-1",children:t.rejectionReason})]}),t.notes&&e.jsxs("div",{className:"p-3 bg-gray-50 border border-gray-200 rounded",children:[e.jsx("label",{className:"text-sm font-medium text-gray-800",children:"Notas adicionales"}),e.jsx("p",{className:"text-sm text-gray-700 mt-1",children:t.notes})]})]}),t.status==="pending"&&e.jsxs("div",{className:"flex gap-2 pt-4 border-t",children:[e.jsxs(l,{onClick:()=>{b(t.id,"approved"),T(!1)},disabled:u.isPending,className:"bg-green-600 hover:bg-green-700 flex-1",children:[e.jsx(D,{className:"h-4 w-4 mr-2"}),"Aprobar Inscripción"]}),e.jsxs(l,{variant:"destructive",onClick:()=>{const s=prompt("Motivo del rechazo (opcional):");b(t.id,"rejected",s||void 0),T(!1)},disabled:u.isPending,className:"flex-1",children:[e.jsx(M,{className:"h-4 w-4 mr-2"}),"Rechazar Inscripción"]})]})]})]})]})})]}),e.jsx(me,{value:"summary",className:"space-y-6",children:Ue?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-[#00a587] mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Cargando resumen de actividades..."})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx(c,{children:e.jsx(d,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Resumen de Actividades"}),e.jsxs("p",{className:"text-gray-600",children:["Estadísticas detalladas de inscripciones por actividad (",F," total)"]})]}),e.jsxs("div",{className:"flex border rounded-lg p-1",children:[e.jsxs(l,{variant:z==="cards"?"default":"ghost",size:"sm",onClick:()=>W("cards"),className:"flex items-center gap-1",children:[e.jsx(ge,{className:"h-4 w-4"}),"Tarjetas"]}),e.jsxs(l,{variant:z==="table"?"default":"ghost",size:"sm",onClick:()=>W("table"),className:"flex items-center gap-1",children:[e.jsx(Ne,{className:"h-4 w-4"}),"Lista"]})]})]})})}),j&&j.length>0?e.jsxs(e.Fragment,{children:[z==="cards"&&e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6",children:se.map(s=>e.jsxs(c,{className:"hover:shadow-lg transition-shadow",children:[e.jsx(ue,{className:"pb-2",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(fe,{className:"text-lg line-clamp-2",children:s.title}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:s.category})]}),e.jsx(w,{variant:s.registrationEnabled?"default":"secondary",children:s.registrationEnabled?"Activa":"Cerrada"})]})}),e.jsxs(d,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx(ps,{className:"h-3 w-3"}),e.jsx("span",{className:"truncate",children:s.parkName})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx(we,{className:"h-3 w-3"}),e.jsx("span",{children:x(new Date(s.startDate),"dd/MM/yyyy",{locale:p})})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx(Ce,{className:"h-3 w-3"}),e.jsx("span",{children:s.startTime})]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h4",{className:"font-medium text-sm mb-3",children:"Estadísticas de Inscripciones"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"text-center p-2 bg-blue-50 rounded",children:[e.jsx("div",{className:"text-lg font-bold text-blue-600",children:s.registrationStats.totalRegistrations}),e.jsx("div",{className:"text-xs text-gray-600",children:"Total"})]}),e.jsxs("div",{className:"text-center p-2 bg-green-50 rounded",children:[e.jsx("div",{className:"text-lg font-bold text-green-600",children:s.registrationStats.approved}),e.jsx("div",{className:"text-xs text-gray-600",children:"Aprobadas"})]}),e.jsxs("div",{className:"text-center p-2 bg-orange-50 rounded",children:[e.jsx("div",{className:"text-lg font-bold text-orange-600",children:s.registrationStats.pending}),e.jsx("div",{className:"text-xs text-gray-600",children:"Pendientes"})]}),e.jsxs("div",{className:"text-center p-2 bg-gray-50 rounded",children:[e.jsx("div",{className:"text-lg font-bold text-gray-600",children:s.registrationStats.availableSlots}),e.jsx("div",{className:"text-xs text-gray-600",children:"Disponibles"})]})]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"Capacidad"}),e.jsxs("span",{className:"text-sm text-gray-600",children:[s.registrationStats.totalRegistrations," / ",s.capacity||s.maxRegistrations||"Sin límite"]})]}),!s.isFree&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:"Ingresos"}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-sm font-bold text-green-600",children:["$",s.revenue.totalRevenue.toLocaleString()]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Potencial: $",s.revenue.potentialRevenue.toLocaleString()]})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Precio"}),e.jsx(w,{variant:s.isFree?"secondary":"outline",children:s.isFree?"Gratuita":`$${parseFloat(s.price).toLocaleString()}`})]})]})]},s.id))}),z==="table"&&e.jsx(c,{children:e.jsx(d,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-4 font-medium text-gray-900",children:"Actividad"}),e.jsx("th",{className:"text-left p-4 font-medium text-gray-900",children:"Parque"}),e.jsx("th",{className:"text-center p-4 font-medium text-gray-900",children:"Total"}),e.jsx("th",{className:"text-center p-4 font-medium text-gray-900",children:"Aprobadas"}),e.jsx("th",{className:"text-center p-4 font-medium text-gray-900",children:"Pendientes"}),e.jsx("th",{className:"text-center p-4 font-medium text-gray-900",children:"Disponibles"}),e.jsx("th",{className:"text-right p-4 font-medium text-gray-900",children:"Ingresos"}),e.jsx("th",{className:"text-center p-4 font-medium text-gray-900",children:"Estado"})]})}),e.jsx("tbody",{children:se.map((s,a)=>e.jsxs("tr",{className:a%2===0?"bg-white":"bg-gray-50",children:[e.jsx("td",{className:"p-4",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900 line-clamp-1",children:s.title}),e.jsx("div",{className:"text-sm text-gray-600",children:s.category}),e.jsxs("div",{className:"text-xs text-gray-500",children:[x(new Date(s.startDate),"dd/MM/yyyy",{locale:p})," - ",s.startTime]})]})}),e.jsx("td",{className:"p-4 text-sm text-gray-600",children:s.parkName}),e.jsx("td",{className:"p-4 text-center",children:e.jsx("span",{className:"inline-flex items-center justify-center w-8 h-8 bg-blue-100 text-blue-800 rounded-full text-sm font-medium",children:s.registrationStats.totalRegistrations})}),e.jsx("td",{className:"p-4 text-center",children:e.jsx("span",{className:"inline-flex items-center justify-center w-8 h-8 bg-green-100 text-green-800 rounded-full text-sm font-medium",children:s.registrationStats.approved})}),e.jsx("td",{className:"p-4 text-center",children:e.jsx("span",{className:"inline-flex items-center justify-center w-8 h-8 bg-orange-100 text-orange-800 rounded-full text-sm font-medium",children:s.registrationStats.pending})}),e.jsx("td",{className:"p-4 text-center",children:e.jsx("span",{className:"inline-flex items-center justify-center w-8 h-8 bg-gray-100 text-gray-800 rounded-full text-sm font-medium",children:s.registrationStats.availableSlots})}),e.jsx("td",{className:"p-4 text-right",children:s.isFree?e.jsx("span",{className:"text-gray-500",children:"Gratuita"}):e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium text-green-600",children:["$",s.revenue.totalRevenue.toLocaleString()]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Pot: $",s.revenue.potentialRevenue.toLocaleString()]})]})}),e.jsx("td",{className:"p-4 text-center",children:e.jsx(w,{variant:s.registrationEnabled?"default":"secondary",children:s.registrationEnabled?"Activa":"Cerrada"})})]},s.id))})]})})})}),v>1&&e.jsx(c,{children:e.jsx(d,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Mostrando ",V+1,"-",Math.min(ee,F)," de ",F," actividades"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(l,{variant:"outline",size:"sm",onClick:()=>O(s=>Math.max(s-1,1)),disabled:S===1,className:"flex items-center gap-1",children:[e.jsx(Se,{className:"h-4 w-4"}),"Anterior"]}),e.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:v},(s,a)=>a+1).filter(s=>v<=7||s===1||s===v||Math.abs(s-S)<=1).map((s,a,i)=>e.jsxs(gs.Fragment,{children:[a>0&&i[a-1]!==s-1&&e.jsx("span",{className:"px-2 text-gray-400",children:"..."}),e.jsx(l,{variant:S===s?"default":"outline",size:"sm",onClick:()=>O(s),className:"w-8 h-8 p-0",children:s})]},s))}),e.jsxs(l,{variant:"outline",size:"sm",onClick:()=>O(s=>Math.min(s+1,v)),disabled:S===v,className:"flex items-center gap-1",children:["Siguiente",e.jsx(Ee,{className:"h-4 w-4"})]})]})]})})})]}):e.jsx(c,{children:e.jsx(d,{className:"p-6",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(de,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Sin Actividades"}),e.jsx("p",{className:"text-gray-600",children:"No hay actividades disponibles para mostrar estadísticas."})]})})})]})})]}),e.jsx(De,{open:Be,onOpenChange:$,children:e.jsxs(Me,{children:[e.jsxs(Pe,{children:[e.jsx(ke,{children:"¿Eliminar inscripción?"}),e.jsx(Ae,{children:"Esta acción eliminará permanentemente la inscripción seleccionada. Esta acción no se puede deshacer."})]}),e.jsxs(Re,{children:[e.jsx(Te,{children:"Cancelar"}),e.jsx(ze,{onClick:es,disabled:_.isPending,className:"bg-red-600 hover:bg-red-700",children:_.isPending?"Eliminando...":"Eliminar"})]})]})}),e.jsx(De,{open:Ve,onOpenChange:q,children:e.jsxs(Me,{children:[e.jsxs(Pe,{children:[e.jsxs(ke,{children:["¿Eliminar ",m.length," inscripciones?"]}),e.jsxs(Ae,{children:["Esta acción eliminará permanentemente las ",m.length," inscripciones seleccionadas. Esta acción no se puede deshacer."]})]}),e.jsxs(Re,{children:[e.jsx(Te,{children:"Cancelar"}),e.jsx(ze,{onClick:as,disabled:I.isPending,className:"bg-red-600 hover:bg-red-700",children:I.isPending?"Eliminando...":`Eliminar ${m.length} inscripciones`})]})]})})]})})};export{us as default};
