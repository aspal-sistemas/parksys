import{l as ae,ae as se,a2 as u,u as O,ag as d,j as e,aX as ie,b1 as ne,b2 as re,b3 as K,b4 as M,f as Q,g as $,h as B,as as U,ab as H,w as E,x as R,B as t,bh as G,y as w,z as D,I as P,J as T,N as g,O as q,$ as L,i as J,o as j,bq as V,bn as X,aq as m}from"./index-D5qLf1ib.js";import{T as W}from"./trending-down-Bn0HnEog.js";function oe(){const{toast:r}=ae(),o=se(),[I,l]=u.useState(!1),[s,x]=u.useState(null),[Y,h]=u.useState(!1),[i,c]=u.useState({name:"",description:"",type:"ingreso"}),{data:v,isLoading:Z}=O({queryKey:["/api/finance/income-categories"]}),{data:N,isLoading:_}=O({queryKey:["/api/finance/expense-categories"]}),C=d({mutationFn:async a=>m("/api/finance/income-categories",{method:"POST",data:a}),onSuccess:()=>{o.invalidateQueries({queryKey:["/api/finance/income-categories"]}),r({title:"Categoría creada",description:"La categoría de ingresos se ha creado exitosamente."}),l(!1),c({name:"",description:"",type:"ingreso"})},onError:a=>{r({title:"Error",description:"No se pudo crear la categoría. Inténtalo de nuevo.",variant:"destructive"}),console.error("Error creando categoría:",a)}}),y=d({mutationFn:async a=>m("/api/finance/expense-categories",{method:"POST",data:a}),onSuccess:()=>{o.invalidateQueries({queryKey:["/api/finance/expense-categories"]}),r({title:"Categoría creada",description:"La categoría de egresos se ha creado exitosamente."}),l(!1),c({name:"",description:"",type:"ingreso"})},onError:a=>{r({title:"Error",description:"No se pudo crear la categoría. Inténtalo de nuevo.",variant:"destructive"}),console.error("Error creando categoría:",a)}}),f=d({mutationFn:async({id:a,categoryData:n})=>await m(`/api/finance/income-categories/${a}`,{method:"PUT",data:n}),onSuccess:()=>{o.invalidateQueries({queryKey:["/api/finance/income-categories"]}),r({title:"Categoría actualizada",description:"La categoría se ha actualizado exitosamente."}),h(!1),x(null)}}),b=d({mutationFn:async({id:a,categoryData:n})=>await m(`/api/finance/expense-categories/${a}`,{method:"PUT",data:n}),onSuccess:()=>{o.invalidateQueries({queryKey:["/api/finance/expense-categories"]}),r({title:"Categoría actualizada",description:"La categoría se ha actualizado exitosamente."}),h(!1),x(null)}}),S=d({mutationFn:async a=>await m(`/api/income-categories/${a}`,{method:"DELETE"}),onSuccess:()=>{o.invalidateQueries({queryKey:["/api/finance/income-categories"]}),r({title:"Categoría eliminada",description:"La categoría de ingresos se ha eliminado exitosamente."})},onError:a=>{var n,p;r({title:"Error",description:((p=(n=a==null?void 0:a.response)==null?void 0:n.data)==null?void 0:p.message)||"No se pudo eliminar la categoría. Puede estar siendo usada en registros.",variant:"destructive"})}}),k=d({mutationFn:async a=>await m(`/api/expense-categories/${a}`,{method:"DELETE"}),onSuccess:()=>{o.invalidateQueries({queryKey:["/api/finance/expense-categories"]}),r({title:"Categoría eliminada",description:"La categoría de egresos se ha eliminado exitosamente."})},onError:a=>{var n,p;r({title:"Error",description:((p=(n=a==null?void 0:a.response)==null?void 0:n.data)==null?void 0:p.message)||"No se pudo eliminar la categoría. Puede estar siendo usada en registros.",variant:"destructive"})}}),z=()=>{if(!i.name.trim()){r({title:"Error",description:"El nombre de la categoría es requerido.",variant:"destructive"});return}i.type==="ingreso"?C.mutate({name:i.name,description:i.description}):y.mutate({name:i.name,description:i.description})},F=(a,n)=>{x({...a,type:n}),h(!0)},ee=()=>{var n;if(!((n=s==null?void 0:s.name)!=null&&n.trim())){r({title:"Error",description:"El nombre de la categoría es requerido.",variant:"destructive"});return}const a={name:s.name,description:s.description||""};s.type==="ingreso"?f.mutate({id:s.id,categoryData:a}):b.mutate({id:s.id,categoryData:a})},A=(a,n)=>{window.confirm("¿Estás seguro de que quieres eliminar esta categoría? Esta acción no se puede deshacer.")&&(n==="ingreso"?S.mutate(a):k.mutate(a))};return e.jsx(ie,{children:e.jsxs("div",{className:"container mx-auto p-6",children:[e.jsx("div",{className:"flex justify-between items-center mb-6",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Catálogo Financiero"}),e.jsx("p",{className:"text-muted-foreground",children:"Gestiona las categorías de ingresos y egresos del sistema"})]})}),e.jsxs(ne,{defaultValue:"income-categories",className:"space-y-6",children:[e.jsxs(re,{className:"grid w-full grid-cols-2",children:[e.jsx(K,{value:"income-categories",children:"Categorías de Ingresos"}),e.jsx(K,{value:"expense-categories",children:"Categorías de Egresos"})]}),e.jsx(M,{value:"income-categories",className:"space-y-6",children:e.jsxs(Q,{children:[e.jsx($,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs(B,{className:"flex items-center gap-2",children:[e.jsx(U,{className:"h-5 w-5 text-green-600"}),"Categorías de Ingresos"]}),e.jsx(H,{children:"Administra las categorías para clasificar los diferentes tipos de ingresos"})]}),e.jsxs(E,{open:I,onOpenChange:l,children:[e.jsx(R,{asChild:!0,children:e.jsxs(t,{onClick:()=>c({...i,type:"ingreso"}),children:[e.jsx(G,{className:"h-4 w-4 mr-2"}),"Nueva Categoría"]})}),e.jsxs(w,{children:[e.jsxs(D,{children:[e.jsx(P,{children:"Nueva Categoría de Ingresos"}),e.jsx(T,{children:"Crear una nueva categoría para organizar los conceptos de ingresos."})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(g,{htmlFor:"categoryName",className:"text-right",children:"Nombre"}),e.jsx(q,{id:"categoryName",value:i.name,onChange:a=>c({...i,name:a.target.value}),className:"col-span-3",placeholder:"Nombre de la categoría"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(g,{htmlFor:"categoryDescription",className:"text-right",children:"Descripción"}),e.jsx(L,{id:"categoryDescription",value:i.description,onChange:a=>c({...i,description:a.target.value}),className:"col-span-3",placeholder:"Descripción de la categoría"})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(t,{variant:"outline",onClick:()=>l(!1),children:"Cancelar"}),e.jsx(t,{onClick:z,disabled:C.isPending,children:C.isPending?"Creando...":"Crear Categoría"})]})]})]})]})}),e.jsx(J,{children:Z?e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{children:"Cargando categorías..."})}):e.jsx("div",{className:"space-y-4",children:v&&v.length>0?v.map(a=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsx("div",{className:"flex-1",children:e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:a.name}),e.jsx("p",{className:"text-sm text-gray-500",children:a.description}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx(j,{variant:"secondary",children:a.code}),e.jsx(j,{variant:a.isActive?"default":"secondary",children:a.isActive?"Activo":"Inactivo"})]})]})})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(t,{variant:"outline",size:"sm",onClick:()=>F(a,"ingreso"),children:e.jsx(V,{className:"h-4 w-4"})}),e.jsx(t,{variant:"outline",size:"sm",onClick:()=>A(a.id,"ingreso"),disabled:S.isPending,children:e.jsx(X,{className:"h-4 w-4"})})]})]},a.id)):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(U,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"No hay categorías de ingresos registradas"})]})})})]})}),e.jsx(M,{value:"expense-categories",className:"space-y-6",children:e.jsxs(Q,{children:[e.jsx($,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs(B,{className:"flex items-center gap-2",children:[e.jsx(W,{className:"h-5 w-5 text-red-600"}),"Categorías de Egresos"]}),e.jsx(H,{children:"Administra las categorías para clasificar los diferentes tipos de gastos"})]}),e.jsxs(E,{open:I,onOpenChange:l,children:[e.jsx(R,{asChild:!0,children:e.jsxs(t,{onClick:()=>c({...i,type:"egreso"}),children:[e.jsx(G,{className:"h-4 w-4 mr-2"}),"Nueva Categoría"]})}),e.jsxs(w,{children:[e.jsxs(D,{children:[e.jsx(P,{children:"Nueva Categoría de Egresos"}),e.jsx(T,{children:"Crear una nueva categoría para organizar los conceptos de gastos."})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(g,{htmlFor:"categoryName",className:"text-right",children:"Nombre"}),e.jsx(q,{id:"categoryName",value:i.name,onChange:a=>c({...i,name:a.target.value}),className:"col-span-3",placeholder:"Nombre de la categoría"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(g,{htmlFor:"categoryDescription",className:"text-right",children:"Descripción"}),e.jsx(L,{id:"categoryDescription",value:i.description,onChange:a=>c({...i,description:a.target.value}),className:"col-span-3",placeholder:"Descripción de la categoría"})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(t,{variant:"outline",onClick:()=>l(!1),children:"Cancelar"}),e.jsx(t,{onClick:z,disabled:y.isPending,children:y.isPending?"Creando...":"Crear Categoría"})]})]})]})]})}),e.jsx(J,{children:_?e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{children:"Cargando categorías..."})}):e.jsx("div",{className:"space-y-4",children:N&&N.length>0?N.map(a=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsx("div",{className:"flex-1",children:e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:a.name}),e.jsx("p",{className:"text-sm text-gray-500",children:a.description}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx(j,{variant:"secondary",children:a.code}),e.jsx(j,{variant:a.isActive?"default":"secondary",children:a.isActive?"Activo":"Inactivo"})]})]})})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(t,{variant:"outline",size:"sm",onClick:()=>F(a,"egreso"),children:e.jsx(V,{className:"h-4 w-4"})}),e.jsx(t,{variant:"outline",size:"sm",onClick:()=>A(a.id,"egreso"),disabled:k.isPending,children:e.jsx(X,{className:"h-4 w-4"})})]})]},a.id)):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(W,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"No hay categorías de egresos registradas"})]})})})]})})]}),e.jsx(E,{open:Y,onOpenChange:h,children:e.jsxs(w,{children:[e.jsxs(D,{children:[e.jsxs(P,{children:["Editar Categoría de ",(s==null?void 0:s.type)==="ingreso"?"Ingresos":"Egresos"]}),e.jsx(T,{children:"Modifica los datos de la categoría seleccionada."})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(g,{htmlFor:"editCategoryName",className:"text-right",children:"Nombre"}),e.jsx(q,{id:"editCategoryName",value:(s==null?void 0:s.name)||"",onChange:a=>x({...s,name:a.target.value}),className:"col-span-3",placeholder:"Nombre de la categoría"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(g,{htmlFor:"editCategoryDescription",className:"text-right",children:"Descripción"}),e.jsx(L,{id:"editCategoryDescription",value:(s==null?void 0:s.description)||"",onChange:a=>x({...s,description:a.target.value}),className:"col-span-3",placeholder:"Descripción de la categoría"})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(t,{variant:"outline",onClick:()=>h(!1),children:"Cancelar"}),e.jsx(t,{onClick:ee,disabled:f.isPending||b.isPending,children:f.isPending||b.isPending?"Actualizando...":"Actualizar Categoría"})]})]})})]})})}export{oe as default};
